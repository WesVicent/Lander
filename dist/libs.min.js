"use strict";var Box2D={};!function(t,n){function o(){}t.inherit=function(t,e){var i=t;o.prototype=e.prototype,t.prototype=new o,t.prototype.constructor=i},t.generateCallback=function(t,e){return function(){e.apply(t,arguments)}},t.NVector=function(t){t===n&&(t=0);for(var e=new Array(t||0),i=0;i<t;++i)e[i]=0;return e},t.is=function(t,e){return null!==t&&(e instanceof Function&&t instanceof e||!(t.constructor.__implements==n||!t.constructor.__implements[e]))},t.parseUInt=function(t){return Math.abs(parseInt(t))}}(Box2D);var i,Vector=Array,Vector_a2j_Number=Box2D.NVector;for(void 0===Box2D&&(Box2D={}),void 0===Box2D.Collision&&(Box2D.Collision={}),void 0===Box2D.Collision.Shapes&&(Box2D.Collision.Shapes={}),void 0===Box2D.Common&&(Box2D.Common={}),void 0===Box2D.Common.Math&&(Box2D.Common.Math={}),void 0===Box2D.Dynamics&&(Box2D.Dynamics={}),void 0===Box2D.Dynamics.Contacts&&(Box2D.Dynamics.Contacts={}),void 0===Box2D.Dynamics.Controllers&&(Box2D.Dynamics.Controllers={}),void 0===Box2D.Dynamics.Joints&&(Box2D.Dynamics.Joints={}),Box2D.Collision.IBroadPhase="Box2D.Collision.IBroadPhase",Box2D.Collision.b2AABB=function t(){t.b2AABB.apply(this,arguments)},Box2D.Collision.b2Bound=function t(){t.b2Bound.apply(this,arguments)},Box2D.Collision.b2BoundValues=function t(){t.b2BoundValues.apply(this,arguments),this.constructor===t&&this.b2BoundValues.apply(this,arguments)},Box2D.Collision.b2Collision=function t(){t.b2Collision.apply(this,arguments)},Box2D.Collision.b2ContactID=function t(){t.b2ContactID.apply(this,arguments),this.constructor===t&&this.b2ContactID.apply(this,arguments)},Box2D.Collision.b2ContactPoint=function t(){t.b2ContactPoint.apply(this,arguments)},Box2D.Collision.b2Distance=function t(){t.b2Distance.apply(this,arguments)},Box2D.Collision.b2DistanceInput=function t(){t.b2DistanceInput.apply(this,arguments)},Box2D.Collision.b2DistanceOutput=function t(){t.b2DistanceOutput.apply(this,arguments)},Box2D.Collision.b2DistanceProxy=function t(){t.b2DistanceProxy.apply(this,arguments)},Box2D.Collision.b2DynamicTree=function t(){t.b2DynamicTree.apply(this,arguments),this.constructor===t&&this.b2DynamicTree.apply(this,arguments)},Box2D.Collision.b2DynamicTreeBroadPhase=function t(){t.b2DynamicTreeBroadPhase.apply(this,arguments)},Box2D.Collision.b2DynamicTreeNode=function t(){t.b2DynamicTreeNode.apply(this,arguments)},Box2D.Collision.b2DynamicTreePair=function t(){t.b2DynamicTreePair.apply(this,arguments)},Box2D.Collision.b2Manifold=function t(){t.b2Manifold.apply(this,arguments),this.constructor===t&&this.b2Manifold.apply(this,arguments)},Box2D.Collision.b2ManifoldPoint=function t(){t.b2ManifoldPoint.apply(this,arguments),this.constructor===t&&this.b2ManifoldPoint.apply(this,arguments)},Box2D.Collision.b2Point=function t(){t.b2Point.apply(this,arguments)},Box2D.Collision.b2RayCastInput=function t(){t.b2RayCastInput.apply(this,arguments),this.constructor===t&&this.b2RayCastInput.apply(this,arguments)},Box2D.Collision.b2RayCastOutput=function t(){t.b2RayCastOutput.apply(this,arguments)},Box2D.Collision.b2Segment=function t(){t.b2Segment.apply(this,arguments)},Box2D.Collision.b2SeparationFunction=function t(){t.b2SeparationFunction.apply(this,arguments)},Box2D.Collision.b2Simplex=function t(){t.b2Simplex.apply(this,arguments),this.constructor===t&&this.b2Simplex.apply(this,arguments)},Box2D.Collision.b2SimplexCache=function t(){t.b2SimplexCache.apply(this,arguments)},Box2D.Collision.b2SimplexVertex=function t(){t.b2SimplexVertex.apply(this,arguments)},Box2D.Collision.b2TimeOfImpact=function t(){t.b2TimeOfImpact.apply(this,arguments)},Box2D.Collision.b2TOIInput=function t(){t.b2TOIInput.apply(this,arguments)},Box2D.Collision.b2WorldManifold=function t(){t.b2WorldManifold.apply(this,arguments),this.constructor===t&&this.b2WorldManifold.apply(this,arguments)},Box2D.Collision.ClipVertex=function t(){t.ClipVertex.apply(this,arguments)},Box2D.Collision.Features=function t(){t.Features.apply(this,arguments)},Box2D.Collision.Shapes.b2CircleShape=function t(){t.b2CircleShape.apply(this,arguments),this.constructor===t&&this.b2CircleShape.apply(this,arguments)},Box2D.Collision.Shapes.b2EdgeChainDef=function t(){t.b2EdgeChainDef.apply(this,arguments),this.constructor===t&&this.b2EdgeChainDef.apply(this,arguments)},Box2D.Collision.Shapes.b2EdgeShape=function t(){t.b2EdgeShape.apply(this,arguments),this.constructor===t&&this.b2EdgeShape.apply(this,arguments)},Box2D.Collision.Shapes.b2MassData=function t(){t.b2MassData.apply(this,arguments)},Box2D.Collision.Shapes.b2PolygonShape=function t(){t.b2PolygonShape.apply(this,arguments),this.constructor===t&&this.b2PolygonShape.apply(this,arguments)},Box2D.Collision.Shapes.b2Shape=function t(){t.b2Shape.apply(this,arguments),this.constructor===t&&this.b2Shape.apply(this,arguments)},Box2D.Common.b2internal="Box2D.Common.b2internal",Box2D.Common.b2Color=function t(){t.b2Color.apply(this,arguments),this.constructor===t&&this.b2Color.apply(this,arguments)},Box2D.Common.b2Settings=function t(){t.b2Settings.apply(this,arguments)},Box2D.Common.Math.b2Mat22=function t(){t.b2Mat22.apply(this,arguments),this.constructor===t&&this.b2Mat22.apply(this,arguments)},Box2D.Common.Math.b2Mat33=function t(){t.b2Mat33.apply(this,arguments),this.constructor===t&&this.b2Mat33.apply(this,arguments)},Box2D.Common.Math.b2Math=function t(){t.b2Math.apply(this,arguments)},Box2D.Common.Math.b2Sweep=function t(){t.b2Sweep.apply(this,arguments)},Box2D.Common.Math.b2Transform=function t(){t.b2Transform.apply(this,arguments),this.constructor===t&&this.b2Transform.apply(this,arguments)},Box2D.Common.Math.b2Vec2=function t(){t.b2Vec2.apply(this,arguments),this.constructor===t&&this.b2Vec2.apply(this,arguments)},Box2D.Common.Math.b2Vec3=function t(){t.b2Vec3.apply(this,arguments),this.constructor===t&&this.b2Vec3.apply(this,arguments)},Box2D.Dynamics.b2Body=function t(){t.b2Body.apply(this,arguments),this.constructor===t&&this.b2Body.apply(this,arguments)},Box2D.Dynamics.b2BodyDef=function t(){t.b2BodyDef.apply(this,arguments),this.constructor===t&&this.b2BodyDef.apply(this,arguments)},Box2D.Dynamics.b2ContactFilter=function t(){t.b2ContactFilter.apply(this,arguments)},Box2D.Dynamics.b2ContactImpulse=function t(){t.b2ContactImpulse.apply(this,arguments)},Box2D.Dynamics.b2ContactListener=function t(){t.b2ContactListener.apply(this,arguments)},Box2D.Dynamics.b2ContactManager=function t(){t.b2ContactManager.apply(this,arguments),this.constructor===t&&this.b2ContactManager.apply(this,arguments)},Box2D.Dynamics.b2DebugDraw=function t(){t.b2DebugDraw.apply(this,arguments),this.constructor===t&&this.b2DebugDraw.apply(this,arguments)},Box2D.Dynamics.b2DestructionListener=function t(){t.b2DestructionListener.apply(this,arguments)},Box2D.Dynamics.b2FilterData=function t(){t.b2FilterData.apply(this,arguments)},Box2D.Dynamics.b2Fixture=function t(){t.b2Fixture.apply(this,arguments),this.constructor===t&&this.b2Fixture.apply(this,arguments)},Box2D.Dynamics.b2FixtureDef=function t(){t.b2FixtureDef.apply(this,arguments),this.constructor===t&&this.b2FixtureDef.apply(this,arguments)},Box2D.Dynamics.b2Island=function t(){t.b2Island.apply(this,arguments),this.constructor===t&&this.b2Island.apply(this,arguments)},Box2D.Dynamics.b2TimeStep=function t(){t.b2TimeStep.apply(this,arguments)},Box2D.Dynamics.b2World=function t(){t.b2World.apply(this,arguments),this.constructor===t&&this.b2World.apply(this,arguments)},Box2D.Dynamics.Contacts.b2CircleContact=function t(){t.b2CircleContact.apply(this,arguments)},Box2D.Dynamics.Contacts.b2Contact=function t(){t.b2Contact.apply(this,arguments),this.constructor===t&&this.b2Contact.apply(this,arguments)},Box2D.Dynamics.Contacts.b2ContactConstraint=function t(){t.b2ContactConstraint.apply(this,arguments),this.constructor===t&&this.b2ContactConstraint.apply(this,arguments)},Box2D.Dynamics.Contacts.b2ContactConstraintPoint=function t(){t.b2ContactConstraintPoint.apply(this,arguments)},Box2D.Dynamics.Contacts.b2ContactEdge=function t(){t.b2ContactEdge.apply(this,arguments)},Box2D.Dynamics.Contacts.b2ContactFactory=function t(){t.b2ContactFactory.apply(this,arguments),this.constructor===t&&this.b2ContactFactory.apply(this,arguments)},Box2D.Dynamics.Contacts.b2ContactRegister=function t(){t.b2ContactRegister.apply(this,arguments)},Box2D.Dynamics.Contacts.b2ContactResult=function t(){t.b2ContactResult.apply(this,arguments)},Box2D.Dynamics.Contacts.b2ContactSolver=function t(){t.b2ContactSolver.apply(this,arguments),this.constructor===t&&this.b2ContactSolver.apply(this,arguments)},Box2D.Dynamics.Contacts.b2EdgeAndCircleContact=function t(){t.b2EdgeAndCircleContact.apply(this,arguments)},Box2D.Dynamics.Contacts.b2NullContact=function t(){t.b2NullContact.apply(this,arguments),this.constructor===t&&this.b2NullContact.apply(this,arguments)},Box2D.Dynamics.Contacts.b2PolyAndCircleContact=function t(){t.b2PolyAndCircleContact.apply(this,arguments)},Box2D.Dynamics.Contacts.b2PolyAndEdgeContact=function t(){t.b2PolyAndEdgeContact.apply(this,arguments)},Box2D.Dynamics.Contacts.b2PolygonContact=function t(){t.b2PolygonContact.apply(this,arguments)},Box2D.Dynamics.Contacts.b2PositionSolverManifold=function t(){t.b2PositionSolverManifold.apply(this,arguments),this.constructor===t&&this.b2PositionSolverManifold.apply(this,arguments)},Box2D.Dynamics.Controllers.b2BuoyancyController=function t(){t.b2BuoyancyController.apply(this,arguments)},Box2D.Dynamics.Controllers.b2ConstantAccelController=function t(){t.b2ConstantAccelController.apply(this,arguments)},Box2D.Dynamics.Controllers.b2ConstantForceController=function t(){t.b2ConstantForceController.apply(this,arguments)},Box2D.Dynamics.Controllers.b2Controller=function t(){t.b2Controller.apply(this,arguments)},Box2D.Dynamics.Controllers.b2ControllerEdge=function t(){t.b2ControllerEdge.apply(this,arguments)},Box2D.Dynamics.Controllers.b2GravityController=function t(){t.b2GravityController.apply(this,arguments)},Box2D.Dynamics.Controllers.b2TensorDampingController=function t(){t.b2TensorDampingController.apply(this,arguments)},Box2D.Dynamics.Joints.b2DistanceJoint=function t(){t.b2DistanceJoint.apply(this,arguments),this.constructor===t&&this.b2DistanceJoint.apply(this,arguments)},Box2D.Dynamics.Joints.b2DistanceJointDef=function t(){t.b2DistanceJointDef.apply(this,arguments),this.constructor===t&&this.b2DistanceJointDef.apply(this,arguments)},Box2D.Dynamics.Joints.b2FrictionJoint=function t(){t.b2FrictionJoint.apply(this,arguments),this.constructor===t&&this.b2FrictionJoint.apply(this,arguments)},Box2D.Dynamics.Joints.b2FrictionJointDef=function t(){t.b2FrictionJointDef.apply(this,arguments),this.constructor===t&&this.b2FrictionJointDef.apply(this,arguments)},Box2D.Dynamics.Joints.b2GearJoint=function t(){t.b2GearJoint.apply(this,arguments),this.constructor===t&&this.b2GearJoint.apply(this,arguments)},Box2D.Dynamics.Joints.b2GearJointDef=function t(){t.b2GearJointDef.apply(this,arguments),this.constructor===t&&this.b2GearJointDef.apply(this,arguments)},Box2D.Dynamics.Joints.b2Jacobian=function t(){t.b2Jacobian.apply(this,arguments)},Box2D.Dynamics.Joints.b2Joint=function t(){t.b2Joint.apply(this,arguments),this.constructor===t&&this.b2Joint.apply(this,arguments)},Box2D.Dynamics.Joints.b2JointDef=function t(){t.b2JointDef.apply(this,arguments),this.constructor===t&&this.b2JointDef.apply(this,arguments)},Box2D.Dynamics.Joints.b2JointEdge=function t(){t.b2JointEdge.apply(this,arguments)},Box2D.Dynamics.Joints.b2LineJoint=function t(){t.b2LineJoint.apply(this,arguments),this.constructor===t&&this.b2LineJoint.apply(this,arguments)},Box2D.Dynamics.Joints.b2LineJointDef=function t(){t.b2LineJointDef.apply(this,arguments),this.constructor===t&&this.b2LineJointDef.apply(this,arguments)},Box2D.Dynamics.Joints.b2MouseJoint=function t(){t.b2MouseJoint.apply(this,arguments),this.constructor===t&&this.b2MouseJoint.apply(this,arguments)},Box2D.Dynamics.Joints.b2MouseJointDef=function t(){t.b2MouseJointDef.apply(this,arguments),this.constructor===t&&this.b2MouseJointDef.apply(this,arguments)},Box2D.Dynamics.Joints.b2PrismaticJoint=function t(){t.b2PrismaticJoint.apply(this,arguments),this.constructor===t&&this.b2PrismaticJoint.apply(this,arguments)},Box2D.Dynamics.Joints.b2PrismaticJointDef=function t(){t.b2PrismaticJointDef.apply(this,arguments),this.constructor===t&&this.b2PrismaticJointDef.apply(this,arguments)},Box2D.Dynamics.Joints.b2PulleyJoint=function t(){t.b2PulleyJoint.apply(this,arguments),this.constructor===t&&this.b2PulleyJoint.apply(this,arguments)},Box2D.Dynamics.Joints.b2PulleyJointDef=function t(){t.b2PulleyJointDef.apply(this,arguments),this.constructor===t&&this.b2PulleyJointDef.apply(this,arguments)},Box2D.Dynamics.Joints.b2RevoluteJoint=function t(){t.b2RevoluteJoint.apply(this,arguments),this.constructor===t&&this.b2RevoluteJoint.apply(this,arguments)},Box2D.Dynamics.Joints.b2RevoluteJointDef=function t(){t.b2RevoluteJointDef.apply(this,arguments),this.constructor===t&&this.b2RevoluteJointDef.apply(this,arguments)},Box2D.Dynamics.Joints.b2WeldJoint=function t(){t.b2WeldJoint.apply(this,arguments),this.constructor===t&&this.b2WeldJoint.apply(this,arguments)},Box2D.Dynamics.Joints.b2WeldJointDef=function t(){t.b2WeldJointDef.apply(this,arguments),this.constructor===t&&this.b2WeldJointDef.apply(this,arguments)},Box2D.postDefs=[],function(){var n=Box2D.Collision.Shapes.b2CircleShape,o=(Box2D.Collision.Shapes.b2EdgeChainDef,Box2D.Collision.Shapes.b2EdgeShape,Box2D.Collision.Shapes.b2MassData,Box2D.Collision.Shapes.b2PolygonShape),r=Box2D.Collision.Shapes.b2Shape,j=(Box2D.Common.b2Color,Box2D.Common.b2internal,Box2D.Common.b2Settings),P=(Box2D.Common.Math.b2Mat22,Box2D.Common.Math.b2Mat33,Box2D.Common.Math.b2Math),t=Box2D.Common.Math.b2Sweep,e=Box2D.Common.Math.b2Transform,I=Box2D.Common.Math.b2Vec2,y=(Box2D.Common.Math.b2Vec3,Box2D.Collision.b2AABB),i=Box2D.Collision.b2Bound,s=Box2D.Collision.b2BoundValues,U=Box2D.Collision.b2Collision,a=Box2D.Collision.b2ContactID,l=Box2D.Collision.b2ContactPoint,g=Box2D.Collision.b2Distance,h=Box2D.Collision.b2DistanceInput,u=Box2D.Collision.b2DistanceOutput,c=Box2D.Collision.b2DistanceProxy,p=Box2D.Collision.b2DynamicTree,m=Box2D.Collision.b2DynamicTreeBroadPhase,f=Box2D.Collision.b2DynamicTreeNode,d=Box2D.Collision.b2DynamicTreePair,J=Box2D.Collision.b2Manifold,_=Box2D.Collision.b2ManifoldPoint,x=Box2D.Collision.b2Point,v=Box2D.Collision.b2RayCastInput,b=Box2D.Collision.b2RayCastOutput,w=Box2D.Collision.b2Segment,R=Box2D.Collision.b2SeparationFunction,C=Box2D.Collision.b2Simplex,D=Box2D.Collision.b2SimplexCache,S=Box2D.Collision.b2SimplexVertex,T=Box2D.Collision.b2TimeOfImpact,A=Box2D.Collision.b2TOIInput,M=Box2D.Collision.b2WorldManifold,B=Box2D.Collision.ClipVertex,E=Box2D.Collision.Features,O=Box2D.Collision.IBroadPhase;y.b2AABB=function(){this.lowerBound=new I,this.upperBound=new I},y.prototype.IsValid=function(){var t=this.upperBound.x-this.lowerBound.x,e=this.upperBound.y-this.lowerBound.y,i=0<=t&&0<=e;return i=i&&this.lowerBound.IsValid()&&this.upperBound.IsValid()},y.prototype.GetCenter=function(){return new I((this.lowerBound.x+this.upperBound.x)/2,(this.lowerBound.y+this.upperBound.y)/2)},y.prototype.GetExtents=function(){return new I((this.upperBound.x-this.lowerBound.x)/2,(this.upperBound.y-this.lowerBound.y)/2)},y.prototype.Contains=function(t){var e=!0;return e=(e=(e=(e=e&&this.lowerBound.x<=t.lowerBound.x)&&this.lowerBound.y<=t.lowerBound.y)&&t.upperBound.x<=this.upperBound.x)&&t.upperBound.y<=this.upperBound.y},y.prototype.RayCast=function(t,e){var i=-Number.MAX_VALUE,n=Number.MAX_VALUE,o=e.p1.x,r=e.p1.y,s=e.p2.x-e.p1.x,a=e.p2.y-e.p1.y,l=Math.abs(s),h=Math.abs(a),u=t.normal,c=0,p=0,m=0,f=0,d=0;if(l<Number.MIN_VALUE){if(o<this.lowerBound.x||this.upperBound.x<o)return!1}else if(c=1/s,p=(this.lowerBound.x-o)*c,d=-1,(m=(this.upperBound.x-o)*c)<p&&(f=p,p=m,m=f,d=1),i<p&&(u.x=d,u.y=0,i=p),(n=Math.min(n,m))<i)return!1;if(h<Number.MIN_VALUE){if(r<this.lowerBound.y||this.upperBound.y<r)return!1}else if(c=1/a,p=(this.lowerBound.y-r)*c,d=-1,(m=(this.upperBound.y-r)*c)<p&&(f=p,p=m,m=f,d=1),i<p&&(u.y=d,u.x=0,i=p),(n=Math.min(n,m))<i)return!1;return t.fraction=i,!0},y.prototype.TestOverlap=function(t){var e=t.lowerBound.x-this.upperBound.x,i=t.lowerBound.y-this.upperBound.y,n=this.lowerBound.x-t.upperBound.x,o=this.lowerBound.y-t.upperBound.y;return!(0<e||0<i)&&!(0<n||0<o)},y.Combine=function(t,e){var i=new y;return i.Combine(t,e),i},y.prototype.Combine=function(t,e){this.lowerBound.x=Math.min(t.lowerBound.x,e.lowerBound.x),this.lowerBound.y=Math.min(t.lowerBound.y,e.lowerBound.y),this.upperBound.x=Math.max(t.upperBound.x,e.upperBound.x),this.upperBound.y=Math.max(t.upperBound.y,e.upperBound.y)},i.b2Bound=function(){},i.prototype.IsLower=function(){return 0==(1&this.value)},i.prototype.IsUpper=function(){return 1==(1&this.value)},i.prototype.Swap=function(t){var e=this.value,i=this.proxy,n=this.stabbingCount;this.value=t.value,this.proxy=t.proxy,this.stabbingCount=t.stabbingCount,t.value=e,t.proxy=i,t.stabbingCount=n},s.b2BoundValues=function(){},s.prototype.b2BoundValues=function(){this.lowerValues=new Vector_a2j_Number,this.lowerValues[0]=0,this.lowerValues[1]=0,this.upperValues=new Vector_a2j_Number,this.upperValues[0]=0,this.upperValues[1]=0},U.b2Collision=function(){},U.ClipSegmentToLine=function(t,e,i,n){void 0===n&&(n=0);var o=0,r=e[0].v,s=e[1].v,a=i.x*r.x+i.y*r.y-n,l=i.x*s.x+i.y*s.y-n;if(a<=0&&t[o++].Set(e[0]),l<=0&&t[o++].Set(e[1]),a*l<0){var h=a/(a-l),u=t[o].v;u.x=r.x+h*(s.x-r.x),u.y=r.y+h*(s.y-r.y),t[o].id=(0<a?e[0]:e[1]).id,++o}return o},U.EdgeSeparation=function(t,e,i,n,o){void 0===i&&(i=0);parseInt(t.m_vertexCount);var r,s,a=t.m_vertices,l=t.m_normals,h=parseInt(n.m_vertexCount),u=n.m_vertices;r=e.R,s=l[i];for(var c=r.col1.x*s.x+r.col2.x*s.y,p=r.col1.y*s.x+r.col2.y*s.y,m=(r=o.R).col1.x*c+r.col1.y*p,f=r.col2.x*c+r.col2.y*p,d=0,_=Number.MAX_VALUE,y=0;y<h;++y){var x=(s=u[y]).x*m+s.y*f;x<_&&(_=x,d=y)}s=a[i],r=e.R;var v=e.position.x+(r.col1.x*s.x+r.col2.x*s.y),b=e.position.y+(r.col1.y*s.x+r.col2.y*s.y);s=u[d],r=o.R;var g=o.position.x+(r.col1.x*s.x+r.col2.x*s.y),w=o.position.y+(r.col1.y*s.x+r.col2.y*s.y);return(g-=v)*c+(w-=b)*p},U.FindMaxSeparation=function(t,e,i,n,o){var r,s,a=parseInt(e.m_vertexCount),l=e.m_normals;s=o.R,r=n.m_centroid;var h=o.position.x+(s.col1.x*r.x+s.col2.x*r.y),u=o.position.y+(s.col1.y*r.x+s.col2.y*r.y);s=i.R,r=e.m_centroid,h-=i.position.x+(s.col1.x*r.x+s.col2.x*r.y),u-=i.position.y+(s.col1.y*r.x+s.col2.y*r.y);for(var c=h*i.R.col1.x+u*i.R.col1.y,p=h*i.R.col2.x+u*i.R.col2.y,m=0,f=-Number.MAX_VALUE,d=0;d<a;++d){var _=(r=l[d]).x*c+r.y*p;f<_&&(f=_,m=d)}var y=U.EdgeSeparation(e,i,m,n,o),x=parseInt(0<=m-1?m-1:a-1),v=U.EdgeSeparation(e,i,x,n,o),b=parseInt(m+1<a?m+1:0),g=U.EdgeSeparation(e,i,b,n,o),w=0,C=0,D=0;if(y<v&&g<v)D=-1,w=x,C=v;else{if(!(y<g))return t[0]=m,y;D=1,w=b,C=g}for(;m=-1==D?0<=w-1?w-1:a-1:w+1<a?w+1:0,C<(y=U.EdgeSeparation(e,i,m,n,o));)w=m,C=y;return t[0]=w,C},U.FindIncidentEdge=function(t,e,i,n,o,r){void 0===n&&(n=0);parseInt(e.m_vertexCount);var s,a,l=e.m_normals,h=parseInt(o.m_vertexCount),u=o.m_vertices,c=o.m_normals;s=i.R,a=l[n];var p=s.col1.x*a.x+s.col2.x*a.y,m=s.col1.y*a.x+s.col2.y*a.y,f=(s=r.R).col1.x*p+s.col1.y*m;m=s.col2.x*p+s.col2.y*m,p=f;for(var d,_=0,y=Number.MAX_VALUE,x=0;x<h;++x){var v=p*(a=c[x]).x+m*a.y;v<y&&(y=v,_=x)}var b=parseInt(_),g=parseInt(b+1<h?b+1:0);d=t[0],a=u[b],s=r.R,d.v.x=r.position.x+(s.col1.x*a.x+s.col2.x*a.y),d.v.y=r.position.y+(s.col1.y*a.x+s.col2.y*a.y),d.id.features.referenceEdge=n,d.id.features.incidentEdge=b,d.id.features.incidentVertex=0,d=t[1],a=u[g],s=r.R,d.v.x=r.position.x+(s.col1.x*a.x+s.col2.x*a.y),d.v.y=r.position.y+(s.col1.y*a.x+s.col2.y*a.y),d.id.features.referenceEdge=n,d.id.features.incidentEdge=g,d.id.features.incidentVertex=1},U.MakeClipPointVector=function(){var t=new Vector(2);return t[0]=new B,t[1]=new B,t},U.CollidePolygons=function(t,e,i,n,o){var r;t.m_pointCount=0;var s=e.m_radius+n.m_radius,a=0;U.s_edgeAO[0]=a;var l=U.FindMaxSeparation(U.s_edgeAO,e,i,n,o);if(a=U.s_edgeAO[0],!(s<l)){var h=0;U.s_edgeBO[0]=h;var u=U.FindMaxSeparation(U.s_edgeBO,n,o,e,i);if(h=U.s_edgeBO[0],!(s<u)){var c,p,m,f,d,_=0,y=0;y=.98*l+.001<u?(c=n,p=e,m=o,f=i,_=h,t.m_type=J.e_faceB,1):(c=e,p=n,m=i,f=o,_=a,t.m_type=J.e_faceA,0);var x=U.s_incidentEdge;U.FindIncidentEdge(x,c,m,_,p,f);var v,b=parseInt(c.m_vertexCount),g=c.m_vertices,w=g[_];v=_+1<b?g[parseInt(_+1)]:g[0];var C=U.s_localTangent;C.Set(v.x-w.x,v.y-w.y),C.Normalize();var D=U.s_localNormal;D.x=C.y,D.y=-C.x;var S=U.s_planePoint;S.Set(.5*(w.x+v.x),.5*(w.y+v.y));var T=U.s_tangent;d=m.R,T.x=d.col1.x*C.x+d.col2.x*C.y,T.y=d.col1.y*C.x+d.col2.y*C.y;var A=U.s_tangent2;A.x=-T.x,A.y=-T.y;var M=U.s_normal;M.x=T.y,M.y=-T.x;var B=U.s_v11,E=U.s_v12;B.x=m.position.x+(d.col1.x*w.x+d.col2.x*w.y),B.y=m.position.y+(d.col1.y*w.x+d.col2.y*w.y),E.x=m.position.x+(d.col1.x*v.x+d.col2.x*v.y),E.y=m.position.y+(d.col1.y*v.x+d.col2.y*v.y);var P=M.x*B.x+M.y*B.y,I=-T.x*B.x-T.y*B.y+s,R=T.x*E.x+T.y*E.y+s,O=U.s_clipPoints1,L=U.s_clipPoints2;if(!(U.ClipSegmentToLine(O,x,A,I)<2||U.ClipSegmentToLine(L,O,T,R)<2)){t.m_localPlaneNormal.SetV(D),t.m_localPoint.SetV(S);for(var F=0,V=0;V<j.b2_maxManifoldPoints;++V){if(r=L[V],M.x*r.v.x+M.y*r.v.y-P<=s){var N=t.m_points[F];d=f.R;var k=r.v.x-f.position.x,G=r.v.y-f.position.y;N.m_localPoint.x=k*d.col1.x+G*d.col1.y,N.m_localPoint.y=k*d.col2.x+G*d.col2.y,N.m_id.Set(r.id),N.m_id.features.flip=y,++F}}t.m_pointCount=F}}}},U.CollideCircles=function(t,e,i,n,o){var r,s;t.m_pointCount=0,r=i.R,s=e.m_p;var a=i.position.x+(r.col1.x*s.x+r.col2.x*s.y),l=i.position.y+(r.col1.y*s.x+r.col2.y*s.y);r=o.R,s=n.m_p;var h=o.position.x+(r.col1.x*s.x+r.col2.x*s.y)-a,u=o.position.y+(r.col1.y*s.x+r.col2.y*s.y)-l,c=h*h+u*u,p=e.m_radius+n.m_radius;p*p<c||(t.m_type=J.e_circles,t.m_localPoint.SetV(e.m_p),t.m_localPlaneNormal.SetZero(),t.m_pointCount=1,t.m_points[0].m_localPoint.SetV(n.m_p),t.m_points[0].m_id.key=0)},U.CollidePolygonAndCircle=function(t,e,i,n,o){var r,s,a=t.m_pointCount=0,l=0;s=o.R,r=n.m_p;var h=o.position.x+(s.col1.x*r.x+s.col2.x*r.y),u=o.position.y+(s.col1.y*r.x+s.col2.y*r.y);a=h-i.position.x,l=u-i.position.y;for(var c=a*(s=i.R).col1.x+l*s.col1.y,p=a*s.col2.x+l*s.col2.y,m=0,f=-Number.MAX_VALUE,d=e.m_radius+n.m_radius,_=parseInt(e.m_vertexCount),y=e.m_vertices,x=e.m_normals,v=0;v<_;++v){a=c-(r=y[v]).x,l=p-r.y;var b=(r=x[v]).x*a+r.y*l;if(d<b)return;f<b&&(f=b,m=v)}var g=parseInt(m),w=parseInt(g+1<_?g+1:0),C=y[g],D=y[w];if(f<Number.MIN_VALUE)return t.m_pointCount=1,t.m_type=J.e_faceA,t.m_localPlaneNormal.SetV(x[m]),t.m_localPoint.x=.5*(C.x+D.x),t.m_localPoint.y=.5*(C.y+D.y),t.m_points[0].m_localPoint.SetV(n.m_p),void(t.m_points[0].m_id.key=0);var S=(c-C.x)*(D.x-C.x)+(p-C.y)*(D.y-C.y),T=(c-D.x)*(C.x-D.x)+(p-D.y)*(C.y-D.y);if(S<=0){if((c-C.x)*(c-C.x)+(p-C.y)*(p-C.y)>d*d)return;t.m_pointCount=1,t.m_type=J.e_faceA,t.m_localPlaneNormal.x=c-C.x,t.m_localPlaneNormal.y=p-C.y,t.m_localPlaneNormal.Normalize(),t.m_localPoint.SetV(C),t.m_points[0].m_localPoint.SetV(n.m_p),t.m_points[0].m_id.key=0}else if(T<=0){if((c-D.x)*(c-D.x)+(p-D.y)*(p-D.y)>d*d)return;t.m_pointCount=1,t.m_type=J.e_faceA,t.m_localPlaneNormal.x=c-D.x,t.m_localPlaneNormal.y=p-D.y,t.m_localPlaneNormal.Normalize(),t.m_localPoint.SetV(D),t.m_points[0].m_localPoint.SetV(n.m_p),t.m_points[0].m_id.key=0}else{var A=.5*(C.x+D.x),M=.5*(C.y+D.y);if(d<(f=(c-A)*x[g].x+(p-M)*x[g].y))return;t.m_pointCount=1,t.m_type=J.e_faceA,t.m_localPlaneNormal.x=x[g].x,t.m_localPlaneNormal.y=x[g].y,t.m_localPlaneNormal.Normalize(),t.m_localPoint.Set(A,M),t.m_points[0].m_localPoint.SetV(n.m_p),t.m_points[0].m_id.key=0}},U.TestOverlap=function(t,e){var i=e.lowerBound,n=t.upperBound,o=i.x-n.x,r=i.y-n.y;i=t.lowerBound,n=e.upperBound;var s=i.x-n.x,a=i.y-n.y;return!(0<o||0<r)&&!(0<s||0<a)},Box2D.postDefs.push(function(){Box2D.Collision.b2Collision.s_incidentEdge=U.MakeClipPointVector(),Box2D.Collision.b2Collision.s_clipPoints1=U.MakeClipPointVector(),Box2D.Collision.b2Collision.s_clipPoints2=U.MakeClipPointVector(),Box2D.Collision.b2Collision.s_edgeAO=new Vector_a2j_Number(1),Box2D.Collision.b2Collision.s_edgeBO=new Vector_a2j_Number(1),Box2D.Collision.b2Collision.s_localTangent=new I,Box2D.Collision.b2Collision.s_localNormal=new I,Box2D.Collision.b2Collision.s_planePoint=new I,Box2D.Collision.b2Collision.s_normal=new I,Box2D.Collision.b2Collision.s_tangent=new I,Box2D.Collision.b2Collision.s_tangent2=new I,Box2D.Collision.b2Collision.s_v11=new I,Box2D.Collision.b2Collision.s_v12=new I,Box2D.Collision.b2Collision.b2CollidePolyTempVec=new I,Box2D.Collision.b2Collision.b2_nullFeature=255}),a.b2ContactID=function(){this.features=new E},a.prototype.b2ContactID=function(){this.features._m_id=this},a.prototype.Set=function(t){this.key=t._key},a.prototype.Copy=function(){var t=new a;return t.key=this.key,t},Object.defineProperty(a.prototype,"key",{enumerable:!1,configurable:!0,get:function(){return this._key}}),Object.defineProperty(a.prototype,"key",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0),this._key=t,this.features._referenceEdge=255&this._key,this.features._incidentEdge=(65280&this._key)>>8&255,this.features._incidentVertex=(16711680&this._key)>>16&255,this.features._flip=(4278190080&this._key)>>24&255}}),l.b2ContactPoint=function(){this.position=new I,this.velocity=new I,this.normal=new I,this.id=new a},g.b2Distance=function(){},g.Distance=function(t,e,i){++g.b2_gjkCalls;var n=i.proxyA,o=i.proxyB,r=i.transformA,s=i.transformB,a=g.s_simplex;a.ReadCache(e,n,r,o,s);for(var l,h=a.m_vertices,u=g.s_saveA,c=g.s_saveB,p=0,m=(a.GetClosestPoint().LengthSquared(),0),f=0;f<20;){for(p=a.m_count,m=0;m<p;m++)u[m]=h[m].indexA,c[m]=h[m].indexB;switch(a.m_count){case 1:break;case 2:a.Solve2();break;case 3:a.Solve3();break;default:j.b2Assert(!1)}if(3==a.m_count)break;(l=a.GetClosestPoint()).LengthSquared();var d=a.GetSearchDirection();if(d.LengthSquared()<Number.MIN_VALUE*Number.MIN_VALUE)break;var _=h[a.m_count];_.indexA=n.GetSupport(P.MulTMV(r.R,d.GetNegative())),_.wA=P.MulX(r,n.GetVertex(_.indexA)),_.indexB=o.GetSupport(P.MulTMV(s.R,d)),_.wB=P.MulX(s,o.GetVertex(_.indexB)),_.w=P.SubtractVV(_.wB,_.wA),++f,++g.b2_gjkIters;var y=!1;for(m=0;m<p;m++)if(_.indexA==u[m]&&_.indexB==c[m]){y=!0;break}if(y)break;++a.m_count}if(g.b2_gjkMaxIters=P.Max(g.b2_gjkMaxIters,f),a.GetWitnessPoints(t.pointA,t.pointB),t.distance=P.SubtractVV(t.pointA,t.pointB).Length(),t.iterations=f,a.WriteCache(e),i.useRadii){var x=n.m_radius,v=o.m_radius;if(t.distance>x+v&&t.distance>Number.MIN_VALUE){t.distance-=x+v;var b=P.SubtractVV(t.pointB,t.pointA);b.Normalize(),t.pointA.x+=x*b.x,t.pointA.y+=x*b.y,t.pointB.x-=v*b.x,t.pointB.y-=v*b.y}else(l=new I).x=.5*(t.pointA.x+t.pointB.x),l.y=.5*(t.pointA.y+t.pointB.y),t.pointA.x=t.pointB.x=l.x,t.pointA.y=t.pointB.y=l.y,t.distance=0}},Box2D.postDefs.push(function(){Box2D.Collision.b2Distance.s_simplex=new C,Box2D.Collision.b2Distance.s_saveA=new Vector_a2j_Number(3),Box2D.Collision.b2Distance.s_saveB=new Vector_a2j_Number(3)}),h.b2DistanceInput=function(){},u.b2DistanceOutput=function(){this.pointA=new I,this.pointB=new I},c.b2DistanceProxy=function(){},c.prototype.Set=function(t){switch(t.GetType()){case r.e_circleShape:var e=t instanceof n?t:null;this.m_vertices=new Vector(1,!0),this.m_vertices[0]=e.m_p,this.m_count=1,this.m_radius=e.m_radius;break;case r.e_polygonShape:var i=t instanceof o?t:null;this.m_vertices=i.m_vertices,this.m_count=i.m_vertexCount,this.m_radius=i.m_radius;break;default:j.b2Assert(!1)}},c.prototype.GetSupport=function(t){for(var e=0,i=this.m_vertices[0].x*t.x+this.m_vertices[0].y*t.y,n=1;n<this.m_count;++n){var o=this.m_vertices[n].x*t.x+this.m_vertices[n].y*t.y;i<o&&(e=n,i=o)}return e},c.prototype.GetSupportVertex=function(t){for(var e=0,i=this.m_vertices[0].x*t.x+this.m_vertices[0].y*t.y,n=1;n<this.m_count;++n){var o=this.m_vertices[n].x*t.x+this.m_vertices[n].y*t.y;i<o&&(e=n,i=o)}return this.m_vertices[e]},c.prototype.GetVertexCount=function(){return this.m_count},c.prototype.GetVertex=function(t){return void 0===t&&(t=0),j.b2Assert(0<=t&&t<this.m_count),this.m_vertices[t]},p.b2DynamicTree=function(){},p.prototype.b2DynamicTree=function(){this.m_root=null,this.m_freeList=null,this.m_path=0,this.m_insertionCount=0},p.prototype.CreateProxy=function(t,e){var i=this.AllocateNode(),n=j.b2_aabbExtension,o=j.b2_aabbExtension;return i.aabb.lowerBound.x=t.lowerBound.x-n,i.aabb.lowerBound.y=t.lowerBound.y-o,i.aabb.upperBound.x=t.upperBound.x+n,i.aabb.upperBound.y=t.upperBound.y+o,i.userData=e,this.InsertLeaf(i),i},p.prototype.DestroyProxy=function(t){this.RemoveLeaf(t),this.FreeNode(t)},p.prototype.MoveProxy=function(t,e,i){if(j.b2Assert(t.IsLeaf()),t.aabb.Contains(e))return!1;this.RemoveLeaf(t);var n=j.b2_aabbExtension+j.b2_aabbMultiplier*(0<i.x?i.x:-i.x),o=j.b2_aabbExtension+j.b2_aabbMultiplier*(0<i.y?i.y:-i.y);return t.aabb.lowerBound.x=e.lowerBound.x-n,t.aabb.lowerBound.y=e.lowerBound.y-o,t.aabb.upperBound.x=e.upperBound.x+n,t.aabb.upperBound.y=e.upperBound.y+o,this.InsertLeaf(t),!0},p.prototype.Rebalance=function(t){if(void 0===t&&(t=0),null!=this.m_root)for(var e=0;e<t;e++){for(var i=this.m_root,n=0;0==i.IsLeaf();)i=this.m_path>>n&1?i.child2:i.child1,n=n+1&31;++this.m_path,this.RemoveLeaf(i),this.InsertLeaf(i)}},p.prototype.GetFatAABB=function(t){return t.aabb},p.prototype.GetUserData=function(t){return t.userData},p.prototype.Query=function(t,e){if(null!=this.m_root){var i=new Vector,n=0;for(i[n++]=this.m_root;0<n;){var o=i[--n];if(o.aabb.TestOverlap(e))if(o.IsLeaf()){if(!t(o))return}else i[n++]=o.child1,i[n++]=o.child2}}},p.prototype.RayCast=function(t,e){if(null!=this.m_root){var i=e.p1,n=e.p2,o=P.SubtractVV(i,n);o.Normalize();var r=P.CrossFV(1,o),s=P.AbsV(r),a=e.maxFraction,l=new y,h=0,u=0;h=i.x+a*(n.x-i.x),u=i.y+a*(n.y-i.y),l.lowerBound.x=Math.min(i.x,h),l.lowerBound.y=Math.min(i.y,u),l.upperBound.x=Math.max(i.x,h),l.upperBound.y=Math.max(i.y,u);var c=new Vector,p=0;for(c[p++]=this.m_root;0<p;){var m=c[--p];if(0!=m.aabb.TestOverlap(l)){var f=m.aabb.GetCenter(),d=m.aabb.GetExtents();if(!(0<Math.abs(r.x*(i.x-f.x)+r.y*(i.y-f.y))-s.x*d.x-s.y*d.y))if(m.IsLeaf()){var _=new v;if(_.p1=e.p1,_.p2=e.p2,_.maxFraction=e.maxFraction,0==(a=t(_,m)))return;0<a&&(h=i.x+a*(n.x-i.x),u=i.y+a*(n.y-i.y),l.lowerBound.x=Math.min(i.x,h),l.lowerBound.y=Math.min(i.y,u),l.upperBound.x=Math.max(i.x,h),l.upperBound.y=Math.max(i.y,u))}else c[p++]=m.child1,c[p++]=m.child2}}}},p.prototype.AllocateNode=function(){if(this.m_freeList){var t=this.m_freeList;return this.m_freeList=t.parent,t.parent=null,t.child1=null,t.child2=null,t}return new f},p.prototype.FreeNode=function(t){t.parent=this.m_freeList,this.m_freeList=t},p.prototype.InsertLeaf=function(t){if(++this.m_insertionCount,null==this.m_root)return this.m_root=t,void(this.m_root.parent=null);var e=t.aabb.GetCenter(),i=this.m_root;if(0==i.IsLeaf())do{var n=i.child1,o=i.child2;i=Math.abs((n.aabb.lowerBound.x+n.aabb.upperBound.x)/2-e.x)+Math.abs((n.aabb.lowerBound.y+n.aabb.upperBound.y)/2-e.y)<Math.abs((o.aabb.lowerBound.x+o.aabb.upperBound.x)/2-e.x)+Math.abs((o.aabb.lowerBound.y+o.aabb.upperBound.y)/2-e.y)?n:o}while(0==i.IsLeaf());var r=i.parent,s=this.AllocateNode();if(s.parent=r,s.userData=null,s.aabb.Combine(t.aabb,i.aabb),r){i.parent.child1==i?r.child1=s:r.child2=s,s.child1=i,s.child2=t,i.parent=s,t.parent=s;do{if(r.aabb.Contains(s.aabb))break;r.aabb.Combine(r.child1.aabb,r.child2.aabb),r=(s=r).parent}while(r)}else s.child1=i,s.child2=t,i.parent=s,t.parent=s,this.m_root=s},p.prototype.RemoveLeaf=function(t){if(t!=this.m_root){var e,i=t.parent,n=i.parent;if(e=i.child1==t?i.child2:i.child1,n)for(n.child1==i?n.child1=e:n.child2=e,e.parent=n,this.FreeNode(i);n;){var o=n.aabb;if(n.aabb=y.Combine(n.child1.aabb,n.child2.aabb),o.Contains(n.aabb))break;n=n.parent}else(this.m_root=e).parent=null,this.FreeNode(i)}else this.m_root=null},m.b2DynamicTreeBroadPhase=function(){this.m_tree=new p,this.m_moveBuffer=new Vector,this.m_pairBuffer=new Vector,this.m_pairCount=0},m.prototype.CreateProxy=function(t,e){var i=this.m_tree.CreateProxy(t,e);return++this.m_proxyCount,this.BufferMove(i),i},m.prototype.DestroyProxy=function(t){this.UnBufferMove(t),--this.m_proxyCount,this.m_tree.DestroyProxy(t)},m.prototype.MoveProxy=function(t,e,i){this.m_tree.MoveProxy(t,e,i)&&this.BufferMove(t)},m.prototype.TestOverlap=function(t,e){var i=this.m_tree.GetFatAABB(t),n=this.m_tree.GetFatAABB(e);return i.TestOverlap(n)},m.prototype.GetUserData=function(t){return this.m_tree.GetUserData(t)},m.prototype.GetFatAABB=function(t){return this.m_tree.GetFatAABB(t)},m.prototype.GetProxyCount=function(){return this.m_proxyCount},m.prototype.UpdatePairs=function(t){var i,n=this,e=n.m_pairCount=0;function o(t){if(t==i)return!0;n.m_pairCount==n.m_pairBuffer.length&&(n.m_pairBuffer[n.m_pairCount]=new d);var e=n.m_pairBuffer[n.m_pairCount];return e.proxyA=t<i?t:i,e.proxyB=i<=t?t:i,++n.m_pairCount,!0}for(e=0;e<n.m_moveBuffer.length;++e){i=n.m_moveBuffer[e];var r=n.m_tree.GetFatAABB(i);n.m_tree.Query(o,r)}for(e=n.m_moveBuffer.length=0;e<n.m_pairCount;){var s=n.m_pairBuffer[e];for(t(n.m_tree.GetUserData(s.proxyA),n.m_tree.GetUserData(s.proxyB)),++e;e<n.m_pairCount;){var a=n.m_pairBuffer[e];if(a.proxyA!=s.proxyA||a.proxyB!=s.proxyB)break;++e}}},m.prototype.Query=function(t,e){this.m_tree.Query(t,e)},m.prototype.RayCast=function(t,e){this.m_tree.RayCast(t,e)},m.prototype.Validate=function(){},m.prototype.Rebalance=function(t){void 0===t&&(t=0),this.m_tree.Rebalance(t)},m.prototype.BufferMove=function(t){this.m_moveBuffer[this.m_moveBuffer.length]=t},m.prototype.UnBufferMove=function(t){var e=parseInt(this.m_moveBuffer.indexOf(t));this.m_moveBuffer.splice(e,1)},m.prototype.ComparePairs=function(t,e){return 0},m.__implements={},m.__implements[O]=!0,f.b2DynamicTreeNode=function(){this.aabb=new y},f.prototype.IsLeaf=function(){return null==this.child1},d.b2DynamicTreePair=function(){},J.b2Manifold=function(){this.m_pointCount=0},J.prototype.b2Manifold=function(){this.m_points=new Vector(j.b2_maxManifoldPoints);for(var t=0;t<j.b2_maxManifoldPoints;t++)this.m_points[t]=new _;this.m_localPlaneNormal=new I,this.m_localPoint=new I},J.prototype.Reset=function(){for(var t=0;t<j.b2_maxManifoldPoints;t++)(this.m_points[t]instanceof _?this.m_points[t]:null).Reset();this.m_localPlaneNormal.SetZero(),this.m_localPoint.SetZero(),this.m_type=0,this.m_pointCount=0},J.prototype.Set=function(t){this.m_pointCount=t.m_pointCount;for(var e=0;e<j.b2_maxManifoldPoints;e++)(this.m_points[e]instanceof _?this.m_points[e]:null).Set(t.m_points[e]);this.m_localPlaneNormal.SetV(t.m_localPlaneNormal),this.m_localPoint.SetV(t.m_localPoint),this.m_type=t.m_type},J.prototype.Copy=function(){var t=new J;return t.Set(this),t},Box2D.postDefs.push(function(){Box2D.Collision.b2Manifold.e_circles=1,Box2D.Collision.b2Manifold.e_faceA=2,Box2D.Collision.b2Manifold.e_faceB=4}),_.b2ManifoldPoint=function(){this.m_localPoint=new I,this.m_id=new a},_.prototype.b2ManifoldPoint=function(){this.Reset()},_.prototype.Reset=function(){this.m_localPoint.SetZero(),this.m_normalImpulse=0,this.m_tangentImpulse=0,this.m_id.key=0},_.prototype.Set=function(t){this.m_localPoint.SetV(t.m_localPoint),this.m_normalImpulse=t.m_normalImpulse,this.m_tangentImpulse=t.m_tangentImpulse,this.m_id.Set(t.m_id)},x.b2Point=function(){this.p=new I},x.prototype.Support=function(t,e,i){return void 0===e&&(e=0),void 0===i&&(i=0),this.p},x.prototype.GetFirstVertex=function(t){return this.p},v.b2RayCastInput=function(){this.p1=new I,this.p2=new I},v.prototype.b2RayCastInput=function(t,e,i){void 0===t&&(t=null),void 0===e&&(e=null),void 0===i&&(i=1),t&&this.p1.SetV(t),e&&this.p2.SetV(e),this.maxFraction=i},b.b2RayCastOutput=function(){this.normal=new I},w.b2Segment=function(){this.p1=new I,this.p2=new I},w.prototype.TestSegment=function(t,e,i,n){void 0===n&&(n=0);var o=i.p1,r=i.p2.x-o.x,s=i.p2.y-o.y,a=this.p2.x-this.p1.x,l=this.p2.y-this.p1.y,h=-a,u=100*Number.MIN_VALUE,c=-(r*l+s*h);if(u<c){var p=o.x-this.p1.x,m=o.y-this.p1.y,f=p*l+m*h;if(0<=f&&f<=n*c){var d=-r*m+s*p;if(-u*c<=d&&d<=c*(1+u)){f/=c;var _=Math.sqrt(l*l+h*h);return l/=_,h/=_,t[0]=f,e.Set(l,h),!0}}}return!1},w.prototype.Extend=function(t){this.ExtendForward(t),this.ExtendBackward(t)},w.prototype.ExtendForward=function(t){var e=this.p2.x-this.p1.x,i=this.p2.y-this.p1.y,n=Math.min(0<e?(t.upperBound.x-this.p1.x)/e:e<0?(t.lowerBound.x-this.p1.x)/e:Number.POSITIVE_INFINITY,0<i?(t.upperBound.y-this.p1.y)/i:i<0?(t.lowerBound.y-this.p1.y)/i:Number.POSITIVE_INFINITY);this.p2.x=this.p1.x+e*n,this.p2.y=this.p1.y+i*n},w.prototype.ExtendBackward=function(t){var e=-this.p2.x+this.p1.x,i=-this.p2.y+this.p1.y,n=Math.min(0<e?(t.upperBound.x-this.p2.x)/e:e<0?(t.lowerBound.x-this.p2.x)/e:Number.POSITIVE_INFINITY,0<i?(t.upperBound.y-this.p2.y)/i:i<0?(t.lowerBound.y-this.p2.y)/i:Number.POSITIVE_INFINITY);this.p1.x=this.p2.x+e*n,this.p1.y=this.p2.y+i*n},R.b2SeparationFunction=function(){this.m_localPoint=new I,this.m_axis=new I},R.prototype.Initialize=function(t,e,i,n,o){this.m_proxyA=e,this.m_proxyB=n;var r,s,a,l,h,u,c=parseInt(t.count);j.b2Assert(0<c&&c<3);var p,m,f=0,d=0,_=0,y=0,x=0,v=0,b=0;if(1==c)this.m_type=R.e_points,r=this.m_proxyA.GetVertex(t.indexA[0]),l=this.m_proxyB.GetVertex(t.indexB[0]),m=r,p=i.R,f=i.position.x+(p.col1.x*m.x+p.col2.x*m.y),d=i.position.y+(p.col1.y*m.x+p.col2.y*m.y),m=l,p=o.R,_=o.position.x+(p.col1.x*m.x+p.col2.x*m.y),y=o.position.y+(p.col1.y*m.x+p.col2.y*m.y),this.m_axis.x=_-f,this.m_axis.y=y-d,this.m_axis.Normalize();else if(t.indexB[0]==t.indexB[1])this.m_type=R.e_faceA,s=this.m_proxyA.GetVertex(t.indexA[0]),a=this.m_proxyA.GetVertex(t.indexA[1]),l=this.m_proxyB.GetVertex(t.indexB[0]),this.m_localPoint.x=.5*(s.x+a.x),this.m_localPoint.y=.5*(s.y+a.y),this.m_axis=P.CrossVF(P.SubtractVV(a,s),1),this.m_axis.Normalize(),m=this.m_axis,x=(p=i.R).col1.x*m.x+p.col2.x*m.y,v=p.col1.y*m.x+p.col2.y*m.y,m=this.m_localPoint,p=i.R,f=i.position.x+(p.col1.x*m.x+p.col2.x*m.y),d=i.position.y+(p.col1.y*m.x+p.col2.y*m.y),m=l,p=o.R,(b=((_=o.position.x+(p.col1.x*m.x+p.col2.x*m.y))-f)*x+((y=o.position.y+(p.col1.y*m.x+p.col2.y*m.y))-d)*v)<0&&this.m_axis.NegativeSelf();else if(t.indexA[0]==t.indexA[0])this.m_type=R.e_faceB,h=this.m_proxyB.GetVertex(t.indexB[0]),u=this.m_proxyB.GetVertex(t.indexB[1]),r=this.m_proxyA.GetVertex(t.indexA[0]),this.m_localPoint.x=.5*(h.x+u.x),this.m_localPoint.y=.5*(h.y+u.y),this.m_axis=P.CrossVF(P.SubtractVV(u,h),1),this.m_axis.Normalize(),m=this.m_axis,x=(p=o.R).col1.x*m.x+p.col2.x*m.y,v=p.col1.y*m.x+p.col2.y*m.y,m=this.m_localPoint,p=o.R,_=o.position.x+(p.col1.x*m.x+p.col2.x*m.y),y=o.position.y+(p.col1.y*m.x+p.col2.y*m.y),m=r,p=i.R,(b=((f=i.position.x+(p.col1.x*m.x+p.col2.x*m.y))-_)*x+((d=i.position.y+(p.col1.y*m.x+p.col2.y*m.y))-y)*v)<0&&this.m_axis.NegativeSelf();else{s=this.m_proxyA.GetVertex(t.indexA[0]),a=this.m_proxyA.GetVertex(t.indexA[1]),h=this.m_proxyB.GetVertex(t.indexB[0]),u=this.m_proxyB.GetVertex(t.indexB[1]);P.MulX(i,r);var g=P.MulMV(i.R,P.SubtractVV(a,s)),w=(P.MulX(o,l),P.MulMV(o.R,P.SubtractVV(u,h))),C=g.x*g.x+g.y*g.y,D=w.x*w.x+w.y*w.y,S=P.SubtractVV(w,g),T=g.x*S.x+g.y*S.y,A=w.x*S.x+w.y*S.y,M=g.x*w.x+g.y*w.y,B=C*D-M*M;(b=0)!=B&&(b=P.Clamp((M*A-T*D)/B,0,1));var E=(M*b+A)/D;E<0&&(E=0,b=P.Clamp((M-T)/C,0,1)),(r=new I).x=s.x+b*(a.x-s.x),r.y=s.y+b*(a.y-s.y),(l=new I).x=h.x+b*(u.x-h.x),l.y=h.y+b*(u.y-h.y),0==b||1==b?(this.m_type=R.e_faceB,this.m_axis=P.CrossVF(P.SubtractVV(u,h),1),this.m_axis.Normalize(),this.m_localPoint=l,m=this.m_axis,x=(p=o.R).col1.x*m.x+p.col2.x*m.y,v=p.col1.y*m.x+p.col2.y*m.y,m=this.m_localPoint,p=o.R,_=o.position.x+(p.col1.x*m.x+p.col2.x*m.y),y=o.position.y+(p.col1.y*m.x+p.col2.y*m.y),m=r,p=i.R,((f=i.position.x+(p.col1.x*m.x+p.col2.x*m.y))-_)*x+((d=i.position.y+(p.col1.y*m.x+p.col2.y*m.y))-y)*v):(this.m_type=R.e_faceA,this.m_axis=P.CrossVF(P.SubtractVV(a,s),1),this.m_localPoint=r,m=this.m_axis,x=(p=i.R).col1.x*m.x+p.col2.x*m.y,v=p.col1.y*m.x+p.col2.y*m.y,m=this.m_localPoint,p=i.R,f=i.position.x+(p.col1.x*m.x+p.col2.x*m.y),d=i.position.y+(p.col1.y*m.x+p.col2.y*m.y),m=l,p=o.R,((_=o.position.x+(p.col1.x*m.x+p.col2.x*m.y))-f)*x+((y=o.position.y+(p.col1.y*m.x+p.col2.y*m.y))-d)*v),b<0&&this.m_axis.NegativeSelf()}},R.prototype.Evaluate=function(t,e){var i,n,o,r,s,a,l;switch(this.m_type){case R.e_points:return i=P.MulTMV(t.R,this.m_axis),n=P.MulTMV(e.R,this.m_axis.GetNegative()),o=this.m_proxyA.GetSupportVertex(i),r=this.m_proxyB.GetSupportVertex(n),s=P.MulX(t,o),((a=P.MulX(e,r)).x-s.x)*this.m_axis.x+(a.y-s.y)*this.m_axis.y;case R.e_faceA:return l=P.MulMV(t.R,this.m_axis),s=P.MulX(t,this.m_localPoint),n=P.MulTMV(e.R,l.GetNegative()),r=this.m_proxyB.GetSupportVertex(n),((a=P.MulX(e,r)).x-s.x)*l.x+(a.y-s.y)*l.y;case R.e_faceB:return l=P.MulMV(e.R,this.m_axis),a=P.MulX(e,this.m_localPoint),i=P.MulTMV(t.R,l.GetNegative()),o=this.m_proxyA.GetSupportVertex(i),((s=P.MulX(t,o)).x-a.x)*l.x+(s.y-a.y)*l.y;default:return j.b2Assert(!1),0}},Box2D.postDefs.push(function(){Box2D.Collision.b2SeparationFunction.e_points=1,Box2D.Collision.b2SeparationFunction.e_faceA=2,Box2D.Collision.b2SeparationFunction.e_faceB=4}),C.b2Simplex=function(){this.m_v1=new S,this.m_v2=new S,this.m_v3=new S,this.m_vertices=new Vector(3)},C.prototype.b2Simplex=function(){this.m_vertices[0]=this.m_v1,this.m_vertices[1]=this.m_v2,this.m_vertices[2]=this.m_v3},C.prototype.ReadCache=function(t,e,i,n,o){var r,s;j.b2Assert(0<=t.count&&t.count<=3),this.m_count=t.count;for(var a=this.m_vertices,l=0;l<this.m_count;l++){var h=a[l];h.indexA=t.indexA[l],h.indexB=t.indexB[l],r=e.GetVertex(h.indexA),s=n.GetVertex(h.indexB),h.wA=P.MulX(i,r),h.wB=P.MulX(o,s),h.w=P.SubtractVV(h.wB,h.wA),h.a=0}if(1<this.m_count){var u=t.metric,c=this.GetMetric();(c<.5*u||2*u<c||c<Number.MIN_VALUE)&&(this.m_count=0)}0==this.m_count&&((h=a[0]).indexA=0,h.indexB=0,r=e.GetVertex(0),s=n.GetVertex(0),h.wA=P.MulX(i,r),h.wB=P.MulX(o,s),h.w=P.SubtractVV(h.wB,h.wA),this.m_count=1)},C.prototype.WriteCache=function(t){t.metric=this.GetMetric(),t.count=Box2D.parseUInt(this.m_count);for(var e=this.m_vertices,i=0;i<this.m_count;i++)t.indexA[i]=Box2D.parseUInt(e[i].indexA),t.indexB[i]=Box2D.parseUInt(e[i].indexB)},C.prototype.GetSearchDirection=function(){switch(this.m_count){case 1:return this.m_v1.w.GetNegative();case 2:var t=P.SubtractVV(this.m_v2.w,this.m_v1.w);return 0<P.CrossVV(t,this.m_v1.w.GetNegative())?P.CrossFV(1,t):P.CrossVF(t,1);default:return j.b2Assert(!1),new I}},C.prototype.GetClosestPoint=function(){switch(this.m_count){case 0:return j.b2Assert(!1),new I;case 1:return this.m_v1.w;case 2:return new I(this.m_v1.a*this.m_v1.w.x+this.m_v2.a*this.m_v2.w.x,this.m_v1.a*this.m_v1.w.y+this.m_v2.a*this.m_v2.w.y);default:return j.b2Assert(!1),new I}},C.prototype.GetWitnessPoints=function(t,e){switch(this.m_count){case 0:j.b2Assert(!1);break;case 1:t.SetV(this.m_v1.wA),e.SetV(this.m_v1.wB);break;case 2:t.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x,t.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y,e.x=this.m_v1.a*this.m_v1.wB.x+this.m_v2.a*this.m_v2.wB.x,e.y=this.m_v1.a*this.m_v1.wB.y+this.m_v2.a*this.m_v2.wB.y;break;case 3:e.x=t.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x+this.m_v3.a*this.m_v3.wA.x,e.y=t.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y+this.m_v3.a*this.m_v3.wA.y;break;default:j.b2Assert(!1)}},C.prototype.GetMetric=function(){switch(this.m_count){case 0:return j.b2Assert(!1),0;case 1:return 0;case 2:return P.SubtractVV(this.m_v1.w,this.m_v2.w).Length();case 3:return P.CrossVV(P.SubtractVV(this.m_v2.w,this.m_v1.w),P.SubtractVV(this.m_v3.w,this.m_v1.w));default:return j.b2Assert(!1),0}},C.prototype.Solve2=function(){var t=this.m_v1.w,e=this.m_v2.w,i=P.SubtractVV(e,t),n=-(t.x*i.x+t.y*i.y);if(n<=0)return this.m_v1.a=1,void(this.m_count=1);var o=e.x*i.x+e.y*i.y;if(o<=0)return this.m_v2.a=1,this.m_count=1,void this.m_v1.Set(this.m_v2);var r=1/(o+n);this.m_v1.a=o*r,this.m_v2.a=n*r,this.m_count=2},C.prototype.Solve3=function(){var t=this.m_v1.w,e=this.m_v2.w,i=this.m_v3.w,n=P.SubtractVV(e,t),o=P.Dot(t,n),r=P.Dot(e,n),s=-o,a=P.SubtractVV(i,t),l=P.Dot(t,a),h=P.Dot(i,a),u=-l,c=P.SubtractVV(i,e),p=P.Dot(e,c),m=P.Dot(i,c),f=-p,d=P.CrossVV(n,a),_=d*P.CrossVV(e,i),y=d*P.CrossVV(i,t),x=d*P.CrossVV(t,e);if(s<=0&&u<=0)return this.m_v1.a=1,void(this.m_count=1);if(0<r&&0<s&&x<=0){var v=1/(r+s);return this.m_v1.a=r*v,this.m_v2.a=s*v,void(this.m_count=2)}if(0<h&&0<u&&y<=0){var b=1/(h+u);return this.m_v1.a=h*b,this.m_v3.a=u*b,this.m_count=2,void this.m_v2.Set(this.m_v3)}if(r<=0&&f<=0)return this.m_v2.a=1,this.m_count=1,void this.m_v1.Set(this.m_v2);if(h<=0&&m<=0)return this.m_v3.a=1,this.m_count=1,void this.m_v1.Set(this.m_v3);if(0<m&&0<f&&_<=0){var g=1/(m+f);return this.m_v2.a=m*g,this.m_v3.a=f*g,this.m_count=2,void this.m_v1.Set(this.m_v3)}var w=1/(_+y+x);this.m_v1.a=_*w,this.m_v2.a=y*w,this.m_v3.a=x*w,this.m_count=3},D.b2SimplexCache=function(){this.indexA=new Vector_a2j_Number(3),this.indexB=new Vector_a2j_Number(3)},S.b2SimplexVertex=function(){},S.prototype.Set=function(t){this.wA.SetV(t.wA),this.wB.SetV(t.wB),this.w.SetV(t.w),this.a=t.a,this.indexA=t.indexA,this.indexB=t.indexB},T.b2TimeOfImpact=function(){},T.TimeOfImpact=function(t){++T.b2_toiCalls;var e=t.proxyA,i=t.proxyB,n=t.sweepA,o=t.sweepB;j.b2Assert(n.t0==o.t0),j.b2Assert(1-n.t0>Number.MIN_VALUE);var r=e.m_radius+i.m_radius,s=t.tolerance,a=0,l=0,h=0;for(T.s_cache.count=0,T.s_distanceInput.useRadii=!1;;){if(n.GetTransform(T.s_xfA,a),o.GetTransform(T.s_xfB,a),T.s_distanceInput.proxyA=e,T.s_distanceInput.proxyB=i,T.s_distanceInput.transformA=T.s_xfA,T.s_distanceInput.transformB=T.s_xfB,g.Distance(T.s_distanceOutput,T.s_cache,T.s_distanceInput),T.s_distanceOutput.distance<=0){a=1;break}T.s_fcn.Initialize(T.s_cache,e,T.s_xfA,i,T.s_xfB);var u=T.s_fcn.Evaluate(T.s_xfA,T.s_xfB);if(u<=0){a=1;break}if(0==l&&(h=r<u?P.Max(r-s,.75*r):P.Max(u-s,.02*r)),u-h<.5*s){if(0!=l)break;a=1;break}var c=a,p=a,m=1,f=u;n.GetTransform(T.s_xfA,m),o.GetTransform(T.s_xfB,m);var d=T.s_fcn.Evaluate(T.s_xfA,T.s_xfB);if(h<=d){a=1;break}for(var _=0;;){var y=0;y=1&_?p+(h-f)*(m-p)/(d-f):.5*(p+m),n.GetTransform(T.s_xfA,y),o.GetTransform(T.s_xfB,y);var x=T.s_fcn.Evaluate(T.s_xfA,T.s_xfB);if(P.Abs(x-h)<.025*s){c=y;break}if(h<x?(p=y,f=x):(m=y,d=x),++_,++T.b2_toiRootIters,50==_)break}if(T.b2_toiMaxRootIters=P.Max(T.b2_toiMaxRootIters,_),c<(1+100*Number.MIN_VALUE)*a)break;if(a=c,l++,++T.b2_toiIters,1e3==l)break}return T.b2_toiMaxIters=P.Max(T.b2_toiMaxIters,l),a},Box2D.postDefs.push(function(){Box2D.Collision.b2TimeOfImpact.b2_toiCalls=0,Box2D.Collision.b2TimeOfImpact.b2_toiIters=0,Box2D.Collision.b2TimeOfImpact.b2_toiMaxIters=0,Box2D.Collision.b2TimeOfImpact.b2_toiRootIters=0,Box2D.Collision.b2TimeOfImpact.b2_toiMaxRootIters=0,Box2D.Collision.b2TimeOfImpact.s_cache=new D,Box2D.Collision.b2TimeOfImpact.s_distanceInput=new h,Box2D.Collision.b2TimeOfImpact.s_xfA=new e,Box2D.Collision.b2TimeOfImpact.s_xfB=new e,Box2D.Collision.b2TimeOfImpact.s_fcn=new R,Box2D.Collision.b2TimeOfImpact.s_distanceOutput=new u}),A.b2TOIInput=function(){this.proxyA=new c,this.proxyB=new c,this.sweepA=new t,this.sweepB=new t},M.b2WorldManifold=function(){this.m_normal=new I},M.prototype.b2WorldManifold=function(){this.m_points=new Vector(j.b2_maxManifoldPoints);for(var t=0;t<j.b2_maxManifoldPoints;t++)this.m_points[t]=new I},M.prototype.Initialize=function(t,e,i,n,o){if(void 0===i&&(i=0),void 0===o&&(o=0),0!=t.m_pointCount){var r,s,a=0,l=0,h=0,u=0,c=0,p=0,m=0;switch(t.m_type){case J.e_circles:s=e.R,r=t.m_localPoint;var f=e.position.x+s.col1.x*r.x+s.col2.x*r.y,d=e.position.y+s.col1.y*r.x+s.col2.y*r.y;s=n.R,r=t.m_points[0].m_localPoint;var _=n.position.x+s.col1.x*r.x+s.col2.x*r.y,y=n.position.y+s.col1.y*r.x+s.col2.y*r.y,x=_-f,v=y-d,b=x*x+v*v;if(b>Number.MIN_VALUE*Number.MIN_VALUE){var g=Math.sqrt(b);this.m_normal.x=x/g,this.m_normal.y=v/g}else this.m_normal.x=1,this.m_normal.y=0;var w=f+i*this.m_normal.x,C=d+i*this.m_normal.y,D=_-o*this.m_normal.x,S=y-o*this.m_normal.y;this.m_points[0].x=.5*(w+D),this.m_points[0].y=.5*(C+S);break;case J.e_faceA:for(s=e.R,r=t.m_localPlaneNormal,l=s.col1.x*r.x+s.col2.x*r.y,h=s.col1.y*r.x+s.col2.y*r.y,s=e.R,r=t.m_localPoint,u=e.position.x+s.col1.x*r.x+s.col2.x*r.y,c=e.position.y+s.col1.y*r.x+s.col2.y*r.y,this.m_normal.x=l,this.m_normal.y=h,a=0;a<t.m_pointCount;a++)s=n.R,r=t.m_points[a].m_localPoint,p=n.position.x+s.col1.x*r.x+s.col2.x*r.y,m=n.position.y+s.col1.y*r.x+s.col2.y*r.y,this.m_points[a].x=p+.5*(i-(p-u)*l-(m-c)*h-o)*l,this.m_points[a].y=m+.5*(i-(p-u)*l-(m-c)*h-o)*h;break;case J.e_faceB:for(s=n.R,r=t.m_localPlaneNormal,l=s.col1.x*r.x+s.col2.x*r.y,h=s.col1.y*r.x+s.col2.y*r.y,s=n.R,r=t.m_localPoint,u=n.position.x+s.col1.x*r.x+s.col2.x*r.y,c=n.position.y+s.col1.y*r.x+s.col2.y*r.y,this.m_normal.x=-l,this.m_normal.y=-h,a=0;a<t.m_pointCount;a++)s=e.R,r=t.m_points[a].m_localPoint,p=e.position.x+s.col1.x*r.x+s.col2.x*r.y,m=e.position.y+s.col1.y*r.x+s.col2.y*r.y,this.m_points[a].x=p+.5*(o-(p-u)*l-(m-c)*h-i)*l,this.m_points[a].y=m+.5*(o-(p-u)*l-(m-c)*h-i)*h}}},B.ClipVertex=function(){this.v=new I,this.id=new a},B.prototype.Set=function(t){this.v.SetV(t.v),this.id.Set(t.id)},E.Features=function(){},Object.defineProperty(E.prototype,"referenceEdge",{enumerable:!1,configurable:!0,get:function(){return this._referenceEdge}}),Object.defineProperty(E.prototype,"referenceEdge",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0),this._referenceEdge=t,this._m_id._key=4294967040&this._m_id._key|255&this._referenceEdge}}),Object.defineProperty(E.prototype,"incidentEdge",{enumerable:!1,configurable:!0,get:function(){return this._incidentEdge}}),Object.defineProperty(E.prototype,"incidentEdge",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0),this._incidentEdge=t,this._m_id._key=4294902015&this._m_id._key|this._incidentEdge<<8&65280}}),Object.defineProperty(E.prototype,"incidentVertex",{enumerable:!1,configurable:!0,get:function(){return this._incidentVertex}}),Object.defineProperty(E.prototype,"incidentVertex",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0),this._incidentVertex=t,this._m_id._key=4278255615&this._m_id._key|this._incidentVertex<<16&16711680}}),Object.defineProperty(E.prototype,"flip",{enumerable:!1,configurable:!0,get:function(){return this._flip}}),Object.defineProperty(E.prototype,"flip",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0),this._flip=t,this._m_id._key=16777215&this._m_id._key|this._flip<<24&4278190080}})}(),function(){Box2D.Common.b2Color,Box2D.Common.b2internal;var s=Box2D.Common.b2Settings,i=Box2D.Collision.Shapes.b2CircleShape,t=Box2D.Collision.Shapes.b2EdgeChainDef,e=Box2D.Collision.Shapes.b2EdgeShape,S=Box2D.Collision.Shapes.b2MassData,a=Box2D.Collision.Shapes.b2PolygonShape,n=Box2D.Collision.Shapes.b2Shape,o=Box2D.Common.Math.b2Mat22,T=(Box2D.Common.Math.b2Mat33,Box2D.Common.Math.b2Math),l=(Box2D.Common.Math.b2Sweep,Box2D.Common.Math.b2Transform),A=Box2D.Common.Math.b2Vec2,h=(Box2D.Common.Math.b2Vec3,Box2D.Dynamics.b2Body,Box2D.Dynamics.b2BodyDef,Box2D.Dynamics.b2ContactFilter,Box2D.Dynamics.b2ContactImpulse,Box2D.Dynamics.b2ContactListener,Box2D.Dynamics.b2ContactManager,Box2D.Dynamics.b2DebugDraw,Box2D.Dynamics.b2DestructionListener,Box2D.Dynamics.b2FilterData,Box2D.Dynamics.b2Fixture,Box2D.Dynamics.b2FixtureDef,Box2D.Dynamics.b2Island,Box2D.Dynamics.b2TimeStep,Box2D.Dynamics.b2World,Box2D.Collision.b2AABB,Box2D.Collision.b2Bound,Box2D.Collision.b2BoundValues,Box2D.Collision.b2Collision,Box2D.Collision.b2ContactID,Box2D.Collision.b2ContactPoint,Box2D.Collision.b2Distance),u=Box2D.Collision.b2DistanceInput,c=Box2D.Collision.b2DistanceOutput,p=Box2D.Collision.b2DistanceProxy,m=(Box2D.Collision.b2DynamicTree,Box2D.Collision.b2DynamicTreeBroadPhase,Box2D.Collision.b2DynamicTreeNode,Box2D.Collision.b2DynamicTreePair,Box2D.Collision.b2Manifold,Box2D.Collision.b2ManifoldPoint,Box2D.Collision.b2Point,Box2D.Collision.b2RayCastInput,Box2D.Collision.b2RayCastOutput,Box2D.Collision.b2Segment,Box2D.Collision.b2SeparationFunction,Box2D.Collision.b2Simplex,Box2D.Collision.b2SimplexCache);Box2D.Collision.b2SimplexVertex,Box2D.Collision.b2TimeOfImpact,Box2D.Collision.b2TOIInput,Box2D.Collision.b2WorldManifold,Box2D.Collision.ClipVertex,Box2D.Collision.Features,Box2D.Collision.IBroadPhase;Box2D.inherit(i,Box2D.Collision.Shapes.b2Shape),i.prototype.__super=Box2D.Collision.Shapes.b2Shape.prototype,i.b2CircleShape=function(){Box2D.Collision.Shapes.b2Shape.b2Shape.apply(this,arguments),this.m_p=new A},i.prototype.Copy=function(){var t=new i;return t.Set(this),t},i.prototype.Set=function(t){if(this.__super.Set.call(this,t),Box2D.is(t,i)){var e=t instanceof i?t:null;this.m_p.SetV(e.m_p)}},i.prototype.TestPoint=function(t,e){var i=t.R,n=t.position.x+(i.col1.x*this.m_p.x+i.col2.x*this.m_p.y),o=t.position.y+(i.col1.y*this.m_p.x+i.col2.y*this.m_p.y);return(n=e.x-n)*n+(o=e.y-o)*o<=this.m_radius*this.m_radius},i.prototype.RayCast=function(t,e,i){var n=i.R,o=i.position.x+(n.col1.x*this.m_p.x+n.col2.x*this.m_p.y),r=i.position.y+(n.col1.y*this.m_p.x+n.col2.y*this.m_p.y),s=e.p1.x-o,a=e.p1.y-r,l=s*s+a*a-this.m_radius*this.m_radius,h=e.p2.x-e.p1.x,u=e.p2.y-e.p1.y,c=s*h+a*u,p=h*h+u*u,m=c*c-p*l;if(m<0||p<Number.MIN_VALUE)return!1;var f=-(c+Math.sqrt(m));return 0<=f&&f<=e.maxFraction*p&&(f/=p,t.fraction=f,t.normal.x=s+f*h,t.normal.y=a+f*u,t.normal.Normalize(),!0)},i.prototype.ComputeAABB=function(t,e){var i=e.R,n=e.position.x+(i.col1.x*this.m_p.x+i.col2.x*this.m_p.y),o=e.position.y+(i.col1.y*this.m_p.x+i.col2.y*this.m_p.y);t.lowerBound.Set(n-this.m_radius,o-this.m_radius),t.upperBound.Set(n+this.m_radius,o+this.m_radius)},i.prototype.ComputeMass=function(t,e){void 0===e&&(e=0),t.mass=e*s.b2_pi*this.m_radius*this.m_radius,t.center.SetV(this.m_p),t.I=t.mass*(.5*this.m_radius*this.m_radius+(this.m_p.x*this.m_p.x+this.m_p.y*this.m_p.y))},i.prototype.ComputeSubmergedArea=function(t,e,i,n){void 0===e&&(e=0);var o=T.MulX(i,this.m_p),r=-(T.Dot(t,o)-e);if(r<-this.m_radius+Number.MIN_VALUE)return 0;if(r>this.m_radius)return n.SetV(o),Math.PI*this.m_radius*this.m_radius;var s=this.m_radius*this.m_radius,a=r*r,l=s*(Math.asin(r/this.m_radius)+Math.PI/2)+r*Math.sqrt(s-a),h=-2/3*Math.pow(s-a,1.5)/l;return n.x=o.x+t.x*h,n.y=o.y+t.y*h,l},i.prototype.GetLocalPosition=function(){return this.m_p},i.prototype.SetLocalPosition=function(t){this.m_p.SetV(t)},i.prototype.GetRadius=function(){return this.m_radius},i.prototype.SetRadius=function(t){void 0===t&&(t=0),this.m_radius=t},i.prototype.b2CircleShape=function(t){void 0===t&&(t=0),this.__super.b2Shape.call(this),this.m_type=n.e_circleShape,this.m_radius=t},t.b2EdgeChainDef=function(){},t.prototype.b2EdgeChainDef=function(){this.vertexCount=0,this.isALoop=!0,this.vertices=[]},Box2D.inherit(e,Box2D.Collision.Shapes.b2Shape),e.prototype.__super=Box2D.Collision.Shapes.b2Shape.prototype,e.b2EdgeShape=function(){Box2D.Collision.Shapes.b2Shape.b2Shape.apply(this,arguments),this.s_supportVec=new A,this.m_v1=new A,this.m_v2=new A,this.m_coreV1=new A,this.m_coreV2=new A,this.m_normal=new A,this.m_direction=new A,this.m_cornerDir1=new A,this.m_cornerDir2=new A},e.prototype.TestPoint=function(t,e){return!1},e.prototype.RayCast=function(t,e,i){var n,o=e.p2.x-e.p1.x,r=e.p2.y-e.p1.y;n=i.R;var s=i.position.x+(n.col1.x*this.m_v1.x+n.col2.x*this.m_v1.y),a=i.position.y+(n.col1.y*this.m_v1.x+n.col2.y*this.m_v1.y),l=i.position.y+(n.col1.y*this.m_v2.x+n.col2.y*this.m_v2.y)-a,h=-(i.position.x+(n.col1.x*this.m_v2.x+n.col2.x*this.m_v2.y)-s),u=100*Number.MIN_VALUE,c=-(o*l+r*h);if(u<c){var p=e.p1.x-s,m=e.p1.y-a,f=p*l+m*h;if(0<=f&&f<=e.maxFraction*c){var d=-o*m+r*p;if(-u*c<=d&&d<=c*(1+u)){f/=c,t.fraction=f;var _=Math.sqrt(l*l+h*h);return t.normal.x=l/_,t.normal.y=h/_,!0}}}return!1},e.prototype.ComputeAABB=function(t,e){var i=e.R,n=e.position.x+(i.col1.x*this.m_v1.x+i.col2.x*this.m_v1.y),o=e.position.y+(i.col1.y*this.m_v1.x+i.col2.y*this.m_v1.y),r=e.position.x+(i.col1.x*this.m_v2.x+i.col2.x*this.m_v2.y),s=e.position.y+(i.col1.y*this.m_v2.x+i.col2.y*this.m_v2.y);t.upperBound.x=n<r?(t.lowerBound.x=n,r):(t.lowerBound.x=r,n),t.upperBound.y=o<s?(t.lowerBound.y=o,s):(t.lowerBound.y=s,o)},e.prototype.ComputeMass=function(t,e){void 0===e&&(e=0),t.mass=0,t.center.SetV(this.m_v1),t.I=0},e.prototype.ComputeSubmergedArea=function(t,e,i,n){void 0===e&&(e=0);var o=new A(t.x*e,t.y*e),r=T.MulX(i,this.m_v1),s=T.MulX(i,this.m_v2),a=T.Dot(t,r)-e,l=T.Dot(t,s)-e;if(0<a){if(0<l)return 0;r.x=-l/(a-l)*r.x+a/(a-l)*s.x,r.y=-l/(a-l)*r.y+a/(a-l)*s.y}else 0<l&&(s.x=-l/(a-l)*r.x+a/(a-l)*s.x,s.y=-l/(a-l)*r.y+a/(a-l)*s.y);return n.x=(o.x+r.x+s.x)/3,n.y=(o.y+r.y+s.y)/3,.5*((r.x-o.x)*(s.y-o.y)-(r.y-o.y)*(s.x-o.x))},e.prototype.GetLength=function(){return this.m_length},e.prototype.GetVertex1=function(){return this.m_v1},e.prototype.GetVertex2=function(){return this.m_v2},e.prototype.GetCoreVertex1=function(){return this.m_coreV1},e.prototype.GetCoreVertex2=function(){return this.m_coreV2},e.prototype.GetNormalVector=function(){return this.m_normal},e.prototype.GetDirectionVector=function(){return this.m_direction},e.prototype.GetCorner1Vector=function(){return this.m_cornerDir1},e.prototype.GetCorner2Vector=function(){return this.m_cornerDir2},e.prototype.Corner1IsConvex=function(){return this.m_cornerConvex1},e.prototype.Corner2IsConvex=function(){return this.m_cornerConvex2},e.prototype.GetFirstVertex=function(t){var e=t.R;return new A(t.position.x+(e.col1.x*this.m_coreV1.x+e.col2.x*this.m_coreV1.y),t.position.y+(e.col1.y*this.m_coreV1.x+e.col2.y*this.m_coreV1.y))},e.prototype.GetNextEdge=function(){return this.m_nextEdge},e.prototype.GetPrevEdge=function(){return this.m_prevEdge},e.prototype.Support=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0);var n=t.R,o=t.position.x+(n.col1.x*this.m_coreV1.x+n.col2.x*this.m_coreV1.y),r=t.position.y+(n.col1.y*this.m_coreV1.x+n.col2.y*this.m_coreV1.y),s=t.position.x+(n.col1.x*this.m_coreV2.x+n.col2.x*this.m_coreV2.y),a=t.position.y+(n.col1.y*this.m_coreV2.x+n.col2.y*this.m_coreV2.y);return this.s_supportVec.y=s*e+a*i<o*e+r*i?(this.s_supportVec.x=o,r):(this.s_supportVec.x=s,a),this.s_supportVec},e.prototype.b2EdgeShape=function(t,e){this.__super.b2Shape.call(this),this.m_type=n.e_edgeShape,this.m_prevEdge=null,this.m_nextEdge=null,this.m_v1=t,this.m_v2=e,this.m_direction.Set(this.m_v2.x-this.m_v1.x,this.m_v2.y-this.m_v1.y),this.m_length=this.m_direction.Normalize(),this.m_normal.Set(this.m_direction.y,-this.m_direction.x),this.m_coreV1.Set(-s.b2_toiSlop*(this.m_normal.x-this.m_direction.x)+this.m_v1.x,-s.b2_toiSlop*(this.m_normal.y-this.m_direction.y)+this.m_v1.y),this.m_coreV2.Set(-s.b2_toiSlop*(this.m_normal.x+this.m_direction.x)+this.m_v2.x,-s.b2_toiSlop*(this.m_normal.y+this.m_direction.y)+this.m_v2.y),this.m_cornerDir1=this.m_normal,this.m_cornerDir2.Set(-this.m_normal.x,-this.m_normal.y)},e.prototype.SetPrevEdge=function(t,e,i,n){this.m_prevEdge=t,this.m_coreV1=e,this.m_cornerDir1=i,this.m_cornerConvex1=n},e.prototype.SetNextEdge=function(t,e,i,n){this.m_nextEdge=t,this.m_coreV2=e,this.m_cornerDir2=i,this.m_cornerConvex2=n},S.b2MassData=function(){this.mass=0,this.center=new A(0,0),this.I=0},Box2D.inherit(a,Box2D.Collision.Shapes.b2Shape),a.prototype.__super=Box2D.Collision.Shapes.b2Shape.prototype,a.b2PolygonShape=function(){Box2D.Collision.Shapes.b2Shape.b2Shape.apply(this,arguments)},a.prototype.Copy=function(){var t=new a;return t.Set(this),t},a.prototype.Set=function(t){if(this.__super.Set.call(this,t),Box2D.is(t,a)){var e=t instanceof a?t:null;this.m_centroid.SetV(e.m_centroid),this.m_vertexCount=e.m_vertexCount,this.Reserve(this.m_vertexCount);for(var i=0;i<this.m_vertexCount;i++)this.m_vertices[i].SetV(e.m_vertices[i]),this.m_normals[i].SetV(e.m_normals[i])}},a.prototype.SetAsArray=function(t,e){void 0===e&&(e=0);var i,n=new Vector,o=0;for(o=0;o<t.length;++o)i=t[o],n.push(i);this.SetAsVector(n,e)},a.AsArray=function(t,e){void 0===e&&(e=0);var i=new a;return i.SetAsArray(t,e),i},a.prototype.SetAsVector=function(t,e){void 0===e&&(e=0),0==e&&(e=t.length),s.b2Assert(2<=e),this.m_vertexCount=e,this.Reserve(e);var i=0;for(i=0;i<this.m_vertexCount;i++)this.m_vertices[i].SetV(t[i]);for(i=0;i<this.m_vertexCount;++i){var n=parseInt(i),o=parseInt(i+1<this.m_vertexCount?i+1:0),r=T.SubtractVV(this.m_vertices[o],this.m_vertices[n]);s.b2Assert(r.LengthSquared()>Number.MIN_VALUE),this.m_normals[i].SetV(T.CrossVF(r,1)),this.m_normals[i].Normalize()}this.m_centroid=a.ComputeCentroid(this.m_vertices,this.m_vertexCount)},a.AsVector=function(t,e){void 0===e&&(e=0);var i=new a;return i.SetAsVector(t,e),i},a.prototype.SetAsBox=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.m_vertexCount=4,this.Reserve(4),this.m_vertices[0].Set(-t,-e),this.m_vertices[1].Set(t,-e),this.m_vertices[2].Set(t,e),this.m_vertices[3].Set(-t,e),this.m_normals[0].Set(0,-1),this.m_normals[1].Set(1,0),this.m_normals[2].Set(0,1),this.m_normals[3].Set(-1,0),this.m_centroid.SetZero()},a.AsBox=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var i=new a;return i.SetAsBox(t,e),i},a.prototype.SetAsOrientedBox=function(t,e,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=null),void 0===n&&(n=0),this.m_vertexCount=4,this.Reserve(4),this.m_vertices[0].Set(-t,-e),this.m_vertices[1].Set(t,-e),this.m_vertices[2].Set(t,e),this.m_vertices[3].Set(-t,e),this.m_normals[0].Set(0,-1),this.m_normals[1].Set(1,0),this.m_normals[2].Set(0,1),this.m_normals[3].Set(-1,0),this.m_centroid=i;var o=new l;o.position=i,o.R.Set(n);for(var r=0;r<this.m_vertexCount;++r)this.m_vertices[r]=T.MulX(o,this.m_vertices[r]),this.m_normals[r]=T.MulMV(o.R,this.m_normals[r])},a.AsOrientedBox=function(t,e,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=null),void 0===n&&(n=0);var o=new a;return o.SetAsOrientedBox(t,e,i,n),o},a.prototype.SetAsEdge=function(t,e){this.m_vertexCount=2,this.Reserve(2),this.m_vertices[0].SetV(t),this.m_vertices[1].SetV(e),this.m_centroid.x=.5*(t.x+e.x),this.m_centroid.y=.5*(t.y+e.y),this.m_normals[0]=T.CrossVF(T.SubtractVV(e,t),1),this.m_normals[0].Normalize(),this.m_normals[1].x=-this.m_normals[0].x,this.m_normals[1].y=-this.m_normals[0].y},a.AsEdge=function(t,e){var i=new a;return i.SetAsEdge(t,e),i},a.prototype.TestPoint=function(t,e){for(var i,n=t.R,o=e.x-t.position.x,r=e.y-t.position.y,s=o*n.col1.x+r*n.col1.y,a=o*n.col2.x+r*n.col2.y,l=0;l<this.m_vertexCount;++l){if(o=s-(i=this.m_vertices[l]).x,r=a-i.y,0<(i=this.m_normals[l]).x*o+i.y*r)return!1}return!0},a.prototype.RayCast=function(t,e,i){var n,o,r=0,s=e.maxFraction,a=0,l=0;a=e.p1.x-i.position.x,l=e.p1.y-i.position.y;var h=a*(n=i.R).col1.x+l*n.col1.y,u=a*n.col2.x+l*n.col2.y;a=e.p2.x-i.position.x,l=e.p2.y-i.position.y;for(var c=a*(n=i.R).col1.x+l*n.col1.y-h,p=a*n.col2.x+l*n.col2.y-u,m=parseInt(-1),f=0;f<this.m_vertexCount;++f){a=(o=this.m_vertices[f]).x-h,l=o.y-u;var d=(o=this.m_normals[f]).x*a+o.y*l,_=o.x*c+o.y*p;if(0==_){if(d<0)return!1}else _<0&&d<r*_?(r=d/_,m=f):0<_&&d<s*_&&(s=d/_);if(s<r-Number.MIN_VALUE)return!1}return 0<=m&&(t.fraction=r,n=i.R,o=this.m_normals[m],t.normal.x=n.col1.x*o.x+n.col2.x*o.y,t.normal.y=n.col1.y*o.x+n.col2.y*o.y,!0)},a.prototype.ComputeAABB=function(t,e){for(var i=e.R,n=this.m_vertices[0],o=e.position.x+(i.col1.x*n.x+i.col2.x*n.y),r=e.position.y+(i.col1.y*n.x+i.col2.y*n.y),s=o,a=r,l=1;l<this.m_vertexCount;++l){n=this.m_vertices[l];var h=e.position.x+(i.col1.x*n.x+i.col2.x*n.y),u=e.position.y+(i.col1.y*n.x+i.col2.y*n.y);o=o<h?o:h,r=r<u?r:u,s=h<s?s:h,a=u<a?a:u}t.lowerBound.x=o-this.m_radius,t.lowerBound.y=r-this.m_radius,t.upperBound.x=s+this.m_radius,t.upperBound.y=a+this.m_radius},a.prototype.ComputeMass=function(t,e){if(void 0===e&&(e=0),2==this.m_vertexCount)return t.center.x=.5*(this.m_vertices[0].x+this.m_vertices[1].x),t.center.y=.5*(this.m_vertices[0].y+this.m_vertices[1].y),t.mass=0,void(t.I=0);for(var i=0,n=0,o=0,r=0,s=0;s<this.m_vertexCount;++s){var a=this.m_vertices[s],l=s+1<this.m_vertexCount?this.m_vertices[parseInt(s+1)]:this.m_vertices[0],h=a.x-0,u=a.y-0,c=l.x-0,p=l.y-0,m=h*p-u*c,f=.5*m;o+=f,i+=f*(1/3)*(0+a.x+l.x),n+=f*(1/3)*(0+a.y+l.y);r+=m*(1/3*(.25*(h*h+c*h+c*c)+(0*h+0*c))+0+(1/3*(.25*(u*u+p*u+p*p)+(0*u+0*p))+0))}t.mass=e*o,i*=1/o,n*=1/o,t.center.Set(i,n),t.I=e*r},a.prototype.ComputeSubmergedArea=function(t,e,i,n){void 0===e&&(e=0);var o=T.MulTMV(i.R,t),r=e-T.Dot(t,i.position),s=new Vector_a2j_Number,a=0,l=parseInt(-1),h=parseInt(-1),u=!1,c=0;for(c=0;c<this.m_vertexCount;++c){s[c]=T.Dot(o,this.m_vertices[c])-r;var p=s[c]<-Number.MIN_VALUE;0<c&&(p?u||(l=c-1,a++):u&&(h=c-1,a++)),u=p}switch(a){case 0:if(u){var m=new S;return this.ComputeMass(m,1),n.SetV(T.MulX(i,m.center)),m.mass}return 0;case 1:-1==l?l=this.m_vertexCount-1:h=this.m_vertexCount-1}var f,d=parseInt((l+1)%this.m_vertexCount),_=parseInt((h+1)%this.m_vertexCount),y=(0-s[l])/(s[d]-s[l]),x=(0-s[h])/(s[_]-s[h]),v=new A(this.m_vertices[l].x*(1-y)+this.m_vertices[d].x*y,this.m_vertices[l].y*(1-y)+this.m_vertices[d].y*y),b=new A(this.m_vertices[h].x*(1-x)+this.m_vertices[_].x*x,this.m_vertices[h].y*(1-x)+this.m_vertices[_].y*x),g=0,w=new A,C=this.m_vertices[d];for(c=d;c!=_;){f=(c=(c+1)%this.m_vertexCount)==_?b:this.m_vertices[c];var D=.5*((C.x-v.x)*(f.y-v.y)-(C.y-v.y)*(f.x-v.x));g+=D,w.x+=D*(v.x+C.x+f.x)/3,w.y+=D*(v.y+C.y+f.y)/3,C=f}return w.Multiply(1/g),n.SetV(T.MulX(i,w)),g},a.prototype.GetVertexCount=function(){return this.m_vertexCount},a.prototype.GetVertices=function(){return this.m_vertices},a.prototype.GetNormals=function(){return this.m_normals},a.prototype.GetSupport=function(t){for(var e=0,i=this.m_vertices[0].x*t.x+this.m_vertices[0].y*t.y,n=1;n<this.m_vertexCount;++n){var o=this.m_vertices[n].x*t.x+this.m_vertices[n].y*t.y;i<o&&(e=n,i=o)}return e},a.prototype.GetSupportVertex=function(t){for(var e=0,i=this.m_vertices[0].x*t.x+this.m_vertices[0].y*t.y,n=1;n<this.m_vertexCount;++n){var o=this.m_vertices[n].x*t.x+this.m_vertices[n].y*t.y;i<o&&(e=n,i=o)}return this.m_vertices[e]},a.prototype.Validate=function(){return!1},a.prototype.b2PolygonShape=function(){this.__super.b2Shape.call(this),this.m_type=n.e_polygonShape,this.m_centroid=new A,this.m_vertices=new Vector,this.m_normals=new Vector},a.prototype.Reserve=function(t){void 0===t&&(t=0);for(var e=parseInt(this.m_vertices.length);e<t;e++)this.m_vertices[e]=new A,this.m_normals[e]=new A},a.ComputeCentroid=function(t,e){void 0===e&&(e=0);for(var i=new A,n=0,o=0;o<e;++o){var r=t[o],s=o+1<e?t[parseInt(o+1)]:t[0],a=r.x-0,l=r.y-0,h=s.x-0,u=.5*(a*(s.y-0)-l*h);n+=u,i.x+=u*(1/3)*(0+r.x+s.x),i.y+=u*(1/3)*(0+r.y+s.y)}return i.x*=1/n,i.y*=1/n,i},a.ComputeOBB=function(t,e,i){void 0===i&&(i=0);var n=0,o=new Vector(i+1);for(n=0;n<i;++n)o[n]=e[n];o[i]=o[0];var r=Number.MAX_VALUE;for(n=1;n<=i;++n){for(var s=o[parseInt(n-1)],a=o[n].x-s.x,l=o[n].y-s.y,h=Math.sqrt(a*a+l*l),u=-(l/=h),c=a/=h,p=Number.MAX_VALUE,m=Number.MAX_VALUE,f=-Number.MAX_VALUE,d=-Number.MAX_VALUE,_=0;_<i;++_){var y=o[_].x-s.x,x=o[_].y-s.y,v=a*y+l*x,b=u*y+c*x;v<p&&(p=v),b<m&&(m=b),f<v&&(f=v),d<b&&(d=b)}var g=(f-p)*(d-m);if(g<.95*r){r=g,t.R.col1.x=a,t.R.col1.y=l,t.R.col2.x=u,t.R.col2.y=c;var w=.5*(p+f),C=.5*(m+d),D=t.R;t.center.x=s.x+(D.col1.x*w+D.col2.x*C),t.center.y=s.y+(D.col1.y*w+D.col2.y*C),t.extents.x=.5*(f-p),t.extents.y=.5*(d-m)}}},Box2D.postDefs.push(function(){Box2D.Collision.Shapes.b2PolygonShape.s_mat=new o}),n.b2Shape=function(){},n.prototype.Copy=function(){return null},n.prototype.Set=function(t){this.m_radius=t.m_radius},n.prototype.GetType=function(){return this.m_type},n.prototype.TestPoint=function(t,e){return!1},n.prototype.RayCast=function(t,e,i){return!1},n.prototype.ComputeAABB=function(t,e){},n.prototype.ComputeMass=function(t,e){void 0===e&&(e=0)},n.prototype.ComputeSubmergedArea=function(t,e,i,n){return void 0===e&&(e=0),0},n.TestOverlap=function(t,e,i,n){var o=new u;o.proxyA=new p,o.proxyA.Set(t),o.proxyB=new p,o.proxyB.Set(i),o.transformA=e,o.transformB=n,o.useRadii=!0;var r=new m;r.count=0;var s=new c;return h.Distance(s,r,o),s.distance<10*Number.MIN_VALUE},n.prototype.b2Shape=function(){this.m_type=n.e_unknownShape,this.m_radius=s.b2_linearSlop},Box2D.postDefs.push(function(){Box2D.Collision.Shapes.b2Shape.e_unknownShape=parseInt(-1),Box2D.Collision.Shapes.b2Shape.e_circleShape=0,Box2D.Collision.Shapes.b2Shape.e_polygonShape=1,Box2D.Collision.Shapes.b2Shape.e_edgeShape=2,Box2D.Collision.Shapes.b2Shape.e_shapeTypeCount=3,Box2D.Collision.Shapes.b2Shape.e_hitCollide=1,Box2D.Collision.Shapes.b2Shape.e_missCollide=0,Box2D.Collision.Shapes.b2Shape.e_startsInsideCollide=parseInt(-1)})}(),function(){var t=Box2D.Common.b2Color,e=(Box2D.Common.b2internal,Box2D.Common.b2Settings),n=(Box2D.Common.Math.b2Mat22,Box2D.Common.Math.b2Mat33,Box2D.Common.Math.b2Math);Box2D.Common.Math.b2Sweep,Box2D.Common.Math.b2Transform,Box2D.Common.Math.b2Vec2,Box2D.Common.Math.b2Vec3;t.b2Color=function(){this._r=0,this._g=0,this._b=0},t.prototype.b2Color=function(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this._r=Box2D.parseUInt(255*n.Clamp(t,0,1)),this._g=Box2D.parseUInt(255*n.Clamp(e,0,1)),this._b=Box2D.parseUInt(255*n.Clamp(i,0,1))},t.prototype.Set=function(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this._r=Box2D.parseUInt(255*n.Clamp(t,0,1)),this._g=Box2D.parseUInt(255*n.Clamp(e,0,1)),this._b=Box2D.parseUInt(255*n.Clamp(i,0,1))},Object.defineProperty(t.prototype,"r",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0),this._r=Box2D.parseUInt(255*n.Clamp(t,0,1))}}),Object.defineProperty(t.prototype,"g",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0),this._g=Box2D.parseUInt(255*n.Clamp(t,0,1))}}),Object.defineProperty(t.prototype,"b",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0),this._b=Box2D.parseUInt(255*n.Clamp(t,0,1))}}),Object.defineProperty(t.prototype,"color",{enumerable:!1,configurable:!0,get:function(){return this._r<<16|this._g<<8|this._b}}),e.b2Settings=function(){},e.b2MixFriction=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),Math.sqrt(t*e)},e.b2MixRestitution=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),e<t?t:e},e.b2Assert=function(t){if(!t)throw"Assertion Failed"},Box2D.postDefs.push(function(){Box2D.Common.b2Settings.VERSION="2.1alpha",Box2D.Common.b2Settings.USHRT_MAX=65535,Box2D.Common.b2Settings.b2_pi=Math.PI,Box2D.Common.b2Settings.b2_maxManifoldPoints=2,Box2D.Common.b2Settings.b2_aabbExtension=.1,Box2D.Common.b2Settings.b2_aabbMultiplier=2,Box2D.Common.b2Settings.b2_polygonRadius=2*e.b2_linearSlop,Box2D.Common.b2Settings.b2_linearSlop=.005,Box2D.Common.b2Settings.b2_angularSlop=2/180*e.b2_pi,Box2D.Common.b2Settings.b2_toiSlop=8*e.b2_linearSlop,Box2D.Common.b2Settings.b2_maxTOIContactsPerIsland=32,Box2D.Common.b2Settings.b2_maxTOIJointsPerIsland=32,Box2D.Common.b2Settings.b2_velocityThreshold=1,Box2D.Common.b2Settings.b2_maxLinearCorrection=.2,Box2D.Common.b2Settings.b2_maxAngularCorrection=8/180*e.b2_pi,Box2D.Common.b2Settings.b2_maxTranslation=2,Box2D.Common.b2Settings.b2_maxTranslationSquared=e.b2_maxTranslation*e.b2_maxTranslation,Box2D.Common.b2Settings.b2_maxRotation=.5*e.b2_pi,Box2D.Common.b2Settings.b2_maxRotationSquared=e.b2_maxRotation*e.b2_maxRotation,Box2D.Common.b2Settings.b2_contactBaumgarte=.2,Box2D.Common.b2Settings.b2_timeToSleep=.5,Box2D.Common.b2Settings.b2_linearSleepTolerance=.01,Box2D.Common.b2Settings.b2_angularSleepTolerance=2/180*e.b2_pi})}(),function(){Box2D.Collision.b2AABB,Box2D.Common.b2Color,Box2D.Common.b2internal,Box2D.Common.b2Settings;var o=Box2D.Common.Math.b2Mat22,t=Box2D.Common.Math.b2Mat33,r=Box2D.Common.Math.b2Math,e=Box2D.Common.Math.b2Sweep,i=Box2D.Common.Math.b2Transform,s=Box2D.Common.Math.b2Vec2,n=Box2D.Common.Math.b2Vec3;o.b2Mat22=function(){this.col1=new s,this.col2=new s},o.prototype.b2Mat22=function(){this.SetIdentity()},o.FromAngle=function(t){void 0===t&&(t=0);var e=new o;return e.Set(t),e},o.FromVV=function(t,e){var i=new o;return i.SetVV(t,e),i},o.prototype.Set=function(t){void 0===t&&(t=0);var e=Math.cos(t),i=Math.sin(t);this.col1.x=e,this.col2.x=-i,this.col1.y=i,this.col2.y=e},o.prototype.SetVV=function(t,e){this.col1.SetV(t),this.col2.SetV(e)},o.prototype.Copy=function(){var t=new o;return t.SetM(this),t},o.prototype.SetM=function(t){this.col1.SetV(t.col1),this.col2.SetV(t.col2)},o.prototype.AddM=function(t){this.col1.x+=t.col1.x,this.col1.y+=t.col1.y,this.col2.x+=t.col2.x,this.col2.y+=t.col2.y},o.prototype.SetIdentity=function(){this.col1.x=1,this.col2.x=0,this.col1.y=0,this.col2.y=1},o.prototype.SetZero=function(){this.col1.x=0,this.col2.x=0,this.col1.y=0,this.col2.y=0},o.prototype.GetAngle=function(){return Math.atan2(this.col1.y,this.col1.x)},o.prototype.GetInverse=function(t){var e=this.col1.x,i=this.col2.x,n=this.col1.y,o=this.col2.y,r=e*o-i*n;return 0!=r&&(r=1/r),t.col1.x=r*o,t.col2.x=-r*i,t.col1.y=-r*n,t.col2.y=r*e,t},o.prototype.Solve=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0);var n=this.col1.x,o=this.col2.x,r=this.col1.y,s=this.col2.y,a=n*s-o*r;return 0!=a&&(a=1/a),t.x=a*(s*e-o*i),t.y=a*(n*i-r*e),t},o.prototype.Abs=function(){this.col1.Abs(),this.col2.Abs()},t.b2Mat33=function(){this.col1=new n,this.col2=new n,this.col3=new n},t.prototype.b2Mat33=function(t,e,i){void 0===t&&(t=null),void 0===e&&(e=null),void 0===i&&(i=null),t||e||i?(this.col1.SetV(t),this.col2.SetV(e),this.col3.SetV(i)):(this.col1.SetZero(),this.col2.SetZero(),this.col3.SetZero())},t.prototype.SetVVV=function(t,e,i){this.col1.SetV(t),this.col2.SetV(e),this.col3.SetV(i)},t.prototype.Copy=function(){return new t(this.col1,this.col2,this.col3)},t.prototype.SetM=function(t){this.col1.SetV(t.col1),this.col2.SetV(t.col2),this.col3.SetV(t.col3)},t.prototype.AddM=function(t){this.col1.x+=t.col1.x,this.col1.y+=t.col1.y,this.col1.z+=t.col1.z,this.col2.x+=t.col2.x,this.col2.y+=t.col2.y,this.col2.z+=t.col2.z,this.col3.x+=t.col3.x,this.col3.y+=t.col3.y,this.col3.z+=t.col3.z},t.prototype.SetIdentity=function(){this.col1.x=1,this.col2.x=0,this.col3.x=0,this.col1.y=0,this.col2.y=1,this.col3.y=0,this.col1.z=0,this.col2.z=0,this.col3.z=1},t.prototype.SetZero=function(){this.col1.x=0,this.col2.x=0,this.col3.x=0,this.col1.y=0,this.col2.y=0,this.col3.y=0,this.col1.z=0,this.col2.z=0,this.col3.z=0},t.prototype.Solve22=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0);var n=this.col1.x,o=this.col2.x,r=this.col1.y,s=this.col2.y,a=n*s-o*r;return 0!=a&&(a=1/a),t.x=a*(s*e-o*i),t.y=a*(n*i-r*e),t},t.prototype.Solve33=function(t,e,i,n){void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0);var o=this.col1.x,r=this.col1.y,s=this.col1.z,a=this.col2.x,l=this.col2.y,h=this.col2.z,u=this.col3.x,c=this.col3.y,p=this.col3.z,m=o*(l*p-h*c)+r*(h*u-a*p)+s*(a*c-l*u);return 0!=m&&(m=1/m),t.x=m*(e*(l*p-h*c)+i*(h*u-a*p)+n*(a*c-l*u)),t.y=m*(o*(i*p-n*c)+r*(n*u-e*p)+s*(e*c-i*u)),t.z=m*(o*(l*n-h*i)+r*(h*e-a*n)+s*(a*i-l*e)),t},r.b2Math=function(){},r.IsValid=function(t){return void 0===t&&(t=0),isFinite(t)},r.Dot=function(t,e){return t.x*e.x+t.y*e.y},r.CrossVV=function(t,e){return t.x*e.y-t.y*e.x},r.CrossVF=function(t,e){return void 0===e&&(e=0),new s(e*t.y,-e*t.x)},r.CrossFV=function(t,e){return void 0===t&&(t=0),new s(-t*e.y,t*e.x)},r.MulMV=function(t,e){return new s(t.col1.x*e.x+t.col2.x*e.y,t.col1.y*e.x+t.col2.y*e.y)},r.MulTMV=function(t,e){return new s(r.Dot(e,t.col1),r.Dot(e,t.col2))},r.MulX=function(t,e){var i=r.MulMV(t.R,e);return i.x+=t.position.x,i.y+=t.position.y,i},r.MulXT=function(t,e){var i=r.SubtractVV(e,t.position),n=i.x*t.R.col1.x+i.y*t.R.col1.y;return i.y=i.x*t.R.col2.x+i.y*t.R.col2.y,i.x=n,i},r.AddVV=function(t,e){return new s(t.x+e.x,t.y+e.y)},r.SubtractVV=function(t,e){return new s(t.x-e.x,t.y-e.y)},r.Distance=function(t,e){var i=t.x-e.x,n=t.y-e.y;return Math.sqrt(i*i+n*n)},r.DistanceSquared=function(t,e){var i=t.x-e.x,n=t.y-e.y;return i*i+n*n},r.MulFV=function(t,e){return void 0===t&&(t=0),new s(t*e.x,t*e.y)},r.AddMM=function(t,e){return o.FromVV(r.AddVV(t.col1,e.col1),r.AddVV(t.col2,e.col2))},r.MulMM=function(t,e){return o.FromVV(r.MulMV(t,e.col1),r.MulMV(t,e.col2))},r.MulTMM=function(t,e){var i=new s(r.Dot(t.col1,e.col1),r.Dot(t.col2,e.col1)),n=new s(r.Dot(t.col1,e.col2),r.Dot(t.col2,e.col2));return o.FromVV(i,n)},r.Abs=function(t){return void 0===t&&(t=0),0<t?t:-t},r.AbsV=function(t){return new s(r.Abs(t.x),r.Abs(t.y))},r.AbsM=function(t){return o.FromVV(r.AbsV(t.col1),r.AbsV(t.col2))},r.Min=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),t<e?t:e},r.MinV=function(t,e){return new s(r.Min(t.x,e.x),r.Min(t.y,e.y))},r.Max=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),e<t?t:e},r.MaxV=function(t,e){return new s(r.Max(t.x,e.x),r.Max(t.y,e.y))},r.Clamp=function(t,e,i){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),t<e?e:i<t?i:t},r.ClampV=function(t,e,i){return r.MaxV(e,r.MinV(t,i))},r.Swap=function(t,e){var i=t[0];t[0]=e[0],e[0]=i},r.Random=function(){return 2*Math.random()-1},r.RandomRange=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var i=Math.random();return i=(e-t)*i+t},r.NextPowerOfTwo=function(t){return void 0===t&&(t=0),t|=t>>1&2147483647,t|=t>>2&1073741823,t|=t>>4&268435455,t|=t>>8&16777215,(t|=t>>16&65535)+1},r.IsPowerOfTwo=function(t){return void 0===t&&(t=0),0<t&&0==(t&t-1)},Box2D.postDefs.push(function(){Box2D.Common.Math.b2Math.b2Vec2_zero=new s(0,0),Box2D.Common.Math.b2Math.b2Mat22_identity=o.FromVV(new s(1,0),new s(0,1)),Box2D.Common.Math.b2Math.b2Transform_identity=new i(r.b2Vec2_zero,r.b2Mat22_identity)}),e.b2Sweep=function(){this.localCenter=new s,this.c0=new s,this.c=new s},e.prototype.Set=function(t){this.localCenter.SetV(t.localCenter),this.c0.SetV(t.c0),this.c.SetV(t.c),this.a0=t.a0,this.a=t.a,this.t0=t.t0},e.prototype.Copy=function(){var t=new e;return t.localCenter.SetV(this.localCenter),t.c0.SetV(this.c0),t.c.SetV(this.c),t.a0=this.a0,t.a=this.a,t.t0=this.t0,t},e.prototype.GetTransform=function(t,e){void 0===e&&(e=0),t.position.x=(1-e)*this.c0.x+e*this.c.x,t.position.y=(1-e)*this.c0.y+e*this.c.y;var i=(1-e)*this.a0+e*this.a;t.R.Set(i);var n=t.R;t.position.x-=n.col1.x*this.localCenter.x+n.col2.x*this.localCenter.y,t.position.y-=n.col1.y*this.localCenter.x+n.col2.y*this.localCenter.y},e.prototype.Advance=function(t){if(void 0===t&&(t=0),this.t0<t&&1-this.t0>Number.MIN_VALUE){var e=(t-this.t0)/(1-this.t0);this.c0.x=(1-e)*this.c0.x+e*this.c.x,this.c0.y=(1-e)*this.c0.y+e*this.c.y,this.a0=(1-e)*this.a0+e*this.a,this.t0=t}},i.b2Transform=function(){this.position=new s,this.R=new o},i.prototype.b2Transform=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),t&&(this.position.SetV(t),this.R.SetM(e))},i.prototype.Initialize=function(t,e){this.position.SetV(t),this.R.SetM(e)},i.prototype.SetIdentity=function(){this.position.SetZero(),this.R.SetIdentity()},i.prototype.Set=function(t){this.position.SetV(t.position),this.R.SetM(t.R)},i.prototype.GetAngle=function(){return Math.atan2(this.R.col1.y,this.R.col1.x)},s.b2Vec2=function(){},s.prototype.b2Vec2=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e},s.prototype.SetZero=function(){this.x=0,this.y=0},s.prototype.Set=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e},s.prototype.SetV=function(t){this.x=t.x,this.y=t.y},s.prototype.GetNegative=function(){return new s(-this.x,-this.y)},s.prototype.NegativeSelf=function(){this.x=-this.x,this.y=-this.y},s.Make=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),new s(t,e)},s.prototype.Copy=function(){return new s(this.x,this.y)},s.prototype.Add=function(t){this.x+=t.x,this.y+=t.y},s.prototype.Subtract=function(t){this.x-=t.x,this.y-=t.y},s.prototype.Multiply=function(t){void 0===t&&(t=0),this.x*=t,this.y*=t},s.prototype.MulM=function(t){var e=this.x;this.x=t.col1.x*e+t.col2.x*this.y,this.y=t.col1.y*e+t.col2.y*this.y},s.prototype.MulTM=function(t){var e=r.Dot(this,t.col1);this.y=r.Dot(this,t.col2),this.x=e},s.prototype.CrossVF=function(t){void 0===t&&(t=0);var e=this.x;this.x=t*this.y,this.y=-t*e},s.prototype.CrossFV=function(t){void 0===t&&(t=0);var e=this.x;this.x=-t*this.y,this.y=t*e},s.prototype.MinV=function(t){this.x=this.x<t.x?this.x:t.x,this.y=this.y<t.y?this.y:t.y},s.prototype.MaxV=function(t){this.x=this.x>t.x?this.x:t.x,this.y=this.y>t.y?this.y:t.y},s.prototype.Abs=function(){this.x<0&&(this.x=-this.x),this.y<0&&(this.y=-this.y)},s.prototype.Length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},s.prototype.LengthSquared=function(){return this.x*this.x+this.y*this.y},s.prototype.Normalize=function(){var t=Math.sqrt(this.x*this.x+this.y*this.y);if(t<Number.MIN_VALUE)return 0;var e=1/t;return this.x*=e,this.y*=e,t},s.prototype.IsValid=function(){return r.IsValid(this.x)&&r.IsValid(this.y)},n.b2Vec3=function(){},n.prototype.b2Vec3=function(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.x=t,this.y=e,this.z=i},n.prototype.SetZero=function(){this.x=this.y=this.z=0},n.prototype.Set=function(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.x=t,this.y=e,this.z=i},n.prototype.SetV=function(t){this.x=t.x,this.y=t.y,this.z=t.z},n.prototype.GetNegative=function(){return new n(-this.x,-this.y,-this.z)},n.prototype.NegativeSelf=function(){this.x=-this.x,this.y=-this.y,this.z=-this.z},n.prototype.Copy=function(){return new n(this.x,this.y,this.z)},n.prototype.Add=function(t){this.x+=t.x,this.y+=t.y,this.z+=t.z},n.prototype.Subtract=function(t){this.x-=t.x,this.y-=t.y,this.z-=t.z},n.prototype.Multiply=function(t){void 0===t&&(t=0),this.x*=t,this.y*=t,this.z*=t}}(),function(){Box2D.Dynamics.Controllers.b2ControllerEdge,Box2D.Common.Math.b2Mat22,Box2D.Common.Math.b2Mat33;var _=Box2D.Common.Math.b2Math,t=Box2D.Common.Math.b2Sweep,e=Box2D.Common.Math.b2Transform,y=Box2D.Common.Math.b2Vec2,x=(Box2D.Common.Math.b2Vec3,Box2D.Common.b2Color),w=(Box2D.Common.b2internal,Box2D.Common.b2Settings),v=Box2D.Collision.b2AABB,i=(Box2D.Collision.b2Bound,Box2D.Collision.b2BoundValues,Box2D.Collision.b2Collision,Box2D.Collision.b2ContactID,Box2D.Collision.b2ContactPoint),n=(Box2D.Collision.b2Distance,Box2D.Collision.b2DistanceInput,Box2D.Collision.b2DistanceOutput,Box2D.Collision.b2DistanceProxy,Box2D.Collision.b2DynamicTree,Box2D.Collision.b2DynamicTreeBroadPhase),o=(Box2D.Collision.b2DynamicTreeNode,Box2D.Collision.b2DynamicTreePair,Box2D.Collision.b2Manifold,Box2D.Collision.b2ManifoldPoint,Box2D.Collision.b2Point,Box2D.Collision.b2RayCastInput),r=Box2D.Collision.b2RayCastOutput,m=(Box2D.Collision.b2Segment,Box2D.Collision.b2SeparationFunction,Box2D.Collision.b2Simplex,Box2D.Collision.b2SimplexCache,Box2D.Collision.b2SimplexVertex,Box2D.Collision.b2TimeOfImpact,Box2D.Collision.b2TOIInput,Box2D.Collision.b2WorldManifold,Box2D.Collision.ClipVertex,Box2D.Collision.Features,Box2D.Collision.IBroadPhase,Box2D.Collision.Shapes.b2CircleShape),f=(Box2D.Collision.Shapes.b2EdgeChainDef,Box2D.Collision.Shapes.b2EdgeShape),s=Box2D.Collision.Shapes.b2MassData,d=Box2D.Collision.Shapes.b2PolygonShape,b=Box2D.Collision.Shapes.b2Shape,C=Box2D.Dynamics.b2Body,a=Box2D.Dynamics.b2BodyDef,l=Box2D.Dynamics.b2ContactFilter,h=Box2D.Dynamics.b2ContactImpulse,u=Box2D.Dynamics.b2ContactListener,c=Box2D.Dynamics.b2ContactManager,g=Box2D.Dynamics.b2DebugDraw,p=Box2D.Dynamics.b2DestructionListener,D=Box2D.Dynamics.b2FilterData,S=Box2D.Dynamics.b2Fixture,T=Box2D.Dynamics.b2FixtureDef,A=Box2D.Dynamics.b2Island,M=Box2D.Dynamics.b2TimeStep,B=Box2D.Dynamics.b2World,E=(Box2D.Dynamics.Contacts.b2CircleContact,Box2D.Dynamics.Contacts.b2Contact),P=(Box2D.Dynamics.Contacts.b2ContactConstraint,Box2D.Dynamics.Contacts.b2ContactConstraintPoint,Box2D.Dynamics.Contacts.b2ContactEdge,Box2D.Dynamics.Contacts.b2ContactFactory),I=(Box2D.Dynamics.Contacts.b2ContactRegister,Box2D.Dynamics.Contacts.b2ContactResult,Box2D.Dynamics.Contacts.b2ContactSolver),R=(Box2D.Dynamics.Contacts.b2EdgeAndCircleContact,Box2D.Dynamics.Contacts.b2NullContact,Box2D.Dynamics.Contacts.b2PolyAndCircleContact,Box2D.Dynamics.Contacts.b2PolyAndEdgeContact,Box2D.Dynamics.Contacts.b2PolygonContact,Box2D.Dynamics.Contacts.b2PositionSolverManifold,Box2D.Dynamics.Controllers.b2Controller,Box2D.Dynamics.Joints.b2DistanceJoint,Box2D.Dynamics.Joints.b2DistanceJointDef,Box2D.Dynamics.Joints.b2FrictionJoint,Box2D.Dynamics.Joints.b2FrictionJointDef,Box2D.Dynamics.Joints.b2GearJoint,Box2D.Dynamics.Joints.b2GearJointDef,Box2D.Dynamics.Joints.b2Jacobian,Box2D.Dynamics.Joints.b2Joint),O=(Box2D.Dynamics.Joints.b2JointDef,Box2D.Dynamics.Joints.b2JointEdge,Box2D.Dynamics.Joints.b2LineJoint,Box2D.Dynamics.Joints.b2LineJointDef,Box2D.Dynamics.Joints.b2MouseJoint,Box2D.Dynamics.Joints.b2MouseJointDef,Box2D.Dynamics.Joints.b2PrismaticJoint,Box2D.Dynamics.Joints.b2PrismaticJointDef,Box2D.Dynamics.Joints.b2PulleyJoint);Box2D.Dynamics.Joints.b2PulleyJointDef,Box2D.Dynamics.Joints.b2RevoluteJoint,Box2D.Dynamics.Joints.b2RevoluteJointDef,Box2D.Dynamics.Joints.b2WeldJoint,Box2D.Dynamics.Joints.b2WeldJointDef;C.b2Body=function(){this.m_xf=new e,this.m_sweep=new t,this.m_linearVelocity=new y,this.m_force=new y},C.prototype.connectEdges=function(t,e,i){void 0===i&&(i=0);var n=Math.atan2(e.GetDirectionVector().y,e.GetDirectionVector().x),o=Math.tan(.5*(n-i)),r=_.MulFV(o,e.GetDirectionVector());r=_.SubtractVV(r,e.GetNormalVector()),r=_.MulFV(w.b2_toiSlop,r),r=_.AddVV(r,e.GetVertex1());var s=_.AddVV(t.GetDirectionVector(),e.GetDirectionVector());s.Normalize();var a=0<_.Dot(t.GetDirectionVector(),e.GetNormalVector());return t.SetNextEdge(e,r,s,a),e.SetPrevEdge(t,r,s,a),n},C.prototype.CreateFixture=function(t){if(1==this.m_world.IsLocked())return null;var e=new S;if(e.Create(this,this.m_xf,t),this.m_flags&C.e_activeFlag){var i=this.m_world.m_contactManager.m_broadPhase;e.CreateProxy(i,this.m_xf)}return e.m_next=this.m_fixtureList,this.m_fixtureList=e,++this.m_fixtureCount,e.m_body=this,0<e.m_density&&this.ResetMassData(),this.m_world.m_flags|=B.e_newFixture,e},C.prototype.CreateFixture2=function(t,e){void 0===e&&(e=0);var i=new T;return i.shape=t,i.density=e,this.CreateFixture(i)},C.prototype.DestroyFixture=function(t){if(1!=this.m_world.IsLocked()){for(var e=this.m_fixtureList,i=null;null!=e;){if(e==t){i?i.m_next=t.m_next:this.m_fixtureList=t.m_next,!0;break}e=(i=e).m_next}for(var n=this.m_contactList;n;){var o=n.contact;n=n.next;var r=o.GetFixtureA(),s=o.GetFixtureB();t!=r&&t!=s||this.m_world.m_contactManager.Destroy(o)}if(this.m_flags&C.e_activeFlag){var a=this.m_world.m_contactManager.m_broadPhase;t.DestroyProxy(a)}t.Destroy(),t.m_body=null,t.m_next=null,--this.m_fixtureCount,this.ResetMassData()}},C.prototype.SetPositionAndAngle=function(t,e){var i;if(void 0===e&&(e=0),1!=this.m_world.IsLocked()){this.m_xf.R.Set(e),this.m_xf.position.SetV(t);var n=this.m_xf.R,o=this.m_sweep.localCenter;this.m_sweep.c.x=n.col1.x*o.x+n.col2.x*o.y,this.m_sweep.c.y=n.col1.y*o.x+n.col2.y*o.y,this.m_sweep.c.x+=this.m_xf.position.x,this.m_sweep.c.y+=this.m_xf.position.y,this.m_sweep.c0.SetV(this.m_sweep.c),this.m_sweep.a0=this.m_sweep.a=e;var r=this.m_world.m_contactManager.m_broadPhase;for(i=this.m_fixtureList;i;i=i.m_next)i.Synchronize(r,this.m_xf,this.m_xf);this.m_world.m_contactManager.FindNewContacts()}},C.prototype.SetTransform=function(t){this.SetPositionAndAngle(t.position,t.GetAngle())},C.prototype.GetTransform=function(){return this.m_xf},C.prototype.GetPosition=function(){return this.m_xf.position},C.prototype.SetPosition=function(t){this.SetPositionAndAngle(t,this.GetAngle())},C.prototype.GetAngle=function(){return this.m_sweep.a},C.prototype.SetAngle=function(t){void 0===t&&(t=0),this.SetPositionAndAngle(this.GetPosition(),t)},C.prototype.GetWorldCenter=function(){return this.m_sweep.c},C.prototype.GetLocalCenter=function(){return this.m_sweep.localCenter},C.prototype.SetLinearVelocity=function(t){this.m_type!=C.b2_staticBody&&this.m_linearVelocity.SetV(t)},C.prototype.GetLinearVelocity=function(){return this.m_linearVelocity},C.prototype.SetAngularVelocity=function(t){void 0===t&&(t=0),this.m_type!=C.b2_staticBody&&(this.m_angularVelocity=t)},C.prototype.GetAngularVelocity=function(){return this.m_angularVelocity},C.prototype.GetDefinition=function(){var t=new a;return t.type=this.GetType(),t.allowSleep=(this.m_flags&C.e_allowSleepFlag)==C.e_allowSleepFlag,t.angle=this.GetAngle(),t.angularDamping=this.m_angularDamping,t.angularVelocity=this.m_angularVelocity,t.fixedRotation=(this.m_flags&C.e_fixedRotationFlag)==C.e_fixedRotationFlag,t.bullet=(this.m_flags&C.e_bulletFlag)==C.e_bulletFlag,t.awake=(this.m_flags&C.e_awakeFlag)==C.e_awakeFlag,t.linearDamping=this.m_linearDamping,t.linearVelocity.SetV(this.GetLinearVelocity()),t.position=this.GetPosition(),t.userData=this.GetUserData(),t},C.prototype.ApplyForce=function(t,e){this.m_type==C.b2_dynamicBody&&(0==this.IsAwake()&&this.SetAwake(!0),this.m_force.x+=t.x,this.m_force.y+=t.y,this.m_torque+=(e.x-this.m_sweep.c.x)*t.y-(e.y-this.m_sweep.c.y)*t.x)},C.prototype.ApplyTorque=function(t){void 0===t&&(t=0),this.m_type==C.b2_dynamicBody&&(0==this.IsAwake()&&this.SetAwake(!0),this.m_torque+=t)},C.prototype.ApplyImpulse=function(t,e){this.m_type==C.b2_dynamicBody&&(0==this.IsAwake()&&this.SetAwake(!0),this.m_linearVelocity.x+=this.m_invMass*t.x,this.m_linearVelocity.y+=this.m_invMass*t.y,this.m_angularVelocity+=this.m_invI*((e.x-this.m_sweep.c.x)*t.y-(e.y-this.m_sweep.c.y)*t.x))},C.prototype.Split=function(t){for(var e,i=this.GetLinearVelocity().Copy(),n=this.GetAngularVelocity(),o=this.GetWorldCenter(),r=this,s=this.m_world.CreateBody(this.GetDefinition()),a=r.m_fixtureList;a;)if(t(a)){var l=a.m_next;e?e.m_next=l:r.m_fixtureList=l,r.m_fixtureCount--,a.m_next=s.m_fixtureList,s.m_fixtureList=a,s.m_fixtureCount++,a.m_body=s,a=l}else a=(e=a).m_next;r.ResetMassData(),s.ResetMassData();var h=r.GetWorldCenter(),u=s.GetWorldCenter(),c=_.AddVV(i,_.CrossFV(n,_.SubtractVV(h,o))),p=_.AddVV(i,_.CrossFV(n,_.SubtractVV(u,o)));return r.SetLinearVelocity(c),s.SetLinearVelocity(p),r.SetAngularVelocity(n),s.SetAngularVelocity(n),r.SynchronizeFixtures(),s.SynchronizeFixtures(),s},C.prototype.Merge=function(t){var e;for(e=t.m_fixtureList;e;){var i=e.m_next;t.m_fixtureCount--,e.m_next=this.m_fixtureList,this.m_fixtureList=e,this.m_fixtureCount++,e.m_body=o,e=i}n.m_fixtureCount=0;var n=this,o=t;n.GetWorldCenter(),o.GetWorldCenter(),n.GetLinearVelocity().Copy(),o.GetLinearVelocity().Copy(),n.GetAngularVelocity(),o.GetAngularVelocity();n.ResetMassData(),this.SynchronizeFixtures()},C.prototype.GetMass=function(){return this.m_mass},C.prototype.GetInertia=function(){return this.m_I},C.prototype.GetMassData=function(t){t.mass=this.m_mass,t.I=this.m_I,t.center.SetV(this.m_sweep.localCenter)},C.prototype.SetMassData=function(t){if(w.b2Assert(0==this.m_world.IsLocked()),1!=this.m_world.IsLocked()&&this.m_type==C.b2_dynamicBody){this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_mass=t.mass,this.m_mass<=0&&(this.m_mass=1),this.m_invMass=1/this.m_mass,0<t.I&&0==(this.m_flags&C.e_fixedRotationFlag)&&(this.m_I=t.I-this.m_mass*(t.center.x*t.center.x+t.center.y*t.center.y),this.m_invI=1/this.m_I);var e=this.m_sweep.c.Copy();this.m_sweep.localCenter.SetV(t.center),this.m_sweep.c0.SetV(_.MulX(this.m_xf,this.m_sweep.localCenter)),this.m_sweep.c.SetV(this.m_sweep.c0),this.m_linearVelocity.x+=this.m_angularVelocity*-(this.m_sweep.c.y-e.y),this.m_linearVelocity.y+=this.m_angularVelocity*+(this.m_sweep.c.x-e.x)}},C.prototype.ResetMassData=function(){if(this.m_mass=0,this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_sweep.localCenter.SetZero(),this.m_type!=C.b2_staticBody&&this.m_type!=C.b2_kinematicBody){for(var t=y.Make(0,0),e=this.m_fixtureList;e;e=e.m_next)if(0!=e.m_density){var i=e.GetMassData();this.m_mass+=i.mass,t.x+=i.center.x*i.mass,t.y+=i.center.y*i.mass,this.m_I+=i.I}0<this.m_mass?(this.m_invMass=1/this.m_mass,t.x*=this.m_invMass,t.y*=this.m_invMass):(this.m_mass=1,this.m_invMass=1),0<this.m_I&&0==(this.m_flags&C.e_fixedRotationFlag)?(this.m_I-=this.m_mass*(t.x*t.x+t.y*t.y),this.m_I*=this.m_inertiaScale,w.b2Assert(0<this.m_I),this.m_invI=1/this.m_I):(this.m_I=0,this.m_invI=0);var n=this.m_sweep.c.Copy();this.m_sweep.localCenter.SetV(t),this.m_sweep.c0.SetV(_.MulX(this.m_xf,this.m_sweep.localCenter)),this.m_sweep.c.SetV(this.m_sweep.c0),this.m_linearVelocity.x+=this.m_angularVelocity*-(this.m_sweep.c.y-n.y),this.m_linearVelocity.y+=this.m_angularVelocity*+(this.m_sweep.c.x-n.x)}},C.prototype.GetWorldPoint=function(t){var e=this.m_xf.R,i=new y(e.col1.x*t.x+e.col2.x*t.y,e.col1.y*t.x+e.col2.y*t.y);return i.x+=this.m_xf.position.x,i.y+=this.m_xf.position.y,i},C.prototype.GetWorldVector=function(t){return _.MulMV(this.m_xf.R,t)},C.prototype.GetLocalPoint=function(t){return _.MulXT(this.m_xf,t)},C.prototype.GetLocalVector=function(t){return _.MulTMV(this.m_xf.R,t)},C.prototype.GetLinearVelocityFromWorldPoint=function(t){return new y(this.m_linearVelocity.x-this.m_angularVelocity*(t.y-this.m_sweep.c.y),this.m_linearVelocity.y+this.m_angularVelocity*(t.x-this.m_sweep.c.x))},C.prototype.GetLinearVelocityFromLocalPoint=function(t){var e=this.m_xf.R,i=new y(e.col1.x*t.x+e.col2.x*t.y,e.col1.y*t.x+e.col2.y*t.y);return i.x+=this.m_xf.position.x,i.y+=this.m_xf.position.y,new y(this.m_linearVelocity.x-this.m_angularVelocity*(i.y-this.m_sweep.c.y),this.m_linearVelocity.y+this.m_angularVelocity*(i.x-this.m_sweep.c.x))},C.prototype.GetLinearDamping=function(){return this.m_linearDamping},C.prototype.SetLinearDamping=function(t){void 0===t&&(t=0),this.m_linearDamping=t},C.prototype.GetAngularDamping=function(){return this.m_angularDamping},C.prototype.SetAngularDamping=function(t){void 0===t&&(t=0),this.m_angularDamping=t},C.prototype.SetType=function(t){if(void 0===t&&(t=0),this.m_type!=t){this.m_type=t,this.ResetMassData(),this.m_type==C.b2_staticBody&&(this.m_linearVelocity.SetZero(),this.m_angularVelocity=0),this.SetAwake(!0),this.m_force.SetZero(),this.m_torque=0;for(var e=this.m_contactList;e;e=e.next)e.contact.FlagForFiltering()}},C.prototype.GetType=function(){return this.m_type},C.prototype.SetBullet=function(t){t?this.m_flags|=C.e_bulletFlag:this.m_flags&=~C.e_bulletFlag},C.prototype.IsBullet=function(){return(this.m_flags&C.e_bulletFlag)==C.e_bulletFlag},C.prototype.SetSleepingAllowed=function(t){t?this.m_flags|=C.e_allowSleepFlag:(this.m_flags&=~C.e_allowSleepFlag,this.SetAwake(!0))},C.prototype.SetAwake=function(t){t?(this.m_flags|=C.e_awakeFlag,this.m_sleepTime=0):(this.m_flags&=~C.e_awakeFlag,this.m_sleepTime=0,this.m_linearVelocity.SetZero(),this.m_angularVelocity=0,this.m_force.SetZero(),this.m_torque=0)},C.prototype.IsAwake=function(){return(this.m_flags&C.e_awakeFlag)==C.e_awakeFlag},C.prototype.SetFixedRotation=function(t){t?this.m_flags|=C.e_fixedRotationFlag:this.m_flags&=~C.e_fixedRotationFlag,this.ResetMassData()},C.prototype.IsFixedRotation=function(){return(this.m_flags&C.e_fixedRotationFlag)==C.e_fixedRotationFlag},C.prototype.SetActive=function(t){var e,i;if(t!=this.IsActive())if(t)for(this.m_flags|=C.e_activeFlag,e=this.m_world.m_contactManager.m_broadPhase,i=this.m_fixtureList;i;i=i.m_next)i.CreateProxy(e,this.m_xf);else{for(this.m_flags&=~C.e_activeFlag,e=this.m_world.m_contactManager.m_broadPhase,i=this.m_fixtureList;i;i=i.m_next)i.DestroyProxy(e);for(var n=this.m_contactList;n;){var o=n;n=n.next,this.m_world.m_contactManager.Destroy(o.contact)}this.m_contactList=null}},C.prototype.IsActive=function(){return(this.m_flags&C.e_activeFlag)==C.e_activeFlag},C.prototype.IsSleepingAllowed=function(){return(this.m_flags&C.e_allowSleepFlag)==C.e_allowSleepFlag},C.prototype.GetFixtureList=function(){return this.m_fixtureList},C.prototype.GetJointList=function(){return this.m_jointList},C.prototype.GetControllerList=function(){return this.m_controllerList},C.prototype.GetContactList=function(){return this.m_contactList},C.prototype.GetNext=function(){return this.m_next},C.prototype.GetUserData=function(){return this.m_userData},C.prototype.SetUserData=function(t){this.m_userData=t},C.prototype.GetWorld=function(){return this.m_world},C.prototype.b2Body=function(t,e){this.m_flags=0,t.bullet&&(this.m_flags|=C.e_bulletFlag),t.fixedRotation&&(this.m_flags|=C.e_fixedRotationFlag),t.allowSleep&&(this.m_flags|=C.e_allowSleepFlag),t.awake&&(this.m_flags|=C.e_awakeFlag),t.active&&(this.m_flags|=C.e_activeFlag),this.m_world=e,this.m_xf.position.SetV(t.position),this.m_xf.R.Set(t.angle),this.m_sweep.localCenter.SetZero(),this.m_sweep.t0=1,this.m_sweep.a0=this.m_sweep.a=t.angle;var i=this.m_xf.R,n=this.m_sweep.localCenter;this.m_sweep.c.x=i.col1.x*n.x+i.col2.x*n.y,this.m_sweep.c.y=i.col1.y*n.x+i.col2.y*n.y,this.m_sweep.c.x+=this.m_xf.position.x,this.m_sweep.c.y+=this.m_xf.position.y,this.m_sweep.c0.SetV(this.m_sweep.c),this.m_jointList=null,this.m_controllerList=null,this.m_contactList=null,this.m_controllerCount=0,this.m_prev=null,this.m_next=null,this.m_linearVelocity.SetV(t.linearVelocity),this.m_angularVelocity=t.angularVelocity,this.m_linearDamping=t.linearDamping,this.m_angularDamping=t.angularDamping,this.m_force.Set(0,0),this.m_torque=0,this.m_sleepTime=0,this.m_type=t.type,this.m_type==C.b2_dynamicBody?(this.m_mass=1,this.m_invMass=1):(this.m_mass=0,this.m_invMass=0),this.m_I=0,this.m_invI=0,this.m_inertiaScale=t.inertiaScale,this.m_userData=t.userData,this.m_fixtureList=null,this.m_fixtureCount=0},C.prototype.SynchronizeFixtures=function(){var t=C.s_xf1;t.R.Set(this.m_sweep.a0);var e,i=t.R,n=this.m_sweep.localCenter;t.position.x=this.m_sweep.c0.x-(i.col1.x*n.x+i.col2.x*n.y),t.position.y=this.m_sweep.c0.y-(i.col1.y*n.x+i.col2.y*n.y);var o=this.m_world.m_contactManager.m_broadPhase;for(e=this.m_fixtureList;e;e=e.m_next)e.Synchronize(o,t,this.m_xf)},C.prototype.SynchronizeTransform=function(){this.m_xf.R.Set(this.m_sweep.a);var t=this.m_xf.R,e=this.m_sweep.localCenter;this.m_xf.position.x=this.m_sweep.c.x-(t.col1.x*e.x+t.col2.x*e.y),this.m_xf.position.y=this.m_sweep.c.y-(t.col1.y*e.x+t.col2.y*e.y)},C.prototype.ShouldCollide=function(t){if(this.m_type!=C.b2_dynamicBody&&t.m_type!=C.b2_dynamicBody)return!1;for(var e=this.m_jointList;e;e=e.next)if(e.other==t&&0==e.joint.m_collideConnected)return!1;return!0},C.prototype.Advance=function(t){void 0===t&&(t=0),this.m_sweep.Advance(t),this.m_sweep.c.SetV(this.m_sweep.c0),this.m_sweep.a=this.m_sweep.a0,this.SynchronizeTransform()},Box2D.postDefs.push(function(){Box2D.Dynamics.b2Body.s_xf1=new e,Box2D.Dynamics.b2Body.e_islandFlag=1,Box2D.Dynamics.b2Body.e_awakeFlag=2,Box2D.Dynamics.b2Body.e_allowSleepFlag=4,Box2D.Dynamics.b2Body.e_bulletFlag=8,Box2D.Dynamics.b2Body.e_fixedRotationFlag=16,Box2D.Dynamics.b2Body.e_activeFlag=32,Box2D.Dynamics.b2Body.b2_staticBody=0,Box2D.Dynamics.b2Body.b2_kinematicBody=1,Box2D.Dynamics.b2Body.b2_dynamicBody=2}),a.b2BodyDef=function(){this.position=new y,this.linearVelocity=new y},a.prototype.b2BodyDef=function(){this.userData=null,this.position.Set(0,0),this.angle=0,this.linearVelocity.Set(0,0),this.angularVelocity=0,this.linearDamping=0,this.angularDamping=0,this.allowSleep=!0,this.awake=!0,this.fixedRotation=!1,this.bullet=!1,this.type=C.b2_staticBody,this.active=!0,this.inertiaScale=1},l.b2ContactFilter=function(){},l.prototype.ShouldCollide=function(t,e){var i=t.GetFilterData(),n=e.GetFilterData();return i.groupIndex==n.groupIndex&&0!=i.groupIndex?0<i.groupIndex:0!=(i.maskBits&n.categoryBits)&&0!=(i.categoryBits&n.maskBits)},l.prototype.RayCollide=function(t,e){return!t||this.ShouldCollide(t instanceof S?t:null,e)},Box2D.postDefs.push(function(){Box2D.Dynamics.b2ContactFilter.b2_defaultFilter=new l}),h.b2ContactImpulse=function(){this.normalImpulses=new Vector_a2j_Number(w.b2_maxManifoldPoints),this.tangentImpulses=new Vector_a2j_Number(w.b2_maxManifoldPoints)},u.b2ContactListener=function(){},u.prototype.BeginContact=function(t){},u.prototype.EndContact=function(t){},u.prototype.PreSolve=function(t,e){},u.prototype.PostSolve=function(t,e){},Box2D.postDefs.push(function(){Box2D.Dynamics.b2ContactListener.b2_defaultListener=new u}),c.b2ContactManager=function(){},c.prototype.b2ContactManager=function(){this.m_world=null,this.m_contactCount=0,this.m_contactFilter=l.b2_defaultFilter,this.m_contactListener=u.b2_defaultListener,this.m_contactFactory=new P(this.m_allocator),this.m_broadPhase=new n},c.prototype.AddPair=function(t,e){var i=t instanceof S?t:null,n=e instanceof S?e:null,o=i.GetBody(),r=n.GetBody();if(o!=r){for(var s=r.GetContactList();s;){if(s.other==o){var a=s.contact.GetFixtureA(),l=s.contact.GetFixtureB();if(a==i&&l==n)return;if(a==n&&l==i)return}s=s.next}if(0!=r.ShouldCollide(o)&&0!=this.m_contactFilter.ShouldCollide(i,n)){var h=this.m_contactFactory.Create(i,n);i=h.GetFixtureA(),n=h.GetFixtureB(),o=i.m_body,r=n.m_body,h.m_prev=null,h.m_next=this.m_world.m_contactList,null!=this.m_world.m_contactList&&(this.m_world.m_contactList.m_prev=h),((this.m_world.m_contactList=h).m_nodeA.contact=h).m_nodeA.other=r,h.m_nodeA.prev=null,h.m_nodeA.next=o.m_contactList,null!=o.m_contactList&&(o.m_contactList.prev=h.m_nodeA),o.m_contactList=h.m_nodeA,(h.m_nodeB.contact=h).m_nodeB.other=o,h.m_nodeB.prev=null,h.m_nodeB.next=r.m_contactList,null!=r.m_contactList&&(r.m_contactList.prev=h.m_nodeB),r.m_contactList=h.m_nodeB,++this.m_world.m_contactCount}}},c.prototype.FindNewContacts=function(){this.m_broadPhase.UpdatePairs(Box2D.generateCallback(this,this.AddPair))},c.prototype.Destroy=function(t){var e=t.GetFixtureA(),i=t.GetFixtureB(),n=e.GetBody(),o=i.GetBody();t.IsTouching()&&this.m_contactListener.EndContact(t),t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t==this.m_world.m_contactList&&(this.m_world.m_contactList=t.m_next),t.m_nodeA.prev&&(t.m_nodeA.prev.next=t.m_nodeA.next),t.m_nodeA.next&&(t.m_nodeA.next.prev=t.m_nodeA.prev),t.m_nodeA==n.m_contactList&&(n.m_contactList=t.m_nodeA.next),t.m_nodeB.prev&&(t.m_nodeB.prev.next=t.m_nodeB.next),t.m_nodeB.next&&(t.m_nodeB.next.prev=t.m_nodeB.prev),t.m_nodeB==o.m_contactList&&(o.m_contactList=t.m_nodeB.next),this.m_contactFactory.Destroy(t),--this.m_contactCount},c.prototype.Collide=function(){for(var t=this.m_world.m_contactList;t;){var e=t.GetFixtureA(),i=t.GetFixtureB(),n=e.GetBody(),o=i.GetBody();if(0!=n.IsAwake()||0!=o.IsAwake()){if(t.m_flags&E.e_filterFlag){if(0==o.ShouldCollide(n)){var r=t;t=r.GetNext(),this.Destroy(r);continue}if(0==this.m_contactFilter.ShouldCollide(e,i)){t=(r=t).GetNext(),this.Destroy(r);continue}t.m_flags&=~E.e_filterFlag}var s=e.m_proxy,a=i.m_proxy;0!=this.m_broadPhase.TestOverlap(s,a)?(t.Update(this.m_contactListener),t=t.GetNext()):(t=(r=t).GetNext(),this.Destroy(r))}else t=t.GetNext()}},Box2D.postDefs.push(function(){Box2D.Dynamics.b2ContactManager.s_evalCP=new i}),g.b2DebugDraw=function(){},g.prototype.b2DebugDraw=function(){},g.prototype.SetFlags=function(t){void 0===t&&(t=0)},g.prototype.GetFlags=function(){},g.prototype.AppendFlags=function(t){void 0===t&&(t=0)},g.prototype.ClearFlags=function(t){void 0===t&&(t=0)},g.prototype.SetSprite=function(t){},g.prototype.GetSprite=function(){},g.prototype.SetDrawScale=function(t){void 0===t&&(t=0)},g.prototype.GetDrawScale=function(){},g.prototype.SetLineThickness=function(t){void 0===t&&(t=0)},g.prototype.GetLineThickness=function(){},g.prototype.SetAlpha=function(t){void 0===t&&(t=0)},g.prototype.GetAlpha=function(){},g.prototype.SetFillAlpha=function(t){void 0===t&&(t=0)},g.prototype.GetFillAlpha=function(){},g.prototype.SetXFormScale=function(t){void 0===t&&(t=0)},g.prototype.GetXFormScale=function(){},g.prototype.DrawPolygon=function(t,e,i){void 0===e&&(e=0)},g.prototype.DrawSolidPolygon=function(t,e,i){void 0===e&&(e=0)},g.prototype.DrawCircle=function(t,e,i){void 0===e&&(e=0)},g.prototype.DrawSolidCircle=function(t,e,i,n){void 0===e&&(e=0)},g.prototype.DrawSegment=function(t,e,i){},g.prototype.DrawTransform=function(t){},Box2D.postDefs.push(function(){Box2D.Dynamics.b2DebugDraw.e_shapeBit=1,Box2D.Dynamics.b2DebugDraw.e_jointBit=2,Box2D.Dynamics.b2DebugDraw.e_aabbBit=4,Box2D.Dynamics.b2DebugDraw.e_pairBit=8,Box2D.Dynamics.b2DebugDraw.e_centerOfMassBit=16,Box2D.Dynamics.b2DebugDraw.e_controllerBit=32}),p.b2DestructionListener=function(){},p.prototype.SayGoodbyeJoint=function(t){},p.prototype.SayGoodbyeFixture=function(t){},D.b2FilterData=function(){this.categoryBits=1,this.maskBits=65535,this.groupIndex=0},D.prototype.Copy=function(){var t=new D;return t.categoryBits=this.categoryBits,t.maskBits=this.maskBits,t.groupIndex=this.groupIndex,t},S.b2Fixture=function(){this.m_filter=new D},S.prototype.GetType=function(){return this.m_shape.GetType()},S.prototype.GetShape=function(){return this.m_shape},S.prototype.SetSensor=function(t){if(this.m_isSensor!=t&&(this.m_isSensor=t,null!=this.m_body))for(var e=this.m_body.GetContactList();e;){var i=e.contact,n=i.GetFixtureA(),o=i.GetFixtureB();n!=this&&o!=this||i.SetSensor(n.IsSensor()||o.IsSensor()),e=e.next}},S.prototype.IsSensor=function(){return this.m_isSensor},S.prototype.SetFilterData=function(t){if(this.m_filter=t.Copy(),!this.m_body)for(var e=this.m_body.GetContactList();e;){var i=e.contact,n=i.GetFixtureA(),o=i.GetFixtureB();n!=this&&o!=this||i.FlagForFiltering(),e=e.next}},S.prototype.GetFilterData=function(){return this.m_filter.Copy()},S.prototype.GetBody=function(){return this.m_body},S.prototype.GetNext=function(){return this.m_next},S.prototype.GetUserData=function(){return this.m_userData},S.prototype.SetUserData=function(t){this.m_userData=t},S.prototype.TestPoint=function(t){return this.m_shape.TestPoint(this.m_body.GetTransform(),t)},S.prototype.RayCast=function(t,e){return this.m_shape.RayCast(t,e,this.m_body.GetTransform())},S.prototype.GetMassData=function(t){return void 0===t&&(t=null),null==t&&(t=new s),this.m_shape.ComputeMass(t,this.m_density),t},S.prototype.SetDensity=function(t){void 0===t&&(t=0),this.m_density=t},S.prototype.GetDensity=function(){return this.m_density},S.prototype.GetFriction=function(){return this.m_friction},S.prototype.SetFriction=function(t){void 0===t&&(t=0),this.m_friction=t},S.prototype.GetRestitution=function(){return this.m_restitution},S.prototype.SetRestitution=function(t){void 0===t&&(t=0),this.m_restitution=t},S.prototype.GetAABB=function(){return this.m_aabb},S.prototype.b2Fixture=function(){this.m_aabb=new v,this.m_userData=null,this.m_body=null,this.m_next=null,this.m_shape=null,this.m_density=0,this.m_friction=0,this.m_restitution=0},S.prototype.Create=function(t,e,i){this.m_userData=i.userData,this.m_friction=i.friction,this.m_restitution=i.restitution,this.m_body=t,this.m_next=null,this.m_filter=i.filter.Copy(),this.m_isSensor=i.isSensor,this.m_shape=i.shape.Copy(),this.m_density=i.density},S.prototype.Destroy=function(){this.m_shape=null},S.prototype.CreateProxy=function(t,e){this.m_shape.ComputeAABB(this.m_aabb,e),this.m_proxy=t.CreateProxy(this.m_aabb,this)},S.prototype.DestroyProxy=function(t){null!=this.m_proxy&&(t.DestroyProxy(this.m_proxy),this.m_proxy=null)},S.prototype.Synchronize=function(t,e,i){if(this.m_proxy){var n=new v,o=new v;this.m_shape.ComputeAABB(n,e),this.m_shape.ComputeAABB(o,i),this.m_aabb.Combine(n,o);var r=_.SubtractVV(i.position,e.position);t.MoveProxy(this.m_proxy,this.m_aabb,r)}},T.b2FixtureDef=function(){this.filter=new D},T.prototype.b2FixtureDef=function(){this.shape=null,this.userData=null,this.friction=.2,this.restitution=0,this.density=0,this.filter.categoryBits=1,this.filter.maskBits=65535,this.filter.groupIndex=0,this.isSensor=!1},A.b2Island=function(){},A.prototype.b2Island=function(){this.m_bodies=new Vector,this.m_contacts=new Vector,this.m_joints=new Vector},A.prototype.Initialize=function(t,e,i,n,o,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0);var s=0;for(this.m_bodyCapacity=t,this.m_contactCapacity=e,this.m_jointCapacity=i,this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0,this.m_allocator=n,this.m_listener=o,this.m_contactSolver=r,s=this.m_bodies.length;s<t;s++)this.m_bodies[s]=null;for(s=this.m_contacts.length;s<e;s++)this.m_contacts[s]=null;for(s=this.m_joints.length;s<i;s++)this.m_joints[s]=null},A.prototype.Clear=function(){this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0},A.prototype.Solve=function(t,e,i){var n,o=0,r=0;for(o=0;o<this.m_bodyCount;++o)(n=this.m_bodies[o]).GetType()==C.b2_dynamicBody&&(n.m_linearVelocity.x+=t.dt*(e.x+n.m_invMass*n.m_force.x),n.m_linearVelocity.y+=t.dt*(e.y+n.m_invMass*n.m_force.y),n.m_angularVelocity+=t.dt*n.m_invI*n.m_torque,n.m_linearVelocity.Multiply(_.Clamp(1-t.dt*n.m_linearDamping,0,1)),n.m_angularVelocity*=_.Clamp(1-t.dt*n.m_angularDamping,0,1));this.m_contactSolver.Initialize(t,this.m_contacts,this.m_contactCount,this.m_allocator);var s=this.m_contactSolver;for(s.InitVelocityConstraints(t),o=0;o<this.m_jointCount;++o)this.m_joints[o].InitVelocityConstraints(t);for(o=0;o<t.velocityIterations;++o){for(r=0;r<this.m_jointCount;++r)this.m_joints[r].SolveVelocityConstraints(t);s.SolveVelocityConstraints()}for(o=0;o<this.m_jointCount;++o)this.m_joints[o].FinalizeVelocityConstraints();for(s.FinalizeVelocityConstraints(),o=0;o<this.m_bodyCount;++o)if((n=this.m_bodies[o]).GetType()!=C.b2_staticBody){var a=t.dt*n.m_linearVelocity.x,l=t.dt*n.m_linearVelocity.y;a*a+l*l>w.b2_maxTranslationSquared&&(n.m_linearVelocity.Normalize(),n.m_linearVelocity.x*=w.b2_maxTranslation*t.inv_dt,n.m_linearVelocity.y*=w.b2_maxTranslation*t.inv_dt);var h=t.dt*n.m_angularVelocity;h*h>w.b2_maxRotationSquared&&(n.m_angularVelocity<0?n.m_angularVelocity=-w.b2_maxRotation*t.inv_dt:n.m_angularVelocity=w.b2_maxRotation*t.inv_dt),n.m_sweep.c0.SetV(n.m_sweep.c),n.m_sweep.a0=n.m_sweep.a,n.m_sweep.c.x+=t.dt*n.m_linearVelocity.x,n.m_sweep.c.y+=t.dt*n.m_linearVelocity.y,n.m_sweep.a+=t.dt*n.m_angularVelocity,n.SynchronizeTransform()}for(o=0;o<t.positionIterations;++o){var u=s.SolvePositionConstraints(w.b2_contactBaumgarte),c=!0;for(r=0;r<this.m_jointCount;++r){var p=this.m_joints[r].SolvePositionConstraints(w.b2_contactBaumgarte);c=c&&p}if(u&&c)break}if(this.Report(s.m_constraints),i){var m=Number.MAX_VALUE,f=w.b2_linearSleepTolerance*w.b2_linearSleepTolerance,d=w.b2_angularSleepTolerance*w.b2_angularSleepTolerance;for(o=0;o<this.m_bodyCount;++o)(n=this.m_bodies[o]).GetType()!=C.b2_staticBody&&(0==(n.m_flags&C.e_allowSleepFlag)&&(m=n.m_sleepTime=0),m=0==(n.m_flags&C.e_allowSleepFlag)||n.m_angularVelocity*n.m_angularVelocity>d||_.Dot(n.m_linearVelocity,n.m_linearVelocity)>f?n.m_sleepTime=0:(n.m_sleepTime+=t.dt,_.Min(m,n.m_sleepTime)));if(m>=w.b2_timeToSleep)for(o=0;o<this.m_bodyCount;++o)(n=this.m_bodies[o]).SetAwake(!1)}},A.prototype.SolveTOI=function(t){var e=0,i=0;this.m_contactSolver.Initialize(t,this.m_contacts,this.m_contactCount,this.m_allocator);var n=this.m_contactSolver;for(e=0;e<this.m_jointCount;++e)this.m_joints[e].InitVelocityConstraints(t);for(e=0;e<t.velocityIterations;++e)for(n.SolveVelocityConstraints(),i=0;i<this.m_jointCount;++i)this.m_joints[i].SolveVelocityConstraints(t);for(e=0;e<this.m_bodyCount;++e){var o=this.m_bodies[e];if(o.GetType()!=C.b2_staticBody){var r=t.dt*o.m_linearVelocity.x,s=t.dt*o.m_linearVelocity.y;r*r+s*s>w.b2_maxTranslationSquared&&(o.m_linearVelocity.Normalize(),o.m_linearVelocity.x*=w.b2_maxTranslation*t.inv_dt,o.m_linearVelocity.y*=w.b2_maxTranslation*t.inv_dt);var a=t.dt*o.m_angularVelocity;a*a>w.b2_maxRotationSquared&&(o.m_angularVelocity<0?o.m_angularVelocity=-w.b2_maxRotation*t.inv_dt:o.m_angularVelocity=w.b2_maxRotation*t.inv_dt),o.m_sweep.c0.SetV(o.m_sweep.c),o.m_sweep.a0=o.m_sweep.a,o.m_sweep.c.x+=t.dt*o.m_linearVelocity.x,o.m_sweep.c.y+=t.dt*o.m_linearVelocity.y,o.m_sweep.a+=t.dt*o.m_angularVelocity,o.SynchronizeTransform()}}for(e=0;e<t.positionIterations;++e){var l=n.SolvePositionConstraints(.75),h=!0;for(i=0;i<this.m_jointCount;++i){var u=this.m_joints[i].SolvePositionConstraints(w.b2_contactBaumgarte);h=h&&u}if(l&&h)break}this.Report(n.m_constraints)},A.prototype.Report=function(t){if(null!=this.m_listener)for(var e=0;e<this.m_contactCount;++e){for(var i=this.m_contacts[e],n=t[e],o=0;o<n.pointCount;++o)A.s_impulse.normalImpulses[o]=n.points[o].normalImpulse,A.s_impulse.tangentImpulses[o]=n.points[o].tangentImpulse;this.m_listener.PostSolve(i,A.s_impulse)}},A.prototype.AddBody=function(t){t.m_islandIndex=this.m_bodyCount,this.m_bodies[this.m_bodyCount++]=t},A.prototype.AddContact=function(t){this.m_contacts[this.m_contactCount++]=t},A.prototype.AddJoint=function(t){this.m_joints[this.m_jointCount++]=t},Box2D.postDefs.push(function(){Box2D.Dynamics.b2Island.s_impulse=new h}),M.b2TimeStep=function(){},M.prototype.Set=function(t){this.dt=t.dt,this.inv_dt=t.inv_dt,this.positionIterations=t.positionIterations,this.velocityIterations=t.velocityIterations,this.warmStarting=t.warmStarting},B.b2World=function(){this.s_stack=new Vector,this.m_contactManager=new c,this.m_contactSolver=new I,this.m_island=new A},B.prototype.b2World=function(t,e){this.m_destructionListener=null,this.m_debugDraw=null,this.m_bodyList=null,this.m_contactList=null,this.m_jointList=null,this.m_controllerList=null,this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0,this.m_controllerCount=0,B.m_warmStarting=!0,B.m_continuousPhysics=!0,this.m_allowSleep=e,this.m_gravity=t,this.m_inv_dt0=0,this.m_contactManager.m_world=this;var i=new a;this.m_groundBody=this.CreateBody(i)},B.prototype.SetDestructionListener=function(t){this.m_destructionListener=t},B.prototype.SetContactFilter=function(t){this.m_contactManager.m_contactFilter=t},B.prototype.SetContactListener=function(t){this.m_contactManager.m_contactListener=t},B.prototype.SetDebugDraw=function(t){this.m_debugDraw=t},B.prototype.SetBroadPhase=function(t){var e=this.m_contactManager.m_broadPhase;this.m_contactManager.m_broadPhase=t;for(var i=this.m_bodyList;i;i=i.m_next)for(var n=i.m_fixtureList;n;n=n.m_next)n.m_proxy=t.CreateProxy(e.GetFatAABB(n.m_proxy),n)},B.prototype.Validate=function(){this.m_contactManager.m_broadPhase.Validate()},B.prototype.GetProxyCount=function(){return this.m_contactManager.m_broadPhase.GetProxyCount()},B.prototype.CreateBody=function(t){if(1==this.IsLocked())return null;var e=new C(t,this);return e.m_prev=null,e.m_next=this.m_bodyList,this.m_bodyList&&(this.m_bodyList.m_prev=e),this.m_bodyList=e,++this.m_bodyCount,e},B.prototype.DestroyBody=function(t){if(1!=this.IsLocked()){for(var e=t.m_jointList;e;){var i=e;e=e.next,this.m_destructionListener&&this.m_destructionListener.SayGoodbyeJoint(i.joint),this.DestroyJoint(i.joint)}for(var n=t.m_controllerList;n;){var o=n;n=n.nextController,o.controller.RemoveBody(t)}for(var r=t.m_contactList;r;){var s=r;r=r.next,this.m_contactManager.Destroy(s.contact)}t.m_contactList=null;for(var a=t.m_fixtureList;a;){var l=a;a=a.m_next,this.m_destructionListener&&this.m_destructionListener.SayGoodbyeFixture(l),l.DestroyProxy(this.m_contactManager.m_broadPhase),l.Destroy()}t.m_fixtureList=null,t.m_fixtureCount=0,t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t==this.m_bodyList&&(this.m_bodyList=t.m_next),--this.m_bodyCount}},B.prototype.CreateJoint=function(t){var e=R.Create(t,null);e.m_prev=null,e.m_next=this.m_jointList,this.m_jointList&&(this.m_jointList.m_prev=e),this.m_jointList=e,++this.m_jointCount,(e.m_edgeA.joint=e).m_edgeA.other=e.m_bodyB,e.m_edgeA.prev=null,e.m_edgeA.next=e.m_bodyA.m_jointList,e.m_bodyA.m_jointList&&(e.m_bodyA.m_jointList.prev=e.m_edgeA),e.m_bodyA.m_jointList=e.m_edgeA,(e.m_edgeB.joint=e).m_edgeB.other=e.m_bodyA,e.m_edgeB.prev=null,e.m_edgeB.next=e.m_bodyB.m_jointList,e.m_bodyB.m_jointList&&(e.m_bodyB.m_jointList.prev=e.m_edgeB),e.m_bodyB.m_jointList=e.m_edgeB;var i=t.bodyA,n=t.bodyB;if(0==t.collideConnected)for(var o=n.GetContactList();o;)o.other==i&&o.contact.FlagForFiltering(),o=o.next;return e},B.prototype.DestroyJoint=function(t){var e=t.m_collideConnected;t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t==this.m_jointList&&(this.m_jointList=t.m_next);var i=t.m_bodyA,n=t.m_bodyB;if(i.SetAwake(!0),n.SetAwake(!0),t.m_edgeA.prev&&(t.m_edgeA.prev.next=t.m_edgeA.next),t.m_edgeA.next&&(t.m_edgeA.next.prev=t.m_edgeA.prev),t.m_edgeA==i.m_jointList&&(i.m_jointList=t.m_edgeA.next),t.m_edgeA.prev=null,t.m_edgeA.next=null,t.m_edgeB.prev&&(t.m_edgeB.prev.next=t.m_edgeB.next),t.m_edgeB.next&&(t.m_edgeB.next.prev=t.m_edgeB.prev),t.m_edgeB==n.m_jointList&&(n.m_jointList=t.m_edgeB.next),t.m_edgeB.prev=null,t.m_edgeB.next=null,R.Destroy(t,null),--this.m_jointCount,0==e)for(var o=n.GetContactList();o;)o.other==i&&o.contact.FlagForFiltering(),o=o.next},B.prototype.AddController=function(t){return t.m_next=this.m_controllerList,t.m_prev=null,((this.m_controllerList=t).m_world=this).m_controllerCount++,t},B.prototype.RemoveController=function(t){t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),this.m_controllerList==t&&(this.m_controllerList=t.m_next),this.m_controllerCount--},B.prototype.CreateController=function(t){if(t.m_world!=this)throw new Error("Controller can only be a member of one world");return t.m_next=this.m_controllerList,t.m_prev=null,this.m_controllerList&&(this.m_controllerList.m_prev=t),this.m_controllerList=t,++this.m_controllerCount,t.m_world=this,t},B.prototype.DestroyController=function(t){t.Clear(),t.m_next&&(t.m_next.m_prev=t.m_prev),t.m_prev&&(t.m_prev.m_next=t.m_next),t==this.m_controllerList&&(this.m_controllerList=t.m_next),--this.m_controllerCount},B.prototype.SetWarmStarting=function(t){B.m_warmStarting=t},B.prototype.SetContinuousPhysics=function(t){B.m_continuousPhysics=t},B.prototype.GetBodyCount=function(){return this.m_bodyCount},B.prototype.GetJointCount=function(){return this.m_jointCount},B.prototype.GetContactCount=function(){return this.m_contactCount},B.prototype.SetGravity=function(t){this.m_gravity=t},B.prototype.GetGravity=function(){return this.m_gravity},B.prototype.GetGroundBody=function(){return this.m_groundBody},B.prototype.Step=function(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.m_flags&B.e_newFixture&&(this.m_contactManager.FindNewContacts(),this.m_flags&=~B.e_newFixture),this.m_flags|=B.e_locked;var n=B.s_timestep2;n.dt=t,n.velocityIterations=e,n.positionIterations=i,n.inv_dt=0<t?1/t:0,n.dtRatio=this.m_inv_dt0*t,n.warmStarting=B.m_warmStarting,this.m_contactManager.Collide(),0<n.dt&&this.Solve(n),B.m_continuousPhysics&&0<n.dt&&this.SolveTOI(n),0<n.dt&&(this.m_inv_dt0=n.inv_dt),this.m_flags&=~B.e_locked},B.prototype.ClearForces=function(){for(var t=this.m_bodyList;t;t=t.m_next)t.m_force.SetZero(),t.m_torque=0},B.prototype.DrawDebugData=function(){if(null!=this.m_debugDraw){this.m_debugDraw.m_sprite.graphics.clear();var t,e,i,n,o,r,s=this.m_debugDraw.GetFlags(),a=(new y,new y,new y,new v,new v,[new y,new y,new y,new y]),l=new x(0,0,0);if(s&g.e_shapeBit)for(t=this.m_bodyList;t;t=t.m_next)for(r=t.m_xf,e=t.GetFixtureList();e;e=e.m_next)i=e.GetShape(),0==t.IsActive()?l.Set(.5,.5,.3):t.GetType()==C.b2_staticBody?l.Set(.5,.9,.5):t.GetType()==C.b2_kinematicBody?l.Set(.5,.5,.9):0==t.IsAwake()?l.Set(.6,.6,.6):l.Set(.9,.7,.7),this.DrawShape(i,r,l);if(s&g.e_jointBit)for(n=this.m_jointList;n;n=n.m_next)this.DrawJoint(n);if(s&g.e_controllerBit)for(var h=this.m_controllerList;h;h=h.m_next)h.Draw(this.m_debugDraw);if(s&g.e_pairBit){l.Set(.3,.9,.9);for(var u=this.m_contactManager.m_contactList;u;u=u.GetNext()){var c=u.GetFixtureA(),p=u.GetFixtureB(),m=c.GetAABB().GetCenter(),f=p.GetAABB().GetCenter();this.m_debugDraw.DrawSegment(m,f,l)}}if(s&g.e_aabbBit)for(o=this.m_contactManager.m_broadPhase,a=[new y,new y,new y,new y],t=this.m_bodyList;t;t=t.GetNext())if(0!=t.IsActive())for(e=t.GetFixtureList();e;e=e.GetNext()){var d=o.GetFatAABB(e.m_proxy);a[0].Set(d.lowerBound.x,d.lowerBound.y),a[1].Set(d.upperBound.x,d.lowerBound.y),a[2].Set(d.upperBound.x,d.upperBound.y),a[3].Set(d.lowerBound.x,d.upperBound.y),this.m_debugDraw.DrawPolygon(a,4,l)}if(s&g.e_centerOfMassBit)for(t=this.m_bodyList;t;t=t.m_next)(r=B.s_xf).R=t.m_xf.R,r.position=t.GetWorldCenter(),this.m_debugDraw.DrawTransform(r)}},B.prototype.QueryAABB=function(e,t){var i=this.m_contactManager.m_broadPhase;i.Query(function(t){return e(i.GetUserData(t))},t)},B.prototype.QueryShape=function(i,n,o){void 0===o&&(o=null),null==o&&(o=new e).SetIdentity();var r=this.m_contactManager.m_broadPhase;var t=new v;n.ComputeAABB(t,o),r.Query(function(t){var e=r.GetUserData(t)instanceof S?r.GetUserData(t):null;return!b.TestOverlap(n,o,e.GetShape(),e.GetBody().GetTransform())||i(e)},t)},B.prototype.QueryPoint=function(i,n){var o=this.m_contactManager.m_broadPhase;var t=new v;t.lowerBound.Set(n.x-w.b2_linearSlop,n.y-w.b2_linearSlop),t.upperBound.Set(n.x+w.b2_linearSlop,n.y+w.b2_linearSlop),o.Query(function(t){var e=o.GetUserData(t)instanceof S?o.GetUserData(t):null;return!e.TestPoint(n)||i(e)},t)},B.prototype.RayCast=function(s,a,l){var h=this.m_contactManager.m_broadPhase,u=new r;var t=new o(a,l);h.RayCast(function(t,e){var i=h.GetUserData(e),n=i instanceof S?i:null;if(n.RayCast(u,t)){var o=u.fraction,r=new y((1-o)*a.x+o*l.x,(1-o)*a.y+o*l.y);return s(n,r,u.normal,o)}return t.maxFraction},t)},B.prototype.RayCastOne=function(t,e){var o;return this.RayCast(function(t,e,i,n){return void 0===n&&(n=0),o=t,n},t,e),o},B.prototype.RayCastAll=function(t,e){var o=new Vector;return this.RayCast(function(t,e,i,n){return void 0===n&&(n=0),o[o.length]=t,1},t,e),o},B.prototype.GetBodyList=function(){return this.m_bodyList},B.prototype.GetJointList=function(){return this.m_jointList},B.prototype.GetContactList=function(){return this.m_contactList},B.prototype.IsLocked=function(){return 0<(this.m_flags&B.e_locked)},B.prototype.Solve=function(t){for(var e,i=this.m_controllerList;i;i=i.m_next)i.Step(t);var n=this.m_island;for(n.Initialize(this.m_bodyCount,this.m_contactCount,this.m_jointCount,null,this.m_contactManager.m_contactListener,this.m_contactSolver),e=this.m_bodyList;e;e=e.m_next)e.m_flags&=~C.e_islandFlag;for(var o=this.m_contactList;o;o=o.m_next)o.m_flags&=~E.e_islandFlag;for(var r=this.m_jointList;r;r=r.m_next)r.m_islandFlag=!1;parseInt(this.m_bodyCount);for(var s=this.s_stack,a=this.m_bodyList;a;a=a.m_next)if(!(a.m_flags&C.e_islandFlag)&&0!=a.IsAwake()&&0!=a.IsActive()&&a.GetType()!=C.b2_staticBody){n.Clear();var l=0;for((s[l++]=a).m_flags|=C.e_islandFlag;0<l;)if(e=s[--l],n.AddBody(e),0==e.IsAwake()&&e.SetAwake(!0),e.GetType()!=C.b2_staticBody){for(var h,u=e.m_contactList;u;u=u.next)u.contact.m_flags&E.e_islandFlag||1!=u.contact.IsSensor()&&0!=u.contact.IsEnabled()&&0!=u.contact.IsTouching()&&(n.AddContact(u.contact),u.contact.m_flags|=E.e_islandFlag,(h=u.other).m_flags&C.e_islandFlag||((s[l++]=h).m_flags|=C.e_islandFlag));for(var c=e.m_jointList;c;c=c.next)1!=c.joint.m_islandFlag&&0!=(h=c.other).IsActive()&&(n.AddJoint(c.joint),c.joint.m_islandFlag=!0,h.m_flags&C.e_islandFlag||((s[l++]=h).m_flags|=C.e_islandFlag))}n.Solve(t,this.m_gravity,this.m_allowSleep);for(var p=0;p<n.m_bodyCount;++p)(e=n.m_bodies[p]).GetType()==C.b2_staticBody&&(e.m_flags&=~C.e_islandFlag)}for(p=0;p<s.length&&s[p];++p)s[p]=null;for(e=this.m_bodyList;e;e=e.m_next)0!=e.IsAwake()&&0!=e.IsActive()&&e.GetType()!=C.b2_staticBody&&e.SynchronizeFixtures();this.m_contactManager.FindNewContacts()},B.prototype.SolveTOI=function(t){var e,i,n,o,r,s,a,l=this.m_island;l.Initialize(this.m_bodyCount,w.b2_maxTOIContactsPerIsland,w.b2_maxTOIJointsPerIsland,null,this.m_contactManager.m_contactListener,this.m_contactSolver);var h,u=B.s_queue;for(e=this.m_bodyList;e;e=e.m_next)e.m_flags&=~C.e_islandFlag,e.m_sweep.t0=0;for(h=this.m_contactList;h;h=h.m_next)h.m_flags&=~(E.e_toiFlag|E.e_islandFlag);for(a=this.m_jointList;a;a=a.m_next)a.m_islandFlag=!1;for(;;){var c=null,p=1;for(h=this.m_contactList;h;h=h.m_next)if(1!=h.IsSensor()&&0!=h.IsEnabled()&&0!=h.IsContinuous()){var m=1;if(h.m_flags&E.e_toiFlag)m=h.m_toi;else{if(i=h.m_fixtureA,n=h.m_fixtureB,o=i.m_body,r=n.m_body,!(o.GetType()==C.b2_dynamicBody&&0!=o.IsAwake()||r.GetType()==C.b2_dynamicBody&&0!=r.IsAwake()))continue;var f=o.m_sweep.t0;o.m_sweep.t0<r.m_sweep.t0?(f=r.m_sweep.t0,o.m_sweep.Advance(f)):r.m_sweep.t0<o.m_sweep.t0&&(f=o.m_sweep.t0,r.m_sweep.Advance(f)),m=h.ComputeTOI(o.m_sweep,r.m_sweep),w.b2Assert(0<=m&&m<=1),0<m&&m<1&&1<(m=(1-m)*f+m)&&(m=1),h.m_toi=m,h.m_flags|=E.e_toiFlag}Number.MIN_VALUE<m&&m<p&&(c=h,p=m)}if(null==c||1-100*Number.MIN_VALUE<p)break;if(i=c.m_fixtureA,n=c.m_fixtureB,o=i.m_body,r=n.m_body,B.s_backupA.Set(o.m_sweep),B.s_backupB.Set(r.m_sweep),o.Advance(p),r.Advance(p),c.Update(this.m_contactManager.m_contactListener),c.m_flags&=~E.e_toiFlag,1!=c.IsSensor()&&0!=c.IsEnabled()){if(0!=c.IsTouching()){var d=o;d.GetType()!=C.b2_dynamicBody&&(d=r),l.Clear();var _=0,y=0;for((u[_+y++]=d).m_flags|=C.e_islandFlag;0<y;)if(e=u[_++],--y,l.AddBody(e),0==e.IsAwake()&&e.SetAwake(!0),e.GetType()==C.b2_dynamicBody){for(s=e.m_contactList;s&&l.m_contactCount!=l.m_contactCapacity;s=s.next)if(!(s.contact.m_flags&E.e_islandFlag)&&1!=s.contact.IsSensor()&&0!=s.contact.IsEnabled()&&0!=s.contact.IsTouching()){l.AddContact(s.contact),s.contact.m_flags|=E.e_islandFlag;var x=s.other;x.m_flags&C.e_islandFlag||(x.GetType()!=C.b2_staticBody&&(x.Advance(p),x.SetAwake(!0)),u[_+y]=x,++y,x.m_flags|=C.e_islandFlag)}for(var v=e.m_jointList;v;v=v.next)l.m_jointCount!=l.m_jointCapacity&&1!=v.joint.m_islandFlag&&0!=(x=v.other).IsActive()&&(l.AddJoint(v.joint),v.joint.m_islandFlag=!0,x.m_flags&C.e_islandFlag||(x.GetType()!=C.b2_staticBody&&(x.Advance(p),x.SetAwake(!0)),u[_+y]=x,++y,x.m_flags|=C.e_islandFlag))}var b=B.s_timestep;b.warmStarting=!1,b.dt=(1-p)*t.dt,b.inv_dt=1/b.dt,b.dtRatio=0,b.velocityIterations=t.velocityIterations,b.positionIterations=t.positionIterations,l.SolveTOI(b);var g=0;for(g=0;g<l.m_bodyCount;++g)if((e=l.m_bodies[g]).m_flags&=~C.e_islandFlag,0!=e.IsAwake()&&e.GetType()==C.b2_dynamicBody)for(e.SynchronizeFixtures(),s=e.m_contactList;s;s=s.next)s.contact.m_flags&=~E.e_toiFlag;for(g=0;g<l.m_contactCount;++g)(h=l.m_contacts[g]).m_flags&=~(E.e_toiFlag|E.e_islandFlag);for(g=0;g<l.m_jointCount;++g)(a=l.m_joints[g]).m_islandFlag=!1;this.m_contactManager.FindNewContacts()}}else o.m_sweep.Set(B.s_backupA),r.m_sweep.Set(B.s_backupB),o.SynchronizeTransform(),r.SynchronizeTransform()}},B.prototype.DrawJoint=function(t){var e=t.GetBodyA(),i=t.GetBodyB(),n=e.m_xf,o=i.m_xf,r=n.position,s=o.position,a=t.GetAnchorA(),l=t.GetAnchorB(),h=B.s_jointColor;switch(t.m_type){case R.e_distanceJoint:this.m_debugDraw.DrawSegment(a,l,h);break;case R.e_pulleyJoint:var u=t instanceof O?t:null,c=u.GetGroundAnchorA(),p=u.GetGroundAnchorB();this.m_debugDraw.DrawSegment(c,a,h),this.m_debugDraw.DrawSegment(p,l,h),this.m_debugDraw.DrawSegment(c,p,h);break;case R.e_mouseJoint:this.m_debugDraw.DrawSegment(a,l,h);break;default:e!=this.m_groundBody&&this.m_debugDraw.DrawSegment(r,a,h),this.m_debugDraw.DrawSegment(a,l,h),i!=this.m_groundBody&&this.m_debugDraw.DrawSegment(s,l,h)}},B.prototype.DrawShape=function(t,e,i){switch(t.m_type){case b.e_circleShape:var n=t instanceof m?t:null,o=_.MulX(e,n.m_p),r=n.m_radius,s=e.R.col1;this.m_debugDraw.DrawSolidCircle(o,r,s,i);break;case b.e_polygonShape:var a=0,l=t instanceof d?t:null,h=parseInt(l.GetVertexCount()),u=l.GetVertices(),c=new Vector(h);for(a=0;a<h;++a)c[a]=_.MulX(e,u[a]);this.m_debugDraw.DrawSolidPolygon(c,h,i);break;case b.e_edgeShape:var p=t instanceof f?t:null;this.m_debugDraw.DrawSegment(_.MulX(e,p.GetVertex1()),_.MulX(e,p.GetVertex2()),i)}},Box2D.postDefs.push(function(){Box2D.Dynamics.b2World.s_timestep2=new M,Box2D.Dynamics.b2World.s_xf=new e,Box2D.Dynamics.b2World.s_backupA=new t,Box2D.Dynamics.b2World.s_backupB=new t,Box2D.Dynamics.b2World.s_timestep=new M,Box2D.Dynamics.b2World.s_queue=new Vector,Box2D.Dynamics.b2World.s_jointColor=new x(.5,.8,.8),Box2D.Dynamics.b2World.e_newFixture=1,Box2D.Dynamics.b2World.e_locked=2})}(),function(){var i=Box2D.Collision.Shapes.b2CircleShape,n=(Box2D.Collision.Shapes.b2EdgeChainDef,Box2D.Collision.Shapes.b2EdgeShape),o=(Box2D.Collision.Shapes.b2MassData,Box2D.Collision.Shapes.b2PolygonShape),_=Box2D.Collision.Shapes.b2Shape,r=Box2D.Dynamics.Contacts.b2CircleContact,y=Box2D.Dynamics.Contacts.b2Contact,nt=Box2D.Dynamics.Contacts.b2ContactConstraint,e=Box2D.Dynamics.Contacts.b2ContactConstraintPoint,t=Box2D.Dynamics.Contacts.b2ContactEdge,s=Box2D.Dynamics.Contacts.b2ContactFactory,a=Box2D.Dynamics.Contacts.b2ContactRegister,l=Box2D.Dynamics.Contacts.b2ContactResult,ot=Box2D.Dynamics.Contacts.b2ContactSolver,h=Box2D.Dynamics.Contacts.b2EdgeAndCircleContact,u=Box2D.Dynamics.Contacts.b2NullContact,c=Box2D.Dynamics.Contacts.b2PolyAndCircleContact,p=Box2D.Dynamics.Contacts.b2PolyAndEdgeContact,m=Box2D.Dynamics.Contacts.b2PolygonContact,f=Box2D.Dynamics.Contacts.b2PositionSolverManifold,x=Box2D.Dynamics.b2Body,d=(Box2D.Dynamics.b2BodyDef,Box2D.Dynamics.b2ContactFilter,Box2D.Dynamics.b2ContactImpulse,Box2D.Dynamics.b2ContactListener,Box2D.Dynamics.b2ContactManager,Box2D.Dynamics.b2DebugDraw,Box2D.Dynamics.b2DestructionListener,Box2D.Dynamics.b2FilterData,Box2D.Dynamics.b2Fixture,Box2D.Dynamics.b2FixtureDef,Box2D.Dynamics.b2Island,Box2D.Dynamics.b2TimeStep),rt=(Box2D.Dynamics.b2World,Box2D.Common.b2Color,Box2D.Common.b2internal,Box2D.Common.b2Settings),v=Box2D.Common.Math.b2Mat22,J=(Box2D.Common.Math.b2Mat33,Box2D.Common.Math.b2Math),b=(Box2D.Common.Math.b2Sweep,Box2D.Common.Math.b2Transform,Box2D.Common.Math.b2Vec2),g=(Box2D.Common.Math.b2Vec3,Box2D.Collision.b2AABB,Box2D.Collision.b2Bound,Box2D.Collision.b2BoundValues,Box2D.Collision.b2Collision),w=Box2D.Collision.b2ContactID,C=(Box2D.Collision.b2ContactPoint,Box2D.Collision.b2Distance,Box2D.Collision.b2DistanceInput,Box2D.Collision.b2DistanceOutput,Box2D.Collision.b2DistanceProxy,Box2D.Collision.b2DynamicTree,Box2D.Collision.b2DynamicTreeBroadPhase,Box2D.Collision.b2DynamicTreeNode,Box2D.Collision.b2DynamicTreePair,Box2D.Collision.b2Manifold),D=(Box2D.Collision.b2ManifoldPoint,Box2D.Collision.b2Point,Box2D.Collision.b2RayCastInput,Box2D.Collision.b2RayCastOutput,Box2D.Collision.b2Segment,Box2D.Collision.b2SeparationFunction,Box2D.Collision.b2Simplex,Box2D.Collision.b2SimplexCache,Box2D.Collision.b2SimplexVertex,Box2D.Collision.b2TimeOfImpact),S=Box2D.Collision.b2TOIInput,T=Box2D.Collision.b2WorldManifold;Box2D.Collision.ClipVertex,Box2D.Collision.Features,Box2D.Collision.IBroadPhase;Box2D.inherit(r,Box2D.Dynamics.Contacts.b2Contact),r.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype,r.b2CircleContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)},r.Create=function(t){return new r},r.Destroy=function(t,e){},r.prototype.Reset=function(t,e){this.__super.Reset.call(this,t,e)},r.prototype.Evaluate=function(){var t=this.m_fixtureA.GetBody(),e=this.m_fixtureB.GetBody();g.CollideCircles(this.m_manifold,this.m_fixtureA.GetShape()instanceof i?this.m_fixtureA.GetShape():null,t.m_xf,this.m_fixtureB.GetShape()instanceof i?this.m_fixtureB.GetShape():null,e.m_xf)},y.b2Contact=function(){this.m_nodeA=new t,this.m_nodeB=new t,this.m_manifold=new C,this.m_oldManifold=new C},y.prototype.GetManifold=function(){return this.m_manifold},y.prototype.GetWorldManifold=function(t){var e=this.m_fixtureA.GetBody(),i=this.m_fixtureB.GetBody(),n=this.m_fixtureA.GetShape(),o=this.m_fixtureB.GetShape();t.Initialize(this.m_manifold,e.GetTransform(),n.m_radius,i.GetTransform(),o.m_radius)},y.prototype.IsTouching=function(){return(this.m_flags&y.e_touchingFlag)==y.e_touchingFlag},y.prototype.IsContinuous=function(){return(this.m_flags&y.e_continuousFlag)==y.e_continuousFlag},y.prototype.SetSensor=function(t){t?this.m_flags|=y.e_sensorFlag:this.m_flags&=~y.e_sensorFlag},y.prototype.IsSensor=function(){return(this.m_flags&y.e_sensorFlag)==y.e_sensorFlag},y.prototype.SetEnabled=function(t){t?this.m_flags|=y.e_enabledFlag:this.m_flags&=~y.e_enabledFlag},y.prototype.IsEnabled=function(){return(this.m_flags&y.e_enabledFlag)==y.e_enabledFlag},y.prototype.GetNext=function(){return this.m_next},y.prototype.GetFixtureA=function(){return this.m_fixtureA},y.prototype.GetFixtureB=function(){return this.m_fixtureB},y.prototype.FlagForFiltering=function(){this.m_flags|=y.e_filterFlag},y.prototype.b2Contact=function(){},y.prototype.Reset=function(t,e){if(void 0===t&&(t=null),void 0===e&&(e=null),this.m_flags=y.e_enabledFlag,!t||!e)return this.m_fixtureA=null,void(this.m_fixtureB=null);(t.IsSensor()||e.IsSensor())&&(this.m_flags|=y.e_sensorFlag);var i=t.GetBody(),n=e.GetBody();(i.GetType()!=x.b2_dynamicBody||i.IsBullet()||n.GetType()!=x.b2_dynamicBody||n.IsBullet())&&(this.m_flags|=y.e_continuousFlag),this.m_fixtureA=t,this.m_fixtureB=e,this.m_manifold.m_pointCount=0,this.m_prev=null,this.m_next=null,this.m_nodeA.contact=null,this.m_nodeA.prev=null,this.m_nodeA.next=null,this.m_nodeA.other=null,this.m_nodeB.contact=null,this.m_nodeB.prev=null,this.m_nodeB.next=null,this.m_nodeB.other=null},y.prototype.Update=function(t){var e=this.m_oldManifold;this.m_oldManifold=this.m_manifold,this.m_manifold=e,this.m_flags|=y.e_enabledFlag;var i=!1,n=(this.m_flags&y.e_touchingFlag)==y.e_touchingFlag,o=this.m_fixtureA.m_body,r=this.m_fixtureB.m_body,s=this.m_fixtureA.m_aabb.TestOverlap(this.m_fixtureB.m_aabb);if(this.m_flags&y.e_sensorFlag){if(s){var a=this.m_fixtureA.GetShape(),l=this.m_fixtureB.GetShape(),h=o.GetTransform(),u=r.GetTransform();i=_.TestOverlap(a,h,l,u)}this.m_manifold.m_pointCount=0}else{if(o.GetType()!=x.b2_dynamicBody||o.IsBullet()||r.GetType()!=x.b2_dynamicBody||r.IsBullet()?this.m_flags|=y.e_continuousFlag:this.m_flags&=~y.e_continuousFlag,s){this.Evaluate(),i=0<this.m_manifold.m_pointCount;for(var c=0;c<this.m_manifold.m_pointCount;++c){var p=this.m_manifold.m_points[c];p.m_normalImpulse=0,p.m_tangentImpulse=0;for(var m=p.m_id,f=0;f<this.m_oldManifold.m_pointCount;++f){var d=this.m_oldManifold.m_points[f];if(d.m_id.key==m.key){p.m_normalImpulse=d.m_normalImpulse,p.m_tangentImpulse=d.m_tangentImpulse;break}}}}else this.m_manifold.m_pointCount=0;i!=n&&(o.SetAwake(!0),r.SetAwake(!0))}i?this.m_flags|=y.e_touchingFlag:this.m_flags&=~y.e_touchingFlag,0==n&&1==i&&t.BeginContact(this),1==n&&0==i&&t.EndContact(this),0==(this.m_flags&y.e_sensorFlag)&&t.PreSolve(this,this.m_oldManifold)},y.prototype.Evaluate=function(){},y.prototype.ComputeTOI=function(t,e){return y.s_input.proxyA.Set(this.m_fixtureA.GetShape()),y.s_input.proxyB.Set(this.m_fixtureB.GetShape()),y.s_input.sweepA=t,y.s_input.sweepB=e,y.s_input.tolerance=rt.b2_linearSlop,D.TimeOfImpact(y.s_input)},Box2D.postDefs.push(function(){Box2D.Dynamics.Contacts.b2Contact.e_sensorFlag=1,Box2D.Dynamics.Contacts.b2Contact.e_continuousFlag=2,Box2D.Dynamics.Contacts.b2Contact.e_islandFlag=4,Box2D.Dynamics.Contacts.b2Contact.e_toiFlag=8,Box2D.Dynamics.Contacts.b2Contact.e_touchingFlag=16,Box2D.Dynamics.Contacts.b2Contact.e_enabledFlag=32,Box2D.Dynamics.Contacts.b2Contact.e_filterFlag=64,Box2D.Dynamics.Contacts.b2Contact.s_input=new S}),nt.b2ContactConstraint=function(){this.localPlaneNormal=new b,this.localPoint=new b,this.normal=new b,this.normalMass=new v,this.K=new v},nt.prototype.b2ContactConstraint=function(){this.points=new Vector(rt.b2_maxManifoldPoints);for(var t=0;t<rt.b2_maxManifoldPoints;t++)this.points[t]=new e},e.b2ContactConstraintPoint=function(){this.localPoint=new b,this.rA=new b,this.rB=new b},t.b2ContactEdge=function(){},s.b2ContactFactory=function(){},s.prototype.b2ContactFactory=function(t){this.m_allocator=t,this.InitializeRegisters()},s.prototype.AddType=function(t,e,i,n){void 0===i&&(i=0),void 0===n&&(n=0),this.m_registers[i][n].createFcn=t,this.m_registers[i][n].destroyFcn=e,this.m_registers[i][n].primary=!0,i!=n&&(this.m_registers[n][i].createFcn=t,this.m_registers[n][i].destroyFcn=e,this.m_registers[n][i].primary=!1)},s.prototype.InitializeRegisters=function(){this.m_registers=new Vector(_.e_shapeTypeCount);for(var t=0;t<_.e_shapeTypeCount;t++){this.m_registers[t]=new Vector(_.e_shapeTypeCount);for(var e=0;e<_.e_shapeTypeCount;e++)this.m_registers[t][e]=new a}this.AddType(r.Create,r.Destroy,_.e_circleShape,_.e_circleShape),this.AddType(c.Create,c.Destroy,_.e_polygonShape,_.e_circleShape),this.AddType(m.Create,m.Destroy,_.e_polygonShape,_.e_polygonShape),this.AddType(h.Create,h.Destroy,_.e_edgeShape,_.e_circleShape),this.AddType(p.Create,p.Destroy,_.e_polygonShape,_.e_edgeShape)},s.prototype.Create=function(t,e){var i,n=parseInt(t.GetType()),o=parseInt(e.GetType()),r=this.m_registers[n][o];if(r.pool)return i=r.pool,r.pool=i.m_next,r.poolCount--,i.Reset(t,e),i;var s=r.createFcn;return null!=s?(r.primary?(i=s(this.m_allocator)).Reset(t,e):(i=s(this.m_allocator)).Reset(e,t),i):null},s.prototype.Destroy=function(t){0<t.m_manifold.m_pointCount&&(t.m_fixtureA.m_body.SetAwake(!0),t.m_fixtureB.m_body.SetAwake(!0));var e=parseInt(t.m_fixtureA.GetType()),i=parseInt(t.m_fixtureB.GetType()),n=this.m_registers[e][i];n.poolCount++,t.m_next=n.pool,n.pool=t,(0,n.destroyFcn)(t,this.m_allocator)},a.b2ContactRegister=function(){},l.b2ContactResult=function(){this.position=new b,this.normal=new b,this.id=new w},ot.b2ContactSolver=function(){this.m_step=new d,this.m_constraints=new Vector},ot.prototype.b2ContactSolver=function(){},ot.prototype.Initialize=function(t,e,i,n){var o;void 0===i&&(i=0),this.m_step.Set(t),this.m_allocator=n;var r=0;for(this.m_constraintCount=i;this.m_constraints.length<this.m_constraintCount;)this.m_constraints[this.m_constraints.length]=new nt;for(r=0;r<i;++r){var s=(o=e[r]).m_fixtureA,a=o.m_fixtureB,l=s.m_shape,h=a.m_shape,u=l.m_radius,c=h.m_radius,p=s.m_body,m=a.m_body,f=o.GetManifold(),d=rt.b2MixFriction(s.GetFriction(),a.GetFriction()),_=rt.b2MixRestitution(s.GetRestitution(),a.GetRestitution()),y=p.m_linearVelocity.x,x=p.m_linearVelocity.y,v=m.m_linearVelocity.x,b=m.m_linearVelocity.y,g=p.m_angularVelocity,w=m.m_angularVelocity;rt.b2Assert(0<f.m_pointCount),ot.s_worldManifold.Initialize(f,p.m_xf,u,m.m_xf,c);var C=ot.s_worldManifold.m_normal.x,D=ot.s_worldManifold.m_normal.y,S=this.m_constraints[r];S.bodyA=p,S.bodyB=m,S.manifold=f,S.normal.x=C,S.normal.y=D,S.pointCount=f.m_pointCount,S.friction=d,S.restitution=_,S.localPlaneNormal.x=f.m_localPlaneNormal.x,S.localPlaneNormal.y=f.m_localPlaneNormal.y,S.localPoint.x=f.m_localPoint.x,S.localPoint.y=f.m_localPoint.y,S.radius=u+c,S.type=f.m_type;for(var T=0;T<S.pointCount;++T){var A=f.m_points[T],M=S.points[T];M.normalImpulse=A.m_normalImpulse,M.tangentImpulse=A.m_tangentImpulse,M.localPoint.SetV(A.m_localPoint);var B=M.rA.x=ot.s_worldManifold.m_points[T].x-p.m_sweep.c.x,E=M.rA.y=ot.s_worldManifold.m_points[T].y-p.m_sweep.c.y,P=M.rB.x=ot.s_worldManifold.m_points[T].x-m.m_sweep.c.x,I=M.rB.y=ot.s_worldManifold.m_points[T].y-m.m_sweep.c.y,R=B*D-E*C,O=P*D-I*C;R*=R,O*=O;var L=p.m_invMass+m.m_invMass+p.m_invI*R+m.m_invI*O;M.normalMass=1/L;var F=p.m_mass*p.m_invMass+m.m_mass*m.m_invMass;F+=p.m_mass*p.m_invI*R+m.m_mass*m.m_invI*O,M.equalizedMass=1/F;var V=-C,N=B*V-E*D,k=P*V-I*D;N*=N,k*=k;var G=p.m_invMass+m.m_invMass+p.m_invI*N+m.m_invI*k;M.tangentMass=1/G,M.velocityBias=0;var j=v+-w*I-y- -g*E,U=b+w*P-x-g*B,J=S.normal.x*j+S.normal.y*U;J<-rt.b2_velocityThreshold&&(M.velocityBias+=-S.restitution*J)}if(2==S.pointCount){var X=S.points[0],W=S.points[1],z=p.m_invMass,H=p.m_invI,Y=m.m_invMass,q=m.m_invI,K=X.rA.x*D-X.rA.y*C,Z=X.rB.x*D-X.rB.y*C,Q=W.rA.x*D-W.rA.y*C,$=W.rB.x*D-W.rB.y*C,tt=z+Y+H*K*K+q*Z*Z,et=z+Y+H*Q*Q+q*$*$,it=z+Y+H*K*Q+q*Z*$;tt*tt<100*(tt*et-it*it)?(S.K.col1.Set(tt,it),S.K.col2.Set(it,et),S.K.GetInverse(S.normalMass)):S.pointCount=1}}},ot.prototype.InitVelocityConstraints=function(t){for(var e=0;e<this.m_constraintCount;++e){var i=this.m_constraints[e],n=i.bodyA,o=i.bodyB,r=n.m_invMass,s=n.m_invI,a=o.m_invMass,l=o.m_invI,h=i.normal.x,u=i.normal.y,c=u,p=-h,m=0,f=0;if(t.warmStarting)for(f=i.pointCount,m=0;m<f;++m){var d=i.points[m];d.normalImpulse*=t.dtRatio,d.tangentImpulse*=t.dtRatio;var _=d.normalImpulse*h+d.tangentImpulse*c,y=d.normalImpulse*u+d.tangentImpulse*p;n.m_angularVelocity-=s*(d.rA.x*y-d.rA.y*_),n.m_linearVelocity.x-=r*_,n.m_linearVelocity.y-=r*y,o.m_angularVelocity+=l*(d.rB.x*y-d.rB.y*_),o.m_linearVelocity.x+=a*_,o.m_linearVelocity.y+=a*y}else for(f=i.pointCount,m=0;m<f;++m){var x=i.points[m];x.normalImpulse=0,x.tangentImpulse=0}}},ot.prototype.SolveVelocityConstraints=function(){for(var t,e,i=0,n=0,o=0,r=0,s=0,a=0,l=0,h=0,u=0,c=0,p=0,m=0,f=0,d=0,_=0;_<this.m_constraintCount;++_){var y=this.m_constraints[_],x=y.bodyA,v=y.bodyB,b=x.m_angularVelocity,g=v.m_angularVelocity,w=x.m_linearVelocity,C=v.m_linearVelocity,D=x.m_invMass,S=x.m_invI,T=v.m_invMass,A=v.m_invI,M=y.normal.x,B=y.normal.y,E=B,P=-M,I=y.friction;for(i=0;i<y.pointCount;i++)t=y.points[i],o=(C.x-g*t.rB.y-w.x+b*t.rA.y)*E+(C.y+g*t.rB.x-w.y-b*t.rA.x)*P,r=t.tangentMass*-o,s=I*t.normalImpulse,l=(r=(a=J.Clamp(t.tangentImpulse+r,-s,s))-t.tangentImpulse)*E,h=r*P,w.x-=D*l,w.y-=D*h,b-=S*(t.rA.x*h-t.rA.y*l),C.x+=T*l,C.y+=T*h,g+=A*(t.rB.x*h-t.rB.y*l),t.tangentImpulse=a;parseInt(y.pointCount);if(1==y.pointCount)t=y.points[0],n=(C.x+-g*t.rB.y-w.x- -b*t.rA.y)*M+(C.y+g*t.rB.x-w.y-b*t.rA.x)*B,r=-t.normalMass*(n-t.velocityBias),l=(r=(a=0<(a=t.normalImpulse+r)?a:0)-t.normalImpulse)*M,h=r*B,w.x-=D*l,w.y-=D*h,b-=S*(t.rA.x*h-t.rA.y*l),C.x+=T*l,C.y+=T*h,g+=A*(t.rB.x*h-t.rB.y*l),t.normalImpulse=a;else{var R=y.points[0],O=y.points[1],L=R.normalImpulse,F=O.normalImpulse,V=(C.x-g*R.rB.y-w.x+b*R.rA.y)*M+(C.y+g*R.rB.x-w.y-b*R.rA.x)*B,N=(C.x-g*O.rB.y-w.x+b*O.rA.y)*M+(C.y+g*O.rB.x-w.y-b*O.rA.x)*B,k=V-R.velocityBias,G=N-O.velocityBias;k-=(e=y.K).col1.x*L+e.col2.x*F,G-=e.col1.y*L+e.col2.y*F;for(;;){var j=-((e=y.normalMass).col1.x*k+e.col2.x*G),U=-(e.col1.y*k+e.col2.y*G);if(0<=j&&0<=U){p=(u=j-L)*M,m=u*B,f=(c=U-F)*M,d=c*B,w.x-=D*(p+f),w.y-=D*(m+d),b-=S*(R.rA.x*m-R.rA.y*p+O.rA.x*d-O.rA.y*f),C.x+=T*(p+f),C.y+=T*(m+d),g+=A*(R.rB.x*m-R.rB.y*p+O.rB.x*d-O.rB.y*f),R.normalImpulse=j,O.normalImpulse=U;break}if(j=-R.normalMass*k,V=U=0,N=y.K.col1.y*j+G,0<=j&&0<=N){p=(u=j-L)*M,m=u*B,f=(c=U-F)*M,d=c*B,w.x-=D*(p+f),w.y-=D*(m+d),b-=S*(R.rA.x*m-R.rA.y*p+O.rA.x*d-O.rA.y*f),C.x+=T*(p+f),C.y+=T*(m+d),g+=A*(R.rB.x*m-R.rB.y*p+O.rB.x*d-O.rB.y*f),R.normalImpulse=j,O.normalImpulse=U;break}if(j=0,U=-O.normalMass*G,V=y.K.col2.x*U+k,(N=0)<=U&&0<=V){p=(u=j-L)*M,m=u*B,f=(c=U-F)*M,d=c*B,w.x-=D*(p+f),w.y-=D*(m+d),b-=S*(R.rA.x*m-R.rA.y*p+O.rA.x*d-O.rA.y*f),C.x+=T*(p+f),C.y+=T*(m+d),g+=A*(R.rB.x*m-R.rB.y*p+O.rB.x*d-O.rB.y*f),R.normalImpulse=j,O.normalImpulse=U;break}if(N=G,(U=j=0)<=(V=k)&&0<=N){p=(u=j-L)*M,m=u*B,f=(c=U-F)*M,d=c*B,w.x-=D*(p+f),w.y-=D*(m+d),b-=S*(R.rA.x*m-R.rA.y*p+O.rA.x*d-O.rA.y*f),C.x+=T*(p+f),C.y+=T*(m+d),g+=A*(R.rB.x*m-R.rB.y*p+O.rB.x*d-O.rB.y*f),R.normalImpulse=j,O.normalImpulse=U;break}break}}x.m_angularVelocity=b,v.m_angularVelocity=g}},ot.prototype.FinalizeVelocityConstraints=function(){for(var t=0;t<this.m_constraintCount;++t)for(var e=this.m_constraints[t],i=e.manifold,n=0;n<e.pointCount;++n){var o=i.m_points[n],r=e.points[n];o.m_normalImpulse=r.normalImpulse,o.m_tangentImpulse=r.tangentImpulse}},ot.prototype.SolvePositionConstraints=function(t){void 0===t&&(t=0);for(var e=0,i=0;i<this.m_constraintCount;i++){var n=this.m_constraints[i],o=n.bodyA,r=n.bodyB,s=o.m_mass*o.m_invMass,a=o.m_mass*o.m_invI,l=r.m_mass*r.m_invMass,h=r.m_mass*r.m_invI;ot.s_psm.Initialize(n);for(var u=ot.s_psm.m_normal,c=0;c<n.pointCount;c++){var p=n.points[c],m=ot.s_psm.m_points[c],f=ot.s_psm.m_separations[c],d=m.x-o.m_sweep.c.x,_=m.y-o.m_sweep.c.y,y=m.x-r.m_sweep.c.x,x=m.y-r.m_sweep.c.y;e=e<f?e:f;var v=J.Clamp(t*(f+rt.b2_linearSlop),-rt.b2_maxLinearCorrection,0),b=-p.equalizedMass*v,g=b*u.x,w=b*u.y;o.m_sweep.c.x-=s*g,o.m_sweep.c.y-=s*w,o.m_sweep.a-=a*(d*w-_*g),o.SynchronizeTransform(),r.m_sweep.c.x+=l*g,r.m_sweep.c.y+=l*w,r.m_sweep.a+=h*(y*w-x*g),r.SynchronizeTransform()}}return e>-1.5*rt.b2_linearSlop},Box2D.postDefs.push(function(){Box2D.Dynamics.Contacts.b2ContactSolver.s_worldManifold=new T,Box2D.Dynamics.Contacts.b2ContactSolver.s_psm=new f}),Box2D.inherit(h,Box2D.Dynamics.Contacts.b2Contact),h.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype,h.b2EdgeAndCircleContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)},h.Create=function(t){return new h},h.Destroy=function(t,e){},h.prototype.Reset=function(t,e){this.__super.Reset.call(this,t,e)},h.prototype.Evaluate=function(){var t=this.m_fixtureA.GetBody(),e=this.m_fixtureB.GetBody();this.b2CollideEdgeAndCircle(this.m_manifold,this.m_fixtureA.GetShape()instanceof n?this.m_fixtureA.GetShape():null,t.m_xf,this.m_fixtureB.GetShape()instanceof i?this.m_fixtureB.GetShape():null,e.m_xf)},h.prototype.b2CollideEdgeAndCircle=function(t,e,i,n,o){},Box2D.inherit(u,Box2D.Dynamics.Contacts.b2Contact),u.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype,u.b2NullContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)},u.prototype.b2NullContact=function(){this.__super.b2Contact.call(this)},u.prototype.Evaluate=function(){},Box2D.inherit(c,Box2D.Dynamics.Contacts.b2Contact),c.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype,c.b2PolyAndCircleContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)},c.Create=function(t){return new c},c.Destroy=function(t,e){},c.prototype.Reset=function(t,e){this.__super.Reset.call(this,t,e),rt.b2Assert(t.GetType()==_.e_polygonShape),rt.b2Assert(e.GetType()==_.e_circleShape)},c.prototype.Evaluate=function(){var t=this.m_fixtureA.m_body,e=this.m_fixtureB.m_body;g.CollidePolygonAndCircle(this.m_manifold,this.m_fixtureA.GetShape()instanceof o?this.m_fixtureA.GetShape():null,t.m_xf,this.m_fixtureB.GetShape()instanceof i?this.m_fixtureB.GetShape():null,e.m_xf)},Box2D.inherit(p,Box2D.Dynamics.Contacts.b2Contact),p.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype,p.b2PolyAndEdgeContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)},p.Create=function(t){return new p},p.Destroy=function(t,e){},p.prototype.Reset=function(t,e){this.__super.Reset.call(this,t,e),rt.b2Assert(t.GetType()==_.e_polygonShape),rt.b2Assert(e.GetType()==_.e_edgeShape)},p.prototype.Evaluate=function(){var t=this.m_fixtureA.GetBody(),e=this.m_fixtureB.GetBody();this.b2CollidePolyAndEdge(this.m_manifold,this.m_fixtureA.GetShape()instanceof o?this.m_fixtureA.GetShape():null,t.m_xf,this.m_fixtureB.GetShape()instanceof n?this.m_fixtureB.GetShape():null,e.m_xf)},p.prototype.b2CollidePolyAndEdge=function(t,e,i,n,o){},Box2D.inherit(m,Box2D.Dynamics.Contacts.b2Contact),m.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype,m.b2PolygonContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)},m.Create=function(t){return new m},m.Destroy=function(t,e){},m.prototype.Reset=function(t,e){this.__super.Reset.call(this,t,e)},m.prototype.Evaluate=function(){var t=this.m_fixtureA.GetBody(),e=this.m_fixtureB.GetBody();g.CollidePolygons(this.m_manifold,this.m_fixtureA.GetShape()instanceof o?this.m_fixtureA.GetShape():null,t.m_xf,this.m_fixtureB.GetShape()instanceof o?this.m_fixtureB.GetShape():null,e.m_xf)},f.b2PositionSolverManifold=function(){},f.prototype.b2PositionSolverManifold=function(){this.m_normal=new b,this.m_separations=new Vector_a2j_Number(rt.b2_maxManifoldPoints),this.m_points=new Vector(rt.b2_maxManifoldPoints);for(var t=0;t<rt.b2_maxManifoldPoints;t++)this.m_points[t]=new b},f.prototype.Initialize=function(t){rt.b2Assert(0<t.pointCount);var e,i,n=0,o=0,r=0,s=0,a=0;switch(t.type){case C.e_circles:e=t.bodyA.m_xf.R,i=t.localPoint;var l=t.bodyA.m_xf.position.x+(e.col1.x*i.x+e.col2.x*i.y),h=t.bodyA.m_xf.position.y+(e.col1.y*i.x+e.col2.y*i.y);e=t.bodyB.m_xf.R,i=t.points[0].localPoint;var u=t.bodyB.m_xf.position.x+(e.col1.x*i.x+e.col2.x*i.y),c=t.bodyB.m_xf.position.y+(e.col1.y*i.x+e.col2.y*i.y),p=u-l,m=c-h,f=p*p+m*m;if(f>Number.MIN_VALUE*Number.MIN_VALUE){var d=Math.sqrt(f);this.m_normal.x=p/d,this.m_normal.y=m/d}else this.m_normal.x=1,this.m_normal.y=0;this.m_points[0].x=.5*(l+u),this.m_points[0].y=.5*(h+c),this.m_separations[0]=p*this.m_normal.x+m*this.m_normal.y-t.radius;break;case C.e_faceA:for(e=t.bodyA.m_xf.R,i=t.localPlaneNormal,this.m_normal.x=e.col1.x*i.x+e.col2.x*i.y,this.m_normal.y=e.col1.y*i.x+e.col2.y*i.y,e=t.bodyA.m_xf.R,i=t.localPoint,s=t.bodyA.m_xf.position.x+(e.col1.x*i.x+e.col2.x*i.y),a=t.bodyA.m_xf.position.y+(e.col1.y*i.x+e.col2.y*i.y),e=t.bodyB.m_xf.R,n=0;n<t.pointCount;++n)i=t.points[n].localPoint,o=t.bodyB.m_xf.position.x+(e.col1.x*i.x+e.col2.x*i.y),r=t.bodyB.m_xf.position.y+(e.col1.y*i.x+e.col2.y*i.y),this.m_separations[n]=(o-s)*this.m_normal.x+(r-a)*this.m_normal.y-t.radius,this.m_points[n].x=o,this.m_points[n].y=r;break;case C.e_faceB:for(e=t.bodyB.m_xf.R,i=t.localPlaneNormal,this.m_normal.x=e.col1.x*i.x+e.col2.x*i.y,this.m_normal.y=e.col1.y*i.x+e.col2.y*i.y,e=t.bodyB.m_xf.R,i=t.localPoint,s=t.bodyB.m_xf.position.x+(e.col1.x*i.x+e.col2.x*i.y),a=t.bodyB.m_xf.position.y+(e.col1.y*i.x+e.col2.y*i.y),e=t.bodyA.m_xf.R,n=0;n<t.pointCount;++n)i=t.points[n].localPoint,o=t.bodyA.m_xf.position.x+(e.col1.x*i.x+e.col2.x*i.y),r=t.bodyA.m_xf.position.y+(e.col1.y*i.x+e.col2.y*i.y),this.m_separations[n]=(o-s)*this.m_normal.x+(r-a)*this.m_normal.y-t.radius,this.m_points[n].Set(o,r);this.m_normal.x*=-1,this.m_normal.y*=-1}},Box2D.postDefs.push(function(){Box2D.Dynamics.Contacts.b2PositionSolverManifold.circlePointA=new b,Box2D.Dynamics.Contacts.b2PositionSolverManifold.circlePointB=new b})}(),function(){Box2D.Dynamics.b2Body,Box2D.Dynamics.b2BodyDef,Box2D.Dynamics.b2ContactFilter,Box2D.Dynamics.b2ContactImpulse,Box2D.Dynamics.b2ContactListener,Box2D.Dynamics.b2ContactManager,Box2D.Dynamics.b2DebugDraw,Box2D.Dynamics.b2DestructionListener,Box2D.Dynamics.b2FilterData,Box2D.Dynamics.b2Fixture,Box2D.Dynamics.b2FixtureDef,Box2D.Dynamics.b2Island,Box2D.Dynamics.b2TimeStep,Box2D.Dynamics.b2World;var t=Box2D.Common.Math.b2Mat22,r=(Box2D.Common.Math.b2Mat33,Box2D.Common.Math.b2Math),m=(Box2D.Common.Math.b2Sweep,Box2D.Common.Math.b2Transform,Box2D.Common.Math.b2Vec2),o=(Box2D.Common.Math.b2Vec3,Box2D.Common.b2Color),e=(Box2D.Common.b2internal,Box2D.Common.b2Settings,Box2D.Collision.Shapes.b2CircleShape,Box2D.Collision.Shapes.b2EdgeChainDef,Box2D.Collision.Shapes.b2EdgeShape,Box2D.Collision.Shapes.b2MassData,Box2D.Collision.Shapes.b2PolygonShape,Box2D.Collision.Shapes.b2Shape,Box2D.Dynamics.Controllers.b2BuoyancyController),i=Box2D.Dynamics.Controllers.b2ConstantAccelController,n=Box2D.Dynamics.Controllers.b2ConstantForceController,s=Box2D.Dynamics.Controllers.b2Controller,a=Box2D.Dynamics.Controllers.b2ControllerEdge,l=Box2D.Dynamics.Controllers.b2GravityController,h=Box2D.Dynamics.Controllers.b2TensorDampingController;Box2D.inherit(e,Box2D.Dynamics.Controllers.b2Controller),e.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype,e.b2BuoyancyController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments),this.normal=new m(0,-1),this.offset=0,this.density=0,this.velocity=new m(0,0),this.linearDrag=2,this.angularDrag=1,this.useDensity=!1,this.useWorldGravity=!0,this.gravity=null},e.prototype.Step=function(t){if(this.m_bodyList){this.useWorldGravity&&(this.gravity=this.GetWorld().GetGravity().Copy());for(var e=this.m_bodyList;e;e=e.nextBody){var i=e.body;if(0!=i.IsAwake()){for(var n=new m,o=new m,r=0,s=0,a=i.GetFixtureList();a;a=a.GetNext()){var l=new m,h=a.GetShape().ComputeSubmergedArea(this.normal,this.offset,i.GetTransform(),l);r+=h,n.x+=h*l.x,n.y+=h*l.y;var u=0;s+=h*(u=(this.useDensity,1)),o.x+=h*l.x*u,o.y+=h*l.y*u}if(n.x/=r,n.y/=r,o.x/=s,o.y/=s,!(r<Number.MIN_VALUE)){var c=this.gravity.GetNegative();c.Multiply(this.density*r),i.ApplyForce(c,o);var p=i.GetLinearVelocityFromWorldPoint(n);p.Subtract(this.velocity),p.Multiply(-this.linearDrag*r),i.ApplyForce(p,n),i.ApplyTorque(-i.GetInertia()/i.GetMass()*r*i.GetAngularVelocity()*this.angularDrag)}}}}},e.prototype.Draw=function(t){var e=new m,i=new m;e.x=this.normal.x*this.offset+1e3*this.normal.y,e.y=this.normal.y*this.offset-1e3*this.normal.x,i.x=this.normal.x*this.offset-1e3*this.normal.y,i.y=this.normal.y*this.offset+1e3*this.normal.x;var n=new o(0,0,1);t.DrawSegment(e,i,n)},Box2D.inherit(i,Box2D.Dynamics.Controllers.b2Controller),i.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype,i.b2ConstantAccelController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments),this.A=new m(0,0)},i.prototype.Step=function(t){for(var e=new m(this.A.x*t.dt,this.A.y*t.dt),i=this.m_bodyList;i;i=i.nextBody){var n=i.body;n.IsAwake()&&n.SetLinearVelocity(new m(n.GetLinearVelocity().x+e.x,n.GetLinearVelocity().y+e.y))}},Box2D.inherit(n,Box2D.Dynamics.Controllers.b2Controller),n.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype,n.b2ConstantForceController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments),this.F=new m(0,0)},n.prototype.Step=function(t){for(var e=this.m_bodyList;e;e=e.nextBody){var i=e.body;i.IsAwake()&&i.ApplyForce(this.F,i.GetWorldCenter())}},s.b2Controller=function(){},s.prototype.Step=function(t){},s.prototype.Draw=function(t){},s.prototype.AddBody=function(t){var e=new a;e.controller=this,e.body=t,e.nextBody=this.m_bodyList,e.prevBody=null,(this.m_bodyList=e).nextBody&&(e.nextBody.prevBody=e),this.m_bodyCount++,e.nextController=t.m_controllerList,e.prevController=null,(t.m_controllerList=e).nextController&&(e.nextController.prevController=e),t.m_controllerCount++},s.prototype.RemoveBody=function(t){for(var e=t.m_controllerList;e&&e.controller!=this;)e=e.nextController;e.prevBody&&(e.prevBody.nextBody=e.nextBody),e.nextBody&&(e.nextBody.prevBody=e.prevBody),e.nextController&&(e.nextController.prevController=e.prevController),e.prevController&&(e.prevController.nextController=e.nextController),this.m_bodyList==e&&(this.m_bodyList=e.nextBody),t.m_controllerList==e&&(t.m_controllerList=e.nextController),t.m_controllerCount--,this.m_bodyCount--},s.prototype.Clear=function(){for(;this.m_bodyList;)this.RemoveBody(this.m_bodyList.body)},s.prototype.GetNext=function(){return this.m_next},s.prototype.GetWorld=function(){return this.m_world},s.prototype.GetBodyList=function(){return this.m_bodyList},a.b2ControllerEdge=function(){},Box2D.inherit(l,Box2D.Dynamics.Controllers.b2Controller),l.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype,l.b2GravityController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments),this.G=1,this.invSqr=!0},l.prototype.Step=function(t){var e=null,i=null,n=null,o=0,r=null,s=null,a=null,l=0,h=0,u=0,c=null;if(this.invSqr)for(e=this.m_bodyList;e;e=e.nextBody)for(n=(i=e.body).GetWorldCenter(),o=i.GetMass(),r=this.m_bodyList;r!=e;r=r.nextBody)(u=(l=(a=(s=r.body).GetWorldCenter()).x-n.x)*l+(h=a.y-n.y)*h)<Number.MIN_VALUE||((c=new m(l,h)).Multiply(this.G/u/Math.sqrt(u)*o*s.GetMass()),i.IsAwake()&&i.ApplyForce(c,n),c.Multiply(-1),s.IsAwake()&&s.ApplyForce(c,a));else for(e=this.m_bodyList;e;e=e.nextBody)for(n=(i=e.body).GetWorldCenter(),o=i.GetMass(),r=this.m_bodyList;r!=e;r=r.nextBody)(u=(l=(a=(s=r.body).GetWorldCenter()).x-n.x)*l+(h=a.y-n.y)*h)<Number.MIN_VALUE||((c=new m(l,h)).Multiply(this.G/u*o*s.GetMass()),i.IsAwake()&&i.ApplyForce(c,n),c.Multiply(-1),s.IsAwake()&&s.ApplyForce(c,a))},Box2D.inherit(h,Box2D.Dynamics.Controllers.b2Controller),h.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype,h.b2TensorDampingController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments),this.T=new t,this.maxTimestep=0},h.prototype.SetAxisAligned=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.T.col1.x=-t,this.T.col1.y=0,this.T.col2.x=0,this.T.col2.y=-e,this.maxTimestep=0<t||0<e?1/Math.max(t,e):0},h.prototype.Step=function(t){var e=t.dt;if(!(e<=Number.MIN_VALUE)){e>this.maxTimestep&&0<this.maxTimestep&&(e=this.maxTimestep);for(var i=this.m_bodyList;i;i=i.nextBody){var n=i.body;if(n.IsAwake()){var o=n.GetWorldVector(r.MulMV(this.T,n.GetLocalVector(n.GetLinearVelocity())));n.SetLinearVelocity(new m(n.GetLinearVelocity().x+o.x*e,n.GetLinearVelocity().y+o.y*e))}}}}}(),function(){Box2D.Common.b2Color,Box2D.Common.b2internal;var V=Box2D.Common.b2Settings,N=Box2D.Common.Math.b2Mat22,e=Box2D.Common.Math.b2Mat33,k=Box2D.Common.Math.b2Math,G=(Box2D.Common.Math.b2Sweep,Box2D.Common.Math.b2Transform,Box2D.Common.Math.b2Vec2),j=Box2D.Common.Math.b2Vec3,n=Box2D.Dynamics.Joints.b2DistanceJoint,o=Box2D.Dynamics.Joints.b2DistanceJointDef,r=Box2D.Dynamics.Joints.b2FrictionJoint,s=Box2D.Dynamics.Joints.b2FrictionJointDef,a=Box2D.Dynamics.Joints.b2GearJoint,l=Box2D.Dynamics.Joints.b2GearJointDef,t=Box2D.Dynamics.Joints.b2Jacobian,T=Box2D.Dynamics.Joints.b2Joint,i=Box2D.Dynamics.Joints.b2JointDef,h=Box2D.Dynamics.Joints.b2JointEdge,u=Box2D.Dynamics.Joints.b2LineJoint,c=Box2D.Dynamics.Joints.b2LineJointDef,p=Box2D.Dynamics.Joints.b2MouseJoint,m=Box2D.Dynamics.Joints.b2MouseJointDef,f=Box2D.Dynamics.Joints.b2PrismaticJoint,d=Box2D.Dynamics.Joints.b2PrismaticJointDef,_=Box2D.Dynamics.Joints.b2PulleyJoint,y=Box2D.Dynamics.Joints.b2PulleyJointDef,A=Box2D.Dynamics.Joints.b2RevoluteJoint,x=Box2D.Dynamics.Joints.b2RevoluteJointDef,v=Box2D.Dynamics.Joints.b2WeldJoint,b=Box2D.Dynamics.Joints.b2WeldJointDef;Box2D.Dynamics.b2Body,Box2D.Dynamics.b2BodyDef,Box2D.Dynamics.b2ContactFilter,Box2D.Dynamics.b2ContactImpulse,Box2D.Dynamics.b2ContactListener,Box2D.Dynamics.b2ContactManager,Box2D.Dynamics.b2DebugDraw,Box2D.Dynamics.b2DestructionListener,Box2D.Dynamics.b2FilterData,Box2D.Dynamics.b2Fixture,Box2D.Dynamics.b2FixtureDef,Box2D.Dynamics.b2Island,Box2D.Dynamics.b2TimeStep,Box2D.Dynamics.b2World;Box2D.inherit(n,Box2D.Dynamics.Joints.b2Joint),n.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,n.b2DistanceJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_localAnchor1=new G,this.m_localAnchor2=new G,this.m_u=new G},n.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},n.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},n.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new G(t*this.m_impulse*this.m_u.x,t*this.m_impulse*this.m_u.y)},n.prototype.GetReactionTorque=function(t){return void 0===t&&(t=0),0},n.prototype.GetLength=function(){return this.m_length},n.prototype.SetLength=function(t){void 0===t&&(t=0),this.m_length=t},n.prototype.GetFrequency=function(){return this.m_frequencyHz},n.prototype.SetFrequency=function(t){void 0===t&&(t=0),this.m_frequencyHz=t},n.prototype.GetDampingRatio=function(){return this.m_dampingRatio},n.prototype.SetDampingRatio=function(t){void 0===t&&(t=0),this.m_dampingRatio=t},n.prototype.b2DistanceJoint=function(t){this.__super.b2Joint.call(this,t);this.m_localAnchor1.SetV(t.localAnchorA),this.m_localAnchor2.SetV(t.localAnchorB),this.m_length=t.length,this.m_frequencyHz=t.frequencyHz,this.m_dampingRatio=t.dampingRatio,this.m_impulse=0,this.m_gamma=0,this.m_bias=0},n.prototype.InitVelocityConstraints=function(t){var e,i=0,n=this.m_bodyA,o=this.m_bodyB;e=n.m_xf.R;var r=this.m_localAnchor1.x-n.m_sweep.localCenter.x,s=this.m_localAnchor1.y-n.m_sweep.localCenter.y;i=e.col1.x*r+e.col2.x*s,s=e.col1.y*r+e.col2.y*s,r=i,e=o.m_xf.R;var a=this.m_localAnchor2.x-o.m_sweep.localCenter.x,l=this.m_localAnchor2.y-o.m_sweep.localCenter.y;i=e.col1.x*a+e.col2.x*l,l=e.col1.y*a+e.col2.y*l,a=i,this.m_u.x=o.m_sweep.c.x+a-n.m_sweep.c.x-r,this.m_u.y=o.m_sweep.c.y+l-n.m_sweep.c.y-s;var h=Math.sqrt(this.m_u.x*this.m_u.x+this.m_u.y*this.m_u.y);h>V.b2_linearSlop?this.m_u.Multiply(1/h):this.m_u.SetZero();var u=r*this.m_u.y-s*this.m_u.x,c=a*this.m_u.y-l*this.m_u.x,p=n.m_invMass+n.m_invI*u*u+o.m_invMass+o.m_invI*c*c;if(this.m_mass=0!=p?1/p:0,0<this.m_frequencyHz){var m=h-this.m_length,f=2*Math.PI*this.m_frequencyHz,d=2*this.m_mass*this.m_dampingRatio*f,_=this.m_mass*f*f;this.m_gamma=t.dt*(d+t.dt*_),this.m_gamma=0!=this.m_gamma?1/this.m_gamma:0,this.m_bias=m*t.dt*_*this.m_gamma,this.m_mass=p+this.m_gamma,this.m_mass=0!=this.m_mass?1/this.m_mass:0}if(t.warmStarting){this.m_impulse*=t.dtRatio;var y=this.m_impulse*this.m_u.x,x=this.m_impulse*this.m_u.y;n.m_linearVelocity.x-=n.m_invMass*y,n.m_linearVelocity.y-=n.m_invMass*x,n.m_angularVelocity-=n.m_invI*(r*x-s*y),o.m_linearVelocity.x+=o.m_invMass*y,o.m_linearVelocity.y+=o.m_invMass*x,o.m_angularVelocity+=o.m_invI*(a*x-l*y)}else this.m_impulse=0},n.prototype.SolveVelocityConstraints=function(t){var e,i=this.m_bodyA,n=this.m_bodyB;e=i.m_xf.R;var o=this.m_localAnchor1.x-i.m_sweep.localCenter.x,r=this.m_localAnchor1.y-i.m_sweep.localCenter.y,s=e.col1.x*o+e.col2.x*r;r=e.col1.y*o+e.col2.y*r,o=s,e=n.m_xf.R;var a=this.m_localAnchor2.x-n.m_sweep.localCenter.x,l=this.m_localAnchor2.y-n.m_sweep.localCenter.y;s=e.col1.x*a+e.col2.x*l,l=e.col1.y*a+e.col2.y*l,a=s;var h=i.m_linearVelocity.x+-i.m_angularVelocity*r,u=i.m_linearVelocity.y+i.m_angularVelocity*o,c=n.m_linearVelocity.x+-n.m_angularVelocity*l,p=n.m_linearVelocity.y+n.m_angularVelocity*a,m=this.m_u.x*(c-h)+this.m_u.y*(p-u),f=-this.m_mass*(m+this.m_bias+this.m_gamma*this.m_impulse);this.m_impulse+=f;var d=f*this.m_u.x,_=f*this.m_u.y;i.m_linearVelocity.x-=i.m_invMass*d,i.m_linearVelocity.y-=i.m_invMass*_,i.m_angularVelocity-=i.m_invI*(o*_-r*d),n.m_linearVelocity.x+=n.m_invMass*d,n.m_linearVelocity.y+=n.m_invMass*_,n.m_angularVelocity+=n.m_invI*(a*_-l*d)},n.prototype.SolvePositionConstraints=function(t){var e;if(void 0===t&&(t=0),0<this.m_frequencyHz)return!0;var i=this.m_bodyA,n=this.m_bodyB;e=i.m_xf.R;var o=this.m_localAnchor1.x-i.m_sweep.localCenter.x,r=this.m_localAnchor1.y-i.m_sweep.localCenter.y,s=e.col1.x*o+e.col2.x*r;r=e.col1.y*o+e.col2.y*r,o=s,e=n.m_xf.R;var a=this.m_localAnchor2.x-n.m_sweep.localCenter.x,l=this.m_localAnchor2.y-n.m_sweep.localCenter.y;s=e.col1.x*a+e.col2.x*l,l=e.col1.y*a+e.col2.y*l,a=s;var h=n.m_sweep.c.x+a-i.m_sweep.c.x-o,u=n.m_sweep.c.y+l-i.m_sweep.c.y-r,c=Math.sqrt(h*h+u*u);h/=c,u/=c;var p=c-this.m_length;p=k.Clamp(p,-V.b2_maxLinearCorrection,V.b2_maxLinearCorrection);var m=-this.m_mass*p;this.m_u.Set(h,u);var f=m*this.m_u.x,d=m*this.m_u.y;return i.m_sweep.c.x-=i.m_invMass*f,i.m_sweep.c.y-=i.m_invMass*d,i.m_sweep.a-=i.m_invI*(o*d-r*f),n.m_sweep.c.x+=n.m_invMass*f,n.m_sweep.c.y+=n.m_invMass*d,n.m_sweep.a+=n.m_invI*(a*d-l*f),i.SynchronizeTransform(),n.SynchronizeTransform(),k.Abs(p)<V.b2_linearSlop},Box2D.inherit(o,Box2D.Dynamics.Joints.b2JointDef),o.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,o.b2DistanceJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.localAnchorA=new G,this.localAnchorB=new G},o.prototype.b2DistanceJointDef=function(){this.__super.b2JointDef.call(this),this.type=T.e_distanceJoint,this.length=1,this.frequencyHz=0,this.dampingRatio=0},o.prototype.Initialize=function(t,e,i,n){this.bodyA=t,this.bodyB=e,this.localAnchorA.SetV(this.bodyA.GetLocalPoint(i)),this.localAnchorB.SetV(this.bodyB.GetLocalPoint(n));var o=n.x-i.x,r=n.y-i.y;this.length=Math.sqrt(o*o+r*r),this.frequencyHz=0,this.dampingRatio=0},Box2D.inherit(r,Box2D.Dynamics.Joints.b2Joint),r.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,r.b2FrictionJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_localAnchorA=new G,this.m_localAnchorB=new G,this.m_linearMass=new N,this.m_linearImpulse=new G},r.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA)},r.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB)},r.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new G(t*this.m_linearImpulse.x,t*this.m_linearImpulse.y)},r.prototype.GetReactionTorque=function(t){return void 0===t&&(t=0),t*this.m_angularImpulse},r.prototype.SetMaxForce=function(t){void 0===t&&(t=0),this.m_maxForce=t},r.prototype.GetMaxForce=function(){return this.m_maxForce},r.prototype.SetMaxTorque=function(t){void 0===t&&(t=0),this.m_maxTorque=t},r.prototype.GetMaxTorque=function(){return this.m_maxTorque},r.prototype.b2FrictionJoint=function(t){this.__super.b2Joint.call(this,t),this.m_localAnchorA.SetV(t.localAnchorA),this.m_localAnchorB.SetV(t.localAnchorB),this.m_linearMass.SetZero(),this.m_angularMass=0,this.m_linearImpulse.SetZero(),this.m_angularImpulse=0,this.m_maxForce=t.maxForce,this.m_maxTorque=t.maxTorque},r.prototype.InitVelocityConstraints=function(t){var e,i=0,n=this.m_bodyA,o=this.m_bodyB;e=n.m_xf.R;var r=this.m_localAnchorA.x-n.m_sweep.localCenter.x,s=this.m_localAnchorA.y-n.m_sweep.localCenter.y;i=e.col1.x*r+e.col2.x*s,s=e.col1.y*r+e.col2.y*s,r=i,e=o.m_xf.R;var a=this.m_localAnchorB.x-o.m_sweep.localCenter.x,l=this.m_localAnchorB.y-o.m_sweep.localCenter.y;i=e.col1.x*a+e.col2.x*l,l=e.col1.y*a+e.col2.y*l,a=i;var h=n.m_invMass,u=o.m_invMass,c=n.m_invI,p=o.m_invI,m=new N;if(m.col1.x=h+u,m.col2.x=0,m.col1.y=0,m.col2.y=h+u,m.col1.x+=c*s*s,m.col2.x+=-c*r*s,m.col1.y+=-c*r*s,m.col2.y+=c*r*r,m.col1.x+=p*l*l,m.col2.x+=-p*a*l,m.col1.y+=-p*a*l,m.col2.y+=p*a*a,m.GetInverse(this.m_linearMass),this.m_angularMass=c+p,0<this.m_angularMass&&(this.m_angularMass=1/this.m_angularMass),t.warmStarting){this.m_linearImpulse.x*=t.dtRatio,this.m_linearImpulse.y*=t.dtRatio,this.m_angularImpulse*=t.dtRatio;var f=this.m_linearImpulse;n.m_linearVelocity.x-=h*f.x,n.m_linearVelocity.y-=h*f.y,n.m_angularVelocity-=c*(r*f.y-s*f.x+this.m_angularImpulse),o.m_linearVelocity.x+=u*f.x,o.m_linearVelocity.y+=u*f.y,o.m_angularVelocity+=p*(a*f.y-l*f.x+this.m_angularImpulse)}else this.m_linearImpulse.SetZero(),this.m_angularImpulse=0},r.prototype.SolveVelocityConstraints=function(t){var e,i=0,n=this.m_bodyA,o=this.m_bodyB,r=n.m_linearVelocity,s=n.m_angularVelocity,a=o.m_linearVelocity,l=o.m_angularVelocity,h=n.m_invMass,u=o.m_invMass,c=n.m_invI,p=o.m_invI;e=n.m_xf.R;var m=this.m_localAnchorA.x-n.m_sweep.localCenter.x,f=this.m_localAnchorA.y-n.m_sweep.localCenter.y;i=e.col1.x*m+e.col2.x*f,f=e.col1.y*m+e.col2.y*f,m=i,e=o.m_xf.R;var d=this.m_localAnchorB.x-o.m_sweep.localCenter.x,_=this.m_localAnchorB.y-o.m_sweep.localCenter.y;i=e.col1.x*d+e.col2.x*_,_=e.col1.y*d+e.col2.y*_,d=i;var y=0,x=l-s,v=-this.m_angularMass*x,b=this.m_angularImpulse;y=t.dt*this.m_maxTorque,this.m_angularImpulse=k.Clamp(this.m_angularImpulse+v,-y,y),s-=c*(v=this.m_angularImpulse-b),l+=p*v;var g=a.x-l*_-r.x+s*f,w=a.y+l*d-r.y-s*m,C=k.MulMV(this.m_linearMass,new G(-g,-w)),D=this.m_linearImpulse.Copy();this.m_linearImpulse.Add(C),y=t.dt*this.m_maxForce,this.m_linearImpulse.LengthSquared()>y*y&&(this.m_linearImpulse.Normalize(),this.m_linearImpulse.Multiply(y)),C=k.SubtractVV(this.m_linearImpulse,D),r.x-=h*C.x,r.y-=h*C.y,s-=c*(m*C.y-f*C.x),a.x+=u*C.x,a.y+=u*C.y,l+=p*(d*C.y-_*C.x),n.m_angularVelocity=s,o.m_angularVelocity=l},r.prototype.SolvePositionConstraints=function(t){return void 0===t&&(t=0),!0},Box2D.inherit(s,Box2D.Dynamics.Joints.b2JointDef),s.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,s.b2FrictionJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.localAnchorA=new G,this.localAnchorB=new G},s.prototype.b2FrictionJointDef=function(){this.__super.b2JointDef.call(this),this.type=T.e_frictionJoint,this.maxForce=0,this.maxTorque=0},s.prototype.Initialize=function(t,e,i){this.bodyA=t,this.bodyB=e,this.localAnchorA.SetV(this.bodyA.GetLocalPoint(i)),this.localAnchorB.SetV(this.bodyB.GetLocalPoint(i))},Box2D.inherit(a,Box2D.Dynamics.Joints.b2Joint),a.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,a.b2GearJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_groundAnchor1=new G,this.m_groundAnchor2=new G,this.m_localAnchor1=new G,this.m_localAnchor2=new G,this.m_J=new t},a.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},a.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},a.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new G(t*this.m_impulse*this.m_J.linearB.x,t*this.m_impulse*this.m_J.linearB.y)},a.prototype.GetReactionTorque=function(t){void 0===t&&(t=0);var e=this.m_bodyB.m_xf.R,i=this.m_localAnchor1.x-this.m_bodyB.m_sweep.localCenter.x,n=this.m_localAnchor1.y-this.m_bodyB.m_sweep.localCenter.y,o=e.col1.x*i+e.col2.x*n;n=e.col1.y*i+e.col2.y*n,i=o;var r=this.m_impulse*this.m_J.linearB.x,s=this.m_impulse*this.m_J.linearB.y;return t*(this.m_impulse*this.m_J.angularB-i*s+n*r)},a.prototype.GetRatio=function(){return this.m_ratio},a.prototype.SetRatio=function(t){void 0===t&&(t=0),this.m_ratio=t},a.prototype.b2GearJoint=function(t){this.__super.b2Joint.call(this,t);var e=parseInt(t.joint1.m_type),i=parseInt(t.joint2.m_type);this.m_revolute1=null,this.m_prismatic1=null,this.m_revolute2=null,this.m_prismatic2=null;var n=0,o=0;this.m_ground1=t.joint1.GetBodyA(),this.m_bodyA=t.joint1.GetBodyB(),n=e==T.e_revoluteJoint?(this.m_revolute1=t.joint1 instanceof A?t.joint1:null,this.m_groundAnchor1.SetV(this.m_revolute1.m_localAnchor1),this.m_localAnchor1.SetV(this.m_revolute1.m_localAnchor2),this.m_revolute1.GetJointAngle()):(this.m_prismatic1=t.joint1 instanceof f?t.joint1:null,this.m_groundAnchor1.SetV(this.m_prismatic1.m_localAnchor1),this.m_localAnchor1.SetV(this.m_prismatic1.m_localAnchor2),this.m_prismatic1.GetJointTranslation()),this.m_ground2=t.joint2.GetBodyA(),this.m_bodyB=t.joint2.GetBodyB(),o=i==T.e_revoluteJoint?(this.m_revolute2=t.joint2 instanceof A?t.joint2:null,this.m_groundAnchor2.SetV(this.m_revolute2.m_localAnchor1),this.m_localAnchor2.SetV(this.m_revolute2.m_localAnchor2),this.m_revolute2.GetJointAngle()):(this.m_prismatic2=t.joint2 instanceof f?t.joint2:null,this.m_groundAnchor2.SetV(this.m_prismatic2.m_localAnchor1),this.m_localAnchor2.SetV(this.m_prismatic2.m_localAnchor2),this.m_prismatic2.GetJointTranslation()),this.m_ratio=t.ratio,this.m_constant=n+this.m_ratio*o,this.m_impulse=0},a.prototype.InitVelocityConstraints=function(t){var e,i,n=this.m_ground1,o=this.m_ground2,r=this.m_bodyA,s=this.m_bodyB,a=0,l=0,h=0,u=0,c=0,p=0,m=0;this.m_J.SetZero(),this.m_revolute1?(this.m_J.angularA=-1,m+=r.m_invI):(e=n.m_xf.R,i=this.m_prismatic1.m_localXAxis1,a=e.col1.x*i.x+e.col2.x*i.y,l=e.col1.y*i.x+e.col2.y*i.y,e=r.m_xf.R,h=this.m_localAnchor1.x-r.m_sweep.localCenter.x,u=this.m_localAnchor1.y-r.m_sweep.localCenter.y,p=e.col1.x*h+e.col2.x*u,u=e.col1.y*h+e.col2.y*u,c=(h=p)*l-u*a,this.m_J.linearA.Set(-a,-l),this.m_J.angularA=-c,m+=r.m_invMass+r.m_invI*c*c),this.m_revolute2?(this.m_J.angularB=-this.m_ratio,m+=this.m_ratio*this.m_ratio*s.m_invI):(e=o.m_xf.R,i=this.m_prismatic2.m_localXAxis1,a=e.col1.x*i.x+e.col2.x*i.y,l=e.col1.y*i.x+e.col2.y*i.y,e=s.m_xf.R,h=this.m_localAnchor2.x-s.m_sweep.localCenter.x,u=this.m_localAnchor2.y-s.m_sweep.localCenter.y,p=e.col1.x*h+e.col2.x*u,u=e.col1.y*h+e.col2.y*u,c=(h=p)*l-u*a,this.m_J.linearB.Set(-this.m_ratio*a,-this.m_ratio*l),this.m_J.angularB=-this.m_ratio*c,m+=this.m_ratio*this.m_ratio*(s.m_invMass+s.m_invI*c*c)),this.m_mass=0<m?1/m:0,t.warmStarting?(r.m_linearVelocity.x+=r.m_invMass*this.m_impulse*this.m_J.linearA.x,r.m_linearVelocity.y+=r.m_invMass*this.m_impulse*this.m_J.linearA.y,r.m_angularVelocity+=r.m_invI*this.m_impulse*this.m_J.angularA,s.m_linearVelocity.x+=s.m_invMass*this.m_impulse*this.m_J.linearB.x,s.m_linearVelocity.y+=s.m_invMass*this.m_impulse*this.m_J.linearB.y,s.m_angularVelocity+=s.m_invI*this.m_impulse*this.m_J.angularB):this.m_impulse=0},a.prototype.SolveVelocityConstraints=function(t){var e=this.m_bodyA,i=this.m_bodyB,n=this.m_J.Compute(e.m_linearVelocity,e.m_angularVelocity,i.m_linearVelocity,i.m_angularVelocity),o=-this.m_mass*n;this.m_impulse+=o,e.m_linearVelocity.x+=e.m_invMass*o*this.m_J.linearA.x,e.m_linearVelocity.y+=e.m_invMass*o*this.m_J.linearA.y,e.m_angularVelocity+=e.m_invI*o*this.m_J.angularA,i.m_linearVelocity.x+=i.m_invMass*o*this.m_J.linearB.x,i.m_linearVelocity.y+=i.m_invMass*o*this.m_J.linearB.y,i.m_angularVelocity+=i.m_invI*o*this.m_J.angularB},a.prototype.SolvePositionConstraints=function(t){void 0===t&&(t=0);var e=this.m_bodyA,i=this.m_bodyB,n=0,o=0;n=this.m_revolute1?this.m_revolute1.GetJointAngle():this.m_prismatic1.GetJointTranslation(),o=this.m_revolute2?this.m_revolute2.GetJointAngle():this.m_prismatic2.GetJointTranslation();var r=this.m_constant-(n+this.m_ratio*o),s=-this.m_mass*r;return e.m_sweep.c.x+=e.m_invMass*s*this.m_J.linearA.x,e.m_sweep.c.y+=e.m_invMass*s*this.m_J.linearA.y,e.m_sweep.a+=e.m_invI*s*this.m_J.angularA,i.m_sweep.c.x+=i.m_invMass*s*this.m_J.linearB.x,i.m_sweep.c.y+=i.m_invMass*s*this.m_J.linearB.y,i.m_sweep.a+=i.m_invI*s*this.m_J.angularB,e.SynchronizeTransform(),i.SynchronizeTransform(),0<V.b2_linearSlop},Box2D.inherit(l,Box2D.Dynamics.Joints.b2JointDef),l.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,l.b2GearJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments)},l.prototype.b2GearJointDef=function(){this.__super.b2JointDef.call(this),this.type=T.e_gearJoint,this.joint1=null,this.joint2=null,this.ratio=1},t.b2Jacobian=function(){this.linearA=new G,this.linearB=new G},t.prototype.SetZero=function(){this.linearA.SetZero(),this.angularA=0,this.linearB.SetZero(),this.angularB=0},t.prototype.Set=function(t,e,i,n){void 0===e&&(e=0),void 0===n&&(n=0),this.linearA.SetV(t),this.angularA=e,this.linearB.SetV(i),this.angularB=n},t.prototype.Compute=function(t,e,i,n){return void 0===e&&(e=0),void 0===n&&(n=0),this.linearA.x*t.x+this.linearA.y*t.y+this.angularA*e+(this.linearB.x*i.x+this.linearB.y*i.y)+this.angularB*n},T.b2Joint=function(){this.m_edgeA=new h,this.m_edgeB=new h,this.m_localCenterA=new G,this.m_localCenterB=new G},T.prototype.GetType=function(){return this.m_type},T.prototype.GetAnchorA=function(){return null},T.prototype.GetAnchorB=function(){return null},T.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),null},T.prototype.GetReactionTorque=function(t){return void 0===t&&(t=0),0},T.prototype.GetBodyA=function(){return this.m_bodyA},T.prototype.GetBodyB=function(){return this.m_bodyB},T.prototype.GetNext=function(){return this.m_next},T.prototype.GetUserData=function(){return this.m_userData},T.prototype.SetUserData=function(t){this.m_userData=t},T.prototype.IsActive=function(){return this.m_bodyA.IsActive()&&this.m_bodyB.IsActive()},T.Create=function(t,e){var i=null;switch(t.type){case T.e_distanceJoint:i=new n(t instanceof o?t:null);break;case T.e_mouseJoint:i=new p(t instanceof m?t:null);break;case T.e_prismaticJoint:i=new f(t instanceof d?t:null);break;case T.e_revoluteJoint:i=new A(t instanceof x?t:null);break;case T.e_pulleyJoint:i=new _(t instanceof y?t:null);break;case T.e_gearJoint:i=new a(t instanceof l?t:null);break;case T.e_lineJoint:i=new u(t instanceof c?t:null);break;case T.e_weldJoint:i=new v(t instanceof b?t:null);break;case T.e_frictionJoint:i=new r(t instanceof s?t:null)}return i},T.Destroy=function(t,e){},T.prototype.b2Joint=function(t){V.b2Assert(t.bodyA!=t.bodyB),this.m_type=t.type,this.m_prev=null,this.m_next=null,this.m_bodyA=t.bodyA,this.m_bodyB=t.bodyB,this.m_collideConnected=t.collideConnected,this.m_islandFlag=!1,this.m_userData=t.userData},T.prototype.InitVelocityConstraints=function(t){},T.prototype.SolveVelocityConstraints=function(t){},T.prototype.FinalizeVelocityConstraints=function(){},T.prototype.SolvePositionConstraints=function(t){return void 0===t&&(t=0),!1},Box2D.postDefs.push(function(){Box2D.Dynamics.Joints.b2Joint.e_unknownJoint=0,Box2D.Dynamics.Joints.b2Joint.e_revoluteJoint=1,Box2D.Dynamics.Joints.b2Joint.e_prismaticJoint=2,Box2D.Dynamics.Joints.b2Joint.e_distanceJoint=3,Box2D.Dynamics.Joints.b2Joint.e_pulleyJoint=4,Box2D.Dynamics.Joints.b2Joint.e_mouseJoint=5,Box2D.Dynamics.Joints.b2Joint.e_gearJoint=6,Box2D.Dynamics.Joints.b2Joint.e_lineJoint=7,Box2D.Dynamics.Joints.b2Joint.e_weldJoint=8,Box2D.Dynamics.Joints.b2Joint.e_frictionJoint=9,Box2D.Dynamics.Joints.b2Joint.e_inactiveLimit=0,Box2D.Dynamics.Joints.b2Joint.e_atLowerLimit=1,Box2D.Dynamics.Joints.b2Joint.e_atUpperLimit=2,Box2D.Dynamics.Joints.b2Joint.e_equalLimits=3}),i.b2JointDef=function(){},i.prototype.b2JointDef=function(){this.type=T.e_unknownJoint,this.userData=null,this.bodyA=null,this.bodyB=null,this.collideConnected=!1},h.b2JointEdge=function(){},Box2D.inherit(u,Box2D.Dynamics.Joints.b2Joint),u.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,u.b2LineJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_localAnchor1=new G,this.m_localAnchor2=new G,this.m_localXAxis1=new G,this.m_localYAxis1=new G,this.m_axis=new G,this.m_perp=new G,this.m_K=new N,this.m_impulse=new G},u.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},u.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},u.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new G(t*(this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.x),t*(this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.y))},u.prototype.GetReactionTorque=function(t){return void 0===t&&(t=0),t*this.m_impulse.y},u.prototype.GetJointTranslation=function(){var t=this.m_bodyA,e=this.m_bodyB,i=t.GetWorldPoint(this.m_localAnchor1),n=e.GetWorldPoint(this.m_localAnchor2),o=n.x-i.x,r=n.y-i.y,s=t.GetWorldVector(this.m_localXAxis1);return s.x*o+s.y*r},u.prototype.GetJointSpeed=function(){var t,e=this.m_bodyA,i=this.m_bodyB;t=e.m_xf.R;var n=this.m_localAnchor1.x-e.m_sweep.localCenter.x,o=this.m_localAnchor1.y-e.m_sweep.localCenter.y,r=t.col1.x*n+t.col2.x*o;o=t.col1.y*n+t.col2.y*o,n=r,t=i.m_xf.R;var s=this.m_localAnchor2.x-i.m_sweep.localCenter.x,a=this.m_localAnchor2.y-i.m_sweep.localCenter.y;r=t.col1.x*s+t.col2.x*a,a=t.col1.y*s+t.col2.y*a,s=r;var l=e.m_sweep.c.x+n,h=e.m_sweep.c.y+o,u=i.m_sweep.c.x+s-l,c=i.m_sweep.c.y+a-h,p=e.GetWorldVector(this.m_localXAxis1),m=e.m_linearVelocity,f=i.m_linearVelocity,d=e.m_angularVelocity,_=i.m_angularVelocity;return u*(-d*p.y)+c*(d*p.x)+(p.x*(f.x+-_*a-m.x- -d*o)+p.y*(f.y+_*s-m.y-d*n))},u.prototype.IsLimitEnabled=function(){return this.m_enableLimit},u.prototype.EnableLimit=function(t){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableLimit=t},u.prototype.GetLowerLimit=function(){return this.m_lowerTranslation},u.prototype.GetUpperLimit=function(){return this.m_upperTranslation},u.prototype.SetLimits=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_lowerTranslation=t,this.m_upperTranslation=e},u.prototype.IsMotorEnabled=function(){return this.m_enableMotor},u.prototype.EnableMotor=function(t){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableMotor=t},u.prototype.SetMotorSpeed=function(t){void 0===t&&(t=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_motorSpeed=t},u.prototype.GetMotorSpeed=function(){return this.m_motorSpeed},u.prototype.SetMaxMotorForce=function(t){void 0===t&&(t=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_maxMotorForce=t},u.prototype.GetMaxMotorForce=function(){return this.m_maxMotorForce},u.prototype.GetMotorForce=function(){return this.m_motorImpulse},u.prototype.b2LineJoint=function(t){this.__super.b2Joint.call(this,t);this.m_localAnchor1.SetV(t.localAnchorA),this.m_localAnchor2.SetV(t.localAnchorB),this.m_localXAxis1.SetV(t.localAxisA),this.m_localYAxis1.x=-this.m_localXAxis1.y,this.m_localYAxis1.y=this.m_localXAxis1.x,this.m_impulse.SetZero(),this.m_motorMass=0,this.m_motorImpulse=0,this.m_lowerTranslation=t.lowerTranslation,this.m_upperTranslation=t.upperTranslation,this.m_maxMotorForce=t.maxMotorForce,this.m_motorSpeed=t.motorSpeed,this.m_enableLimit=t.enableLimit,this.m_enableMotor=t.enableMotor,this.m_limitState=T.e_inactiveLimit,this.m_axis.SetZero(),this.m_perp.SetZero()},u.prototype.InitVelocityConstraints=function(t){var e,i=this.m_bodyA,n=this.m_bodyB,o=0;this.m_localCenterA.SetV(i.GetLocalCenter()),this.m_localCenterB.SetV(n.GetLocalCenter());var r=i.GetTransform();n.GetTransform();e=i.m_xf.R;var s=this.m_localAnchor1.x-this.m_localCenterA.x,a=this.m_localAnchor1.y-this.m_localCenterA.y;o=e.col1.x*s+e.col2.x*a,a=e.col1.y*s+e.col2.y*a,s=o,e=n.m_xf.R;var l=this.m_localAnchor2.x-this.m_localCenterB.x,h=this.m_localAnchor2.y-this.m_localCenterB.y;o=e.col1.x*l+e.col2.x*h,h=e.col1.y*l+e.col2.y*h,l=o;var u=n.m_sweep.c.x+l-i.m_sweep.c.x-s,c=n.m_sweep.c.y+h-i.m_sweep.c.y-a;this.m_invMassA=i.m_invMass,this.m_invMassB=n.m_invMass,this.m_invIA=i.m_invI,this.m_invIB=n.m_invI,this.m_axis.SetV(k.MulMV(r.R,this.m_localXAxis1)),this.m_a1=(u+s)*this.m_axis.y-(c+a)*this.m_axis.x,this.m_a2=l*this.m_axis.y-h*this.m_axis.x,this.m_motorMass=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_a1*this.m_a1+this.m_invIB*this.m_a2*this.m_a2,this.m_motorMass=this.m_motorMass>Number.MIN_VALUE?1/this.m_motorMass:0,this.m_perp.SetV(k.MulMV(r.R,this.m_localYAxis1)),this.m_s1=(u+s)*this.m_perp.y-(c+a)*this.m_perp.x,this.m_s2=l*this.m_perp.y-h*this.m_perp.x;var p=this.m_invMassA,m=this.m_invMassB,f=this.m_invIA,d=this.m_invIB;if(this.m_K.col1.x=p+m+f*this.m_s1*this.m_s1+d*this.m_s2*this.m_s2,this.m_K.col1.y=f*this.m_s1*this.m_a1+d*this.m_s2*this.m_a2,this.m_K.col2.x=this.m_K.col1.y,this.m_K.col2.y=p+m+f*this.m_a1*this.m_a1+d*this.m_a2*this.m_a2,this.m_enableLimit){var _=this.m_axis.x*u+this.m_axis.y*c;k.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*V.b2_linearSlop?this.m_limitState=T.e_equalLimits:_<=this.m_lowerTranslation?this.m_limitState!=T.e_atLowerLimit&&(this.m_limitState=T.e_atLowerLimit,this.m_impulse.y=0):_>=this.m_upperTranslation?this.m_limitState!=T.e_atUpperLimit&&(this.m_limitState=T.e_atUpperLimit,this.m_impulse.y=0):(this.m_limitState=T.e_inactiveLimit,this.m_impulse.y=0)}else this.m_limitState=T.e_inactiveLimit;if(0==this.m_enableMotor&&(this.m_motorImpulse=0),t.warmStarting){this.m_impulse.x*=t.dtRatio,this.m_impulse.y*=t.dtRatio,this.m_motorImpulse*=t.dtRatio;var y=this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.x,x=this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.y,v=this.m_impulse.x*this.m_s1+(this.m_motorImpulse+this.m_impulse.y)*this.m_a1,b=this.m_impulse.x*this.m_s2+(this.m_motorImpulse+this.m_impulse.y)*this.m_a2;i.m_linearVelocity.x-=this.m_invMassA*y,i.m_linearVelocity.y-=this.m_invMassA*x,i.m_angularVelocity-=this.m_invIA*v,n.m_linearVelocity.x+=this.m_invMassB*y,n.m_linearVelocity.y+=this.m_invMassB*x,n.m_angularVelocity+=this.m_invIB*b}else this.m_impulse.SetZero(),this.m_motorImpulse=0},u.prototype.SolveVelocityConstraints=function(t){var e=this.m_bodyA,i=this.m_bodyB,n=e.m_linearVelocity,o=e.m_angularVelocity,r=i.m_linearVelocity,s=i.m_angularVelocity,a=0,l=0,h=0,u=0;if(this.m_enableMotor&&this.m_limitState!=T.e_equalLimits){var c=this.m_axis.x*(r.x-n.x)+this.m_axis.y*(r.y-n.y)+this.m_a2*s-this.m_a1*o,p=this.m_motorMass*(this.m_motorSpeed-c),m=this.m_motorImpulse,f=t.dt*this.m_maxMotorForce;this.m_motorImpulse=k.Clamp(this.m_motorImpulse+p,-f,f),a=(p=this.m_motorImpulse-m)*this.m_axis.x,l=p*this.m_axis.y,h=p*this.m_a1,u=p*this.m_a2,n.x-=this.m_invMassA*a,n.y-=this.m_invMassA*l,o-=this.m_invIA*h,r.x+=this.m_invMassB*a,r.y+=this.m_invMassB*l,s+=this.m_invIB*u}var d=this.m_perp.x*(r.x-n.x)+this.m_perp.y*(r.y-n.y)+this.m_s2*s-this.m_s1*o;if(this.m_enableLimit&&this.m_limitState!=T.e_inactiveLimit){var _=this.m_axis.x*(r.x-n.x)+this.m_axis.y*(r.y-n.y)+this.m_a2*s-this.m_a1*o,y=this.m_impulse.Copy(),x=this.m_K.Solve(new G,-d,-_);this.m_impulse.Add(x),this.m_limitState==T.e_atLowerLimit?this.m_impulse.y=k.Max(this.m_impulse.y,0):this.m_limitState==T.e_atUpperLimit&&(this.m_impulse.y=k.Min(this.m_impulse.y,0));var v=-d-(this.m_impulse.y-y.y)*this.m_K.col2.x,b=0;b=0!=this.m_K.col1.x?v/this.m_K.col1.x+y.x:y.x,this.m_impulse.x=b,x.x=this.m_impulse.x-y.x,x.y=this.m_impulse.y-y.y,a=x.x*this.m_perp.x+x.y*this.m_axis.x,l=x.x*this.m_perp.y+x.y*this.m_axis.y,h=x.x*this.m_s1+x.y*this.m_a1,u=x.x*this.m_s2+x.y*this.m_a2,n.x-=this.m_invMassA*a,n.y-=this.m_invMassA*l,o-=this.m_invIA*h,r.x+=this.m_invMassB*a,r.y+=this.m_invMassB*l,s+=this.m_invIB*u}else{var g=0;g=0!=this.m_K.col1.x?-d/this.m_K.col1.x:0,this.m_impulse.x+=g,a=g*this.m_perp.x,l=g*this.m_perp.y,h=g*this.m_s1,u=g*this.m_s2,n.x-=this.m_invMassA*a,n.y-=this.m_invMassA*l,o-=this.m_invIA*h,r.x+=this.m_invMassB*a,r.y+=this.m_invMassB*l,s+=this.m_invIB*u}e.m_linearVelocity.SetV(n),e.m_angularVelocity=o,i.m_linearVelocity.SetV(r),i.m_angularVelocity=s},u.prototype.SolvePositionConstraints=function(t){void 0===t&&(t=0);var e,i=this.m_bodyA,n=this.m_bodyB,o=i.m_sweep.c,r=i.m_sweep.a,s=n.m_sweep.c,a=n.m_sweep.a,l=0,h=0,u=0,c=0,p=0,m=0,f=!1,d=0,_=N.FromAngle(r),y=N.FromAngle(a);e=_;var x=this.m_localAnchor1.x-this.m_localCenterA.x,v=this.m_localAnchor1.y-this.m_localCenterA.y;l=e.col1.x*x+e.col2.x*v,v=e.col1.y*x+e.col2.y*v,x=l,e=y;var b=this.m_localAnchor2.x-this.m_localCenterB.x,g=this.m_localAnchor2.y-this.m_localCenterB.y;l=e.col1.x*b+e.col2.x*g,g=e.col1.y*b+e.col2.y*g,b=l;var w=s.x+b-o.x-x,C=s.y+g-o.y-v;if(this.m_enableLimit){this.m_axis=k.MulMV(_,this.m_localXAxis1),this.m_a1=(w+x)*this.m_axis.y-(C+v)*this.m_axis.x,this.m_a2=b*this.m_axis.y-g*this.m_axis.x;var D=this.m_axis.x*w+this.m_axis.y*C;k.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*V.b2_linearSlop?(d=k.Clamp(D,-V.b2_maxLinearCorrection,V.b2_maxLinearCorrection),m=k.Abs(D),f=!0):D<=this.m_lowerTranslation?(d=k.Clamp(D-this.m_lowerTranslation+V.b2_linearSlop,-V.b2_maxLinearCorrection,0),m=this.m_lowerTranslation-D,f=!0):D>=this.m_upperTranslation&&(d=k.Clamp(D-this.m_upperTranslation+V.b2_linearSlop,0,V.b2_maxLinearCorrection),m=D-this.m_upperTranslation,f=!0)}this.m_perp=k.MulMV(_,this.m_localYAxis1),this.m_s1=(w+x)*this.m_perp.y-(C+v)*this.m_perp.x,this.m_s2=b*this.m_perp.y-g*this.m_perp.x;var S=new G,T=this.m_perp.x*w+this.m_perp.y*C;if(m=k.Max(m,k.Abs(T)),0,f)h=this.m_invMassA,u=this.m_invMassB,c=this.m_invIA,p=this.m_invIB,this.m_K.col1.x=h+u+c*this.m_s1*this.m_s1+p*this.m_s2*this.m_s2,this.m_K.col1.y=c*this.m_s1*this.m_a1+p*this.m_s2*this.m_a2,this.m_K.col2.x=this.m_K.col1.y,this.m_K.col2.y=h+u+c*this.m_a1*this.m_a1+p*this.m_a2*this.m_a2,this.m_K.Solve(S,-T,-d);else{h=this.m_invMassA,u=this.m_invMassB,c=this.m_invIA,p=this.m_invIB;var A=h+u+c*this.m_s1*this.m_s1+p*this.m_s2*this.m_s2,M=0;M=0!=A?-T/A:0,S.x=M,S.y=0}var B=S.x*this.m_perp.x+S.y*this.m_axis.x,E=S.x*this.m_perp.y+S.y*this.m_axis.y,P=S.x*this.m_s1+S.y*this.m_a1,I=S.x*this.m_s2+S.y*this.m_a2;return o.x-=this.m_invMassA*B,o.y-=this.m_invMassA*E,r-=this.m_invIA*P,s.x+=this.m_invMassB*B,s.y+=this.m_invMassB*E,a+=this.m_invIB*I,i.m_sweep.a=r,n.m_sweep.a=a,i.SynchronizeTransform(),n.SynchronizeTransform(),m<=V.b2_linearSlop&&0<=V.b2_angularSlop},Box2D.inherit(c,Box2D.Dynamics.Joints.b2JointDef),c.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,c.b2LineJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.localAnchorA=new G,this.localAnchorB=new G,this.localAxisA=new G},c.prototype.b2LineJointDef=function(){this.__super.b2JointDef.call(this),this.type=T.e_lineJoint,this.localAxisA.Set(1,0),this.enableLimit=!1,this.lowerTranslation=0,this.upperTranslation=0,this.enableMotor=!1,this.maxMotorForce=0,this.motorSpeed=0},c.prototype.Initialize=function(t,e,i,n){this.bodyA=t,this.bodyB=e,this.localAnchorA=this.bodyA.GetLocalPoint(i),this.localAnchorB=this.bodyB.GetLocalPoint(i),this.localAxisA=this.bodyA.GetLocalVector(n)},Box2D.inherit(p,Box2D.Dynamics.Joints.b2Joint),p.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,p.b2MouseJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.K=new N,this.K1=new N,this.K2=new N,this.m_localAnchor=new G,this.m_target=new G,this.m_impulse=new G,this.m_mass=new N,this.m_C=new G},p.prototype.GetAnchorA=function(){return this.m_target},p.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor)},p.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new G(t*this.m_impulse.x,t*this.m_impulse.y)},p.prototype.GetReactionTorque=function(t){return void 0===t&&(t=0),0},p.prototype.GetTarget=function(){return this.m_target},p.prototype.SetTarget=function(t){0==this.m_bodyB.IsAwake()&&this.m_bodyB.SetAwake(!0),this.m_target=t},p.prototype.GetMaxForce=function(){return this.m_maxForce},p.prototype.SetMaxForce=function(t){void 0===t&&(t=0),this.m_maxForce=t},p.prototype.GetFrequency=function(){return this.m_frequencyHz},p.prototype.SetFrequency=function(t){void 0===t&&(t=0),this.m_frequencyHz=t},p.prototype.GetDampingRatio=function(){return this.m_dampingRatio},p.prototype.SetDampingRatio=function(t){void 0===t&&(t=0),this.m_dampingRatio=t},p.prototype.b2MouseJoint=function(t){this.__super.b2Joint.call(this,t),this.m_target.SetV(t.target);var e=this.m_target.x-this.m_bodyB.m_xf.position.x,i=this.m_target.y-this.m_bodyB.m_xf.position.y,n=this.m_bodyB.m_xf.R;this.m_localAnchor.x=e*n.col1.x+i*n.col1.y,this.m_localAnchor.y=e*n.col2.x+i*n.col2.y,this.m_maxForce=t.maxForce,this.m_impulse.SetZero(),this.m_frequencyHz=t.frequencyHz,this.m_dampingRatio=t.dampingRatio,this.m_beta=0,this.m_gamma=0},p.prototype.InitVelocityConstraints=function(t){var e,i=this.m_bodyB,n=i.GetMass(),o=2*Math.PI*this.m_frequencyHz,r=2*n*this.m_dampingRatio*o,s=n*o*o;this.m_gamma=t.dt*(r+t.dt*s),this.m_gamma=0!=this.m_gamma?1/this.m_gamma:0,this.m_beta=t.dt*s*this.m_gamma,e=i.m_xf.R;var a=this.m_localAnchor.x-i.m_sweep.localCenter.x,l=this.m_localAnchor.y-i.m_sweep.localCenter.y,h=e.col1.x*a+e.col2.x*l;l=e.col1.y*a+e.col2.y*l,a=h;var u=i.m_invMass,c=i.m_invI;this.K1.col1.x=u,this.K1.col2.x=0,this.K1.col1.y=0,this.K1.col2.y=u,this.K2.col1.x=c*l*l,this.K2.col2.x=-c*a*l,this.K2.col1.y=-c*a*l,this.K2.col2.y=c*a*a,this.K.SetM(this.K1),this.K.AddM(this.K2),this.K.col1.x+=this.m_gamma,this.K.col2.y+=this.m_gamma,this.K.GetInverse(this.m_mass),this.m_C.x=i.m_sweep.c.x+a-this.m_target.x,this.m_C.y=i.m_sweep.c.y+l-this.m_target.y,i.m_angularVelocity*=.98,this.m_impulse.x*=t.dtRatio,this.m_impulse.y*=t.dtRatio,i.m_linearVelocity.x+=u*this.m_impulse.x,i.m_linearVelocity.y+=u*this.m_impulse.y,i.m_angularVelocity+=c*(a*this.m_impulse.y-l*this.m_impulse.x)},p.prototype.SolveVelocityConstraints=function(t){var e,i,n=this.m_bodyB,o=0;e=n.m_xf.R;var r=this.m_localAnchor.x-n.m_sweep.localCenter.x,s=this.m_localAnchor.y-n.m_sweep.localCenter.y;o=e.col1.x*r+e.col2.x*s,s=e.col1.y*r+e.col2.y*s,r=o;var a=n.m_linearVelocity.x+-n.m_angularVelocity*s,l=n.m_linearVelocity.y+n.m_angularVelocity*r;e=this.m_mass,o=a+this.m_beta*this.m_C.x+this.m_gamma*this.m_impulse.x,i=l+this.m_beta*this.m_C.y+this.m_gamma*this.m_impulse.y;var h=-(e.col1.x*o+e.col2.x*i),u=-(e.col1.y*o+e.col2.y*i),c=this.m_impulse.x,p=this.m_impulse.y;this.m_impulse.x+=h,this.m_impulse.y+=u;var m=t.dt*this.m_maxForce;this.m_impulse.LengthSquared()>m*m&&this.m_impulse.Multiply(m/this.m_impulse.Length()),h=this.m_impulse.x-c,u=this.m_impulse.y-p,n.m_linearVelocity.x+=n.m_invMass*h,n.m_linearVelocity.y+=n.m_invMass*u,n.m_angularVelocity+=n.m_invI*(r*u-s*h)},p.prototype.SolvePositionConstraints=function(t){return void 0===t&&(t=0),!0},Box2D.inherit(m,Box2D.Dynamics.Joints.b2JointDef),m.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,m.b2MouseJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.target=new G},m.prototype.b2MouseJointDef=function(){this.__super.b2JointDef.call(this),this.type=T.e_mouseJoint,this.maxForce=0,this.frequencyHz=5,this.dampingRatio=.7},Box2D.inherit(f,Box2D.Dynamics.Joints.b2Joint),f.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,f.b2PrismaticJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_localAnchor1=new G,this.m_localAnchor2=new G,this.m_localXAxis1=new G,this.m_localYAxis1=new G,this.m_axis=new G,this.m_perp=new G,this.m_K=new e,this.m_impulse=new j},f.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},f.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},f.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new G(t*(this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.x),t*(this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.y))},f.prototype.GetReactionTorque=function(t){return void 0===t&&(t=0),t*this.m_impulse.y},f.prototype.GetJointTranslation=function(){var t=this.m_bodyA,e=this.m_bodyB,i=t.GetWorldPoint(this.m_localAnchor1),n=e.GetWorldPoint(this.m_localAnchor2),o=n.x-i.x,r=n.y-i.y,s=t.GetWorldVector(this.m_localXAxis1);return s.x*o+s.y*r},f.prototype.GetJointSpeed=function(){var t,e=this.m_bodyA,i=this.m_bodyB;t=e.m_xf.R;var n=this.m_localAnchor1.x-e.m_sweep.localCenter.x,o=this.m_localAnchor1.y-e.m_sweep.localCenter.y,r=t.col1.x*n+t.col2.x*o;o=t.col1.y*n+t.col2.y*o,n=r,t=i.m_xf.R;var s=this.m_localAnchor2.x-i.m_sweep.localCenter.x,a=this.m_localAnchor2.y-i.m_sweep.localCenter.y;r=t.col1.x*s+t.col2.x*a,a=t.col1.y*s+t.col2.y*a,s=r;var l=e.m_sweep.c.x+n,h=e.m_sweep.c.y+o,u=i.m_sweep.c.x+s-l,c=i.m_sweep.c.y+a-h,p=e.GetWorldVector(this.m_localXAxis1),m=e.m_linearVelocity,f=i.m_linearVelocity,d=e.m_angularVelocity,_=i.m_angularVelocity;return u*(-d*p.y)+c*(d*p.x)+(p.x*(f.x+-_*a-m.x- -d*o)+p.y*(f.y+_*s-m.y-d*n))},f.prototype.IsLimitEnabled=function(){return this.m_enableLimit},f.prototype.EnableLimit=function(t){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableLimit=t},f.prototype.GetLowerLimit=function(){return this.m_lowerTranslation},f.prototype.GetUpperLimit=function(){return this.m_upperTranslation},f.prototype.SetLimits=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_lowerTranslation=t,this.m_upperTranslation=e},f.prototype.IsMotorEnabled=function(){return this.m_enableMotor},f.prototype.EnableMotor=function(t){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableMotor=t},f.prototype.SetMotorSpeed=function(t){void 0===t&&(t=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_motorSpeed=t},f.prototype.GetMotorSpeed=function(){return this.m_motorSpeed},f.prototype.SetMaxMotorForce=function(t){void 0===t&&(t=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_maxMotorForce=t},f.prototype.GetMotorForce=function(){return this.m_motorImpulse},f.prototype.b2PrismaticJoint=function(t){this.__super.b2Joint.call(this,t);this.m_localAnchor1.SetV(t.localAnchorA),this.m_localAnchor2.SetV(t.localAnchorB),this.m_localXAxis1.SetV(t.localAxisA),this.m_localYAxis1.x=-this.m_localXAxis1.y,this.m_localYAxis1.y=this.m_localXAxis1.x,this.m_refAngle=t.referenceAngle,this.m_impulse.SetZero(),this.m_motorMass=0,this.m_motorImpulse=0,this.m_lowerTranslation=t.lowerTranslation,this.m_upperTranslation=t.upperTranslation,this.m_maxMotorForce=t.maxMotorForce,this.m_motorSpeed=t.motorSpeed,this.m_enableLimit=t.enableLimit,this.m_enableMotor=t.enableMotor,this.m_limitState=T.e_inactiveLimit,this.m_axis.SetZero(),this.m_perp.SetZero()},f.prototype.InitVelocityConstraints=function(t){var e,i=this.m_bodyA,n=this.m_bodyB,o=0;this.m_localCenterA.SetV(i.GetLocalCenter()),this.m_localCenterB.SetV(n.GetLocalCenter());var r=i.GetTransform();n.GetTransform();e=i.m_xf.R;var s=this.m_localAnchor1.x-this.m_localCenterA.x,a=this.m_localAnchor1.y-this.m_localCenterA.y;o=e.col1.x*s+e.col2.x*a,a=e.col1.y*s+e.col2.y*a,s=o,e=n.m_xf.R;var l=this.m_localAnchor2.x-this.m_localCenterB.x,h=this.m_localAnchor2.y-this.m_localCenterB.y;o=e.col1.x*l+e.col2.x*h,h=e.col1.y*l+e.col2.y*h,l=o;var u=n.m_sweep.c.x+l-i.m_sweep.c.x-s,c=n.m_sweep.c.y+h-i.m_sweep.c.y-a;this.m_invMassA=i.m_invMass,this.m_invMassB=n.m_invMass,this.m_invIA=i.m_invI,this.m_invIB=n.m_invI,this.m_axis.SetV(k.MulMV(r.R,this.m_localXAxis1)),this.m_a1=(u+s)*this.m_axis.y-(c+a)*this.m_axis.x,this.m_a2=l*this.m_axis.y-h*this.m_axis.x,this.m_motorMass=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_a1*this.m_a1+this.m_invIB*this.m_a2*this.m_a2,this.m_motorMass>Number.MIN_VALUE&&(this.m_motorMass=1/this.m_motorMass),this.m_perp.SetV(k.MulMV(r.R,this.m_localYAxis1)),this.m_s1=(u+s)*this.m_perp.y-(c+a)*this.m_perp.x,this.m_s2=l*this.m_perp.y-h*this.m_perp.x;var p=this.m_invMassA,m=this.m_invMassB,f=this.m_invIA,d=this.m_invIB;if(this.m_K.col1.x=p+m+f*this.m_s1*this.m_s1+d*this.m_s2*this.m_s2,this.m_K.col1.y=f*this.m_s1+d*this.m_s2,this.m_K.col1.z=f*this.m_s1*this.m_a1+d*this.m_s2*this.m_a2,this.m_K.col2.x=this.m_K.col1.y,this.m_K.col2.y=f+d,this.m_K.col2.z=f*this.m_a1+d*this.m_a2,this.m_K.col3.x=this.m_K.col1.z,this.m_K.col3.y=this.m_K.col2.z,this.m_K.col3.z=p+m+f*this.m_a1*this.m_a1+d*this.m_a2*this.m_a2,this.m_enableLimit){var _=this.m_axis.x*u+this.m_axis.y*c;k.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*V.b2_linearSlop?this.m_limitState=T.e_equalLimits:_<=this.m_lowerTranslation?this.m_limitState!=T.e_atLowerLimit&&(this.m_limitState=T.e_atLowerLimit,this.m_impulse.z=0):_>=this.m_upperTranslation?this.m_limitState!=T.e_atUpperLimit&&(this.m_limitState=T.e_atUpperLimit,this.m_impulse.z=0):(this.m_limitState=T.e_inactiveLimit,this.m_impulse.z=0)}else this.m_limitState=T.e_inactiveLimit;if(0==this.m_enableMotor&&(this.m_motorImpulse=0),t.warmStarting){this.m_impulse.x*=t.dtRatio,this.m_impulse.y*=t.dtRatio,this.m_motorImpulse*=t.dtRatio;var y=this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.x,x=this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.y,v=this.m_impulse.x*this.m_s1+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a1,b=this.m_impulse.x*this.m_s2+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a2;i.m_linearVelocity.x-=this.m_invMassA*y,i.m_linearVelocity.y-=this.m_invMassA*x,i.m_angularVelocity-=this.m_invIA*v,n.m_linearVelocity.x+=this.m_invMassB*y,n.m_linearVelocity.y+=this.m_invMassB*x,n.m_angularVelocity+=this.m_invIB*b}else this.m_impulse.SetZero(),this.m_motorImpulse=0},f.prototype.SolveVelocityConstraints=function(t){var e=this.m_bodyA,i=this.m_bodyB,n=e.m_linearVelocity,o=e.m_angularVelocity,r=i.m_linearVelocity,s=i.m_angularVelocity,a=0,l=0,h=0,u=0;if(this.m_enableMotor&&this.m_limitState!=T.e_equalLimits){var c=this.m_axis.x*(r.x-n.x)+this.m_axis.y*(r.y-n.y)+this.m_a2*s-this.m_a1*o,p=this.m_motorMass*(this.m_motorSpeed-c),m=this.m_motorImpulse,f=t.dt*this.m_maxMotorForce;this.m_motorImpulse=k.Clamp(this.m_motorImpulse+p,-f,f),a=(p=this.m_motorImpulse-m)*this.m_axis.x,l=p*this.m_axis.y,h=p*this.m_a1,u=p*this.m_a2,n.x-=this.m_invMassA*a,n.y-=this.m_invMassA*l,o-=this.m_invIA*h,r.x+=this.m_invMassB*a,r.y+=this.m_invMassB*l,s+=this.m_invIB*u}var d=this.m_perp.x*(r.x-n.x)+this.m_perp.y*(r.y-n.y)+this.m_s2*s-this.m_s1*o,_=s-o;if(this.m_enableLimit&&this.m_limitState!=T.e_inactiveLimit){var y=this.m_axis.x*(r.x-n.x)+this.m_axis.y*(r.y-n.y)+this.m_a2*s-this.m_a1*o,x=this.m_impulse.Copy(),v=this.m_K.Solve33(new j,-d,-_,-y);this.m_impulse.Add(v),this.m_limitState==T.e_atLowerLimit?this.m_impulse.z=k.Max(this.m_impulse.z,0):this.m_limitState==T.e_atUpperLimit&&(this.m_impulse.z=k.Min(this.m_impulse.z,0));var b=-d-(this.m_impulse.z-x.z)*this.m_K.col3.x,g=-_-(this.m_impulse.z-x.z)*this.m_K.col3.y,w=this.m_K.Solve22(new G,b,g);w.x+=x.x,w.y+=x.y,this.m_impulse.x=w.x,this.m_impulse.y=w.y,v.x=this.m_impulse.x-x.x,v.y=this.m_impulse.y-x.y,v.z=this.m_impulse.z-x.z,a=v.x*this.m_perp.x+v.z*this.m_axis.x,l=v.x*this.m_perp.y+v.z*this.m_axis.y,h=v.x*this.m_s1+v.y+v.z*this.m_a1,u=v.x*this.m_s2+v.y+v.z*this.m_a2,n.x-=this.m_invMassA*a,n.y-=this.m_invMassA*l,o-=this.m_invIA*h,r.x+=this.m_invMassB*a,r.y+=this.m_invMassB*l,s+=this.m_invIB*u}else{var C=this.m_K.Solve22(new G,-d,-_);this.m_impulse.x+=C.x,this.m_impulse.y+=C.y,a=C.x*this.m_perp.x,l=C.x*this.m_perp.y,h=C.x*this.m_s1+C.y,u=C.x*this.m_s2+C.y,n.x-=this.m_invMassA*a,n.y-=this.m_invMassA*l,o-=this.m_invIA*h,r.x+=this.m_invMassB*a,r.y+=this.m_invMassB*l,s+=this.m_invIB*u}e.m_linearVelocity.SetV(n),e.m_angularVelocity=o,i.m_linearVelocity.SetV(r),i.m_angularVelocity=s},f.prototype.SolvePositionConstraints=function(t){void 0===t&&(t=0);var e,i,n=this.m_bodyA,o=this.m_bodyB,r=n.m_sweep.c,s=n.m_sweep.a,a=o.m_sweep.c,l=o.m_sweep.a,h=0,u=0,c=0,p=0,m=0,f=0,d=!1,_=0,y=N.FromAngle(s),x=N.FromAngle(l);e=y;var v=this.m_localAnchor1.x-this.m_localCenterA.x,b=this.m_localAnchor1.y-this.m_localCenterA.y;h=e.col1.x*v+e.col2.x*b,b=e.col1.y*v+e.col2.y*b,v=h,e=x;var g=this.m_localAnchor2.x-this.m_localCenterB.x,w=this.m_localAnchor2.y-this.m_localCenterB.y;h=e.col1.x*g+e.col2.x*w,w=e.col1.y*g+e.col2.y*w,g=h;var C=a.x+g-r.x-v,D=a.y+w-r.y-b;if(this.m_enableLimit){this.m_axis=k.MulMV(y,this.m_localXAxis1),this.m_a1=(C+v)*this.m_axis.y-(D+b)*this.m_axis.x,this.m_a2=g*this.m_axis.y-w*this.m_axis.x;var S=this.m_axis.x*C+this.m_axis.y*D;k.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*V.b2_linearSlop?(_=k.Clamp(S,-V.b2_maxLinearCorrection,V.b2_maxLinearCorrection),f=k.Abs(S),d=!0):S<=this.m_lowerTranslation?(_=k.Clamp(S-this.m_lowerTranslation+V.b2_linearSlop,-V.b2_maxLinearCorrection,0),f=this.m_lowerTranslation-S,d=!0):S>=this.m_upperTranslation&&(_=k.Clamp(S-this.m_upperTranslation+V.b2_linearSlop,0,V.b2_maxLinearCorrection),f=S-this.m_upperTranslation,d=!0)}this.m_perp=k.MulMV(y,this.m_localYAxis1),this.m_s1=(C+v)*this.m_perp.y-(D+b)*this.m_perp.x,this.m_s2=g*this.m_perp.y-w*this.m_perp.x;var T=new j,A=this.m_perp.x*C+this.m_perp.y*D,M=l-s-this.m_refAngle;if(f=k.Max(f,k.Abs(A)),i=k.Abs(M),d)u=this.m_invMassA,c=this.m_invMassB,p=this.m_invIA,m=this.m_invIB,this.m_K.col1.x=u+c+p*this.m_s1*this.m_s1+m*this.m_s2*this.m_s2,this.m_K.col1.y=p*this.m_s1+m*this.m_s2,this.m_K.col1.z=p*this.m_s1*this.m_a1+m*this.m_s2*this.m_a2,this.m_K.col2.x=this.m_K.col1.y,this.m_K.col2.y=p+m,this.m_K.col2.z=p*this.m_a1+m*this.m_a2,this.m_K.col3.x=this.m_K.col1.z,this.m_K.col3.y=this.m_K.col2.z,this.m_K.col3.z=u+c+p*this.m_a1*this.m_a1+m*this.m_a2*this.m_a2,this.m_K.Solve33(T,-A,-M,-_);else{u=this.m_invMassA,c=this.m_invMassB,p=this.m_invIA,m=this.m_invIB;var B=u+c+p*this.m_s1*this.m_s1+m*this.m_s2*this.m_s2,E=p*this.m_s1+m*this.m_s2,P=p+m;this.m_K.col1.Set(B,E,0),this.m_K.col2.Set(E,P,0);var I=this.m_K.Solve22(new G,-A,-M);T.x=I.x,T.y=I.y,T.z=0}var R=T.x*this.m_perp.x+T.z*this.m_axis.x,O=T.x*this.m_perp.y+T.z*this.m_axis.y,L=T.x*this.m_s1+T.y+T.z*this.m_a1,F=T.x*this.m_s2+T.y+T.z*this.m_a2;return r.x-=this.m_invMassA*R,r.y-=this.m_invMassA*O,s-=this.m_invIA*L,a.x+=this.m_invMassB*R,a.y+=this.m_invMassB*O,l+=this.m_invIB*F,n.m_sweep.a=s,o.m_sweep.a=l,n.SynchronizeTransform(),o.SynchronizeTransform(),f<=V.b2_linearSlop&&i<=V.b2_angularSlop},Box2D.inherit(d,Box2D.Dynamics.Joints.b2JointDef),d.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,d.b2PrismaticJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.localAnchorA=new G,this.localAnchorB=new G,this.localAxisA=new G},d.prototype.b2PrismaticJointDef=function(){this.__super.b2JointDef.call(this),this.type=T.e_prismaticJoint,this.localAxisA.Set(1,0),this.referenceAngle=0,this.enableLimit=!1,this.lowerTranslation=0,this.upperTranslation=0,this.enableMotor=!1,this.maxMotorForce=0,this.motorSpeed=0},d.prototype.Initialize=function(t,e,i,n){this.bodyA=t,this.bodyB=e,this.localAnchorA=this.bodyA.GetLocalPoint(i),this.localAnchorB=this.bodyB.GetLocalPoint(i),this.localAxisA=this.bodyA.GetLocalVector(n),this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()},Box2D.inherit(_,Box2D.Dynamics.Joints.b2Joint),_.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,_.b2PulleyJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_groundAnchor1=new G,this.m_groundAnchor2=new G,this.m_localAnchor1=new G,this.m_localAnchor2=new G,this.m_u1=new G,this.m_u2=new G},_.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},_.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},_.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new G(t*this.m_impulse*this.m_u2.x,t*this.m_impulse*this.m_u2.y)},_.prototype.GetReactionTorque=function(t){return void 0===t&&(t=0),0},_.prototype.GetGroundAnchorA=function(){var t=this.m_ground.m_xf.position.Copy();return t.Add(this.m_groundAnchor1),t},_.prototype.GetGroundAnchorB=function(){var t=this.m_ground.m_xf.position.Copy();return t.Add(this.m_groundAnchor2),t},_.prototype.GetLength1=function(){var t=this.m_bodyA.GetWorldPoint(this.m_localAnchor1),e=this.m_ground.m_xf.position.x+this.m_groundAnchor1.x,i=this.m_ground.m_xf.position.y+this.m_groundAnchor1.y,n=t.x-e,o=t.y-i;return Math.sqrt(n*n+o*o)},_.prototype.GetLength2=function(){var t=this.m_bodyB.GetWorldPoint(this.m_localAnchor2),e=this.m_ground.m_xf.position.x+this.m_groundAnchor2.x,i=this.m_ground.m_xf.position.y+this.m_groundAnchor2.y,n=t.x-e,o=t.y-i;return Math.sqrt(n*n+o*o)},_.prototype.GetRatio=function(){return this.m_ratio},_.prototype.b2PulleyJoint=function(t){this.__super.b2Joint.call(this,t);this.m_ground=this.m_bodyA.m_world.m_groundBody,this.m_groundAnchor1.x=t.groundAnchorA.x-this.m_ground.m_xf.position.x,this.m_groundAnchor1.y=t.groundAnchorA.y-this.m_ground.m_xf.position.y,this.m_groundAnchor2.x=t.groundAnchorB.x-this.m_ground.m_xf.position.x,this.m_groundAnchor2.y=t.groundAnchorB.y-this.m_ground.m_xf.position.y,this.m_localAnchor1.SetV(t.localAnchorA),this.m_localAnchor2.SetV(t.localAnchorB),this.m_ratio=t.ratio,this.m_constant=t.lengthA+this.m_ratio*t.lengthB,this.m_maxLength1=k.Min(t.maxLengthA,this.m_constant-this.m_ratio*_.b2_minPulleyLength),this.m_maxLength2=k.Min(t.maxLengthB,(this.m_constant-_.b2_minPulleyLength)/this.m_ratio),this.m_impulse=0,this.m_limitImpulse1=0,this.m_limitImpulse2=0},_.prototype.InitVelocityConstraints=function(t){var e,i=this.m_bodyA,n=this.m_bodyB;e=i.m_xf.R;var o=this.m_localAnchor1.x-i.m_sweep.localCenter.x,r=this.m_localAnchor1.y-i.m_sweep.localCenter.y,s=e.col1.x*o+e.col2.x*r;r=e.col1.y*o+e.col2.y*r,o=s,e=n.m_xf.R;var a=this.m_localAnchor2.x-n.m_sweep.localCenter.x,l=this.m_localAnchor2.y-n.m_sweep.localCenter.y;s=e.col1.x*a+e.col2.x*l,l=e.col1.y*a+e.col2.y*l,a=s;var h=i.m_sweep.c.x+o,u=i.m_sweep.c.y+r,c=n.m_sweep.c.x+a,p=n.m_sweep.c.y+l,m=this.m_ground.m_xf.position.x+this.m_groundAnchor1.x,f=this.m_ground.m_xf.position.y+this.m_groundAnchor1.y,d=this.m_ground.m_xf.position.x+this.m_groundAnchor2.x,_=this.m_ground.m_xf.position.y+this.m_groundAnchor2.y;this.m_u1.Set(h-m,u-f),this.m_u2.Set(c-d,p-_);var y=this.m_u1.Length(),x=this.m_u2.Length();y>V.b2_linearSlop?this.m_u1.Multiply(1/y):this.m_u1.SetZero(),x>V.b2_linearSlop?this.m_u2.Multiply(1/x):this.m_u2.SetZero(),0<this.m_constant-y-this.m_ratio*x?(this.m_state=T.e_inactiveLimit,this.m_impulse=0):this.m_state=T.e_atUpperLimit,y<this.m_maxLength1?(this.m_limitState1=T.e_inactiveLimit,this.m_limitImpulse1=0):this.m_limitState1=T.e_atUpperLimit,x<this.m_maxLength2?(this.m_limitState2=T.e_inactiveLimit,this.m_limitImpulse2=0):this.m_limitState2=T.e_atUpperLimit;var v=o*this.m_u1.y-r*this.m_u1.x,b=a*this.m_u2.y-l*this.m_u2.x;if(this.m_limitMass1=i.m_invMass+i.m_invI*v*v,this.m_limitMass2=n.m_invMass+n.m_invI*b*b,this.m_pulleyMass=this.m_limitMass1+this.m_ratio*this.m_ratio*this.m_limitMass2,this.m_limitMass1=1/this.m_limitMass1,this.m_limitMass2=1/this.m_limitMass2,this.m_pulleyMass=1/this.m_pulleyMass,t.warmStarting){this.m_impulse*=t.dtRatio,this.m_limitImpulse1*=t.dtRatio,this.m_limitImpulse2*=t.dtRatio;var g=(-this.m_impulse-this.m_limitImpulse1)*this.m_u1.x,w=(-this.m_impulse-this.m_limitImpulse1)*this.m_u1.y,C=(-this.m_ratio*this.m_impulse-this.m_limitImpulse2)*this.m_u2.x,D=(-this.m_ratio*this.m_impulse-this.m_limitImpulse2)*this.m_u2.y;i.m_linearVelocity.x+=i.m_invMass*g,i.m_linearVelocity.y+=i.m_invMass*w,i.m_angularVelocity+=i.m_invI*(o*w-r*g),n.m_linearVelocity.x+=n.m_invMass*C,n.m_linearVelocity.y+=n.m_invMass*D,n.m_angularVelocity+=n.m_invI*(a*D-l*C)}else this.m_impulse=0,this.m_limitImpulse1=0,this.m_limitImpulse2=0},_.prototype.SolveVelocityConstraints=function(t){var e,i=this.m_bodyA,n=this.m_bodyB;e=i.m_xf.R;var o=this.m_localAnchor1.x-i.m_sweep.localCenter.x,r=this.m_localAnchor1.y-i.m_sweep.localCenter.y,s=e.col1.x*o+e.col2.x*r;r=e.col1.y*o+e.col2.y*r,o=s,e=n.m_xf.R;var a=this.m_localAnchor2.x-n.m_sweep.localCenter.x,l=this.m_localAnchor2.y-n.m_sweep.localCenter.y;s=e.col1.x*a+e.col2.x*l,l=e.col1.y*a+e.col2.y*l,a=s;var h=0,u=0,c=0,p=0,m=0,f=0,d=0,_=0,y=0,x=0,v=0;this.m_state==T.e_atUpperLimit&&(h=i.m_linearVelocity.x+-i.m_angularVelocity*r,u=i.m_linearVelocity.y+i.m_angularVelocity*o,c=n.m_linearVelocity.x+-n.m_angularVelocity*l,p=n.m_linearVelocity.y+n.m_angularVelocity*a,y=-(this.m_u1.x*h+this.m_u1.y*u)-this.m_ratio*(this.m_u2.x*c+this.m_u2.y*p),x=this.m_pulleyMass*-y,v=this.m_impulse,this.m_impulse=k.Max(0,this.m_impulse+x),m=-(x=this.m_impulse-v)*this.m_u1.x,f=-x*this.m_u1.y,d=-this.m_ratio*x*this.m_u2.x,_=-this.m_ratio*x*this.m_u2.y,i.m_linearVelocity.x+=i.m_invMass*m,i.m_linearVelocity.y+=i.m_invMass*f,i.m_angularVelocity+=i.m_invI*(o*f-r*m),n.m_linearVelocity.x+=n.m_invMass*d,n.m_linearVelocity.y+=n.m_invMass*_,n.m_angularVelocity+=n.m_invI*(a*_-l*d)),this.m_limitState1==T.e_atUpperLimit&&(h=i.m_linearVelocity.x+-i.m_angularVelocity*r,u=i.m_linearVelocity.y+i.m_angularVelocity*o,y=-(this.m_u1.x*h+this.m_u1.y*u),x=-this.m_limitMass1*y,v=this.m_limitImpulse1,this.m_limitImpulse1=k.Max(0,this.m_limitImpulse1+x),m=-(x=this.m_limitImpulse1-v)*this.m_u1.x,f=-x*this.m_u1.y,i.m_linearVelocity.x+=i.m_invMass*m,i.m_linearVelocity.y+=i.m_invMass*f,i.m_angularVelocity+=i.m_invI*(o*f-r*m)),this.m_limitState2==T.e_atUpperLimit&&(c=n.m_linearVelocity.x+-n.m_angularVelocity*l,p=n.m_linearVelocity.y+n.m_angularVelocity*a,y=-(this.m_u2.x*c+this.m_u2.y*p),x=-this.m_limitMass2*y,v=this.m_limitImpulse2,this.m_limitImpulse2=k.Max(0,this.m_limitImpulse2+x),d=-(x=this.m_limitImpulse2-v)*this.m_u2.x,_=-x*this.m_u2.y,n.m_linearVelocity.x+=n.m_invMass*d,n.m_linearVelocity.y+=n.m_invMass*_,n.m_angularVelocity+=n.m_invI*(a*_-l*d))},_.prototype.SolvePositionConstraints=function(t){void 0===t&&(t=0);var e,i=this.m_bodyA,n=this.m_bodyB,o=this.m_ground.m_xf.position.x+this.m_groundAnchor1.x,r=this.m_ground.m_xf.position.y+this.m_groundAnchor1.y,s=this.m_ground.m_xf.position.x+this.m_groundAnchor2.x,a=this.m_ground.m_xf.position.y+this.m_groundAnchor2.y,l=0,h=0,u=0,c=0,p=0,m=0,f=0,d=0,_=0,y=0,x=0,v=0,b=0,g=0;return this.m_state==T.e_atUpperLimit&&(e=i.m_xf.R,l=this.m_localAnchor1.x-i.m_sweep.localCenter.x,h=this.m_localAnchor1.y-i.m_sweep.localCenter.y,b=e.col1.x*l+e.col2.x*h,h=e.col1.y*l+e.col2.y*h,l=b,e=n.m_xf.R,u=this.m_localAnchor2.x-n.m_sweep.localCenter.x,c=this.m_localAnchor2.y-n.m_sweep.localCenter.y,b=e.col1.x*u+e.col2.x*c,c=e.col1.y*u+e.col2.y*c,u=b,p=i.m_sweep.c.x+l,m=i.m_sweep.c.y+h,f=n.m_sweep.c.x+u,d=n.m_sweep.c.y+c,this.m_u1.Set(p-o,m-r),this.m_u2.Set(f-s,d-a),_=this.m_u1.Length(),y=this.m_u2.Length(),_>V.b2_linearSlop?this.m_u1.Multiply(1/_):this.m_u1.SetZero(),y>V.b2_linearSlop?this.m_u2.Multiply(1/y):this.m_u2.SetZero(),x=this.m_constant-_-this.m_ratio*y,g=k.Max(g,-x),x=k.Clamp(x+V.b2_linearSlop,-V.b2_maxLinearCorrection,0),p=-(v=-this.m_pulleyMass*x)*this.m_u1.x,m=-v*this.m_u1.y,f=-this.m_ratio*v*this.m_u2.x,d=-this.m_ratio*v*this.m_u2.y,i.m_sweep.c.x+=i.m_invMass*p,i.m_sweep.c.y+=i.m_invMass*m,i.m_sweep.a+=i.m_invI*(l*m-h*p),n.m_sweep.c.x+=n.m_invMass*f,n.m_sweep.c.y+=n.m_invMass*d,n.m_sweep.a+=n.m_invI*(u*d-c*f),i.SynchronizeTransform(),n.SynchronizeTransform()),this.m_limitState1==T.e_atUpperLimit&&(e=i.m_xf.R,l=this.m_localAnchor1.x-i.m_sweep.localCenter.x,h=this.m_localAnchor1.y-i.m_sweep.localCenter.y,b=e.col1.x*l+e.col2.x*h,h=e.col1.y*l+e.col2.y*h,l=b,p=i.m_sweep.c.x+l,m=i.m_sweep.c.y+h,this.m_u1.Set(p-o,m-r),(_=this.m_u1.Length())>V.b2_linearSlop?(this.m_u1.x*=1/_,this.m_u1.y*=1/_):this.m_u1.SetZero(),x=this.m_maxLength1-_,g=k.Max(g,-x),x=k.Clamp(x+V.b2_linearSlop,-V.b2_maxLinearCorrection,0),p=-(v=-this.m_limitMass1*x)*this.m_u1.x,m=-v*this.m_u1.y,i.m_sweep.c.x+=i.m_invMass*p,i.m_sweep.c.y+=i.m_invMass*m,i.m_sweep.a+=i.m_invI*(l*m-h*p),i.SynchronizeTransform()),this.m_limitState2==T.e_atUpperLimit&&(e=n.m_xf.R,u=this.m_localAnchor2.x-n.m_sweep.localCenter.x,c=this.m_localAnchor2.y-n.m_sweep.localCenter.y,b=e.col1.x*u+e.col2.x*c,c=e.col1.y*u+e.col2.y*c,u=b,f=n.m_sweep.c.x+u,d=n.m_sweep.c.y+c,this.m_u2.Set(f-s,d-a),(y=this.m_u2.Length())>V.b2_linearSlop?(this.m_u2.x*=1/y,this.m_u2.y*=1/y):this.m_u2.SetZero(),x=this.m_maxLength2-y,g=k.Max(g,-x),x=k.Clamp(x+V.b2_linearSlop,-V.b2_maxLinearCorrection,0),f=-(v=-this.m_limitMass2*x)*this.m_u2.x,d=-v*this.m_u2.y,n.m_sweep.c.x+=n.m_invMass*f,n.m_sweep.c.y+=n.m_invMass*d,n.m_sweep.a+=n.m_invI*(u*d-c*f),n.SynchronizeTransform()),g<V.b2_linearSlop},Box2D.postDefs.push(function(){Box2D.Dynamics.Joints.b2PulleyJoint.b2_minPulleyLength=2}),Box2D.inherit(y,Box2D.Dynamics.Joints.b2JointDef),y.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,y.b2PulleyJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.groundAnchorA=new G,this.groundAnchorB=new G,this.localAnchorA=new G,this.localAnchorB=new G},y.prototype.b2PulleyJointDef=function(){this.__super.b2JointDef.call(this),this.type=T.e_pulleyJoint,this.groundAnchorA.Set(-1,1),this.groundAnchorB.Set(1,1),this.localAnchorA.Set(-1,0),this.localAnchorB.Set(1,0),this.lengthA=0,this.maxLengthA=0,this.lengthB=0,this.maxLengthB=0,this.ratio=1,this.collideConnected=!0},y.prototype.Initialize=function(t,e,i,n,o,r,s){void 0===s&&(s=0),this.bodyA=t,this.bodyB=e,this.groundAnchorA.SetV(i),this.groundAnchorB.SetV(n),this.localAnchorA=this.bodyA.GetLocalPoint(o),this.localAnchorB=this.bodyB.GetLocalPoint(r);var a=o.x-i.x,l=o.y-i.y;this.lengthA=Math.sqrt(a*a+l*l);var h=r.x-n.x,u=r.y-n.y;this.lengthB=Math.sqrt(h*h+u*u),this.ratio=s;var c=this.lengthA+this.ratio*this.lengthB;this.maxLengthA=c-this.ratio*_.b2_minPulleyLength,this.maxLengthB=(c-_.b2_minPulleyLength)/this.ratio},Box2D.inherit(A,Box2D.Dynamics.Joints.b2Joint),A.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,A.b2RevoluteJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.K=new N,this.K1=new N,this.K2=new N,this.K3=new N,this.impulse3=new j,this.impulse2=new G,this.reduced=new G,this.m_localAnchor1=new G,this.m_localAnchor2=new G,this.m_impulse=new j,this.m_mass=new e},A.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},A.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},A.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new G(t*this.m_impulse.x,t*this.m_impulse.y)},A.prototype.GetReactionTorque=function(t){return void 0===t&&(t=0),t*this.m_impulse.z},A.prototype.GetJointAngle=function(){return this.m_bodyB.m_sweep.a-this.m_bodyA.m_sweep.a-this.m_referenceAngle},A.prototype.GetJointSpeed=function(){return this.m_bodyB.m_angularVelocity-this.m_bodyA.m_angularVelocity},A.prototype.IsLimitEnabled=function(){return this.m_enableLimit},A.prototype.EnableLimit=function(t){this.m_enableLimit=t},A.prototype.GetLowerLimit=function(){return this.m_lowerAngle},A.prototype.GetUpperLimit=function(){return this.m_upperAngle},A.prototype.SetLimits=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.m_lowerAngle=t,this.m_upperAngle=e},A.prototype.IsMotorEnabled=function(){return this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableMotor},A.prototype.EnableMotor=function(t){this.m_enableMotor=t},A.prototype.SetMotorSpeed=function(t){void 0===t&&(t=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_motorSpeed=t},A.prototype.GetMotorSpeed=function(){return this.m_motorSpeed},A.prototype.SetMaxMotorTorque=function(t){void 0===t&&(t=0),this.m_maxMotorTorque=t},A.prototype.GetMotorTorque=function(){return this.m_maxMotorTorque},A.prototype.b2RevoluteJoint=function(t){this.__super.b2Joint.call(this,t),this.m_localAnchor1.SetV(t.localAnchorA),this.m_localAnchor2.SetV(t.localAnchorB),this.m_referenceAngle=t.referenceAngle,this.m_impulse.SetZero(),this.m_motorImpulse=0,this.m_lowerAngle=t.lowerAngle,this.m_upperAngle=t.upperAngle,this.m_maxMotorTorque=t.maxMotorTorque,this.m_motorSpeed=t.motorSpeed,this.m_enableLimit=t.enableLimit,this.m_enableMotor=t.enableMotor,this.m_limitState=T.e_inactiveLimit},A.prototype.InitVelocityConstraints=function(t){var e,i=this.m_bodyA,n=this.m_bodyB,o=0;this.m_enableMotor||this.m_enableLimit,e=i.m_xf.R;var r=this.m_localAnchor1.x-i.m_sweep.localCenter.x,s=this.m_localAnchor1.y-i.m_sweep.localCenter.y;o=e.col1.x*r+e.col2.x*s,s=e.col1.y*r+e.col2.y*s,r=o,e=n.m_xf.R;var a=this.m_localAnchor2.x-n.m_sweep.localCenter.x,l=this.m_localAnchor2.y-n.m_sweep.localCenter.y;o=e.col1.x*a+e.col2.x*l,l=e.col1.y*a+e.col2.y*l,a=o;var h=i.m_invMass,u=n.m_invMass,c=i.m_invI,p=n.m_invI;if(this.m_mass.col1.x=h+u+s*s*c+l*l*p,this.m_mass.col2.x=-s*r*c-l*a*p,this.m_mass.col3.x=-s*c-l*p,this.m_mass.col1.y=this.m_mass.col2.x,this.m_mass.col2.y=h+u+r*r*c+a*a*p,this.m_mass.col3.y=r*c+a*p,this.m_mass.col1.z=this.m_mass.col3.x,this.m_mass.col2.z=this.m_mass.col3.y,this.m_mass.col3.z=c+p,this.m_motorMass=1/(c+p),0==this.m_enableMotor&&(this.m_motorImpulse=0),this.m_enableLimit){var m=n.m_sweep.a-i.m_sweep.a-this.m_referenceAngle;k.Abs(this.m_upperAngle-this.m_lowerAngle)<2*V.b2_angularSlop?this.m_limitState=T.e_equalLimits:m<=this.m_lowerAngle?(this.m_limitState!=T.e_atLowerLimit&&(this.m_impulse.z=0),this.m_limitState=T.e_atLowerLimit):m>=this.m_upperAngle?(this.m_limitState!=T.e_atUpperLimit&&(this.m_impulse.z=0),this.m_limitState=T.e_atUpperLimit):(this.m_limitState=T.e_inactiveLimit,this.m_impulse.z=0)}else this.m_limitState=T.e_inactiveLimit;if(t.warmStarting){this.m_impulse.x*=t.dtRatio,this.m_impulse.y*=t.dtRatio,this.m_motorImpulse*=t.dtRatio;var f=this.m_impulse.x,d=this.m_impulse.y;i.m_linearVelocity.x-=h*f,i.m_linearVelocity.y-=h*d,i.m_angularVelocity-=c*(r*d-s*f+this.m_motorImpulse+this.m_impulse.z),n.m_linearVelocity.x+=u*f,n.m_linearVelocity.y+=u*d,n.m_angularVelocity+=p*(a*d-l*f+this.m_motorImpulse+this.m_impulse.z)}else this.m_impulse.SetZero(),this.m_motorImpulse=0},A.prototype.SolveVelocityConstraints=function(t){var e,i=this.m_bodyA,n=this.m_bodyB,o=0,r=0,s=0,a=0,l=0,h=i.m_linearVelocity,u=i.m_angularVelocity,c=n.m_linearVelocity,p=n.m_angularVelocity,m=i.m_invMass,f=n.m_invMass,d=i.m_invI,_=n.m_invI;if(this.m_enableMotor&&this.m_limitState!=T.e_equalLimits){var y=p-u-this.m_motorSpeed,x=this.m_motorMass*-y,v=this.m_motorImpulse,b=t.dt*this.m_maxMotorTorque;this.m_motorImpulse=k.Clamp(this.m_motorImpulse+x,-b,b),u-=d*(x=this.m_motorImpulse-v),p+=_*x}if(this.m_enableLimit&&this.m_limitState!=T.e_inactiveLimit){e=i.m_xf.R,r=this.m_localAnchor1.x-i.m_sweep.localCenter.x,s=this.m_localAnchor1.y-i.m_sweep.localCenter.y,o=e.col1.x*r+e.col2.x*s,s=e.col1.y*r+e.col2.y*s,r=o,e=n.m_xf.R,a=this.m_localAnchor2.x-n.m_sweep.localCenter.x,l=this.m_localAnchor2.y-n.m_sweep.localCenter.y,o=e.col1.x*a+e.col2.x*l,l=e.col1.y*a+e.col2.y*l,a=o;var g=c.x+-p*l-h.x- -u*s,w=c.y+p*a-h.y-u*r,C=p-u;this.m_mass.Solve33(this.impulse3,-g,-w,-C),this.m_limitState==T.e_equalLimits?this.m_impulse.Add(this.impulse3):this.m_limitState==T.e_atLowerLimit?this.m_impulse.z+this.impulse3.z<0&&(this.m_mass.Solve22(this.reduced,-g,-w),this.impulse3.x=this.reduced.x,this.impulse3.y=this.reduced.y,this.impulse3.z=-this.m_impulse.z,this.m_impulse.x+=this.reduced.x,this.m_impulse.y+=this.reduced.y,this.m_impulse.z=0):this.m_limitState==T.e_atUpperLimit&&0<this.m_impulse.z+this.impulse3.z&&(this.m_mass.Solve22(this.reduced,-g,-w),this.impulse3.x=this.reduced.x,this.impulse3.y=this.reduced.y,this.impulse3.z=-this.m_impulse.z,this.m_impulse.x+=this.reduced.x,this.m_impulse.y+=this.reduced.y,this.m_impulse.z=0),h.x-=m*this.impulse3.x,h.y-=m*this.impulse3.y,u-=d*(r*this.impulse3.y-s*this.impulse3.x+this.impulse3.z),c.x+=f*this.impulse3.x,c.y+=f*this.impulse3.y,p+=_*(a*this.impulse3.y-l*this.impulse3.x+this.impulse3.z)}else{e=i.m_xf.R,r=this.m_localAnchor1.x-i.m_sweep.localCenter.x,s=this.m_localAnchor1.y-i.m_sweep.localCenter.y,o=e.col1.x*r+e.col2.x*s,s=e.col1.y*r+e.col2.y*s,r=o,e=n.m_xf.R,a=this.m_localAnchor2.x-n.m_sweep.localCenter.x,l=this.m_localAnchor2.y-n.m_sweep.localCenter.y,o=e.col1.x*a+e.col2.x*l,l=e.col1.y*a+e.col2.y*l,a=o;var D=c.x+-p*l-h.x- -u*s,S=c.y+p*a-h.y-u*r;this.m_mass.Solve22(this.impulse2,-D,-S),this.m_impulse.x+=this.impulse2.x,this.m_impulse.y+=this.impulse2.y,h.x-=m*this.impulse2.x,h.y-=m*this.impulse2.y,u-=d*(r*this.impulse2.y-s*this.impulse2.x),c.x+=f*this.impulse2.x,c.y+=f*this.impulse2.y,p+=_*(a*this.impulse2.y-l*this.impulse2.x)}i.m_linearVelocity.SetV(h),i.m_angularVelocity=u,n.m_linearVelocity.SetV(c),n.m_angularVelocity=p},A.prototype.SolvePositionConstraints=function(t){void 0===t&&(t=0);var e,i,n=0,o=this.m_bodyA,r=this.m_bodyB,s=0,a=0,l=0,h=0;if(this.m_enableLimit&&this.m_limitState!=T.e_inactiveLimit){var u=r.m_sweep.a-o.m_sweep.a-this.m_referenceAngle,c=0;this.m_limitState==T.e_equalLimits?(n=k.Clamp(u-this.m_lowerAngle,-V.b2_maxAngularCorrection,V.b2_maxAngularCorrection),c=-this.m_motorMass*n,s=k.Abs(n)):this.m_limitState==T.e_atLowerLimit?(s=-(n=u-this.m_lowerAngle),n=k.Clamp(n+V.b2_angularSlop,-V.b2_maxAngularCorrection,0),c=-this.m_motorMass*n):this.m_limitState==T.e_atUpperLimit&&(s=n=u-this.m_upperAngle,n=k.Clamp(n-V.b2_angularSlop,0,V.b2_maxAngularCorrection),c=-this.m_motorMass*n),o.m_sweep.a-=o.m_invI*c,r.m_sweep.a+=r.m_invI*c,o.SynchronizeTransform(),r.SynchronizeTransform()}e=o.m_xf.R;var p=this.m_localAnchor1.x-o.m_sweep.localCenter.x,m=this.m_localAnchor1.y-o.m_sweep.localCenter.y;a=e.col1.x*p+e.col2.x*m,m=e.col1.y*p+e.col2.y*m,p=a,e=r.m_xf.R;var f=this.m_localAnchor2.x-r.m_sweep.localCenter.x,d=this.m_localAnchor2.y-r.m_sweep.localCenter.y;a=e.col1.x*f+e.col2.x*d,d=e.col1.y*f+e.col2.y*d,f=a;var _=r.m_sweep.c.x+f-o.m_sweep.c.x-p,y=r.m_sweep.c.y+d-o.m_sweep.c.y-m,x=_*_+y*y,v=Math.sqrt(x);i=v;var b=o.m_invMass,g=r.m_invMass,w=o.m_invI,C=r.m_invI,D=10*V.b2_linearSlop;if(D*D<x){var S=1/(b+g);l=S*-_,h=S*-y;o.m_sweep.c.x-=.5*b*l,o.m_sweep.c.y-=.5*b*h,r.m_sweep.c.x+=.5*g*l,r.m_sweep.c.y+=.5*g*h,_=r.m_sweep.c.x+f-o.m_sweep.c.x-p,y=r.m_sweep.c.y+d-o.m_sweep.c.y-m}return this.K1.col1.x=b+g,this.K1.col2.x=0,this.K1.col1.y=0,this.K1.col2.y=b+g,this.K2.col1.x=w*m*m,this.K2.col2.x=-w*p*m,this.K2.col1.y=-w*p*m,this.K2.col2.y=w*p*p,this.K3.col1.x=C*d*d,this.K3.col2.x=-C*f*d,this.K3.col1.y=-C*f*d,this.K3.col2.y=C*f*f,this.K.SetM(this.K1),this.K.AddM(this.K2),this.K.AddM(this.K3),this.K.Solve(A.tImpulse,-_,-y),l=A.tImpulse.x,h=A.tImpulse.y,o.m_sweep.c.x-=o.m_invMass*l,o.m_sweep.c.y-=o.m_invMass*h,o.m_sweep.a-=o.m_invI*(p*h-m*l),r.m_sweep.c.x+=r.m_invMass*l,r.m_sweep.c.y+=r.m_invMass*h,r.m_sweep.a+=r.m_invI*(f*h-d*l),o.SynchronizeTransform(),r.SynchronizeTransform(),i<=V.b2_linearSlop&&s<=V.b2_angularSlop},Box2D.postDefs.push(function(){Box2D.Dynamics.Joints.b2RevoluteJoint.tImpulse=new G}),Box2D.inherit(x,Box2D.Dynamics.Joints.b2JointDef),x.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,x.b2RevoluteJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.localAnchorA=new G,this.localAnchorB=new G},x.prototype.b2RevoluteJointDef=function(){this.__super.b2JointDef.call(this),this.type=T.e_revoluteJoint,this.localAnchorA.Set(0,0),this.localAnchorB.Set(0,0),this.referenceAngle=0,this.lowerAngle=0,this.upperAngle=0,this.maxMotorTorque=0,this.motorSpeed=0,this.enableLimit=!1,this.enableMotor=!1},x.prototype.Initialize=function(t,e,i){this.bodyA=t,this.bodyB=e,this.localAnchorA=this.bodyA.GetLocalPoint(i),this.localAnchorB=this.bodyB.GetLocalPoint(i),this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()},Box2D.inherit(v,Box2D.Dynamics.Joints.b2Joint),v.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,v.b2WeldJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_localAnchorA=new G,this.m_localAnchorB=new G,this.m_impulse=new j,this.m_mass=new e},v.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA)},v.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB)},v.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new G(t*this.m_impulse.x,t*this.m_impulse.y)},v.prototype.GetReactionTorque=function(t){return void 0===t&&(t=0),t*this.m_impulse.z},v.prototype.b2WeldJoint=function(t){this.__super.b2Joint.call(this,t),this.m_localAnchorA.SetV(t.localAnchorA),this.m_localAnchorB.SetV(t.localAnchorB),this.m_referenceAngle=t.referenceAngle,this.m_impulse.SetZero(),this.m_mass=new e},v.prototype.InitVelocityConstraints=function(t){var e,i=0,n=this.m_bodyA,o=this.m_bodyB;e=n.m_xf.R;var r=this.m_localAnchorA.x-n.m_sweep.localCenter.x,s=this.m_localAnchorA.y-n.m_sweep.localCenter.y;i=e.col1.x*r+e.col2.x*s,s=e.col1.y*r+e.col2.y*s,r=i,e=o.m_xf.R;var a=this.m_localAnchorB.x-o.m_sweep.localCenter.x,l=this.m_localAnchorB.y-o.m_sweep.localCenter.y;i=e.col1.x*a+e.col2.x*l,l=e.col1.y*a+e.col2.y*l,a=i;var h=n.m_invMass,u=o.m_invMass,c=n.m_invI,p=o.m_invI;this.m_mass.col1.x=h+u+s*s*c+l*l*p,this.m_mass.col2.x=-s*r*c-l*a*p,this.m_mass.col3.x=-s*c-l*p,this.m_mass.col1.y=this.m_mass.col2.x,this.m_mass.col2.y=h+u+r*r*c+a*a*p,this.m_mass.col3.y=r*c+a*p,this.m_mass.col1.z=this.m_mass.col3.x,this.m_mass.col2.z=this.m_mass.col3.y,this.m_mass.col3.z=c+p,t.warmStarting?(this.m_impulse.x*=t.dtRatio,this.m_impulse.y*=t.dtRatio,this.m_impulse.z*=t.dtRatio,n.m_linearVelocity.x-=h*this.m_impulse.x,n.m_linearVelocity.y-=h*this.m_impulse.y,n.m_angularVelocity-=c*(r*this.m_impulse.y-s*this.m_impulse.x+this.m_impulse.z),o.m_linearVelocity.x+=u*this.m_impulse.x,o.m_linearVelocity.y+=u*this.m_impulse.y,o.m_angularVelocity+=p*(a*this.m_impulse.y-l*this.m_impulse.x+this.m_impulse.z)):this.m_impulse.SetZero()},v.prototype.SolveVelocityConstraints=function(t){var e,i=0,n=this.m_bodyA,o=this.m_bodyB,r=n.m_linearVelocity,s=n.m_angularVelocity,a=o.m_linearVelocity,l=o.m_angularVelocity,h=n.m_invMass,u=o.m_invMass,c=n.m_invI,p=o.m_invI;e=n.m_xf.R;var m=this.m_localAnchorA.x-n.m_sweep.localCenter.x,f=this.m_localAnchorA.y-n.m_sweep.localCenter.y;i=e.col1.x*m+e.col2.x*f,f=e.col1.y*m+e.col2.y*f,m=i,e=o.m_xf.R;var d=this.m_localAnchorB.x-o.m_sweep.localCenter.x,_=this.m_localAnchorB.y-o.m_sweep.localCenter.y;i=e.col1.x*d+e.col2.x*_,_=e.col1.y*d+e.col2.y*_,d=i;var y=a.x-l*_-r.x+s*f,x=a.y+l*d-r.y-s*m,v=l-s,b=new j;this.m_mass.Solve33(b,-y,-x,-v),this.m_impulse.Add(b),r.x-=h*b.x,r.y-=h*b.y,s-=c*(m*b.y-f*b.x+b.z),a.x+=u*b.x,a.y+=u*b.y,l+=p*(d*b.y-_*b.x+b.z),n.m_angularVelocity=s,o.m_angularVelocity=l},v.prototype.SolvePositionConstraints=function(t){var e;void 0===t&&(t=0);var i=0,n=this.m_bodyA,o=this.m_bodyB;e=n.m_xf.R;var r=this.m_localAnchorA.x-n.m_sweep.localCenter.x,s=this.m_localAnchorA.y-n.m_sweep.localCenter.y;i=e.col1.x*r+e.col2.x*s,s=e.col1.y*r+e.col2.y*s,r=i,e=o.m_xf.R;var a=this.m_localAnchorB.x-o.m_sweep.localCenter.x,l=this.m_localAnchorB.y-o.m_sweep.localCenter.y;i=e.col1.x*a+e.col2.x*l,l=e.col1.y*a+e.col2.y*l,a=i;var h=n.m_invMass,u=o.m_invMass,c=n.m_invI,p=o.m_invI,m=o.m_sweep.c.x+a-n.m_sweep.c.x-r,f=o.m_sweep.c.y+l-n.m_sweep.c.y-s,d=o.m_sweep.a-n.m_sweep.a-this.m_referenceAngle,_=10*V.b2_linearSlop,y=Math.sqrt(m*m+f*f),x=k.Abs(d);_<y&&(c*=1,p*=1),this.m_mass.col1.x=h+u+s*s*c+l*l*p,this.m_mass.col2.x=-s*r*c-l*a*p,this.m_mass.col3.x=-s*c-l*p,this.m_mass.col1.y=this.m_mass.col2.x,this.m_mass.col2.y=h+u+r*r*c+a*a*p,this.m_mass.col3.y=r*c+a*p,this.m_mass.col1.z=this.m_mass.col3.x,this.m_mass.col2.z=this.m_mass.col3.y,this.m_mass.col3.z=c+p;var v=new j;return this.m_mass.Solve33(v,-m,-f,-d),n.m_sweep.c.x-=h*v.x,n.m_sweep.c.y-=h*v.y,n.m_sweep.a-=c*(r*v.y-s*v.x+v.z),o.m_sweep.c.x+=u*v.x,o.m_sweep.c.y+=u*v.y,o.m_sweep.a+=p*(a*v.y-l*v.x+v.z),n.SynchronizeTransform(),o.SynchronizeTransform(),y<=V.b2_linearSlop&&x<=V.b2_angularSlop},Box2D.inherit(b,Box2D.Dynamics.Joints.b2JointDef),b.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,b.b2WeldJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.localAnchorA=new G,this.localAnchorB=new G},b.prototype.b2WeldJointDef=function(){this.__super.b2JointDef.call(this),this.type=T.e_weldJoint,this.referenceAngle=0},b.prototype.Initialize=function(t,e,i){this.bodyA=t,this.bodyB=e,this.localAnchorA.SetV(this.bodyA.GetLocalPoint(i)),this.localAnchorB.SetV(this.bodyB.GetLocalPoint(i)),this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()}}(),function(){var t=Box2D.Dynamics.b2DebugDraw;t.b2DebugDraw=function(){this.m_drawScale=1,this.m_lineThickness=1,this.m_alpha=1,this.m_fillAlpha=1,this.m_xformScale=1;var t=this;this.m_sprite={graphics:{clear:function(){t.m_ctx.clearRect(0,0,t.m_ctx.canvas.width,t.m_ctx.canvas.height)}}}},t.prototype._color=function(t,e){return"rgba("+((16711680&t)>>16)+","+((65280&t)>>8)+","+(255&t)+","+e+")"},t.prototype.b2DebugDraw=function(){this.m_drawFlags=0},t.prototype.SetFlags=function(t){void 0===t&&(t=0),this.m_drawFlags=t},t.prototype.GetFlags=function(){return this.m_drawFlags},t.prototype.AppendFlags=function(t){void 0===t&&(t=0),this.m_drawFlags|=t},t.prototype.ClearFlags=function(t){void 0===t&&(t=0),this.m_drawFlags&=~t},t.prototype.SetSprite=function(t){this.m_ctx=t},t.prototype.GetSprite=function(){return this.m_ctx},t.prototype.SetDrawScale=function(t){void 0===t&&(t=0),this.m_drawScale=t},t.prototype.GetDrawScale=function(){return this.m_drawScale},t.prototype.SetLineThickness=function(t){void 0===t&&(t=0),this.m_lineThickness=t,this.m_ctx.strokeWidth=t},t.prototype.GetLineThickness=function(){return this.m_lineThickness},t.prototype.SetAlpha=function(t){void 0===t&&(t=0),this.m_alpha=t},t.prototype.GetAlpha=function(){return this.m_alpha},t.prototype.SetFillAlpha=function(t){void 0===t&&(t=0),this.m_fillAlpha=t},t.prototype.GetFillAlpha=function(){return this.m_fillAlpha},t.prototype.SetXFormScale=function(t){void 0===t&&(t=0),this.m_xformScale=t},t.prototype.GetXFormScale=function(){return this.m_xformScale},t.prototype.DrawPolygon=function(t,e,i){if(e){var n=this.m_ctx,o=this.m_drawScale;n.beginPath(),n.strokeStyle=this._color(i.color,this.m_alpha),n.moveTo(t[0].x*o,t[0].y*o);for(var r=1;r<e;r++)n.lineTo(t[r].x*o,t[r].y*o);n.lineTo(t[0].x*o,t[0].y*o),n.closePath(),n.stroke()}},t.prototype.DrawSolidPolygon=function(t,e,i){if(e){var n=this.m_ctx,o=this.m_drawScale;n.beginPath(),n.strokeStyle=this._color(i.color,this.m_alpha),n.fillStyle=this._color(i.color,this.m_fillAlpha),n.moveTo(t[0].x*o,t[0].y*o);for(var r=1;r<e;r++)n.lineTo(t[r].x*o,t[r].y*o);n.lineTo(t[0].x*o,t[0].y*o),n.closePath(),n.fill(),n.stroke()}},t.prototype.DrawCircle=function(t,e,i){if(e){var n=this.m_ctx,o=this.m_drawScale;n.beginPath(),n.strokeStyle=this._color(i.color,this.m_alpha),n.arc(t.x*o,t.y*o,e*o,0,2*Math.PI,!0),n.closePath(),n.stroke()}},t.prototype.DrawSolidCircle=function(t,e,i,n){if(e){var o=this.m_ctx,r=this.m_drawScale,s=t.x*r,a=t.y*r;o.moveTo(0,0),o.beginPath(),o.strokeStyle=this._color(n.color,this.m_alpha),o.fillStyle=this._color(n.color,this.m_fillAlpha),o.arc(s,a,e*r,0,2*Math.PI,!0),o.moveTo(s,a),o.lineTo((t.x+i.x*e)*r,(t.y+i.y*e)*r),o.closePath(),o.fill(),o.stroke()}},t.prototype.DrawSegment=function(t,e,i){var n=this.m_ctx,o=this.m_drawScale;n.strokeStyle=this._color(i.color,this.m_alpha),n.beginPath(),n.moveTo(t.x*o,t.y*o),n.lineTo(e.x*o,e.y*o),n.closePath(),n.stroke()},t.prototype.DrawTransform=function(t){var e=this.m_ctx,i=this.m_drawScale;e.beginPath(),e.strokeStyle=this._color(16711680,this.m_alpha),e.moveTo(t.position.x*i,t.position.y*i),e.lineTo((t.position.x+this.m_xformScale*t.R.col1.x)*i,(t.position.y+this.m_xformScale*t.R.col1.y)*i),e.strokeStyle=this._color(65280,this.m_alpha),e.moveTo(t.position.x*i,t.position.y*i),e.lineTo((t.position.x+this.m_xformScale*t.R.col2.x)*i,(t.position.y+this.m_xformScale*t.R.col2.y)*i),e.closePath(),e.stroke()}}(),i=0;i<Box2D.postDefs.length;++i)Box2D.postDefs[i]();!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).PIXI=t()}}(function(){return function r(s,a,l){function h(i,t){if(!a[i]){if(!s[i]){var e="function"==typeof require&&require;if(!t&&e)return e(i,!0);if(u)return u(i,!0);var n=new Error("Cannot find module '"+i+"'");throw n.code="MODULE_NOT_FOUND",n}var o=a[i]={exports:{}};s[i][0].call(o.exports,function(t){var e=s[i][1][t];return h(e||t)},o,o.exports,r,s,a,l)}return a[i].exports}for(var u="function"==typeof require&&require,t=0;t<l.length;t++)h(l[t]);return h}({1:[function(t,e,i){function n(t){var e=32;return(t&=-t)&&e--,65535&t&&(e-=16),16711935&t&&(e-=8),252645135&t&&(e-=4),858993459&t&&(e-=2),1431655765&t&&(e-=1),e}i.INT_BITS=32,i.INT_MAX=2147483647,i.INT_MIN=-1<<31,i.sign=function(t){return(0<t)-(t<0)},i.abs=function(t){var e=t>>31;return(t^e)-e},i.min=function(t,e){return e^(t^e)&-(t<e)},i.max=function(t,e){return t^(t^e)&-(t<e)},i.isPow2=function(t){return!(t&t-1||!t)},i.log2=function(t){var e,i;return e=(65535<t)<<4,e|=i=(255<(t>>>=e))<<3,e|=i=(15<(t>>>=i))<<2,(e|=i=(3<(t>>>=i))<<1)|(t>>>=i)>>1},i.log10=function(t){return 1e9<=t?9:1e8<=t?8:1e7<=t?7:1e6<=t?6:1e5<=t?5:1e4<=t?4:1e3<=t?3:100<=t?2:10<=t?1:0},i.popCount=function(t){return 16843009*((t=(858993459&(t-=t>>>1&1431655765))+(t>>>2&858993459))+(t>>>4)&252645135)>>>24},i.countTrailingZeros=n,i.nextPow2=function(t){return t+=0===t,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)+1},i.prevPow2=function(t){return t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)-(t>>>1)},i.parity=function(t){return t^=t>>>16,t^=t>>>8,t^=t>>>4,27030>>>(t&=15)&1};var o=new Array(256);!function(t){for(var e=0;e<256;++e){var i=e,n=e,o=7;for(i>>>=1;i;i>>>=1)n<<=1,n|=1&i,--o;t[e]=n<<o&255}}(o),i.reverse=function(t){return o[255&t]<<24|o[t>>>8&255]<<16|o[t>>>16&255]<<8|o[t>>>24&255]},i.interleave2=function(t,e){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t&=65535)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e&=65535)|e<<8))|e<<4))|e<<2))|e<<1))<<1},i.deinterleave2=function(t,e){return(t=65535&((t=16711935&((t=252645135&((t=858993459&((t=t>>>e&1431655765)|t>>>1))|t>>>2))|t>>>4))|t>>>16))<<16>>16},i.interleave3=function(t,e,i){return t=1227133513&((t=3272356035&((t=251719695&((t=4278190335&((t&=1023)|t<<16))|t<<8))|t<<4))|t<<2),(t|=(e=1227133513&((e=3272356035&((e=251719695&((e=4278190335&((e&=1023)|e<<16))|e<<8))|e<<4))|e<<2))<<1)|(i=1227133513&((i=3272356035&((i=251719695&((i=4278190335&((i&=1023)|i<<16))|i<<8))|i<<4))|i<<2))<<2},i.deinterleave3=function(t,e){return(t=1023&((t=4278190335&((t=251719695&((t=3272356035&((t=t>>>e&1227133513)|t>>>2))|t>>>4))|t>>>8))|t>>>16))<<22>>22},i.nextCombination=function(t){var e=t|t-1;return e+1|(~e&-~e)-1>>>n(t)+1}},{}],2:[function(t,e,i){function n(t,e,i){i=i||2;var n,o,r,s,a,l,h,u=e&&e.length,c=u?e[0]*i:t.length,p=d(t,0,c,i,!0),m=[];if(!p||p.next===p.prev)return m;if(u&&(p=function(t,e,i,n){var o,r,s,a,l,h=[];for(o=0,r=e.length;o<r;o++)s=e[o]*n,a=o<r-1?e[o+1]*n:t.length,(l=d(t,s,a,n,!1))===l.next&&(l.steiner=!0),h.push(g(l));for(h.sort(x),o=0;o<h.length;o++)v(h[o],i),i=_(i,i.next);return i}(t,e,p,i)),t.length>80*i){n=r=t[0],o=s=t[1];for(var f=i;f<c;f+=i)(a=t[f])<n&&(n=a),(l=t[f+1])<o&&(o=l),r<a&&(r=a),s<l&&(s=l);h=0!==(h=Math.max(r-n,s-o))?1/h:0}return y(p,m,i,n,o,h),m}function d(t,e,i,n,o){var r,s;if(o===0<A(t,e,i,n))for(r=e;r<i;r+=n)s=l(r,t[r],t[r+1],s);else for(r=i-n;e<=r;r-=n)s=l(r,t[r],t[r+1],s);return s&&a(s,s.next)&&(T(s),s=s.next),s}function _(t,e){if(!t)return t;e||(e=t);var i,n=t;do{if(i=!1,n.steiner||!a(n,n.next)&&0!==C(n.prev,n,n.next))n=n.next;else{if(T(n),(n=e=n.prev)===n.next)break;i=!0}}while(i||n!==e);return e}function y(t,e,i,n,o,r,s){if(t){!s&&r&&function(t,e,i,n){var o=t;for(;null===o.z&&(o.z=b(o.x,o.y,e,i,n)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next,o!==t;);o.prevZ.nextZ=null,o.prevZ=null,function(t){var e,i,n,o,r,s,a,l,h=1;do{for(i=t,r=t=null,s=0;i;){for(s++,n=i,e=a=0;e<h&&(a++,n=n.nextZ);e++);for(l=h;0<a||0<l&&n;)0!==a&&(0===l||!n||i.z<=n.z)?(i=(o=i).nextZ,a--):(n=(o=n).nextZ,l--),r?r.nextZ=o:t=o,o.prevZ=r,r=o;i=n}r.nextZ=null,h*=2}while(1<s)}(o)}(t,n,o,r);for(var a,l,h=t;t.prev!==t.next;)if(a=t.prev,l=t.next,r?c(t,n,o,r):u(t))e.push(a.i/i),e.push(t.i/i),e.push(l.i/i),T(t),t=l.next,h=l.next;else if((t=l)===h){s?1===s?y(t=p(t,e,i),e,i,n,o,r,2):2===s&&m(t,e,i,n,o,r):y(_(t),e,i,n,o,r,1);break}}}function u(t){var e=t.prev,i=t,n=t.next;if(0<=C(e,i,n))return!1;for(var o=t.next.next;o!==t.prev;){if(w(e.x,e.y,i.x,i.y,n.x,n.y,o.x,o.y)&&0<=C(o.prev,o,o.next))return!1;o=o.next}return!0}function c(t,e,i,n){var o=t.prev,r=t,s=t.next;if(0<=C(o,r,s))return!1;for(var a=o.x<r.x?o.x<s.x?o.x:s.x:r.x<s.x?r.x:s.x,l=o.y<r.y?o.y<s.y?o.y:s.y:r.y<s.y?r.y:s.y,h=o.x>r.x?o.x>s.x?o.x:s.x:r.x>s.x?r.x:s.x,u=o.y>r.y?o.y>s.y?o.y:s.y:r.y>s.y?r.y:s.y,c=b(a,l,e,i,n),p=b(h,u,e,i,n),m=t.prevZ,f=t.nextZ;m&&m.z>=c&&f&&f.z<=p;){if(m!==t.prev&&m!==t.next&&w(o.x,o.y,r.x,r.y,s.x,s.y,m.x,m.y)&&0<=C(m.prev,m,m.next))return!1;if(m=m.prevZ,f!==t.prev&&f!==t.next&&w(o.x,o.y,r.x,r.y,s.x,s.y,f.x,f.y)&&0<=C(f.prev,f,f.next))return!1;f=f.nextZ}for(;m&&m.z>=c;){if(m!==t.prev&&m!==t.next&&w(o.x,o.y,r.x,r.y,s.x,s.y,m.x,m.y)&&0<=C(m.prev,m,m.next))return!1;m=m.prevZ}for(;f&&f.z<=p;){if(f!==t.prev&&f!==t.next&&w(o.x,o.y,r.x,r.y,s.x,s.y,f.x,f.y)&&0<=C(f.prev,f,f.next))return!1;f=f.nextZ}return!0}function p(t,e,i){var n=t;do{var o=n.prev,r=n.next.next;!a(o,r)&&f(o,n,n.next,r)&&D(o,r)&&D(r,o)&&(e.push(o.i/i),e.push(n.i/i),e.push(r.i/i),T(n),T(n.next),n=t=r),n=n.next}while(n!==t);return n}function m(t,e,i,n,o,r){var s,a,l=t;do{for(var h=l.next.next;h!==l.prev;){if(l.i!==h.i&&(a=h,(s=l).next.i!==a.i&&s.prev.i!==a.i&&!function(t,e){var i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&f(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}(s,a)&&D(s,a)&&D(a,s)&&function(t,e){var i=t,n=!1,o=(t.x+e.x)/2,r=(t.y+e.y)/2;for(;i.y>r!=i.next.y>r&&i.next.y!==i.y&&o<(i.next.x-i.x)*(r-i.y)/(i.next.y-i.y)+i.x&&(n=!n),i=i.next,i!==t;);return n}(s,a))){var u=S(l,h);return l=_(l,l.next),u=_(u,u.next),y(l,e,i,n,o,r),void y(u,e,i,n,o,r)}h=h.next}l=l.next}while(l!==t)}function x(t,e){return t.x-e.x}function v(t,e){if(e=function(t,e){var i,n=e,o=t.x,r=t.y,s=-1/0;do{if(r<=n.y&&r>=n.next.y&&n.next.y!==n.y){var a=n.x+(r-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(a<=o&&s<a){if((s=a)===o){if(r===n.y)return n;if(r===n.next.y)return n.next}i=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!i)return null;if(o===s)return i.prev;var l,h=i,u=i.x,c=i.y,p=1/0;n=i.next;for(;n!==h;)o>=n.x&&n.x>=u&&o!==n.x&&w(r<c?o:s,r,u,c,r<c?s:o,r,n.x,n.y)&&((l=Math.abs(r-n.y)/(o-n.x))<p||l===p&&n.x>i.x)&&D(n,t)&&(i=n,p=l),n=n.next;return i}(t,e)){var i=S(e,t);_(i,i.next)}}function b(t,e,i,n,o){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*o)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*o)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function g(t){for(var e=t,i=t;e.x<i.x&&(i=e),(e=e.next)!==t;);return i}function w(t,e,i,n,o,r,s,a){return 0<=(o-s)*(e-a)-(t-s)*(r-a)&&0<=(t-s)*(n-a)-(i-s)*(e-a)&&0<=(i-s)*(r-a)-(o-s)*(n-a)}function C(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function a(t,e){return t.x===e.x&&t.y===e.y}function f(t,e,i,n){return!!(a(t,e)&&a(i,n)||a(t,n)&&a(i,e))||0<C(t,e,i)!=0<C(t,e,n)&&0<C(i,n,t)!=0<C(i,n,e)}function D(t,e){return C(t.prev,t,t.next)<0?0<=C(t,e,t.next)&&0<=C(t,t.prev,e):C(t,e,t.prev)<0||C(t,t.next,e)<0}function S(t,e){var i=new s(t.i,t.x,t.y),n=new s(e.i,e.x,e.y),o=t.next,r=e.prev;return(t.next=e).prev=t,(i.next=o).prev=i,(n.next=i).prev=n,(r.next=n).prev=r,n}function l(t,e,i,n){var o=new s(t,e,i);return n?(o.next=n.next,(o.prev=n).next.prev=o,n.next=o):(o.prev=o).next=o,o}function T(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function s(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function A(t,e,i,n){for(var o=0,r=e,s=i-n;r<i;r+=n)o+=(t[s]-t[r])*(t[r+1]+t[s+1]),s=r;return o}e.exports=n,(e.exports.default=n).deviation=function(t,e,i,n){var o=e&&e.length,r=o?e[0]*i:t.length,s=Math.abs(A(t,0,r,i));if(o)for(var a=0,l=e.length;a<l;a++){var h=e[a]*i,u=a<l-1?e[a+1]*i:t.length;s-=Math.abs(A(t,h,u,i))}var c=0;for(a=0;a<n.length;a+=3){var p=n[a]*i,m=n[a+1]*i,f=n[a+2]*i;c+=Math.abs((t[p]-t[f])*(t[m+1]-t[p+1])-(t[p]-t[m])*(t[f+1]-t[p+1]))}return 0===s&&0===c?0:Math.abs((c-s)/s)},n.flatten=function(t){for(var e=t[0][0].length,i={vertices:[],holes:[],dimensions:e},n=0,o=0;o<t.length;o++){for(var r=0;r<t[o].length;r++)for(var s=0;s<e;s++)i.vertices.push(t[o][r][s]);0<o&&(n+=t[o-1].length,i.holes.push(n))}return i}},{}],3:[function(t,e,i){var n=Object.prototype.hasOwnProperty,m="~";function h(){}function r(t,e,i){this.fn=t,this.context=e,this.once=i||!1}function o(){this._events=new h,this._eventsCount=0}Object.create&&(h.prototype=Object.create(null),(new h).__proto__||(m=!1)),o.prototype.eventNames=function(){var t,e,i=[];if(0===this._eventsCount)return i;for(e in t=this._events)n.call(t,e)&&i.push(m?e.slice(1):e);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(t)):i},o.prototype.listeners=function(t,e){var i=m?m+t:t,n=this._events[i];if(e)return!!n;if(!n)return[];if(n.fn)return[n.fn];for(var o=0,r=n.length,s=new Array(r);o<r;o++)s[o]=n[o].fn;return s},o.prototype.emit=function(t,e,i,n,o,r){var s=m?m+t:t;if(!this._events[s])return!1;var a,l,h=this._events[s],u=arguments.length;if(h.fn){switch(h.once&&this.removeListener(t,h.fn,void 0,!0),u){case 1:return h.fn.call(h.context),!0;case 2:return h.fn.call(h.context,e),!0;case 3:return h.fn.call(h.context,e,i),!0;case 4:return h.fn.call(h.context,e,i,n),!0;case 5:return h.fn.call(h.context,e,i,n,o),!0;case 6:return h.fn.call(h.context,e,i,n,o,r),!0}for(l=1,a=new Array(u-1);l<u;l++)a[l-1]=arguments[l];h.fn.apply(h.context,a)}else{var c,p=h.length;for(l=0;l<p;l++)switch(h[l].once&&this.removeListener(t,h[l].fn,void 0,!0),u){case 1:h[l].fn.call(h[l].context);break;case 2:h[l].fn.call(h[l].context,e);break;case 3:h[l].fn.call(h[l].context,e,i);break;case 4:h[l].fn.call(h[l].context,e,i,n);break;default:if(!a)for(c=1,a=new Array(u-1);c<u;c++)a[c-1]=arguments[c];h[l].fn.apply(h[l].context,a)}}return!0},o.prototype.on=function(t,e,i){var n=new r(e,i||this),o=m?m+t:t;return this._events[o]?this._events[o].fn?this._events[o]=[this._events[o],n]:this._events[o].push(n):(this._events[o]=n,this._eventsCount++),this},o.prototype.once=function(t,e,i){var n=new r(e,i||this,!0),o=m?m+t:t;return this._events[o]?this._events[o].fn?this._events[o]=[this._events[o],n]:this._events[o].push(n):(this._events[o]=n,this._eventsCount++),this},o.prototype.removeListener=function(t,e,i,n){var o=m?m+t:t;if(!this._events[o])return this;if(!e)return 0==--this._eventsCount?this._events=new h:delete this._events[o],this;var r=this._events[o];if(r.fn)r.fn!==e||n&&!r.once||i&&r.context!==i||(0==--this._eventsCount?this._events=new h:delete this._events[o]);else{for(var s=0,a=[],l=r.length;s<l;s++)(r[s].fn!==e||n&&!r[s].once||i&&r[s].context!==i)&&a.push(r[s]);a.length?this._events[o]=1===a.length?a[0]:a:0==--this._eventsCount?this._events=new h:delete this._events[o]}return this},o.prototype.removeAllListeners=function(t){var e;return t?(e=m?m+t:t,this._events[e]&&(0==--this._eventsCount?this._events=new h:delete this._events[e])):(this._events=new h,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prototype.setMaxListeners=function(){return this},o.prefixed=m,o.EventEmitter=o,void 0!==e&&(e.exports=o)},{}],4:[function(t,i,e){!function(t){var o=/iPhone/i,r=/iPod/i,s=/iPad/i,a=/\bAndroid(?:.+)Mobile\b/i,l=/Android/i,h=/\bAndroid(?:.+)SD4930UR\b/i,u=/\bAndroid(?:.+)(?:KF[A-Z]{2,4})\b/i,c=/Windows Phone/i,p=/\bWindows(?:.+)ARM\b/i,m=/BlackBerry/i,f=/BB10/i,d=/Opera Mini/i,_=/\b(CriOS|Chrome)(?:.+)Mobile/i,y=/\Mobile(?:.+)Firefox\b/i;function x(t,e){return t.test(e)}function e(t){var e=t||("undefined"!=typeof navigator?navigator.userAgent:""),i=e.split("[FBAN");void 0!==i[1]&&(e=i[0]),void 0!==(i=e.split("Twitter"))[1]&&(e=i[0]);var n={apple:{phone:x(o,e)&&!x(c,e),ipod:x(r,e),tablet:!x(o,e)&&x(s,e)&&!x(c,e),device:(x(o,e)||x(r,e)||x(s,e))&&!x(c,e)},amazon:{phone:x(h,e),tablet:!x(h,e)&&x(u,e),device:x(h,e)||x(u,e)},android:{phone:!x(c,e)&&x(h,e)||!x(c,e)&&x(a,e),tablet:!x(c,e)&&!x(h,e)&&!x(a,e)&&(x(u,e)||x(l,e)),device:!x(c,e)&&(x(h,e)||x(u,e)||x(a,e)||x(l,e))},windows:{phone:x(c,e),tablet:x(p,e),device:x(c,e)||x(p,e)},other:{blackberry:x(m,e),blackberry10:x(f,e),opera:x(d,e),firefox:x(y,e),chrome:x(_,e),device:x(m,e)||x(f,e)||x(d,e)||x(y,e)||x(_,e)}};return n.any=n.apple.device||n.android.device||n.windows.device||n.other.device,n.phone=n.apple.phone||n.android.phone||n.windows.phone,n.tablet=n.apple.tablet||n.android.tablet||n.windows.tablet,n}void 0!==i&&i.exports&&"undefined"==typeof window?i.exports=e:void 0!==i&&i.exports&&"undefined"!=typeof window?i.exports=e():t.isMobile=e()}(this)},{}],5:[function(t,e,i){Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}();function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var n=function(){function n(t,e,i){void 0===e&&(e=!1),r(this,n),this._fn=t,this._once=e,this._thisArg=i,this._next=this._prev=this._owner=null}return o(n,[{key:"detach",value:function(){return null!==this._owner&&(this._owner.detach(this),!0)}}]),n}();function s(t,e){return t._head?(t._tail._next=e)._prev=t._tail:t._head=e,(t._tail=e)._owner=t,e}var a=function(){function t(){r(this,t),this._head=this._tail=void 0}return o(t,[{key:"handlers",value:function(){var t=!(arguments.length<=0||void 0===arguments[0])&&arguments[0],e=this._head;if(t)return!!e;for(var i=[];e;)i.push(e),e=e._next;return i}},{key:"has",value:function(t){if(!(t instanceof n))throw new Error("MiniSignal#has(): First arg must be a MiniSignalBinding object.");return t._owner===this}},{key:"dispatch",value:function(){var t=this._head;if(!t)return!1;for(;t;)t._once&&this.detach(t),t._fn.apply(t._thisArg,arguments),t=t._next;return!0}},{key:"add",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?null:arguments[1];if("function"!=typeof t)throw new Error("MiniSignal#add(): First arg must be a Function.");return s(this,new n(t,!1,e))}},{key:"once",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?null:arguments[1];if("function"!=typeof t)throw new Error("MiniSignal#once(): First arg must be a Function.");return s(this,new n(t,!0,e))}},{key:"detach",value:function(t){if(!(t instanceof n))throw new Error("MiniSignal#detach(): First arg must be a MiniSignalBinding object.");return t._owner!==this||(t._prev&&(t._prev._next=t._next),t._next&&(t._next._prev=t._prev),t===this._head?(this._head=t._next,null===t._next&&(this._tail=null)):t===this._tail&&(this._tail=t._prev,this._tail._next=null),t._owner=null),this}},{key:"detachAll",value:function(){var t=this._head;if(!t)return this;for(this._head=this._tail=null;t;)t._owner=null,t=t._next;return this}}]),t}();a.MiniSignalBinding=n,i.default=a,e.exports=i.default},{}],6:[function(t,e,i){var l=Object.getOwnPropertySymbols,h=Object.prototype.hasOwnProperty,u=Object.prototype.propertyIsEnumerable;e.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},i=0;i<10;i++)e["_"+String.fromCharCode(i)]=i;if("0123456789"!==Object.getOwnPropertyNames(e).map(function(t){return e[t]}).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach(function(t){n[t]=t}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(t){return!1}}()?Object.assign:function(t,e){for(var i,n,o=function(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}(t),r=1;r<arguments.length;r++){for(var s in i=Object(arguments[r]))h.call(i,s)&&(o[s]=i[s]);if(l){n=l(i);for(var a=0;a<n.length;a++)u.call(i,n[a])&&(o[n[a]]=i[n[a]])}}return o}},{}],7:[function(t,e,i){e.exports=function(t,e){e=e||{};for(var n={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},i=n.parser[e.strictMode?"strict":"loose"].exec(t),o={},r=14;r--;)o[n.key[r]]=i[r]||"";return o[n.q.name]={},o[n.key[12]].replace(n.q.parser,function(t,e,i){e&&(o[n.q.name][e]=i)}),o}},{}],8:[function(t,e,h){(function(o){function r(t,e){for(var i=0,n=t.length-1;0<=n;n--){var o=t[n];"."===o?t.splice(n,1):".."===o?(t.splice(n,1),i++):i&&(t.splice(n,1),i--)}if(e)for(;i--;i)t.unshift("..");return t}var e=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,s=function(t){return e.exec(t).slice(1)};function a(t,e){if(t.filter)return t.filter(e);for(var i=[],n=0;n<t.length;n++)e(t[n],n,t)&&i.push(t[n]);return i}h.resolve=function(){for(var t="",e=!1,i=arguments.length-1;-1<=i&&!e;i--){var n=0<=i?arguments[i]:o.cwd();if("string"!=typeof n)throw new TypeError("Arguments to path.resolve must be strings");n&&(t=n+"/"+t,e="/"===n.charAt(0))}return(e?"/":"")+(t=r(a(t.split("/"),function(t){return!!t}),!e).join("/"))||"."},h.normalize=function(t){var e=h.isAbsolute(t),i="/"===n(t,-1);return(t=r(a(t.split("/"),function(t){return!!t}),!e).join("/"))||e||(t="."),t&&i&&(t+="/"),(e?"/":"")+t},h.isAbsolute=function(t){return"/"===t.charAt(0)},h.join=function(){var t=Array.prototype.slice.call(arguments,0);return h.normalize(a(t,function(t,e){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))},h.relative=function(t,e){function i(t){for(var e=0;e<t.length&&""===t[e];e++);for(var i=t.length-1;0<=i&&""===t[i];i--);return i<e?[]:t.slice(e,i-e+1)}t=h.resolve(t).substr(1),e=h.resolve(e).substr(1);for(var n=i(t.split("/")),o=i(e.split("/")),r=Math.min(n.length,o.length),s=r,a=0;a<r;a++)if(n[a]!==o[a]){s=a;break}var l=[];for(a=s;a<n.length;a++)l.push("..");return(l=l.concat(o.slice(s))).join("/")},h.sep="/",h.delimiter=":",h.dirname=function(t){var e=s(t),i=e[0],n=e[1];return i||n?(n&&(n=n.substr(0,n.length-1)),i+n):"."},h.basename=function(t,e){var i=s(t)[2];return e&&i.substr(-1*e.length)===e&&(i=i.substr(0,i.length-e.length)),i},h.extname=function(t){return s(t)[3]};var n="b"==="ab".substr(-1)?function(t,e,i){return t.substr(e,i)}:function(t,e,i){return e<0&&(e=t.length+e),t.substr(e,i)}}).call(this,t("_process"))},{_process:26}],9:[function(t,e,i){var o=new ArrayBuffer(0),r=function(t,e,i,n){this.gl=t,this.buffer=t.createBuffer(),this.type=e||t.ARRAY_BUFFER,this.drawType=n||t.STATIC_DRAW,this.data=o,i&&this.upload(i),this._updateID=0};r.prototype.upload=function(t,e,i){i||this.bind();var n=this.gl;t=t||this.data,e=e||0,this.data.byteLength>=t.byteLength?n.bufferSubData(this.type,e,t):n.bufferData(this.type,t,this.drawType),this.data=t},r.prototype.bind=function(){this.gl.bindBuffer(this.type,this.buffer)},r.createVertexBuffer=function(t,e,i){return new r(t,t.ARRAY_BUFFER,e,i)},r.createIndexBuffer=function(t,e,i){return new r(t,t.ELEMENT_ARRAY_BUFFER,e,i)},r.create=function(t,e,i,n){return new r(t,e,i,n)},r.prototype.destroy=function(){this.gl.deleteBuffer(this.buffer)},e.exports=r},{}],10:[function(t,e,i){var s=t("./GLTexture"),a=function(t,e,i){this.gl=t,this.framebuffer=t.createFramebuffer(),this.stencil=null,this.texture=null,this.width=e||100,this.height=i||100};a.prototype.enableTexture=function(t){var e=this.gl;this.texture=t||new s(e),this.texture.bind(),this.bind(),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this.texture.texture,0)},a.prototype.enableStencil=function(){if(!this.stencil){var t=this.gl;this.stencil=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,this.stencil),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,this.stencil),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,this.width,this.height)}},a.prototype.clear=function(t,e,i,n){this.bind();var o=this.gl;o.clearColor(t,e,i,n),o.clear(o.COLOR_BUFFER_BIT|o.DEPTH_BUFFER_BIT)},a.prototype.bind=function(){var t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer)},a.prototype.unbind=function(){var t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,null)},a.prototype.resize=function(t,e){var i=this.gl;this.width=t,this.height=e,this.texture&&this.texture.uploadData(null,t,e),this.stencil&&(i.bindRenderbuffer(i.RENDERBUFFER,this.stencil),i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,t,e))},a.prototype.destroy=function(){var t=this.gl;this.texture&&this.texture.destroy(),t.deleteFramebuffer(this.framebuffer),this.gl=null,this.stencil=null,this.texture=null},a.createRGBA=function(t,e,i,n){var o=s.fromData(t,null,e,i);o.enableNearestScaling(),o.enableWrapClamp();var r=new a(t,e,i);return r.enableTexture(o),r.unbind(),r},a.createFloat32=function(t,e,i,n){var o=new s.fromData(t,n,e,i);o.enableNearestScaling(),o.enableWrapClamp();var r=new a(t,e,i);return r.enableTexture(o),r.unbind(),r},e.exports=a},{"./GLTexture":12}],11:[function(t,e,i){var r=t("./shader/compileProgram"),s=t("./shader/extractAttributes"),a=t("./shader/extractUniforms"),l=t("./shader/setPrecision"),h=t("./shader/generateUniformAccessObject"),n=function(t,e,i,n,o){this.gl=t,n&&(e=l(e,n),i=l(i,n)),this.program=r(t,e,i,o),this.attributes=s(t,this.program),this.uniformData=a(t,this.program),this.uniforms=h(t,this.uniformData)};n.prototype.bind=function(){return this.gl.useProgram(this.program),this},n.prototype.destroy=function(){this.attributes=null,this.uniformData=null,this.uniforms=null,this.gl.deleteProgram(this.program)},e.exports=n},{"./shader/compileProgram":17,"./shader/extractAttributes":19,"./shader/extractUniforms":20,"./shader/generateUniformAccessObject":21,"./shader/setPrecision":25}],12:[function(t,e,i){var r=function(t,e,i,n,o){this.gl=t,this.texture=t.createTexture(),this.mipmap=!1,this.premultiplyAlpha=!1,this.width=e||-1,this.height=i||-1,this.format=n||t.RGBA,this.type=o||t.UNSIGNED_BYTE},o=!(r.prototype.upload=function(t){this.bind();var e=this.gl;e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.premultiplyAlpha);var i=t.videoWidth||t.width,n=t.videoHeight||t.height;n!==this.height||i!==this.width?e.texImage2D(e.TEXTURE_2D,0,this.format,this.format,this.type,t):e.texSubImage2D(e.TEXTURE_2D,0,0,0,this.format,this.type,t),this.width=i,this.height=n});r.prototype.uploadData=function(t,e,i){this.bind();var n=this.gl;if(t instanceof Float32Array){if(!o){if(!n.getExtension("OES_texture_float"))throw new Error("floating point textures not available");o=!0}this.type=n.FLOAT}else this.type=this.type||n.UNSIGNED_BYTE;n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.premultiplyAlpha),e!==this.width||i!==this.height?n.texImage2D(n.TEXTURE_2D,0,this.format,e,i,0,this.format,this.type,t||null):n.texSubImage2D(n.TEXTURE_2D,0,0,0,e,i,this.format,this.type,t||null),this.width=e,this.height=i},r.prototype.bind=function(t){var e=this.gl;void 0!==t&&e.activeTexture(e.TEXTURE0+t),e.bindTexture(e.TEXTURE_2D,this.texture)},r.prototype.unbind=function(){var t=this.gl;t.bindTexture(t.TEXTURE_2D,null)},r.prototype.minFilter=function(t){var e=this.gl;this.bind(),this.mipmap?e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,t?e.LINEAR_MIPMAP_LINEAR:e.NEAREST_MIPMAP_NEAREST):e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,t?e.LINEAR:e.NEAREST)},r.prototype.magFilter=function(t){var e=this.gl;this.bind(),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,t?e.LINEAR:e.NEAREST)},r.prototype.enableMipmap=function(){var t=this.gl;this.bind(),this.mipmap=!0,t.generateMipmap(t.TEXTURE_2D)},r.prototype.enableLinearScaling=function(){this.minFilter(!0),this.magFilter(!0)},r.prototype.enableNearestScaling=function(){this.minFilter(!1),this.magFilter(!1)},r.prototype.enableWrapClamp=function(){var t=this.gl;this.bind(),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)},r.prototype.enableWrapRepeat=function(){var t=this.gl;this.bind(),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT)},r.prototype.enableWrapMirrorRepeat=function(){var t=this.gl;this.bind(),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.MIRRORED_REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.MIRRORED_REPEAT)},r.prototype.destroy=function(){this.gl.deleteTexture(this.texture)},r.fromSource=function(t,e,i){var n=new r(t);return n.premultiplyAlpha=i||!1,n.upload(e),n},r.fromData=function(t,e,i,n){var o=new r(t);return o.uploadData(e,i,n),o},e.exports=r},{}],13:[function(t,e,i){var o=t("./setVertexAttribArrays");function n(t,e){if(this.nativeVaoExtension=null,n.FORCE_NATIVE||(this.nativeVaoExtension=t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object")),this.nativeState=e,this.nativeVaoExtension){this.nativeVao=this.nativeVaoExtension.createVertexArrayOES();var i=t.getParameter(t.MAX_VERTEX_ATTRIBS);this.nativeState={tempAttribState:new Array(i),attribState:new Array(i)}}this.gl=t,this.attributes=[],this.indexBuffer=null,this.dirty=!1}n.prototype.constructor=n,(e.exports=n).FORCE_NATIVE=!1,n.prototype.bind=function(){if(this.nativeVao){if(this.nativeVaoExtension.bindVertexArrayOES(this.nativeVao),this.dirty)return this.dirty=!1,this.activate(),this;this.indexBuffer&&this.indexBuffer.bind()}else this.activate();return this},n.prototype.unbind=function(){return this.nativeVao&&this.nativeVaoExtension.bindVertexArrayOES(null),this},n.prototype.activate=function(){for(var t=this.gl,e=null,i=0;i<this.attributes.length;i++){var n=this.attributes[i];e!==n.buffer&&(n.buffer.bind(),e=n.buffer),t.vertexAttribPointer(n.attribute.location,n.attribute.size,n.type||t.FLOAT,n.normalized||!1,n.stride||0,n.start||0)}return o(t,this.attributes,this.nativeState),this.indexBuffer&&this.indexBuffer.bind(),this},n.prototype.addAttribute=function(t,e,i,n,o,r){return this.attributes.push({buffer:t,attribute:e,location:e.location,type:i||this.gl.FLOAT,normalized:n||!1,stride:o||0,start:r||0}),this.dirty=!0,this},n.prototype.addIndex=function(t){return this.indexBuffer=t,this.dirty=!0,this},n.prototype.clear=function(){return this.nativeVao&&this.nativeVaoExtension.bindVertexArrayOES(this.nativeVao),this.attributes.length=0,this.indexBuffer=null,this},n.prototype.draw=function(t,e,i){var n=this.gl;return this.indexBuffer?n.drawElements(t,e||this.indexBuffer.data.length,n.UNSIGNED_SHORT,2*(i||0)):n.drawArrays(t,i,e||this.getSize()),this},n.prototype.destroy=function(){this.gl=null,this.indexBuffer=null,this.attributes=null,this.nativeState=null,this.nativeVao&&this.nativeVaoExtension.deleteVertexArrayOES(this.nativeVao),this.nativeVaoExtension=null,this.nativeVao=null},n.prototype.getSize=function(){var t=this.attributes[0];return t.buffer.data.length/(t.stride/4||t.attribute.size)}},{"./setVertexAttribArrays":16}],14:[function(t,e,i){e.exports=function(t,e){var i=t.getContext("webgl",e)||t.getContext("experimental-webgl",e);if(!i)throw new Error("This browser does not support webGL. Try using the canvas renderer");return i}},{}],15:[function(t,e,i){var n={createContext:t("./createContext"),setVertexAttribArrays:t("./setVertexAttribArrays"),GLBuffer:t("./GLBuffer"),GLFramebuffer:t("./GLFramebuffer"),GLShader:t("./GLShader"),GLTexture:t("./GLTexture"),VertexArrayObject:t("./VertexArrayObject"),shader:t("./shader")};void 0!==e&&e.exports&&(e.exports=n),"undefined"!=typeof window&&(window.PIXI=window.PIXI||{},window.PIXI.glCore=n)},{"./GLBuffer":9,"./GLFramebuffer":10,"./GLShader":11,"./GLTexture":12,"./VertexArrayObject":13,"./createContext":14,"./setVertexAttribArrays":16,"./shader":22}],16:[function(t,e,i){e.exports=function(t,e,i){var n;if(i){var o=i.tempAttribState,r=i.attribState;for(n=0;n<o.length;n++)o[n]=!1;for(n=0;n<e.length;n++)o[e[n].attribute.location]=!0;for(n=0;n<r.length;n++)r[n]!==o[n]&&(r[n]=o[n],i.attribState[n]?t.enableVertexAttribArray(n):t.disableVertexAttribArray(n))}else for(n=0;n<e.length;n++){var s=e[n];t.enableVertexAttribArray(s.attribute.location)}}},{}],17:[function(t,e,i){var l=function(t,e,i){var n=t.createShader(e);return t.shaderSource(n,i),t.compileShader(n),t.getShaderParameter(n,t.COMPILE_STATUS)?n:(console.log(t.getShaderInfoLog(n)),null)};e.exports=function(t,e,i,n){var o=l(t,t.VERTEX_SHADER,e),r=l(t,t.FRAGMENT_SHADER,i),s=t.createProgram();if(t.attachShader(s,o),t.attachShader(s,r),n)for(var a in n)t.bindAttribLocation(s,n[a],a);return t.linkProgram(s),t.getProgramParameter(s,t.LINK_STATUS)||(console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",t.getProgramParameter(s,t.VALIDATE_STATUS)),console.error("gl.getError()",t.getError()),""!==t.getProgramInfoLog(s)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(s)),t.deleteProgram(s),s=null),t.deleteShader(o),t.deleteShader(r),s}},{}],18:[function(t,e,i){var n=function(t){for(var e=new Array(t),i=0;i<e.length;i++)e[i]=!1;return e};e.exports=function(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"int":case"sampler2D":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"bool":return!1;case"bvec2":return n(2*e);case"bvec3":return n(3*e);case"bvec4":return n(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}}},{}],19:[function(t,e,i){var a=t("./mapType"),l=t("./mapSize"),h=function(t,e,i,n){gl.vertexAttribPointer(this.location,this.size,t||gl.FLOAT,e||!1,i||0,n||0)};e.exports=function(t,e){for(var i={},n=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),o=0;o<n;o++){var r=t.getActiveAttrib(e,o),s=a(t,r.type);i[r.name]={type:s,size:l(s),location:t.getAttribLocation(e,r.name),pointer:h}}return i}},{"./mapSize":23,"./mapType":24}],20:[function(t,e,i){var l=t("./mapType"),h=t("./defaultValue");e.exports=function(t,e){for(var i={},n=t.getProgramParameter(e,t.ACTIVE_UNIFORMS),o=0;o<n;o++){var r=t.getActiveUniform(e,o),s=r.name.replace(/\[.*?\]/,""),a=l(t,r.type);i[s]={type:a,size:r.size,location:t.getUniformLocation(e,s),value:h(a,r.size)}}return i}},{"./defaultValue":18,"./mapType":24}],21:[function(t,e,i){var u=function(t){return function(){return this.data[t].value}},o={float:function(t,e,i){t.uniform1f(e,i)},vec2:function(t,e,i){t.uniform2f(e,i[0],i[1])},vec3:function(t,e,i){t.uniform3f(e,i[0],i[1],i[2])},vec4:function(t,e,i){t.uniform4f(e,i[0],i[1],i[2],i[3])},int:function(t,e,i){t.uniform1i(e,i)},ivec2:function(t,e,i){t.uniform2i(e,i[0],i[1])},ivec3:function(t,e,i){t.uniform3i(e,i[0],i[1],i[2])},ivec4:function(t,e,i){t.uniform4i(e,i[0],i[1],i[2],i[3])},bool:function(t,e,i){t.uniform1i(e,i)},bvec2:function(t,e,i){t.uniform2i(e,i[0],i[1])},bvec3:function(t,e,i){t.uniform3i(e,i[0],i[1],i[2])},bvec4:function(t,e,i){t.uniform4i(e,i[0],i[1],i[2],i[3])},mat2:function(t,e,i){t.uniformMatrix2fv(e,!1,i)},mat3:function(t,e,i){t.uniformMatrix3fv(e,!1,i)},mat4:function(t,e,i){t.uniformMatrix4fv(e,!1,i)},sampler2D:function(t,e,i){t.uniform1i(e,i)}},r={float:function(t,e,i){t.uniform1fv(e,i)},vec2:function(t,e,i){t.uniform2fv(e,i)},vec3:function(t,e,i){t.uniform3fv(e,i)},vec4:function(t,e,i){t.uniform4fv(e,i)},int:function(t,e,i){t.uniform1iv(e,i)},ivec2:function(t,e,i){t.uniform2iv(e,i)},ivec3:function(t,e,i){t.uniform3iv(e,i)},ivec4:function(t,e,i){t.uniform4iv(e,i)},bool:function(t,e,i){t.uniform1iv(e,i)},bvec2:function(t,e,i){t.uniform2iv(e,i)},bvec3:function(t,e,i){t.uniform3iv(e,i)},bvec4:function(t,e,i){t.uniform4iv(e,i)},sampler2D:function(t,e,i){t.uniform1iv(e,i)}};function c(i,n){return function(t){this.data[i].value=t;var e=this.data[i].location;1===n.size?o[n.type](this.gl,e,t):r[n.type](this.gl,e,t)}}function p(t,e){for(var i=e,n=0;n<t.length-1;n++){var o=i[t[n]]||{data:{}};i[t[n]]=o,i=o}return i}e.exports=function(t,e){var i={data:{}};i.gl=t;for(var n=Object.keys(e),o=0;o<n.length;o++){var r=n[o],s=r.split("."),a=s[s.length-1],l=p(s,i),h=e[r];l.data[a]=h,l.gl=t,Object.defineProperty(l,a,{get:u(a),set:c(a,h)})}return i}},{}],22:[function(t,e,i){e.exports={compileProgram:t("./compileProgram"),defaultValue:t("./defaultValue"),extractAttributes:t("./extractAttributes"),extractUniforms:t("./extractUniforms"),generateUniformAccessObject:t("./generateUniformAccessObject"),setPrecision:t("./setPrecision"),mapSize:t("./mapSize"),mapType:t("./mapType")}},{"./compileProgram":17,"./defaultValue":18,"./extractAttributes":19,"./extractUniforms":20,"./generateUniformAccessObject":21,"./mapSize":23,"./mapType":24,"./setPrecision":25}],23:[function(t,e,i){var n={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};e.exports=function(t){return n[t]}},{}],24:[function(t,e,i){var r=null,s={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D"};e.exports=function(t,e){if(!r){var i=Object.keys(s);r={};for(var n=0;n<i.length;++n){var o=i[n];r[t[o]]=s[o]}}return r[e]}},{}],25:[function(t,e,i){e.exports=function(t,e){return"precision"!==t.substring(0,9)?"precision "+e+" float;\n"+t:t}},{}],26:[function(t,e,i){var n,o,r=e.exports={};function s(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function l(e){if(n===setTimeout)return setTimeout(e,0);if((n===s||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:s}catch(t){n=s}try{o="function"==typeof clearTimeout?clearTimeout:a}catch(t){o=a}}();var h,u=[],c=!1,p=-1;function m(){c&&h&&(c=!1,h.length?u=h.concat(u):p=-1,u.length&&f())}function f(){if(!c){var t=l(m);c=!0;for(var e=u.length;e;){for(h=u,u=[];++p<e;)h&&h[p].run();p=-1,e=u.length}h=null,c=!1,function(e){if(o===clearTimeout)return clearTimeout(e);if((o===a||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(e);try{o(e)}catch(t){try{return o.call(null,e)}catch(t){return o.call(this,e)}}}(t)}}function d(t,e){this.fun=t,this.array=e}function _(){}r.nextTick=function(t){var e=new Array(arguments.length-1);if(1<arguments.length)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];u.push(new d(t,e)),1!==u.length||c||l(f)},d.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=_,r.addListener=_,r.once=_,r.off=_,r.removeListener=_,r.removeAllListeners=_,r.emit=_,r.prependListener=_,r.prependOnceListener=_,r.listeners=function(t){return[]},r.binding=function(t){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},{}],27:[function(t,I,R){(function(P){!function(t){var e="object"==typeof R&&R&&!R.nodeType&&R,i="object"==typeof I&&I&&!I.nodeType&&I,n="object"==typeof P&&P;n.global!==n&&n.window!==n&&n.self!==n||(t=n);var o,r,y=2147483647,x=36,v=1,b=26,s=38,a=700,g=72,w=128,C="-",l=/^xn--/,h=/[^\x20-\x7E]/,u=/[\x2E\u3002\uFF0E\uFF61]/g,c={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},p=x-v,D=Math.floor,S=String.fromCharCode;function T(t){throw new RangeError(c[t])}function m(t,e){for(var i=t.length,n=[];i--;)n[i]=e(t[i]);return n}function f(t,e){var i=t.split("@"),n="";return 1<i.length&&(n=i[0]+"@",t=i[1]),n+m((t=t.replace(u,".")).split("."),e).join(".")}function A(t){for(var e,i,n=[],o=0,r=t.length;o<r;)55296<=(e=t.charCodeAt(o++))&&e<=56319&&o<r?56320==(64512&(i=t.charCodeAt(o++)))?n.push(((1023&e)<<10)+(1023&i)+65536):(n.push(e),o--):n.push(e);return n}function M(t){return m(t,function(t){var e="";return 65535<t&&(e+=S((t-=65536)>>>10&1023|55296),t=56320|1023&t),e+=S(t)}).join("")}function B(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function E(t,e,i){var n=0;for(t=i?D(t/a):t>>1,t+=D(t/e);p*b>>1<t;n+=x)t=D(t/p);return D(n+(p+1)*t/(t+s))}function d(t){var e,i,n,o,r,s,a,l,h,u,c,p=[],m=t.length,f=0,d=w,_=g;for((i=t.lastIndexOf(C))<0&&(i=0),n=0;n<i;++n)128<=t.charCodeAt(n)&&T("not-basic"),p.push(t.charCodeAt(n));for(o=0<i?i+1:0;o<m;){for(r=f,s=1,a=x;m<=o&&T("invalid-input"),c=t.charCodeAt(o++),(x<=(l=c-48<10?c-22:c-65<26?c-65:c-97<26?c-97:x)||l>D((y-f)/s))&&T("overflow"),f+=l*s,!(l<(h=a<=_?v:_+b<=a?b:a-_));a+=x)s>D(y/(u=x-h))&&T("overflow"),s*=u;_=E(f-r,e=p.length+1,0==r),D(f/e)>y-d&&T("overflow"),d+=D(f/e),f%=e,p.splice(f++,0,d)}return M(p)}function _(t){var e,i,n,o,r,s,a,l,h,u,c,p,m,f,d,_=[];for(p=(t=A(t)).length,e=w,r=g,s=i=0;s<p;++s)(c=t[s])<128&&_.push(S(c));for(n=o=_.length,o&&_.push(C);n<p;){for(a=y,s=0;s<p;++s)e<=(c=t[s])&&c<a&&(a=c);for(a-e>D((y-i)/(m=n+1))&&T("overflow"),i+=(a-e)*m,e=a,s=0;s<p;++s)if((c=t[s])<e&&++i>y&&T("overflow"),c==e){for(l=i,h=x;!(l<(u=h<=r?v:r+b<=h?b:h-r));h+=x)d=l-u,f=x-u,_.push(S(B(u+d%f,0))),l=D(d/f);_.push(S(B(l,0))),r=E(i,m,n==o),i=0,++n}++i,++e}return _.join("")}if(o={version:"1.4.1",ucs2:{decode:A,encode:M},decode:d,encode:_,toASCII:function(t){return f(t,function(t){return h.test(t)?"xn--"+_(t):t})},toUnicode:function(t){return f(t,function(t){return l.test(t)?d(t.slice(4).toLowerCase()):t})}},e&&i)if(I.exports==e)i.exports=o;else for(r in o)o.hasOwnProperty(r)&&(e[r]=o[r]);else t.punycode=o}(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],28:[function(t,e,i){e.exports=function(t,e,i,n){e=e||"&",i=i||"=";var o={};if("string"!=typeof t||0===t.length)return o;var r=/\+/g;t=t.split(e);var s=1e3;n&&"number"==typeof n.maxKeys&&(s=n.maxKeys);var a,l,h=t.length;0<s&&s<h&&(h=s);for(var u=0;u<h;++u){var c,p,m,f,d=t[u].replace(r,"%20"),_=d.indexOf(i);p=0<=_?(c=d.substr(0,_),d.substr(_+1)):(c=d,""),m=decodeURIComponent(c),f=decodeURIComponent(p),a=o,l=m,Object.prototype.hasOwnProperty.call(a,l)?y(o[m])?o[m].push(f):o[m]=[o[m],f]:o[m]=f}return o};var y=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},{}],29:[function(t,e,i){var r=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};e.exports=function(i,n,o,t){return n=n||"&",o=o||"=",null===i&&(i=void 0),"object"==typeof i?a(l(i),function(t){var e=encodeURIComponent(r(t))+o;return s(i[t])?a(i[t],function(t){return e+encodeURIComponent(r(t))}).join(n):e+encodeURIComponent(r(i[t]))}).join(n):t?encodeURIComponent(r(t))+o+encodeURIComponent(r(i)):""};var s=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function a(t,e){if(t.map)return t.map(e);for(var i=[],n=0;n<t.length;n++)i.push(e(t[n],n));return i}var l=Object.keys||function(t){var e=[];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.push(i);return e}},{}],30:[function(t,e,i){i.decode=i.parse=t("./decode"),i.encode=i.stringify=t("./encode")},{"./decode":28,"./encode":29}],31:[function(t,e,i){e.exports=function(t,e,i){var n,o=t.length;if(!(o<=e||0===i)){var r=o-(i=o<e+i?o-e:i);for(n=e;n<r;++n)t[n]=t[n+i];t.length=r}}},{}],32:[function(t,e,i){i.__esModule=!0,i.Loader=void 0;var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),s=r(t("mini-signals")),o=r(t("parse-uri")),a=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}}(t("./async")),c=t("./Resource");function r(t){return t&&t.__esModule?t:{default:t}}var l=/(#[\w-]+)?$/,h=i.Loader=function(){function r(){var i=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:10;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),this.baseUrl=t,this.progress=0,this.loading=!1,this.defaultQueryString="",this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(t,e){return i._loadResource(t,e)},this._queue=a.queue(this._boundLoadResource,e),this._queue.pause(),this.resources={},this.onProgress=new s.default,this.onError=new s.default,this.onLoad=new s.default,this.onStart=new s.default,this.onComplete=new s.default;for(var n=0;n<r._defaultBeforeMiddleware.length;++n)this.pre(r._defaultBeforeMiddleware[n]);for(var o=0;o<r._defaultAfterMiddleware.length;++o)this.use(r._defaultAfterMiddleware[o])}return r.prototype.add=function(t,e,i,n){if(Array.isArray(t)){for(var o=0;o<t.length;++o)this.add(t[o]);return this}if("object"===(void 0===t?"undefined":u(t))&&(n=e||t.callback||t.onComplete,e=(i=t).url,t=t.name||t.key||t.url),"string"!=typeof e&&(n=i,i=e,e=t),"string"!=typeof e)throw new Error("No url passed to add resource to loader.");if("function"==typeof i&&(n=i,i=null),this.loading&&(!i||!i.parentResource))throw new Error("Cannot add resources while the loader is running.");if(this.resources[t])throw new Error('Resource named "'+t+'" already exists.');if(e=this._prepareUrl(e),this.resources[t]=new c.Resource(t,e,i),"function"==typeof n&&this.resources[t].onAfterMiddleware.once(n),this.loading){for(var r=i.parentResource,s=[],a=0;a<r.children.length;++a)r.children[a].isComplete||s.push(r.children[a]);var l=r.progressChunk*(s.length+1)/(s.length+2);r.children.push(this.resources[t]),r.progressChunk=l;for(var h=0;h<s.length;++h)s[h].progressChunk=l;this.resources[t].progressChunk=l}return this._queue.push(this.resources[t]),this},r.prototype.pre=function(t){return this._beforeMiddleware.push(t),this},r.prototype.use=function(t){return this._afterMiddleware.push(t),this},r.prototype.reset=function(){for(var t in this.progress=0,this.loading=!1,this._queue.kill(),this._queue.pause(),this.resources){var e=this.resources[t];e._onLoadBinding&&e._onLoadBinding.detach(),e.isLoading&&e.abort()}return this.resources={},this},r.prototype.load=function(t){if("function"==typeof t&&this.onComplete.once(t),this.loading)return this;if(this._queue.idle())this._onStart(),this._onComplete();else{for(var e=100/this._queue._tasks.length,i=0;i<this._queue._tasks.length;++i)this._queue._tasks[i].data.progressChunk=e;this._onStart(),this._queue.resume()}return this},r.prototype._prepareUrl=function(t){var e=(0,o.default)(t,{strictMode:!0}),i=void 0;if(i=e.protocol||!e.path||0===t.indexOf("//")?t:this.baseUrl.length&&this.baseUrl.lastIndexOf("/")!==this.baseUrl.length-1&&"/"!==t.charAt(0)?this.baseUrl+"/"+t:this.baseUrl+t,this.defaultQueryString){var n=l.exec(i)[0];-1!==(i=i.substr(0,i.length-n.length)).indexOf("?")?i+="&"+this.defaultQueryString:i+="?"+this.defaultQueryString,i+=n}return i},r.prototype._loadResource=function(i,t){var n=this;i._dequeue=t,a.eachSeries(this._beforeMiddleware,function(t,e){t.call(n,i,function(){e(i.isComplete?{}:null)})},function(){i.isComplete?n._onLoad(i):(i._onLoadBinding=i.onComplete.once(n._onLoad,n),i.load())},!0)},r.prototype._onStart=function(){this.progress=0,this.loading=!0,this.onStart.dispatch(this)},r.prototype._onComplete=function(){this.progress=100,this.loading=!1,this.onComplete.dispatch(this,this.resources)},r.prototype._onLoad=function(i){var n=this;i._onLoadBinding=null,this._resourcesParsing.push(i),i._dequeue(),a.eachSeries(this._afterMiddleware,function(t,e){t.call(n,i,e)},function(){i.onAfterMiddleware.dispatch(i),n.progress=Math.min(100,n.progress+i.progressChunk),n.onProgress.dispatch(n,i),i.error?n.onError.dispatch(i.error,n,i):n.onLoad.dispatch(n,i),n._resourcesParsing.splice(n._resourcesParsing.indexOf(i),1),n._queue.idle()&&0===n._resourcesParsing.length&&n._onComplete()},!0)},n(r,[{key:"concurrency",get:function(){return this._queue.concurrency},set:function(t){this._queue.concurrency=t}}]),r}();h._defaultBeforeMiddleware=[],h._defaultAfterMiddleware=[],h.pre=function(t){return h._defaultBeforeMiddleware.push(t),h},h.use=function(t){return h._defaultAfterMiddleware.push(t),h}},{"./Resource":33,"./async":34,"mini-signals":5,"parse-uri":7}],33:[function(t,e,i){i.__esModule=!0,i.Resource=void 0;var n=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),o=r(t("parse-uri")),s=r(t("mini-signals"));function r(t){return t&&t.__esModule?t:{default:t}}var a=!(!window.XDomainRequest||"withCredentials"in new XMLHttpRequest),l=null;function h(){}var u=i.Resource=function(){function r(t,e,i){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),"string"!=typeof t||"string"!=typeof e)throw new Error("Both name and url are required for constructing a resource.");i=i||{},this._flags=0,this._setFlag(r.STATUS_FLAGS.DATA_URL,0===e.indexOf("data:")),this.name=t,this.url=e,this.extension=this._getExtension(),this.data=null,this.crossOrigin=!0===i.crossOrigin?"anonymous":i.crossOrigin,this.timeout=i.timeout||0,this.loadType=i.loadType||this._determineLoadType(),this.xhrType=i.xhrType,this.metadata=i.metadata||{},this.error=null,this.xhr=null,this.children=[],this.type=r.TYPE.UNKNOWN,this.progressChunk=0,this._dequeue=h,this._onLoadBinding=null,this._elementTimer=0,this._boundComplete=this.complete.bind(this),this._boundOnError=this._onError.bind(this),this._boundOnProgress=this._onProgress.bind(this),this._boundOnTimeout=this._onTimeout.bind(this),this._boundXhrOnError=this._xhrOnError.bind(this),this._boundXhrOnTimeout=this._xhrOnTimeout.bind(this),this._boundXhrOnAbort=this._xhrOnAbort.bind(this),this._boundXhrOnLoad=this._xhrOnLoad.bind(this),this.onStart=new s.default,this.onProgress=new s.default,this.onComplete=new s.default,this.onAfterMiddleware=new s.default}return r.setExtensionLoadType=function(t,e){c(r._loadTypeMap,t,e)},r.setExtensionXhrType=function(t,e){c(r._xhrTypeMap,t,e)},r.prototype.complete=function(){this._clearEvents(),this._finish()},r.prototype.abort=function(t){if(!this.error){if(this.error=new Error(t),this._clearEvents(),this.xhr)this.xhr.abort();else if(this.xdr)this.xdr.abort();else if(this.data)if(this.data.src)this.data.src=r.EMPTY_GIF;else for(;this.data.firstChild;)this.data.removeChild(this.data.firstChild);this._finish()}},r.prototype.load=function(t){var e=this;if(!this.isLoading)if(this.isComplete)t&&setTimeout(function(){return t(e)},1);else switch(t&&this.onComplete.once(t),this._setFlag(r.STATUS_FLAGS.LOADING,!0),this.onStart.dispatch(this),!1!==this.crossOrigin&&"string"==typeof this.crossOrigin||(this.crossOrigin=this._determineCrossOrigin(this.url)),this.loadType){case r.LOAD_TYPE.IMAGE:this.type=r.TYPE.IMAGE,this._loadElement("image");break;case r.LOAD_TYPE.AUDIO:this.type=r.TYPE.AUDIO,this._loadSourceElement("audio");break;case r.LOAD_TYPE.VIDEO:this.type=r.TYPE.VIDEO,this._loadSourceElement("video");break;case r.LOAD_TYPE.XHR:default:a&&this.crossOrigin?this._loadXdr():this._loadXhr()}},r.prototype._hasFlag=function(t){return 0!=(this._flags&t)},r.prototype._setFlag=function(t,e){this._flags=e?this._flags|t:this._flags&~t},r.prototype._clearEvents=function(){clearTimeout(this._elementTimer),this.data&&this.data.removeEventListener&&(this.data.removeEventListener("error",this._boundOnError,!1),this.data.removeEventListener("load",this._boundComplete,!1),this.data.removeEventListener("progress",this._boundOnProgress,!1),this.data.removeEventListener("canplaythrough",this._boundComplete,!1)),this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener("error",this._boundXhrOnError,!1),this.xhr.removeEventListener("timeout",this._boundXhrOnTimeout,!1),this.xhr.removeEventListener("abort",this._boundXhrOnAbort,!1),this.xhr.removeEventListener("progress",this._boundOnProgress,!1),this.xhr.removeEventListener("load",this._boundXhrOnLoad,!1)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null))},r.prototype._finish=function(){if(this.isComplete)throw new Error("Complete called again for an already completed resource.");this._setFlag(r.STATUS_FLAGS.COMPLETE,!0),this._setFlag(r.STATUS_FLAGS.LOADING,!1),this.onComplete.dispatch(this)},r.prototype._loadElement=function(t){this.metadata.loadElement?this.data=this.metadata.loadElement:"image"===t&&void 0!==window.Image?this.data=new Image:this.data=document.createElement(t),this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),this.metadata.skipSource||(this.data.src=this.url),this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))},r.prototype._loadSourceElement=function(t){if(this.metadata.loadElement?this.data=this.metadata.loadElement:"audio"===t&&void 0!==window.Audio?this.data=new Audio:this.data=document.createElement(t),null!==this.data){if(this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),!this.metadata.skipSource)if(navigator.isCocoonJS)this.data.src=Array.isArray(this.url)?this.url[0]:this.url;else if(Array.isArray(this.url))for(var e=this.metadata.mimeType,i=0;i<this.url.length;++i)this.data.appendChild(this._createSource(t,this.url[i],Array.isArray(e)?e[i]:e));else{var n=this.metadata.mimeType;this.data.appendChild(this._createSource(t,this.url,Array.isArray(n)?n[0]:n))}this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.data.addEventListener("canplaythrough",this._boundComplete,!1),this.data.load(),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))}else this.abort("Unsupported element: "+t)},r.prototype._loadXhr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var t=this.xhr=new XMLHttpRequest;t.open("GET",this.url,!0),t.timeout=this.timeout,this.xhrType===r.XHR_RESPONSE_TYPE.JSON||this.xhrType===r.XHR_RESPONSE_TYPE.DOCUMENT?t.responseType=r.XHR_RESPONSE_TYPE.TEXT:t.responseType=this.xhrType,t.addEventListener("error",this._boundXhrOnError,!1),t.addEventListener("timeout",this._boundXhrOnTimeout,!1),t.addEventListener("abort",this._boundXhrOnAbort,!1),t.addEventListener("progress",this._boundOnProgress,!1),t.addEventListener("load",this._boundXhrOnLoad,!1),t.send()},r.prototype._loadXdr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var t=this.xhr=new XDomainRequest;t.timeout=this.timeout||5e3,t.onerror=this._boundXhrOnError,t.ontimeout=this._boundXhrOnTimeout,t.onprogress=this._boundOnProgress,t.onload=this._boundXhrOnLoad,t.open("GET",this.url,!0),setTimeout(function(){return t.send()},1)},r.prototype._createSource=function(t,e,i){i||(i=t+"/"+this._getExtension(e));var n=document.createElement("source");return n.src=e,n.type=i,n},r.prototype._onError=function(t){this.abort("Failed to load element using: "+t.target.nodeName)},r.prototype._onProgress=function(t){t&&t.lengthComputable&&this.onProgress.dispatch(this,t.loaded/t.total)},r.prototype._onTimeout=function(){this.abort("Load timed out.")},r.prototype._xhrOnError=function(){var t=this.xhr;this.abort(p(t)+" Request failed. Status: "+t.status+', text: "'+t.statusText+'"')},r.prototype._xhrOnTimeout=function(){var t=this.xhr;this.abort(p(t)+" Request timed out.")},r.prototype._xhrOnAbort=function(){var t=this.xhr;this.abort(p(t)+" Request was aborted by the user.")},r.prototype._xhrOnLoad=function(){var t=this.xhr,e="",i=void 0===t.status?200:t.status;if(""!==t.responseType&&"text"!==t.responseType&&void 0!==t.responseType||(e=t.responseText),0===i&&(0<e.length||t.responseType===r.XHR_RESPONSE_TYPE.BUFFER)?i=200:1223===i&&(i=204),2===(i/100|0)){if(this.xhrType===r.XHR_RESPONSE_TYPE.TEXT)this.data=e,this.type=r.TYPE.TEXT;else if(this.xhrType===r.XHR_RESPONSE_TYPE.JSON)try{this.data=JSON.parse(e),this.type=r.TYPE.JSON}catch(t){return void this.abort("Error trying to parse loaded json: "+t)}else if(this.xhrType===r.XHR_RESPONSE_TYPE.DOCUMENT)try{if(window.DOMParser){var n=new DOMParser;this.data=n.parseFromString(e,"text/xml")}else{var o=document.createElement("div");o.innerHTML=e,this.data=o}this.type=r.TYPE.XML}catch(t){return void this.abort("Error trying to parse loaded xml: "+t)}else this.data=t.response||e;this.complete()}else this.abort("["+t.status+"] "+t.statusText+": "+t.responseURL)},r.prototype._determineCrossOrigin=function(t,e){if(0===t.indexOf("data:"))return"";if(window.origin!==window.location.origin)return"anonymous";e=e||window.location,l||(l=document.createElement("a")),l.href=t;var i=!(t=(0,o.default)(l.href,{strictMode:!0})).port&&""===e.port||t.port===e.port,n=t.protocol?t.protocol+":":"";return t.host===e.hostname&&i&&n===e.protocol?"":"anonymous"},r.prototype._determineXhrType=function(){return r._xhrTypeMap[this.extension]||r.XHR_RESPONSE_TYPE.TEXT},r.prototype._determineLoadType=function(){return r._loadTypeMap[this.extension]||r.LOAD_TYPE.XHR},r.prototype._getExtension=function(){var t=this.url,e="";if(this.isDataUrl){var i=t.indexOf("/");e=t.substring(i+1,t.indexOf(";",i))}else{var n=t.indexOf("?"),o=t.indexOf("#"),r=Math.min(-1<n?n:t.length,-1<o?o:t.length);e=(t=t.substring(0,r)).substring(t.lastIndexOf(".")+1)}return e.toLowerCase()},r.prototype._getMimeFromXhrType=function(t){switch(t){case r.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case r.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case r.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case r.XHR_RESPONSE_TYPE.JSON:return"application/json";case r.XHR_RESPONSE_TYPE.DEFAULT:case r.XHR_RESPONSE_TYPE.TEXT:default:return"text/plain"}},n(r,[{key:"isDataUrl",get:function(){return this._hasFlag(r.STATUS_FLAGS.DATA_URL)}},{key:"isComplete",get:function(){return this._hasFlag(r.STATUS_FLAGS.COMPLETE)}},{key:"isLoading",get:function(){return this._hasFlag(r.STATUS_FLAGS.LOADING)}}]),r}();function c(t,e,i){e&&0===e.indexOf(".")&&(e=e.substring(1)),e&&(t[e]=i)}function p(t){return t.toString().replace("object ","")}u.STATUS_FLAGS={NONE:0,DATA_URL:1,COMPLETE:2,LOADING:4},u.TYPE={UNKNOWN:0,JSON:1,XML:2,IMAGE:3,AUDIO:4,VIDEO:5,TEXT:6},u.LOAD_TYPE={XHR:1,IMAGE:2,AUDIO:3,VIDEO:4},u.XHR_RESPONSE_TYPE={DEFAULT:"text",BUFFER:"arraybuffer",BLOB:"blob",DOCUMENT:"document",JSON:"json",TEXT:"text"},u._loadTypeMap={gif:u.LOAD_TYPE.IMAGE,png:u.LOAD_TYPE.IMAGE,bmp:u.LOAD_TYPE.IMAGE,jpg:u.LOAD_TYPE.IMAGE,jpeg:u.LOAD_TYPE.IMAGE,tif:u.LOAD_TYPE.IMAGE,tiff:u.LOAD_TYPE.IMAGE,webp:u.LOAD_TYPE.IMAGE,tga:u.LOAD_TYPE.IMAGE,svg:u.LOAD_TYPE.IMAGE,"svg+xml":u.LOAD_TYPE.IMAGE,mp3:u.LOAD_TYPE.AUDIO,ogg:u.LOAD_TYPE.AUDIO,wav:u.LOAD_TYPE.AUDIO,mp4:u.LOAD_TYPE.VIDEO,webm:u.LOAD_TYPE.VIDEO},u._xhrTypeMap={xhtml:u.XHR_RESPONSE_TYPE.DOCUMENT,html:u.XHR_RESPONSE_TYPE.DOCUMENT,htm:u.XHR_RESPONSE_TYPE.DOCUMENT,xml:u.XHR_RESPONSE_TYPE.DOCUMENT,tmx:u.XHR_RESPONSE_TYPE.DOCUMENT,svg:u.XHR_RESPONSE_TYPE.DOCUMENT,tsx:u.XHR_RESPONSE_TYPE.DOCUMENT,gif:u.XHR_RESPONSE_TYPE.BLOB,png:u.XHR_RESPONSE_TYPE.BLOB,bmp:u.XHR_RESPONSE_TYPE.BLOB,jpg:u.XHR_RESPONSE_TYPE.BLOB,jpeg:u.XHR_RESPONSE_TYPE.BLOB,tif:u.XHR_RESPONSE_TYPE.BLOB,tiff:u.XHR_RESPONSE_TYPE.BLOB,webp:u.XHR_RESPONSE_TYPE.BLOB,tga:u.XHR_RESPONSE_TYPE.BLOB,json:u.XHR_RESPONSE_TYPE.JSON,text:u.XHR_RESPONSE_TYPE.TEXT,txt:u.XHR_RESPONSE_TYPE.TEXT,ttf:u.XHR_RESPONSE_TYPE.BUFFER,otf:u.XHR_RESPONSE_TYPE.BUFFER},u.EMPTY_GIF="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==",void 0!==e&&(e.exports.default=u)},{"mini-signals":5,"parse-uri":7}],34:[function(t,e,i){function s(){}function a(e){return function(){if(null===e)throw new Error("Callback was already called.");var t=e;e=null,t.apply(this,arguments)}}i.__esModule=!0,i.eachSeries=function(i,n,o,r){var s=0,a=i.length;!function t(e){e||s===a?o&&o(e):r?setTimeout(function(){n(i[s++],t)},1):n(i[s++],t)}()},i.queue=function(e,t){if(null==t)t=1;else if(0===t)throw new Error("Concurrency must not be zero");var i=0,o={_tasks:[],concurrency:t,saturated:s,unsaturated:s,buffer:t/4,empty:s,drain:s,error:s,started:!1,paused:!1,push:function(t,e){n(t,!1,e)},kill:function(){i=0,o.drain=s,o.started=!1,o._tasks=[]},unshift:function(t,e){n(t,!0,e)},process:function(){for(;!o.paused&&i<o.concurrency&&o._tasks.length;){var t=o._tasks.shift();0===o._tasks.length&&o.empty(),(i+=1)===o.concurrency&&o.saturated(),e(t.data,a(r(t)))}},length:function(){return o._tasks.length},running:function(){return i},idle:function(){return o._tasks.length+i===0},pause:function(){!0!==o.paused&&(o.paused=!0)},resume:function(){if(!1!==o.paused){o.paused=!1;for(var t=1;t<=o.concurrency;t++)o.process()}}};function n(t,e,i){if(null!=i&&"function"!=typeof i)throw new Error("task callback must be a function");if(o.started=!0,null==t&&o.idle())setTimeout(function(){return o.drain()},1);else{var n={data:t,callback:"function"==typeof i?i:s};e?o._tasks.unshift(n):o._tasks.push(n),setTimeout(function(){return o.process()},1)}}function r(t){return function(){i-=1,t.callback.apply(t,arguments),null!=arguments[0]&&o.error(arguments[0],t.data),i<=o.concurrency-o.buffer&&o.unsaturated(),o.idle()&&o.drain(),o.process()}}return o}},{}],35:[function(t,e,i){i.__esModule=!0,i.encodeBinary=n;var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function n(t){for(var e="",i=0;i<t.length;){for(var n=[0,0,0],o=[0,0,0,0],r=0;r<n.length;++r)i<t.length?n[r]=255&t.charCodeAt(i++):n[r]=0;switch(o[0]=n[0]>>2,o[1]=(3&n[0])<<4|n[1]>>4,o[2]=(15&n[1])<<2|n[2]>>6,o[3]=63&n[2],i-(t.length-1)){case 2:o[3]=64,o[2]=64;break;case 1:o[3]=64}for(var s=0;s<o.length;++s)e+=a.charAt(o[s])}return e}void 0!==e&&(e.exports.default=n)},{}],36:[function(t,e,i){var n=t("./Loader").Loader,o=t("./Resource").Resource,r=t("./async"),s=t("./b64");n.Resource=o,n.async=r,n.encodeBinary=s,n.base64=s,e.exports=n,e.exports.Loader=n,e.exports.default=n},{"./Loader":32,"./Resource":33,"./async":34,"./b64":35}],37:[function(t,e,i){i.__esModule=!0,i.blobMiddlewareFactory=function(){return function(t,e){if(t.data){if(t.xhr&&t.xhrType===o.Resource.XHR_RESPONSE_TYPE.BLOB)if(window.Blob&&"string"!=typeof t.data){if(0===t.data.type.indexOf("image")){var i=s.createObjectURL(t.data);return t.blob=t.data,t.data=new Image,t.data.src=i,t.type=o.Resource.TYPE.IMAGE,void(t.data.onload=function(){s.revokeObjectURL(i),t.data.onload=null,e()})}}else{var n=t.xhr.getResponseHeader("content-type");if(n&&0===n.indexOf("image"))return t.data=new Image,t.data.src="data:"+n+";base64,"+(0,r.encodeBinary)(t.xhr.responseText),t.type=o.Resource.TYPE.IMAGE,void(t.data.onload=function(){t.data.onload=null,e()})}e()}else e()}};var o=t("../../Resource"),r=t("../../b64"),s=window.URL||window.webkitURL},{"../../Resource":33,"../../b64":35}],38:[function(t,e,i){var R=t("punycode"),O=t("./util");function A(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}i.parse=r,i.resolve=function(t,e){return r(t,!1,!0).resolve(e)},i.resolveObject=function(t,e){return t?r(t,!1,!0).resolveObject(e):e},i.format=function(t){O.isString(t)&&(t=r(t));return t instanceof A?t.format():A.prototype.format.call(t)},i.Url=A;var L=/^([a-z0-9.+-]+:)/i,n=/:[0-9]*$/,F=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,o=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),V=["'"].concat(o),N=["%","/","?",";","#"].concat(V),k=["/","?","#"],G=/^[+a-z0-9A-Z_-]{0,63}$/,j=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,U={javascript:!0,"javascript:":!0},J={javascript:!0,"javascript:":!0},X={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},W=t("querystring");function r(t,e,i){if(t&&O.isObject(t)&&t instanceof A)return t;var n=new A;return n.parse(t,e,i),n}A.prototype.parse=function(t,e,i){if(!O.isString(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var n=t.indexOf("?"),o=-1!==n&&n<t.indexOf("#")?"?":"#",r=t.split(o);r[0]=r[0].replace(/\\/g,"/");var s=t=r.join(o);if(s=s.trim(),!i&&1===t.split("#").length){var a=F.exec(s);if(a)return this.path=s,this.href=s,this.pathname=a[1],a[2]?(this.search=a[2],this.query=e?W.parse(this.search.substr(1)):this.search.substr(1)):e&&(this.search="",this.query={}),this}var l=L.exec(s);if(l){var h=(l=l[0]).toLowerCase();this.protocol=h,s=s.substr(l.length)}if(i||l||s.match(/^\/\/[^@\/]+@[^@\/]+/)){var u="//"===s.substr(0,2);!u||l&&J[l]||(s=s.substr(2),this.slashes=!0)}if(!J[l]&&(u||l&&!X[l])){for(var c,p,m=-1,f=0;f<k.length;f++){-1!==(d=s.indexOf(k[f]))&&(-1===m||d<m)&&(m=d)}-1!==(p=-1===m?s.lastIndexOf("@"):s.lastIndexOf("@",m))&&(c=s.slice(0,p),s=s.slice(p+1),this.auth=decodeURIComponent(c)),m=-1;for(f=0;f<N.length;f++){var d;-1!==(d=s.indexOf(N[f]))&&(-1===m||d<m)&&(m=d)}-1===m&&(m=s.length),this.host=s.slice(0,m),s=s.slice(m),this.parseHost(),this.hostname=this.hostname||"";var _="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!_)for(var y=this.hostname.split(/\./),x=(f=0,y.length);f<x;f++){var v=y[f];if(v&&!v.match(G)){for(var b="",g=0,w=v.length;g<w;g++)127<v.charCodeAt(g)?b+="x":b+=v[g];if(!b.match(G)){var C=y.slice(0,f),D=y.slice(f+1),S=v.match(j);S&&(C.push(S[1]),D.unshift(S[2])),D.length&&(s="/"+D.join(".")+s),this.hostname=C.join(".");break}}}255<this.hostname.length?this.hostname="":this.hostname=this.hostname.toLowerCase(),_||(this.hostname=R.toASCII(this.hostname));var T=this.port?":"+this.port:"",A=this.hostname||"";this.host=A+T,this.href+=this.host,_&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==s[0]&&(s="/"+s))}if(!U[h])for(f=0,x=V.length;f<x;f++){var M=V[f];if(-1!==s.indexOf(M)){var B=encodeURIComponent(M);B===M&&(B=escape(M)),s=s.split(M).join(B)}}var E=s.indexOf("#");-1!==E&&(this.hash=s.substr(E),s=s.slice(0,E));var P=s.indexOf("?");if(-1!==P?(this.search=s.substr(P),this.query=s.substr(P+1),e&&(this.query=W.parse(this.query)),s=s.slice(0,P)):e&&(this.search="",this.query={}),s&&(this.pathname=s),X[h]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){T=this.pathname||"";var I=this.search||"";this.path=T+I}return this.href=this.format(),this},A.prototype.format=function(){var t=this.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var e=this.protocol||"",i=this.pathname||"",n=this.hash||"",o=!1,r="";this.host?o=t+this.host:this.hostname&&(o=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&O.isObject(this.query)&&Object.keys(this.query).length&&(r=W.stringify(this.query));var s=this.search||r&&"?"+r||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||X[e])&&!1!==o?(o="//"+(o||""),i&&"/"!==i.charAt(0)&&(i="/"+i)):o||(o=""),n&&"#"!==n.charAt(0)&&(n="#"+n),s&&"?"!==s.charAt(0)&&(s="?"+s),e+o+(i=i.replace(/[?#]/g,function(t){return encodeURIComponent(t)}))+(s=s.replace("#","%23"))+n},A.prototype.resolve=function(t){return this.resolveObject(r(t,!1,!0)).format()},A.prototype.resolveObject=function(t){if(O.isString(t)){var e=new A;e.parse(t,!1,!0),t=e}for(var i=new A,n=Object.keys(this),o=0;o<n.length;o++){var r=n[o];i[r]=this[r]}if(i.hash=t.hash,""===t.href)return i.href=i.format(),i;if(t.slashes&&!t.protocol){for(var s=Object.keys(t),a=0;a<s.length;a++){var l=s[a];"protocol"!==l&&(i[l]=t[l])}return X[i.protocol]&&i.hostname&&!i.pathname&&(i.path=i.pathname="/"),i.href=i.format(),i}if(t.protocol&&t.protocol!==i.protocol){if(!X[t.protocol]){for(var h=Object.keys(t),u=0;u<h.length;u++){var c=h[u];i[c]=t[c]}return i.href=i.format(),i}if(i.protocol=t.protocol,t.host||J[t.protocol])i.pathname=t.pathname;else{for(var p=(t.pathname||"").split("/");p.length&&!(t.host=p.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==p[0]&&p.unshift(""),p.length<2&&p.unshift(""),i.pathname=p.join("/")}if(i.search=t.search,i.query=t.query,i.host=t.host||"",i.auth=t.auth,i.hostname=t.hostname||t.host,i.port=t.port,i.pathname||i.search){var m=i.pathname||"",f=i.search||"";i.path=m+f}return i.slashes=i.slashes||t.slashes,i.href=i.format(),i}var d=i.pathname&&"/"===i.pathname.charAt(0),_=t.host||t.pathname&&"/"===t.pathname.charAt(0),y=_||d||i.host&&t.pathname,x=y,v=i.pathname&&i.pathname.split("/")||[],b=(p=t.pathname&&t.pathname.split("/")||[],i.protocol&&!X[i.protocol]);if(b&&(i.hostname="",i.port=null,i.host&&(""===v[0]?v[0]=i.host:v.unshift(i.host)),i.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===p[0]?p[0]=t.host:p.unshift(t.host)),t.host=null),y=y&&(""===p[0]||""===v[0])),_)i.host=t.host||""===t.host?t.host:i.host,i.hostname=t.hostname||""===t.hostname?t.hostname:i.hostname,i.search=t.search,i.query=t.query,v=p;else if(p.length)v||(v=[]),v.pop(),v=v.concat(p),i.search=t.search,i.query=t.query;else if(!O.isNullOrUndefined(t.search)){if(b)i.hostname=i.host=v.shift(),(S=!!(i.host&&0<i.host.indexOf("@"))&&i.host.split("@"))&&(i.auth=S.shift(),i.host=i.hostname=S.shift());return i.search=t.search,i.query=t.query,O.isNull(i.pathname)&&O.isNull(i.search)||(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.href=i.format(),i}if(!v.length)return i.pathname=null,i.search?i.path="/"+i.search:i.path=null,i.href=i.format(),i;for(var g=v.slice(-1)[0],w=(i.host||t.host||1<v.length)&&("."===g||".."===g)||""===g,C=0,D=v.length;0<=D;D--)"."===(g=v[D])?v.splice(D,1):".."===g?(v.splice(D,1),C++):C&&(v.splice(D,1),C--);if(!y&&!x)for(;C--;C)v.unshift("..");!y||""===v[0]||v[0]&&"/"===v[0].charAt(0)||v.unshift(""),w&&"/"!==v.join("/").substr(-1)&&v.push("");var S,T=""===v[0]||v[0]&&"/"===v[0].charAt(0);b&&(i.hostname=i.host=T?"":v.length?v.shift():"",(S=!!(i.host&&0<i.host.indexOf("@"))&&i.host.split("@"))&&(i.auth=S.shift(),i.host=i.hostname=S.shift()));return(y=y||i.host&&v.length)&&!T&&v.unshift(""),v.length?i.pathname=v.join("/"):(i.pathname=null,i.path=null),O.isNull(i.pathname)&&O.isNull(i.search)||(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.auth=t.auth||i.auth,i.slashes=i.slashes||t.slashes,i.href=i.format(),i},A.prototype.parseHost=function(){var t=this.host,e=n.exec(t);e&&(":"!==(e=e[0])&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)}},{"./util":39,punycode:27,querystring:30}],39:[function(t,e,i){e.exports={isString:function(t){return"string"==typeof t},isObject:function(t){return"object"==typeof t&&null!==t},isNull:function(t){return null===t},isNullOrUndefined:function(t){return null==t}}},{}],40:[function(t,e,i){i.__esModule=!0;var l=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}}(t("../core")),n=r(t("ismobilejs")),o=r(t("./accessibleTarget"));function r(t){return t&&t.__esModule?t:{default:t}}l.utils.mixins.delayMixin(l.DisplayObject.prototype,o.default);var s=function(){function i(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),!n.default.tablet&&!n.default.phone||navigator.isCocoonJS||this.createTouchHook();var e=document.createElement("div");e.style.width="100px",e.style.height="100px",e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.style.zIndex=2,this.div=e,this.pool=[],this.renderId=0,this.debug=!1,this.renderer=t,this.children=[],this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this.isActive=!1,this.isMobileAccessabillity=!1,window.addEventListener("keydown",this._onKeyDown,!1)}return i.prototype.createTouchHook=function(){var t=this,e=document.createElement("button");e.style.width="1px",e.style.height="1px",e.style.position="absolute",e.style.top="-1000px",e.style.left="-1000px",e.style.zIndex=2,e.style.backgroundColor="#FF0000",e.title="HOOK DIV",e.addEventListener("focus",function(){t.isMobileAccessabillity=!0,t.activate(),document.body.removeChild(e)}),document.body.appendChild(e)},i.prototype.activate=function(){this.isActive||(this.isActive=!0,window.document.addEventListener("mousemove",this._onMouseMove,!0),window.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),this.renderer.view.parentNode&&this.renderer.view.parentNode.appendChild(this.div))},i.prototype.deactivate=function(){this.isActive&&!this.isMobileAccessabillity&&(this.isActive=!1,window.document.removeEventListener("mousemove",this._onMouseMove,!0),window.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),this.div.parentNode&&this.div.parentNode.removeChild(this.div))},i.prototype.updateAccessibleObjects=function(t){if(t.visible){t.accessible&&t.interactive&&(t._accessibleActive||this.addChild(t),t.renderId=this.renderId);for(var e=t.children,i=0;i<e.length;i++)this.updateAccessibleObjects(e[i])}},i.prototype.update=function(){if(this.renderer.renderingToScreen){this.updateAccessibleObjects(this.renderer._lastObjectRendered);var t=this.renderer.view.getBoundingClientRect(),e=t.width/this.renderer.width,i=t.height/this.renderer.height,n=this.div;n.style.left=t.left+"px",n.style.top=t.top+"px",n.style.width=this.renderer.width+"px",n.style.height=this.renderer.height+"px";for(var o=0;o<this.children.length;o++){var r=this.children[o];if(r.renderId!==this.renderId)r._accessibleActive=!1,l.utils.removeItems(this.children,o,1),this.div.removeChild(r._accessibleDiv),this.pool.push(r._accessibleDiv),r._accessibleDiv=null,o--,0===this.children.length&&this.deactivate();else{n=r._accessibleDiv;var s=r.hitArea,a=r.worldTransform;r.hitArea?(n.style.left=(a.tx+s.x*a.a)*e+"px",n.style.top=(a.ty+s.y*a.d)*i+"px",n.style.width=s.width*a.a*e+"px",n.style.height=s.height*a.d*i+"px"):(s=r.getBounds(),this.capHitArea(s),n.style.left=s.x*e+"px",n.style.top=s.y*i+"px",n.style.width=s.width*e+"px",n.style.height=s.height*i+"px",n.title!==r.accessibleTitle&&null!==r.accessibleTitle&&(n.title=r.accessibleTitle),n.getAttribute("aria-label")!==r.accessibleHint&&null!==r.accessibleHint&&n.setAttribute("aria-label",r.accessibleHint))}}this.renderId++}},i.prototype.capHitArea=function(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0),t.x+t.width>this.renderer.width&&(t.width=this.renderer.width-t.x),t.y+t.height>this.renderer.height&&(t.height=this.renderer.height-t.y)},i.prototype.addChild=function(t){var e=this.pool.pop();e||((e=document.createElement("button")).style.width="100px",e.style.height="100px",e.style.backgroundColor=this.debug?"rgba(255,0,0,0.5)":"transparent",e.style.position="absolute",e.style.zIndex=2,e.style.borderStyle="none",-1<navigator.userAgent.toLowerCase().indexOf("chrome")?e.setAttribute("aria-live","off"):e.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?e.setAttribute("aria-relevant","additions"):e.setAttribute("aria-relevant","text"),e.addEventListener("click",this._onClick.bind(this)),e.addEventListener("focus",this._onFocus.bind(this)),e.addEventListener("focusout",this._onFocusOut.bind(this))),t.accessibleTitle&&null!==t.accessibleTitle?e.title=t.accessibleTitle:t.accessibleHint&&null!==t.accessibleHint||(e.title="displayObject "+t.tabIndex),t.accessibleHint&&null!==t.accessibleHint&&e.setAttribute("aria-label",t.accessibleHint),t._accessibleActive=!0,(t._accessibleDiv=e).displayObject=t,this.children.push(t),this.div.appendChild(t._accessibleDiv),t._accessibleDiv.tabIndex=t.tabIndex},i.prototype._onClick=function(t){var e=this.renderer.plugins.interaction;e.dispatchEvent(t.target.displayObject,"click",e.eventData)},i.prototype._onFocus=function(t){t.target.getAttribute("aria-live","off")||t.target.setAttribute("aria-live","assertive");var e=this.renderer.plugins.interaction;e.dispatchEvent(t.target.displayObject,"mouseover",e.eventData)},i.prototype._onFocusOut=function(t){t.target.getAttribute("aria-live","off")||t.target.setAttribute("aria-live","polite");var e=this.renderer.plugins.interaction;e.dispatchEvent(t.target.displayObject,"mouseout",e.eventData)},i.prototype._onKeyDown=function(t){9===t.keyCode&&this.activate()},i.prototype._onMouseMove=function(t){0===t.movementX&&0===t.movementY||this.deactivate()},i.prototype.destroy=function(){this.div=null;for(var t=0;t<this.children.length;t++)this.children[t].div=null;window.document.removeEventListener("mousemove",this._onMouseMove,!0),window.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null},i}();i.default=s,l.WebGLRenderer.registerPlugin("accessibility",s),l.CanvasRenderer.registerPlugin("accessibility",s)},{"../core":65,"./accessibleTarget":41,ismobilejs:4}],41:[function(t,e,i){i.__esModule=!0,i.default={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:!1}},{}],42:[function(t,e,i){i.__esModule=!0;var n=t("./accessibleTarget");Object.defineProperty(i,"accessibleTarget",{enumerable:!0,get:function(){return r(n).default}});var o=t("./AccessibilityManager");function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(i,"AccessibilityManager",{enumerable:!0,get:function(){return r(o).default}})},{"./AccessibilityManager":40,"./accessibleTarget":41}],43:[function(t,e,i){i.__esModule=!0;var n=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),s=t("./autoDetectRenderer"),a=r(t("./display/Container")),l=t("./ticker"),h=r(t("./settings")),o=t("./const");function r(t){return t&&t.__esModule?t:{default:t}}var u=function(){function r(t,e,i,n,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),"number"==typeof t&&(t=Object.assign({width:t,height:e||h.default.RENDER_OPTIONS.height,forceCanvas:!!n,sharedTicker:!!o},i)),this._options=t=Object.assign({autoStart:!0,sharedTicker:!1,forceCanvas:!1,sharedLoader:!1},t),this.renderer=(0,s.autoDetectRenderer)(t),this.stage=new a.default,this._ticker=null,this.ticker=t.sharedTicker?l.shared:new l.Ticker,t.autoStart&&this.start()}return r.prototype.render=function(){this.renderer.render(this.stage)},r.prototype.stop=function(){this._ticker.stop()},r.prototype.start=function(){this._ticker.start()},r.prototype.destroy=function(t,e){if(this._ticker){var i=this._ticker;this.ticker=null,i.destroy()}this.stage.destroy(e),this.stage=null,this.renderer.destroy(t),this.renderer=null,this._options=null},n(r,[{key:"ticker",set:function(t){this._ticker&&this._ticker.remove(this.render,this),(this._ticker=t)&&t.add(this.render,this,o.UPDATE_PRIORITY.LOW)},get:function(){return this._ticker}},{key:"view",get:function(){return this.renderer.view}},{key:"screen",get:function(){return this.renderer.screen}}]),r}();i.default=u},{"./autoDetectRenderer":45,"./const":46,"./display/Container":48,"./settings":101,"./ticker":121}],44:[function(t,e,i){i.__esModule=!0;var n,o=t("pixi-gl-core"),r=t("./settings"),a=(n=r)&&n.__esModule?n:{default:n};function l(t,e){if(t instanceof Array){if("precision"!==t[0].substring(0,9)){var i=t.slice(0);return i.unshift("precision "+e+" float;"),i}}else if("precision"!==t.trim().substring(0,9))return"precision "+e+" float;\n"+t;return t}var s=function(r){function s(t,e,i,n,o){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,r.call(this,t,l(e,o||a.default.PRECISION_VERTEX),l(i,o||a.default.PRECISION_FRAGMENT),void 0,n))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(s,r),s}(o.GLShader);i.default=s},{"./settings":101,"pixi-gl-core":15}],45:[function(t,e,i){i.__esModule=!0,i.autoDetectRenderer=function(t,e,i,n){var o=t&&t.forceCanvas;void 0!==n&&(o=n);return o||!r.isWebGLSupported()?new s.default(t,e,i):new a.default(t,e,i)};var r=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}}(t("./utils")),s=n(t("./renderers/canvas/CanvasRenderer")),a=n(t("./renderers/webgl/WebGLRenderer"));function n(t){return t&&t.__esModule?t:{default:t}}},{"./renderers/canvas/CanvasRenderer":77,"./renderers/webgl/WebGLRenderer":84,"./utils":125}],46:[function(t,e,i){i.__esModule=!0;i.VERSION="4.8.4",i.PI_2=2*Math.PI,i.RAD_TO_DEG=180/Math.PI,i.DEG_TO_RAD=Math.PI/180,i.RENDERER_TYPE={UNKNOWN:0,WEBGL:1,CANVAS:2},i.BLEND_MODES={NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16,NORMAL_NPM:17,ADD_NPM:18,SCREEN_NPM:19},i.DRAW_MODES={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},i.SCALE_MODES={LINEAR:0,NEAREST:1},i.WRAP_MODES={CLAMP:0,REPEAT:1,MIRRORED_REPEAT:2},i.GC_MODES={AUTO:0,MANUAL:1},i.URL_FILE_EXTENSION=/\.(\w{3,4})(?:$|\?|#)/i,i.DATA_URI=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i,i.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i,i.SHAPES={POLY:0,RECT:1,CIRC:2,ELIP:3,RREC:4},i.PRECISION={LOW:"lowp",MEDIUM:"mediump",HIGH:"highp"},i.TRANSFORM_MODE={STATIC:0,DYNAMIC:1},i.TEXT_GRADIENT={LINEAR_VERTICAL:0,LINEAR_HORIZONTAL:1},i.UPDATE_PRIORITY={INTERACTION:50,HIGH:25,NORMAL:0,LOW:-25,UTILITY:-50}},{}],47:[function(t,e,i){i.__esModule=!0;var n=t("../math");var o=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null}return t.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},t.prototype.clear=function(){this.updateID++,this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},t.prototype.getRectangle=function(t){return this.minX>this.maxX||this.minY>this.maxY?n.Rectangle.EMPTY:((t=t||new n.Rectangle(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},t.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)},t.prototype.addQuad=function(t){var e=this.minX,i=this.minY,n=this.maxX,o=this.maxY,r=t[0],s=t[1];e=r<e?r:e,i=s<i?s:i,n=n<r?r:n,o=o<s?s:o,e=(r=t[2])<e?r:e,i=(s=t[3])<i?s:i,n=n<r?r:n,o=o<s?s:o,e=(r=t[4])<e?r:e,i=(s=t[5])<i?s:i,n=n<r?r:n,o=o<s?s:o,e=(r=t[6])<e?r:e,i=(s=t[7])<i?s:i,n=n<r?r:n,o=o<s?s:o,this.minX=e,this.minY=i,this.maxX=n,this.maxY=o},t.prototype.addFrame=function(t,e,i,n,o){var r=t.worldTransform,s=r.a,a=r.b,l=r.c,h=r.d,u=r.tx,c=r.ty,p=this.minX,m=this.minY,f=this.maxX,d=this.maxY,_=s*e+l*i+u,y=a*e+h*i+c;p=_<p?_:p,m=y<m?y:m,f=f<_?_:f,d=d<y?y:d,p=(_=s*n+l*i+u)<p?_:p,m=(y=a*n+h*i+c)<m?y:m,f=f<_?_:f,d=d<y?y:d,p=(_=s*e+l*o+u)<p?_:p,m=(y=a*e+h*o+c)<m?y:m,f=f<_?_:f,d=d<y?y:d,p=(_=s*n+l*o+u)<p?_:p,m=(y=a*n+h*o+c)<m?y:m,f=f<_?_:f,d=d<y?y:d,this.minX=p,this.minY=m,this.maxX=f,this.maxY=d},t.prototype.addVertices=function(t,e,i,n){for(var o=t.worldTransform,r=o.a,s=o.b,a=o.c,l=o.d,h=o.tx,u=o.ty,c=this.minX,p=this.minY,m=this.maxX,f=this.maxY,d=i;d<n;d+=2){var _=e[d],y=e[d+1],x=r*_+a*y+h,v=l*y+s*_+u;c=x<c?x:c,p=v<p?v:p,m=m<x?x:m,f=f<v?v:f}this.minX=c,this.minY=p,this.maxX=m,this.maxY=f},t.prototype.addBounds=function(t){var e=this.minX,i=this.minY,n=this.maxX,o=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<i?t.minY:i,this.maxX=t.maxX>n?t.maxX:n,this.maxY=t.maxY>o?t.maxY:o},t.prototype.addBoundsMask=function(t,e){var i=t.minX>e.minX?t.minX:e.minX,n=t.minY>e.minY?t.minY:e.minY,o=t.maxX<e.maxX?t.maxX:e.maxX,r=t.maxY<e.maxY?t.maxY:e.maxY;if(i<=o&&n<=r){var s=this.minX,a=this.minY,l=this.maxX,h=this.maxY;this.minX=i<s?i:s,this.minY=n<a?n:a,this.maxX=l<o?o:l,this.maxY=h<r?r:h}},t.prototype.addBoundsArea=function(t,e){var i=t.minX>e.x?t.minX:e.x,n=t.minY>e.y?t.minY:e.y,o=t.maxX<e.x+e.width?t.maxX:e.x+e.width,r=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(i<=o&&n<=r){var s=this.minX,a=this.minY,l=this.maxX,h=this.maxY;this.minX=i<s?i:s,this.minY=n<a?n:a,this.maxX=l<o?o:l,this.maxY=h<r?r:h}},t}();i.default=o},{"../math":70}],48:[function(t,e,i){i.__esModule=!0;var n,r=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),s=t("../utils"),o=t("./DisplayObject");var a=function(o){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var t=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,o.call(this));return t.children=[],t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o),e.prototype.onChildrenChange=function(){},e.prototype.addChild=function(t){var e=arguments.length;if(1<e)for(var i=0;i<e;i++)this.addChild(arguments[i]);else t.parent&&t.parent.removeChild(t),t.parent=this,t.transform._parentID=-1,this.children.push(t),this._boundsID++,this.onChildrenChange(this.children.length-1),t.emit("added",this);return t},e.prototype.addChildAt=function(t,e){if(e<0||e>this.children.length)throw new Error(t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),t.parent=this,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),t},e.prototype.swapChildren=function(t,e){if(t!==e){var i=this.getChildIndex(t),n=this.getChildIndex(e);this.children[i]=e,this.children[n]=t,this.onChildrenChange(i<n?i:n)}},e.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},e.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error("The index "+e+" supplied is out of bounds "+this.children.length);var i=this.getChildIndex(t);(0,s.removeItems)(this.children,i,1),this.children.splice(e,0,t),this.onChildrenChange(e)},e.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error("getChildAt: Index ("+t+") does not exist.");return this.children[t]},e.prototype.removeChild=function(t){var e=arguments.length;if(1<e)for(var i=0;i<e;i++)this.removeChild(arguments[i]);else{var n=this.children.indexOf(t);if(-1===n)return null;t.parent=null,t.transform._parentID=-1,(0,s.removeItems)(this.children,n,1),this._boundsID++,this.onChildrenChange(n),t.emit("removed",this)}return t},e.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,(0,s.removeItems)(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),e},e.prototype.removeChildren=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,e=arguments[1],i=t,n="number"==typeof e?e:this.children.length,o=n-i,r=void 0;if(0<o&&o<=n){r=this.children.splice(i,o);for(var s=0;s<r.length;++s)r[s].parent=null,r[s].transform&&(r[s].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(var a=0;a<r.length;++a)r[a].emit("removed",this);return r}if(0===o&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},e.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var i=this.children[t];i.visible&&i.updateTransform()}},e.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var e=this.children[t];e.visible&&e.renderable&&(e.calculateBounds(),e._mask?(e._mask.calculateBounds(),this._bounds.addBoundsMask(e._bounds,e._mask._bounds)):e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds))}this._lastBoundsID=this._boundsID},e.prototype._calculateBounds=function(){},e.prototype.renderWebGL=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this._filters)this.renderAdvancedWebGL(t);else{this._renderWebGL(t);for(var e=0,i=this.children.length;e<i;++e)this.children[e].renderWebGL(t)}},e.prototype.renderAdvancedWebGL=function(t){t.flush();var e=this._filters,i=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]);for(var n=this._enabledFilters.length=0;n<e.length;n++)e[n].enabled&&this._enabledFilters.push(e[n]);this._enabledFilters.length&&t.filterManager.pushFilter(this,this._enabledFilters)}i&&t.maskManager.pushMask(this,this._mask),this._renderWebGL(t);for(var o=0,r=this.children.length;o<r;o++)this.children[o].renderWebGL(t);t.flush(),i&&t.maskManager.popMask(this,this._mask),e&&this._enabledFilters&&this._enabledFilters.length&&t.filterManager.popFilter()},e.prototype._renderWebGL=function(t){},e.prototype._renderCanvas=function(t){},e.prototype.renderCanvas=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable){this._mask&&t.maskManager.pushMask(this._mask),this._renderCanvas(t);for(var e=0,i=this.children.length;e<i;++e)this.children[e].renderCanvas(t);this._mask&&t.maskManager.popMask(t)}},e.prototype.destroy=function(t){o.prototype.destroy.call(this);var e="boolean"==typeof t?t:t&&t.children,i=this.removeChildren(0,this.children.length);if(e)for(var n=0;n<i.length;++n)i[n].destroy(t)},r(e,[{key:"width",get:function(){return this.scale.x*this.getLocalBounds().width},set:function(t){var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t}},{key:"height",get:function(){return this.scale.y*this.getLocalBounds().height},set:function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t}}]),e}(((n=o)&&n.__esModule?n:{default:n}).default);(i.default=a).prototype.containerUpdateTransform=a.prototype.updateTransform},{"../utils":125,"./DisplayObject":49}],49:[function(t,e,i){i.__esModule=!0;var o=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),n=c(t("eventemitter3")),r=t("../const"),s=c(t("../settings")),a=c(t("./TransformStatic")),l=c(t("./Transform")),h=c(t("./Bounds")),u=t("../math");function c(t){return t&&t.__esModule?t:{default:t}}var p=function(i){function n(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n);var t=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,i.call(this)),e=s.default.TRANSFORM_MODE===r.TRANSFORM_MODE.STATIC?a.default:l.default;return t.tempDisplayObjectParent=null,t.transform=new e,t.alpha=1,t.visible=!0,t.renderable=!0,t.parent=null,t.worldAlpha=1,t.filterArea=null,t._filters=null,t._enabledFilters=null,t._bounds=new h.default,t._boundsID=0,t._lastBoundsID=-1,t._boundsRect=null,t._localBoundsRect=null,t._mask=null,t._destroyed=!1,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(n,i),n.prototype.updateTransform=function(){this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha,this._bounds.updateID++},n.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},n.prototype.getBounds=function(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._boundsID!==this._lastBoundsID&&this.calculateBounds(),e||(this._boundsRect||(this._boundsRect=new u.Rectangle),e=this._boundsRect),this._bounds.getRectangle(e)},n.prototype.getLocalBounds=function(t){var e=this.transform,i=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform,t||(this._localBoundsRect||(this._localBoundsRect=new u.Rectangle),t=this._localBoundsRect);var n=this.getBounds(!1,t);return this.parent=i,this.transform=e,n},n.prototype.toGlobal=function(t,e){return 2<arguments.length&&void 0!==arguments[2]&&arguments[2]||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)},n.prototype.toLocal=function(t,e,i,n){return e&&(t=e.toGlobal(t,i,n)),n||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,i)},n.prototype.renderWebGL=function(t){},n.prototype.renderCanvas=function(t){},n.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t},n.prototype.setTransform=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1,o=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,r=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0,s=6<arguments.length&&void 0!==arguments[6]?arguments[6]:0,a=7<arguments.length&&void 0!==arguments[7]?arguments[7]:0,l=8<arguments.length&&void 0!==arguments[8]?arguments[8]:0;return this.position.x=t,this.position.y=e,this.scale.x=i||1,this.scale.y=n||1,this.rotation=o,this.skew.x=r,this.skew.y=s,this.pivot.x=a,this.pivot.y=l,this},n.prototype.destroy=function(){this.removeAllListeners(),this.parent&&this.parent.removeChild(this),this.transform=null,this.parent=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.filterArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},o(n,[{key:"_tempDisplayObjectParent",get:function(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new n),this.tempDisplayObjectParent}},{key:"x",get:function(){return this.position.x},set:function(t){this.transform.position.x=t}},{key:"y",get:function(){return this.position.y},set:function(t){this.transform.position.y=t}},{key:"worldTransform",get:function(){return this.transform.worldTransform}},{key:"localTransform",get:function(){return this.transform.localTransform}},{key:"position",get:function(){return this.transform.position},set:function(t){this.transform.position.copy(t)}},{key:"scale",get:function(){return this.transform.scale},set:function(t){this.transform.scale.copy(t)}},{key:"pivot",get:function(){return this.transform.pivot},set:function(t){this.transform.pivot.copy(t)}},{key:"skew",get:function(){return this.transform.skew},set:function(t){this.transform.skew.copy(t)}},{key:"rotation",get:function(){return this.transform.rotation},set:function(t){this.transform.rotation=t}},{key:"worldVisible",get:function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0}},{key:"mask",get:function(){return this._mask},set:function(t){this._mask&&(this._mask.renderable=!0,this._mask.isMask=!1),this._mask=t,this._mask&&(this._mask.renderable=!1,this._mask.isMask=!0)}},{key:"filters",get:function(){return this._filters&&this._filters.slice()},set:function(t){this._filters=t&&t.slice()}}]),n}(n.default);(i.default=p).prototype.displayObjectUpdateTransform=p.prototype.updateTransform},{"../const":46,"../math":70,"../settings":101,"./Bounds":47,"./Transform":50,"./TransformStatic":52,eventemitter3:3}],50:[function(t,e,i){i.__esModule=!0;var n,o=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),r=t("../math"),s=t("./TransformBase");var a=function(e){function i(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i);var t=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,e.call(this));return t.position=new r.Point(0,0),t.scale=new r.Point(1,1),t.skew=new r.ObservablePoint(t.updateSkew,t,0,0),t.pivot=new r.Point(0,0),t._rotation=0,t._cx=1,t._sx=0,t._cy=0,t._sy=1,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(i,e),i.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew._y),this._sx=Math.sin(this._rotation+this.skew._y),this._cy=-Math.sin(this._rotation-this.skew._x),this._sy=Math.cos(this._rotation-this.skew._x)},i.prototype.updateLocalTransform=function(){var t=this.localTransform;t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d)},i.prototype.updateTransform=function(t){var e=this.localTransform;e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d);var i=t.worldTransform,n=this.worldTransform;n.a=e.a*i.a+e.b*i.c,n.b=e.a*i.b+e.b*i.d,n.c=e.c*i.a+e.d*i.c,n.d=e.c*i.b+e.d*i.d,n.tx=e.tx*i.a+e.ty*i.c+i.tx,n.ty=e.tx*i.b+e.ty*i.d+i.ty,this._worldID++},i.prototype.setFromMatrix=function(t){t.decompose(this)},o(i,[{key:"rotation",get:function(){return this._rotation},set:function(t){this._rotation=t,this.updateSkew()}}]),i}(((n=s)&&n.__esModule?n:{default:n}).default);i.default=a},{"../math":70,"./TransformBase":51}],51:[function(t,e,i){i.__esModule=!0;var n=t("../math");var o=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.worldTransform=new n.Matrix,this.localTransform=new n.Matrix,this._worldID=0,this._parentID=0}return t.prototype.updateLocalTransform=function(){},t.prototype.updateTransform=function(t){var e=t.worldTransform,i=this.worldTransform,n=this.localTransform;i.a=n.a*e.a+n.b*e.c,i.b=n.a*e.b+n.b*e.d,i.c=n.c*e.a+n.d*e.c,i.d=n.c*e.b+n.d*e.d,i.tx=n.tx*e.a+n.ty*e.c+e.tx,i.ty=n.tx*e.b+n.ty*e.d+e.ty,this._worldID++},t}();(i.default=o).prototype.updateWorldTransform=o.prototype.updateTransform,o.IDENTITY=new o},{"../math":70}],52:[function(t,e,i){i.__esModule=!0;var n,o=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),r=t("../math"),s=t("./TransformBase");var a=function(e){function i(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i);var t=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,e.call(this));return t.position=new r.ObservablePoint(t.onChange,t,0,0),t.scale=new r.ObservablePoint(t.onChange,t,1,1),t.pivot=new r.ObservablePoint(t.onChange,t,0,0),t.skew=new r.ObservablePoint(t.updateSkew,t,0,0),t._rotation=0,t._cx=1,t._sx=0,t._cy=0,t._sy=1,t._localID=0,t._currentLocalID=0,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(i,e),i.prototype.onChange=function(){this._localID++},i.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew._y),this._sx=Math.sin(this._rotation+this.skew._y),this._cy=-Math.sin(this._rotation-this.skew._x),this._sy=Math.cos(this._rotation-this.skew._x),this._localID++},i.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale._x,t.b=this._sx*this.scale._x,t.c=this._cy*this.scale._y,t.d=this._sy*this.scale._y,t.tx=this.position._x-(this.pivot._x*t.a+this.pivot._y*t.c),t.ty=this.position._y-(this.pivot._x*t.b+this.pivot._y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},i.prototype.updateTransform=function(t){var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale._x,e.b=this._sx*this.scale._x,e.c=this._cy*this.scale._y,e.d=this._sy*this.scale._y,e.tx=this.position._x-(this.pivot._x*e.a+this.pivot._y*e.c),e.ty=this.position._y-(this.pivot._x*e.b+this.pivot._y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var i=t.worldTransform,n=this.worldTransform;n.a=e.a*i.a+e.b*i.c,n.b=e.a*i.b+e.b*i.d,n.c=e.c*i.a+e.d*i.c,n.d=e.c*i.b+e.d*i.d,n.tx=e.tx*i.a+e.ty*i.c+i.tx,n.ty=e.tx*i.b+e.ty*i.d+i.ty,this._parentID=t._worldID,this._worldID++}},i.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},o(i,[{key:"rotation",get:function(){return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())}}]),i}(((n=s)&&n.__esModule?n:{default:n}).default);i.default=a},{"../math":70,"./TransformBase":51}],53:[function(t,e,i){i.__esModule=!0;var n=o(t("../display/Container")),r=o(t("../textures/RenderTexture")),s=o(t("../textures/Texture")),a=o(t("./GraphicsData")),l=o(t("../sprites/Sprite")),h=t("../math"),u=t("../utils"),D=t("../const"),c=o(t("../display/Bounds")),p=o(t("./utils/bezierCurveTo")),m=o(t("../renderers/canvas/CanvasRenderer"));function o(t){return t&&t.__esModule?t:{default:t}}var f=void 0,d=new h.Matrix,_=new h.Point,y=new Float32Array(4),x=new Float32Array(4),v=function(o){function C(){var t=0<arguments.length&&void 0!==arguments[0]&&arguments[0];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,C);var e=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,o.call(this));return e.fillAlpha=1,e.lineWidth=0,e.nativeLines=t,e.lineColor=0,e.lineAlignment=.5,e.graphicsData=[],e.tint=16777215,e._prevTint=16777215,e.blendMode=D.BLEND_MODES.NORMAL,e.currentPath=null,e._webGL={},e.isMask=!1,e.boundsPadding=0,e._localBounds=new c.default,e.dirty=0,e.fastRectDirty=-1,e.clearDirty=0,e.boundsDirty=-1,e.cachedSpriteDirty=!1,e._spriteRect=null,e._fastRect=!1,e._prevRectTint=null,e._prevRectFillColor=null,e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(C,o),C.prototype.clone=function(){var t=new C;t.renderable=this.renderable,t.fillAlpha=this.fillAlpha,t.lineWidth=this.lineWidth,t.lineColor=this.lineColor,t.lineAlignment=this.lineAlignment,t.tint=this.tint,t.blendMode=this.blendMode,t.isMask=this.isMask,t.boundsPadding=this.boundsPadding,t.dirty=0,t.cachedSpriteDirty=this.cachedSpriteDirty;for(var e=0;e<this.graphicsData.length;++e)t.graphicsData.push(this.graphicsData[e].clone());return t.currentPath=t.graphicsData[t.graphicsData.length-1],t.updateLocalBounds(),t},C.prototype._quadraticCurveLength=function(t,e,i,n,o,r){var s=t-(2*i+o),a=e-(2*n+r),l=(i-2)*t*2,h=(n-2)*e*2,u=4*(s*s+a*a),c=4*(s*l+a*h),p=l*l+h*h,m=2*Math.sqrt(u+c+p),f=Math.sqrt(u),d=2*u*f,_=2*Math.sqrt(p),y=c/f;return(d*m+f*c*(m-_)+(4*p*u-c*c)*Math.log((2*f+y+m)/(y+_)))/(4*d)},C.prototype._bezierCurveLength=function(t,e,i,n,o,r,s,a){for(var l=0,h=0,u=0,c=0,p=0,m=0,f=0,d=0,_=0,y=0,x=0,v=t,b=e,g=1;g<=10;++g)y=v-(d=(f=(m=(p=1-(h=g/10))*p)*p)*t+3*m*h*i+3*p*(u=h*h)*o+(c=u*h)*s),x=b-(_=f*e+3*m*h*n+3*p*u*r+c*a),v=d,b=_,l+=Math.sqrt(y*y+x*x);return l},C.prototype._segmentsCount=function(t){var e=Math.ceil(t/C.CURVES.maxLength);return e<C.CURVES.minSegments?e=C.CURVES.minSegments:e>C.CURVES.maxSegments&&(e=C.CURVES.maxSegments),e},C.prototype.lineStyle=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:.5;if(this.lineWidth=t,this.lineColor=e,this.lineAlpha=i,this.lineAlignment=n,this.currentPath)if(this.currentPath.shape.points.length){var o=new h.Polygon(this.currentPath.shape.points.slice(-2));o.closed=!1,this.drawShape(o)}else this.currentPath.lineWidth=this.lineWidth,this.currentPath.lineColor=this.lineColor,this.currentPath.lineAlpha=this.lineAlpha,this.currentPath.lineAlignment=this.lineAlignment;return this},C.prototype.moveTo=function(t,e){var i=new h.Polygon([t,e]);return i.closed=!1,this.drawShape(i),this},C.prototype.lineTo=function(t,e){var i=this.currentPath.shape.points,n=i[i.length-2],o=i[i.length-1];return n===t&&o===e||(i.push(t,e),this.dirty++),this},C.prototype.quadraticCurveTo=function(t,e,i,n){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);var o=this.currentPath.shape.points,r=0,s=0;0===o.length&&this.moveTo(0,0);for(var a=o[o.length-2],l=o[o.length-1],h=C.CURVES.adaptive?this._segmentsCount(this._quadraticCurveLength(a,l,t,e,i,n)):20,u=1;u<=h;++u){var c=u/h;r=a+(t-a)*c,s=l+(e-l)*c,o.push(r+(t+(i-t)*c-r)*c,s+(e+(n-e)*c-s)*c)}return this.dirty++,this},C.prototype.bezierCurveTo=function(t,e,i,n,o,r){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);var s=this.currentPath.shape.points,a=s[s.length-2],l=s[s.length-1];s.length-=2;var h=C.CURVES.adaptive?this._segmentsCount(this._bezierCurveLength(a,l,t,e,i,n,o,r)):20;return(0,p.default)(a,l,t,e,i,n,o,r,h,s),this.dirty++,this},C.prototype.arcTo=function(t,e,i,n,o){this.currentPath?0===this.currentPath.shape.points.length&&this.currentPath.shape.points.push(t,e):this.moveTo(t,e);var r=this.currentPath.shape.points,s=r[r.length-2],a=r[r.length-1]-e,l=s-t,h=n-e,u=i-t,c=Math.abs(a*u-l*h);if(c<1e-8||0===o)r[r.length-2]===t&&r[r.length-1]===e||r.push(t,e);else{var p=a*a+l*l,m=h*h+u*u,f=a*h+l*u,d=o*Math.sqrt(p)/c,_=o*Math.sqrt(m)/c,y=d*f/p,x=_*f/m,v=d*u+_*l,b=d*h+_*a,g=l*(_+y),w=a*(_+y),C=u*(d+x),D=h*(d+x),S=Math.atan2(w-b,g-v),T=Math.atan2(D-b,C-v);this.arc(v+t,b+e,o,S,T,u*a<l*h)}return this.dirty++,this},C.prototype.arc=function(t,e,i,n,o){var r=5<arguments.length&&void 0!==arguments[5]&&arguments[5];if(n===o)return this;!r&&o<=n?o+=D.PI_2:r&&n<=o&&(n+=D.PI_2);var s=o-n,a=C.CURVES.adaptive?this._segmentsCount(Math.abs(s)*i):40*Math.ceil(Math.abs(s)/D.PI_2);if(0===s)return this;var l=t+Math.cos(n)*i,h=e+Math.sin(n)*i,u=this.currentPath?this.currentPath.shape.points:null;if(u){var c=Math.abs(u[u.length-2]-l),p=Math.abs(u[u.length-1]-h);c<.001&&p<.001||u.push(l,h)}else this.moveTo(l,h),u=this.currentPath.shape.points;for(var m=s/(2*a),f=2*m,d=Math.cos(m),_=Math.sin(m),y=a-1,x=y%1/y,v=0;v<=y;++v){var b=m+n+f*(v+x*v),g=Math.cos(b),w=-Math.sin(b);u.push((d*g+_*w)*i+t,(d*-w+_*g)*i+e)}return this.dirty++,this},C.prototype.beginFill=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;return this.filling=!0,this.fillColor=t,this.fillAlpha=e,this.currentPath&&this.currentPath.shape.points.length<=2&&(this.currentPath.fill=this.filling,this.currentPath.fillColor=this.fillColor,this.currentPath.fillAlpha=this.fillAlpha),this},C.prototype.endFill=function(){return this.filling=!1,this.fillColor=null,this.fillAlpha=1,this},C.prototype.drawRect=function(t,e,i,n){return this.drawShape(new h.Rectangle(t,e,i,n)),this},C.prototype.drawRoundedRect=function(t,e,i,n,o){return this.drawShape(new h.RoundedRectangle(t,e,i,n,o)),this},C.prototype.drawCircle=function(t,e,i){return this.drawShape(new h.Circle(t,e,i)),this},C.prototype.drawEllipse=function(t,e,i,n){return this.drawShape(new h.Ellipse(t,e,i,n)),this},C.prototype.drawPolygon=function(t){var e=t,i=!0;if(e instanceof h.Polygon&&(i=e.closed,e=e.points),!Array.isArray(e)){e=new Array(arguments.length);for(var n=0;n<e.length;++n)e[n]=arguments[n]}var o=new h.Polygon(e);return o.closed=i,this.drawShape(o),this},C.prototype.drawStar=function(t,e,i,n,o){var r=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0;o=o||n/2;for(var s=-1*Math.PI/2+r,a=2*i,l=D.PI_2/a,h=[],u=0;u<a;u++){var c=u%2?o:n,p=u*l+s;h.push(t+c*Math.cos(p),e+c*Math.sin(p))}return this.drawPolygon(h)},C.prototype.clear=function(){return(this.lineWidth||this.filling||0<this.graphicsData.length)&&(this.lineWidth=0,this.lineAlignment=.5,this.filling=!1,this.boundsDirty=-1,this.canvasTintDirty=-1,this.dirty++,this.clearDirty++,this.graphicsData.length=0),this.currentPath=null,this._spriteRect=null,this},C.prototype.isFastRect=function(){return 1===this.graphicsData.length&&this.graphicsData[0].shape.type===D.SHAPES.RECT&&!this.graphicsData[0].lineWidth},C.prototype._renderWebGL=function(t){this.dirty!==this.fastRectDirty&&(this.fastRectDirty=this.dirty,this._fastRect=this.isFastRect()),this._fastRect?this._renderSpriteRect(t):(t.setObjectRenderer(t.plugins.graphics),t.plugins.graphics.render(this))},C.prototype._renderSpriteRect=function(t){var e=this.graphicsData[0].shape;this._spriteRect||(this._spriteRect=new l.default(new s.default(s.default.WHITE)));var i=this._spriteRect,n=this.graphicsData[0].fillColor;if(16777215===this.tint)i.tint=n;else if(this.tint!==this._prevRectTint||n!==this._prevRectFillColor){var o=y,r=x;(0,u.hex2rgb)(n,o),(0,u.hex2rgb)(this.tint,r),o[0]*=r[0],o[1]*=r[1],o[2]*=r[2],i.tint=(0,u.rgb2hex)(o),this._prevRectTint=this.tint,this._prevRectFillColor=n}i.alpha=this.graphicsData[0].fillAlpha,i.worldAlpha=this.worldAlpha*i.alpha,i.blendMode=this.blendMode,i._texture._frame.width=e.width,i._texture._frame.height=e.height,i.transform.worldTransform=this.transform.worldTransform,i.anchor.set(-e.x/e.width,-e.y/e.height),i._onAnchorUpdate(),i._renderWebGL(t)},C.prototype._renderCanvas=function(t){!0!==this.isMask&&t.plugins.graphics.render(this)},C.prototype._calculateBounds=function(){this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.updateLocalBounds(),this.cachedSpriteDirty=!0);var t=this._localBounds;this._bounds.addFrame(this.transform,t.minX,t.minY,t.maxX,t.maxY)},C.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,_);for(var e=this.graphicsData,i=0;i<e.length;++i){var n=e[i];if(n.fill&&(n.shape&&n.shape.contains(_.x,_.y))){if(n.holes)for(var o=0;o<n.holes.length;o++){if(n.holes[o].contains(_.x,_.y))return!1}return!0}}return!1},C.prototype.updateLocalBounds=function(){var t=1/0,e=-1/0,i=1/0,n=-1/0;if(this.graphicsData.length)for(var o=0,r=0,s=0,a=0,l=0,h=0;h<this.graphicsData.length;h++){var u=this.graphicsData[h],c=u.type,p=u.lineWidth*u.lineAlignment;if(o=u.shape,c===D.SHAPES.RECT||c===D.SHAPES.RREC)r=o.x-p,s=o.y-p,t=r<t?r:t,e=e<r+(a=o.width+2*p)?r+a:e,i=s<i?s:i,n=n<s+(l=o.height+2*p)?s+l:n;else if(c===D.SHAPES.CIRC)r=o.x,s=o.y,t=r-(a=o.radius+p)<t?r-a:t,e=e<r+a?r+a:e,i=s-(l=o.radius+p)<i?s-l:i,n=n<s+l?s+l:n;else if(c===D.SHAPES.ELIP)r=o.x,s=o.y,t=r-(a=o.width+p)<t?r-a:t,e=e<r+a?r+a:e,i=s-(l=o.height+p)<i?s-l:i,n=n<s+l?s+l:n;else for(var m=o.points,f=0,d=0,_=0,y=0,x=0,v=0,b=0,g=0,w=0;w+2<m.length;w+=2)r=m[w],s=m[w+1],f=m[w+2],d=m[w+3],_=Math.abs(f-r),y=Math.abs(d-s),l=2*p,(a=Math.sqrt(_*_+y*y))<1e-9||(t=(b=(f+r)/2)-(x=(l/a*y+_)/2)<t?b-x:t,e=e<b+x?b+x:e,i=(g=(d+s)/2)-(v=(l/a*_+y)/2)<i?g-v:i,n=n<g+v?g+v:n)}else n=i=e=t=0;var C=this.boundsPadding;this._localBounds.minX=t-C,this._localBounds.maxX=e+C,this._localBounds.minY=i-C,this._localBounds.maxY=n+C},C.prototype.drawShape=function(t){this.currentPath&&this.currentPath.shape.points.length<=2&&this.graphicsData.pop(),this.currentPath=null;var e=new a.default(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.filling,this.nativeLines,t,this.lineAlignment);return this.graphicsData.push(e),e.type===D.SHAPES.POLY&&(e.shape.closed=e.shape.closed,this.currentPath=e),this.dirty++,e},C.prototype.generateCanvasTexture=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,i=this.getLocalBounds(),n=r.default.create(i.width,i.height,t,e);f||(f=new m.default),this.transform.updateLocalTransform(),this.transform.localTransform.copy(d),d.invert(),d.tx-=i.x,d.ty-=i.y,f.render(this,n,!0,d);var o=s.default.fromCanvas(n.baseTexture._canvasRenderTarget.canvas,t,"graphics");return o.baseTexture.resolution=e,o.baseTexture.update(),o},C.prototype.closePath=function(){var t=this.currentPath;return t&&t.shape&&t.shape.close(),this},C.prototype.addHole=function(){var t=this.graphicsData.pop();return this.currentPath=this.graphicsData[this.graphicsData.length-1],this.currentPath.addHole(t.shape),this.currentPath=null,this},C.prototype.destroy=function(t){o.prototype.destroy.call(this,t);for(var e=0;e<this.graphicsData.length;++e)this.graphicsData[e].destroy();for(var i in this._webGL)for(var n=0;n<this._webGL[i].data.length;++n)this._webGL[i].data[n].destroy();this._spriteRect&&this._spriteRect.destroy(),this.graphicsData=null,this.currentPath=null,this._webGL=null,this._localBounds=null},C}(n.default);(i.default=v)._SPRITE_TEXTURE=null,v.CURVES={adaptive:!1,maxLength:10,minSegments:8,maxSegments:2048}},{"../const":46,"../display/Bounds":47,"../display/Container":48,"../math":70,"../renderers/canvas/CanvasRenderer":77,"../sprites/Sprite":102,"../textures/RenderTexture":113,"../textures/Texture":115,"../utils":125,"./GraphicsData":54,"./utils/bezierCurveTo":56}],54:[function(t,e,i){i.__esModule=!0;var n=function(){function h(t,e,i,n,o,r,s,a,l){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),this.lineWidth=t,this.lineAlignment=l,this.nativeLines=s,this.lineColor=e,this.lineAlpha=i,this._lineTint=e,this.fillColor=n,this.fillAlpha=o,this._fillTint=n,this.fill=r,this.holes=[],this.shape=a,this.type=a.type}return h.prototype.clone=function(){return new h(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.nativeLines,this.shape)},h.prototype.addHole=function(t){this.holes.push(t)},h.prototype.destroy=function(){this.shape=null,this.holes=null},h}();i.default=n},{}],55:[function(t,e,i){i.__esModule=!0;var n,o=t("../../renderers/canvas/CanvasRenderer"),r=(n=o)&&n.__esModule?n:{default:n},V=t("../../const");var s=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.renderer=t}return e.prototype.render=function(t){var e=this.renderer,i=e.context,n=t.worldAlpha,o=t.transform.worldTransform,r=e.resolution;i.setTransform(o.a*r,o.b*r,o.c*r,o.d*r,o.tx*r,o.ty*r),t.canvasTintDirty===t.dirty&&t._prevTint===t.tint||this.updateGraphicsTint(t),e.setBlendMode(t.blendMode);for(var s=0;s<t.graphicsData.length;s++){var a=t.graphicsData[s],l=a.shape,h=a._fillTint,u=a._lineTint;if(i.lineWidth=a.lineWidth,a.type===V.SHAPES.POLY){i.beginPath();var c=l.points,p=a.holes,m=void 0,f=void 0;i.moveTo(c[0],c[1]);for(var d=2;d<c.length;d+=2)i.lineTo(c[d],c[d+1]);if(l.closed&&i.closePath(),0<p.length){for(var _=m=0;_<c.length;_+=2)m+=c[_]*c[_+3]-c[_+1]*c[_+2];for(var y=0;y<p.length;y++){c=p[y].points;for(var x=f=0;x<c.length;x+=2)f+=c[x]*c[x+3]-c[x+1]*c[x+2];if(i.moveTo(c[0],c[1]),f*m<0)for(var v=2;v<c.length;v+=2)i.lineTo(c[v],c[v+1]);else for(var b=c.length-2;2<=b;b-=2)i.lineTo(c[b],c[b+1]);p[y].closed&&i.closePath()}}a.fill&&(i.globalAlpha=a.fillAlpha*n,i.fillStyle="#"+("00000"+(0|h).toString(16)).substr(-6),i.fill()),a.lineWidth&&(i.globalAlpha=a.lineAlpha*n,i.strokeStyle="#"+("00000"+(0|u).toString(16)).substr(-6),i.stroke())}else if(a.type===V.SHAPES.RECT)(a.fillColor||0===a.fillColor)&&(i.globalAlpha=a.fillAlpha*n,i.fillStyle="#"+("00000"+(0|h).toString(16)).substr(-6),i.fillRect(l.x,l.y,l.width,l.height)),a.lineWidth&&(i.globalAlpha=a.lineAlpha*n,i.strokeStyle="#"+("00000"+(0|u).toString(16)).substr(-6),i.strokeRect(l.x,l.y,l.width,l.height));else if(a.type===V.SHAPES.CIRC)i.beginPath(),i.arc(l.x,l.y,l.radius,0,2*Math.PI),i.closePath(),a.fill&&(i.globalAlpha=a.fillAlpha*n,i.fillStyle="#"+("00000"+(0|h).toString(16)).substr(-6),i.fill()),a.lineWidth&&(i.globalAlpha=a.lineAlpha*n,i.strokeStyle="#"+("00000"+(0|u).toString(16)).substr(-6),i.stroke());else if(a.type===V.SHAPES.ELIP){var g=2*l.width,w=2*l.height,C=l.x-g/2,D=l.y-w/2;i.beginPath();var S=g/2*.5522848,T=w/2*.5522848,A=C+g,M=D+w,B=C+g/2,E=D+w/2;i.moveTo(C,E),i.bezierCurveTo(C,E-T,B-S,D,B,D),i.bezierCurveTo(B+S,D,A,E-T,A,E),i.bezierCurveTo(A,E+T,B+S,M,B,M),i.bezierCurveTo(B-S,M,C,E+T,C,E),i.closePath(),a.fill&&(i.globalAlpha=a.fillAlpha*n,i.fillStyle="#"+("00000"+(0|h).toString(16)).substr(-6),i.fill()),a.lineWidth&&(i.globalAlpha=a.lineAlpha*n,i.strokeStyle="#"+("00000"+(0|u).toString(16)).substr(-6),i.stroke())}else if(a.type===V.SHAPES.RREC){var P=l.x,I=l.y,R=l.width,O=l.height,L=l.radius,F=Math.min(R,O)/2|0;L=F<L?F:L,i.beginPath(),i.moveTo(P,I+L),i.lineTo(P,I+O-L),i.quadraticCurveTo(P,I+O,P+L,I+O),i.lineTo(P+R-L,I+O),i.quadraticCurveTo(P+R,I+O,P+R,I+O-L),i.lineTo(P+R,I+L),i.quadraticCurveTo(P+R,I,P+R-L,I),i.lineTo(P+L,I),i.quadraticCurveTo(P,I,P,I+L),i.closePath(),(a.fillColor||0===a.fillColor)&&(i.globalAlpha=a.fillAlpha*n,i.fillStyle="#"+("00000"+(0|h).toString(16)).substr(-6),i.fill()),a.lineWidth&&(i.globalAlpha=a.lineAlpha*n,i.strokeStyle="#"+("00000"+(0|u).toString(16)).substr(-6),i.stroke())}}},e.prototype.updateGraphicsTint=function(t){t._prevTint=t.tint,t.canvasTintDirty=t.dirty;for(var e=(t.tint>>16&255)/255,i=(t.tint>>8&255)/255,n=(255&t.tint)/255,o=0;o<t.graphicsData.length;++o){var r=t.graphicsData[o],s=0|r.fillColor,a=0|r.lineColor;r._fillTint=((s>>16&255)/255*e*255<<16)+((s>>8&255)/255*i*255<<8)+(255&s)/255*n*255,r._lineTint=((a>>16&255)/255*e*255<<16)+((a>>8&255)/255*i*255<<8)+(255&a)/255*n*255}},e.prototype.renderPolygon=function(t,e,i){i.moveTo(t[0],t[1]);for(var n=1;n<t.length/2;++n)i.lineTo(t[2*n],t[2*n+1]);e&&i.closePath()},e.prototype.destroy=function(){this.renderer=null},e}();i.default=s,r.default.registerPlugin("graphics",s)},{"../../const":46,"../../renderers/canvas/CanvasRenderer":77}],56:[function(t,e,i){i.__esModule=!0,i.default=function(t,e,i,n,o,r,s,a,l){var h=9<arguments.length&&void 0!==arguments[9]?arguments[9]:[],u=0,c=0,p=0,m=0,f=0;h.push(t,e);for(var d=1,_=0;d<=l;++d)p=(c=(u=1-(_=d/l))*u)*u,f=(m=_*_)*_,h.push(p*t+3*c*_*i+3*u*m*o+f*s,p*e+3*c*_*n+3*u*m*r+f*a);return h}},{}],57:[function(t,e,i){i.__esModule=!0;var h=t("../../utils"),u=t("../../const"),o=a(t("../../renderers/webgl/utils/ObjectRenderer")),n=a(t("../../renderers/webgl/WebGLRenderer")),r=a(t("./WebGLGraphicsData")),s=a(t("./shaders/PrimitiveShader")),c=a(t("./utils/buildPoly")),p=a(t("./utils/buildRectangle")),m=a(t("./utils/buildRoundedRectangle")),f=a(t("./utils/buildCircle"));function a(t){return t&&t.__esModule?t:{default:t}}var l=function(i){function n(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n);var e=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,i.call(this,t));return e.graphicsDataPool=[],e.primitiveShader=null,e.gl=t.gl,e.CONTEXT_UID=0,e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(n,i),n.prototype.onContextChange=function(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.primitiveShader=new s.default(this.gl)},n.prototype.destroy=function(){o.default.prototype.destroy.call(this);for(var t=0;t<this.graphicsDataPool.length;++t)this.graphicsDataPool[t].destroy();this.graphicsDataPool=null},n.prototype.render=function(t){var e=this.renderer,i=e.gl,n=void 0,o=t._webGL[this.CONTEXT_UID];o&&t.dirty===o.dirty||(this.updateGraphics(t),o=t._webGL[this.CONTEXT_UID]);var r=this.primitiveShader;e.bindShader(r),e.state.setBlendMode(t.blendMode);for(var s=0,a=o.data.length;s<a;s++){var l=(n=o.data[s]).shader;e.bindShader(l),l.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),l.uniforms.tint=(0,h.hex2rgb)(t.tint),l.uniforms.alpha=t.worldAlpha,e.bindVao(n.vao),n.nativeLines?i.drawArrays(i.LINES,0,n.points.length/6):n.vao.draw(i.TRIANGLE_STRIP,n.indices.length)}},n.prototype.updateGraphics=function(t){var e=this.renderer.gl,i=t._webGL[this.CONTEXT_UID];if(i||(i=t._webGL[this.CONTEXT_UID]={lastIndex:0,data:[],gl:e,clearDirty:-1,dirty:-1}),i.dirty=t.dirty,t.clearDirty!==i.clearDirty){i.clearDirty=t.clearDirty;for(var n=0;n<i.data.length;n++)this.graphicsDataPool.push(i.data[n]);i.data.length=0,i.lastIndex=0}for(var o=void 0,r=void 0,s=i.lastIndex;s<t.graphicsData.length;s++){var a=t.graphicsData[s];o=this.getWebGLData(i,0),a.nativeLines&&a.lineWidth&&(r=this.getWebGLData(i,0,!0),i.lastIndex++),a.type===u.SHAPES.POLY&&(0,c.default)(a,o,r),a.type===u.SHAPES.RECT?(0,p.default)(a,o,r):a.type===u.SHAPES.CIRC||a.type===u.SHAPES.ELIP?(0,f.default)(a,o,r):a.type===u.SHAPES.RREC&&(0,m.default)(a,o,r),i.lastIndex++}this.renderer.bindVao(null);for(var l=0;l<i.data.length;l++)(o=i.data[l]).dirty&&o.upload()},n.prototype.getWebGLData=function(t,e,i){var n=t.data[t.data.length-1];return(!n||n.nativeLines!==i||32e4<n.points.length)&&((n=this.graphicsDataPool.pop()||new r.default(this.renderer.gl,this.primitiveShader,this.renderer.state.attribsState)).nativeLines=i,n.reset(e),t.data.push(n)),n.dirty=!0,n},n}(o.default);i.default=l,n.default.registerPlugin("graphics",l)},{"../../const":46,"../../renderers/webgl/WebGLRenderer":84,"../../renderers/webgl/utils/ObjectRenderer":94,"../../utils":125,"./WebGLGraphicsData":58,"./shaders/PrimitiveShader":59,"./utils/buildCircle":60,"./utils/buildPoly":62,"./utils/buildRectangle":63,"./utils/buildRoundedRectangle":64}],58:[function(t,e,i){i.__esModule=!0;var n,o=t("pixi-gl-core"),r=(n=o)&&n.__esModule?n:{default:n};var s=function(){function n(t,e,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),this.gl=t,this.color=[0,0,0],this.points=[],this.indices=[],this.buffer=r.default.GLBuffer.createVertexBuffer(t),this.indexBuffer=r.default.GLBuffer.createIndexBuffer(t),this.dirty=!0,this.nativeLines=!1,this.glPoints=null,this.glIndices=null,this.shader=e,this.vao=new r.default.VertexArrayObject(t,i).addIndex(this.indexBuffer).addAttribute(this.buffer,e.attributes.aVertexPosition,t.FLOAT,!1,24,0).addAttribute(this.buffer,e.attributes.aColor,t.FLOAT,!1,24,8)}return n.prototype.reset=function(){this.points.length=0,this.indices.length=0},n.prototype.upload=function(){this.glPoints=new Float32Array(this.points),this.buffer.upload(this.glPoints),this.glIndices=new Uint16Array(this.indices),this.indexBuffer.upload(this.glIndices),this.dirty=!1},n.prototype.destroy=function(){this.color=null,this.points=null,this.indices=null,this.vao.destroy(),this.buffer.destroy(),this.indexBuffer.destroy(),this.gl=null,this.buffer=null,this.indexBuffer=null,this.glPoints=null,this.glIndices=null},n}();i.default=s},{"pixi-gl-core":15}],59:[function(t,e,i){i.__esModule=!0;var n,o=t("../../../Shader");var r=function(e){function i(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,e.call(this,t,["attribute vec2 aVertexPosition;","attribute vec4 aColor;","uniform mat3 translationMatrix;","uniform mat3 projectionMatrix;","uniform float alpha;","uniform vec3 tint;","varying vec4 vColor;","void main(void){","   gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vColor = aColor * vec4(tint * alpha, alpha);","}"].join("\n"),["varying vec4 vColor;","void main(void){","   gl_FragColor = vColor;","}"].join("\n")))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(i,e),i}(((n=o)&&n.__esModule?n:{default:n}).default);i.default=r},{"../../../Shader":44}],60:[function(t,e,i){i.__esModule=!0,i.default=function(t,e,i){var n=t.shape,o=n.x,r=n.y,s=void 0,a=void 0;a=t.type===w.SHAPES.CIRC?(s=n.radius,n.radius):(s=n.width,n.height);if(0===s||0===a)return;var l=Math.floor(30*Math.sqrt(n.radius))||Math.floor(15*Math.sqrt(n.width+n.height)),h=2*Math.PI/l;if(t.fill){var u=(0,C.hex2rgb)(t.fillColor),c=t.fillAlpha,p=u[0]*c,m=u[1]*c,f=u[2]*c,d=e.points,_=e.indices,y=d.length/6;_.push(y);for(var x=0;x<l+1;x++)d.push(o,r,p,m,f,c),d.push(o+Math.sin(h*x)*s,r+Math.cos(h*x)*a,p,m,f,c),_.push(y++,y++);_.push(y-1)}if(t.lineWidth){var v=t.points;t.points=[];for(var b=0;b<l;b++)t.points.push(o+Math.sin(h*-b)*s,r+Math.cos(h*-b)*a);t.points.push(t.points[0],t.points[1]),(0,g.default)(t,e,i),t.points=v}};var n,o=t("./buildLine"),g=(n=o)&&n.__esModule?n:{default:n},w=t("../../../const"),C=t("../../../utils")},{"../../../const":46,"../../../utils":125,"./buildLine":61}],61:[function(t,e,i){i.__esModule=!0,i.default=function(t,e,i){t.nativeLines?function(t,e){var i=0,n=t.points;if(0===n.length)return;var o=e.points,r=n.length/2,s=(0,H.hex2rgb)(t.lineColor),a=t.lineAlpha,l=s[0]*a,h=s[1]*a,u=s[2]*a;for(i=1;i<r;i++){var c=n[2*(i-1)],p=n[2*(i-1)+1],m=n[2*i],f=n[2*i+1];o.push(c,p),o.push(l,h,u,a),o.push(m,f),o.push(l,h,u,a)}}(t,i):function(t,e){var i=t.points;if(0===i.length)return;var n=new z.Point(i[0],i[1]),o=new z.Point(i[i.length-2],i[i.length-1]);if(n.x===o.x&&n.y===o.y){(i=i.slice()).pop(),i.pop();var r=(o=new z.Point(i[i.length-2],i[i.length-1])).x+.5*(n.x-o.x),s=o.y+.5*(n.y-o.y);i.unshift(r,s),i.push(r,s)}var a=e.points,l=e.indices,h=i.length/2,u=i.length,c=a.length/6,p=t.lineWidth/2,m=(0,H.hex2rgb)(t.lineColor),f=t.lineAlpha,d=m[0]*f,_=m[1]*f,y=m[2]*f,x=i[0],v=i[1],b=i[2],g=i[3],w=0,C=0,D=-(v-g),S=x-b,T=0,A=0,M=0,B=0,E=Math.sqrt(D*D+S*S);D/=E,S/=E,D*=p,S*=p;var P=t.lineAlignment,I=2*(1-P),R=2*P;a.push(x-D*I,v-S*I,d,_,y,f),a.push(x+D*R,v+S*R,d,_,y,f);for(var O=1;O<h-1;++O){x=i[2*(O-1)],v=i[2*(O-1)+1],b=i[2*O],g=i[2*O+1],w=i[2*(O+1)],C=i[2*(O+1)+1],D=-(v-g),S=x-b,E=Math.sqrt(D*D+S*S),D/=E,S/=E,D*=p,S*=p,T=-(g-C),A=b-w,E=Math.sqrt(T*T+A*A),T/=E,A/=E;var L=-S+v-(-S+g),F=-D+b-(-D+x),V=(-D+x)*(-S+g)-(-D+b)*(-S+v),N=-(A*=p)+C-(-A+g),k=-(T*=p)+b-(-T+w),G=(-T+w)*(-A+g)-(-T+b)*(-A+C),j=L*k-N*F;if(Math.abs(j)<.1)j+=10.1,a.push(b-D*I,g-S*I,d,_,y,f),a.push(b+D*R,g+S*R,d,_,y,f);else{var U=(F*G-k*V)/j,J=(N*V-L*G)/j,X=(U-b)*(U-b)+(J-g)*(J-g);196*p*p<X?(M=D-T,B=S-A,E=Math.sqrt(M*M+B*B),M/=E,B/=E,M*=p,B*=p,a.push(b-M*I,g-B*I),a.push(d,_,y,f),a.push(b+M*R,g+B*R),a.push(d,_,y,f),a.push(b-M*R*I,g-B*I),a.push(d,_,y,f),u++):(a.push(b+(U-b)*I,g+(J-g)*I),a.push(d,_,y,f),a.push(b-(U-b)*R,g-(J-g)*R),a.push(d,_,y,f))}}x=i[2*(h-2)],v=i[2*(h-2)+1],b=i[2*(h-1)],g=i[2*(h-1)+1],D=-(v-g),S=x-b,E=Math.sqrt(D*D+S*S),D/=E,S/=E,D*=p,S*=p,a.push(b-D*I,g-S*I),a.push(d,_,y,f),a.push(b+D*R,g+S*R),a.push(d,_,y,f),l.push(c);for(var W=0;W<u;++W)l.push(c++);l.push(c-1)}(t,e)};var z=t("../../../math"),H=t("../../../utils")},{"../../../math":70,"../../../utils":125}],62:[function(t,e,i){i.__esModule=!0,i.default=function(t,e,i){t.points=t.shape.points.slice();var n=t.points;if(t.fill&&6<=n.length){for(var o=[],r=t.holes,s=0;s<r.length;s++){var a=r[s];o.push(n.length/2),n=n.concat(a.points)}var l=e.points,h=e.indices,u=n.length/2,c=(0,g.hex2rgb)(t.fillColor),p=t.fillAlpha,m=c[0]*p,f=c[1]*p,d=c[2]*p,_=(0,w.default)(n,o,2);if(!_)return;for(var y=l.length/6,x=0;x<_.length;x+=3)h.push(_[x]+y),h.push(_[x]+y),h.push(_[x+1]+y),h.push(_[x+2]+y),h.push(_[x+2]+y);for(var v=0;v<u;v++)l.push(n[2*v],n[2*v+1],m,f,d,p)}0<t.lineWidth&&(0,b.default)(t,e,i)};var b=n(t("./buildLine")),g=t("../../../utils"),w=n(t("earcut"));function n(t){return t&&t.__esModule?t:{default:t}}},{"../../../utils":125,"./buildLine":61,earcut:2}],63:[function(t,e,i){i.__esModule=!0,i.default=function(t,e,i){var n=t.shape,o=n.x,r=n.y,s=n.width,a=n.height;if(t.fill){var l=(0,x.hex2rgb)(t.fillColor),h=t.fillAlpha,u=l[0]*h,c=l[1]*h,p=l[2]*h,m=e.points,f=e.indices,d=m.length/6;m.push(o,r),m.push(u,c,p,h),m.push(o+s,r),m.push(u,c,p,h),m.push(o,r+a),m.push(u,c,p,h),m.push(o+s,r+a),m.push(u,c,p,h),f.push(d,d,d+1,d+2,d+3,d+3)}if(t.lineWidth){var _=t.points;t.points=[o,r,o+s,r,o+s,r+a,o,r+a,o,r],(0,y.default)(t,e,i),t.points=_}};var n,o=t("./buildLine"),y=(n=o)&&n.__esModule?n:{default:n},x=t("../../../utils")},{"../../../utils":125,"./buildLine":61}],64:[function(t,e,i){i.__esModule=!0,i.default=function(t,e,i){var n=t.shape,o=n.x,r=n.y,s=n.width,a=n.height,l=n.radius,h=[];if(h.push(o+l,r),A(o+s-l,r,o+s,r,o+s,r+l,h),A(o+s,r+a-l,o+s,r+a,o+s-l,r+a,h),A(o+l,r+a,o,r+a,o,r+a-l,h),A(o,r+l,o,r,o+l+1e-10,r,h),t.fill){for(var u=(0,T.hex2rgb)(t.fillColor),c=t.fillAlpha,p=u[0]*c,m=u[1]*c,f=u[2]*c,d=e.points,_=e.indices,y=d.length/6,x=(0,D.default)(h,null,2),v=0,b=x.length;v<b;v+=3)_.push(x[v]+y),_.push(x[v]+y),_.push(x[v+1]+y),_.push(x[v+2]+y),_.push(x[v+2]+y);for(var g=0,w=h.length;g<w;g++)d.push(h[g],h[++g],p,m,f,c)}if(t.lineWidth){var C=t.points;t.points=h,(0,S.default)(t,e,i),t.points=C}};var D=n(t("earcut")),S=n(t("./buildLine")),T=t("../../../utils");function n(t){return t&&t.__esModule?t:{default:t}}function d(t,e,i){return t+(e-t)*i}function A(t,e,i,n,o,r){for(var s=6<arguments.length&&void 0!==arguments[6]?arguments[6]:[],a=0,l=0,h=0,u=0,c=0,p=0,m=0,f=0;m<=20;++m)a=d(t,i,f=m/20),l=d(e,n,f),h=d(i,o,f),u=d(n,r,f),c=d(a,h,f),p=d(l,u,f),s.push(c,p);return s}},{"../../../utils":125,"./buildLine":61,earcut:2}],65:[function(t,e,i){i.__esModule=!0,i.autoDetectRenderer=i.Application=i.Filter=i.SpriteMaskFilter=i.Quad=i.RenderTarget=i.ObjectRenderer=i.WebGLManager=i.Shader=i.CanvasRenderTarget=i.TextureUvs=i.VideoBaseTexture=i.BaseRenderTexture=i.RenderTexture=i.BaseTexture=i.TextureMatrix=i.Texture=i.Spritesheet=i.CanvasGraphicsRenderer=i.GraphicsRenderer=i.GraphicsData=i.Graphics=i.TextMetrics=i.TextStyle=i.Text=i.SpriteRenderer=i.CanvasTinter=i.CanvasSpriteRenderer=i.Sprite=i.TransformBase=i.TransformStatic=i.Transform=i.Container=i.DisplayObject=i.Bounds=i.glCore=i.WebGLRenderer=i.CanvasRenderer=i.ticker=i.utils=i.settings=void 0;var n=t("./const");Object.keys(n).forEach(function(t){"default"!==t&&"__esModule"!==t&&Object.defineProperty(i,t,{enumerable:!0,get:function(){return n[t]}})});var o=t("./math");Object.keys(o).forEach(function(t){"default"!==t&&"__esModule"!==t&&Object.defineProperty(i,t,{enumerable:!0,get:function(){return o[t]}})});var r=t("pixi-gl-core");Object.defineProperty(i,"glCore",{enumerable:!0,get:function(){return H(r).default}});var s=t("./display/Bounds");Object.defineProperty(i,"Bounds",{enumerable:!0,get:function(){return H(s).default}});var a=t("./display/DisplayObject");Object.defineProperty(i,"DisplayObject",{enumerable:!0,get:function(){return H(a).default}});var l=t("./display/Container");Object.defineProperty(i,"Container",{enumerable:!0,get:function(){return H(l).default}});var h=t("./display/Transform");Object.defineProperty(i,"Transform",{enumerable:!0,get:function(){return H(h).default}});var u=t("./display/TransformStatic");Object.defineProperty(i,"TransformStatic",{enumerable:!0,get:function(){return H(u).default}});var c=t("./display/TransformBase");Object.defineProperty(i,"TransformBase",{enumerable:!0,get:function(){return H(c).default}});var p=t("./sprites/Sprite");Object.defineProperty(i,"Sprite",{enumerable:!0,get:function(){return H(p).default}});var m=t("./sprites/canvas/CanvasSpriteRenderer");Object.defineProperty(i,"CanvasSpriteRenderer",{enumerable:!0,get:function(){return H(m).default}});var f=t("./sprites/canvas/CanvasTinter");Object.defineProperty(i,"CanvasTinter",{enumerable:!0,get:function(){return H(f).default}});var d=t("./sprites/webgl/SpriteRenderer");Object.defineProperty(i,"SpriteRenderer",{enumerable:!0,get:function(){return H(d).default}});var _=t("./text/Text");Object.defineProperty(i,"Text",{enumerable:!0,get:function(){return H(_).default}});var y=t("./text/TextStyle");Object.defineProperty(i,"TextStyle",{enumerable:!0,get:function(){return H(y).default}});var x=t("./text/TextMetrics");Object.defineProperty(i,"TextMetrics",{enumerable:!0,get:function(){return H(x).default}});var v=t("./graphics/Graphics");Object.defineProperty(i,"Graphics",{enumerable:!0,get:function(){return H(v).default}});var b=t("./graphics/GraphicsData");Object.defineProperty(i,"GraphicsData",{enumerable:!0,get:function(){return H(b).default}});var g=t("./graphics/webgl/GraphicsRenderer");Object.defineProperty(i,"GraphicsRenderer",{enumerable:!0,get:function(){return H(g).default}});var w=t("./graphics/canvas/CanvasGraphicsRenderer");Object.defineProperty(i,"CanvasGraphicsRenderer",{enumerable:!0,get:function(){return H(w).default}});var C=t("./textures/Spritesheet");Object.defineProperty(i,"Spritesheet",{enumerable:!0,get:function(){return H(C).default}});var D=t("./textures/Texture");Object.defineProperty(i,"Texture",{enumerable:!0,get:function(){return H(D).default}});var S=t("./textures/TextureMatrix");Object.defineProperty(i,"TextureMatrix",{enumerable:!0,get:function(){return H(S).default}});var T=t("./textures/BaseTexture");Object.defineProperty(i,"BaseTexture",{enumerable:!0,get:function(){return H(T).default}});var A=t("./textures/RenderTexture");Object.defineProperty(i,"RenderTexture",{enumerable:!0,get:function(){return H(A).default}});var M=t("./textures/BaseRenderTexture");Object.defineProperty(i,"BaseRenderTexture",{enumerable:!0,get:function(){return H(M).default}});var B=t("./textures/VideoBaseTexture");Object.defineProperty(i,"VideoBaseTexture",{enumerable:!0,get:function(){return H(B).default}});var E=t("./textures/TextureUvs");Object.defineProperty(i,"TextureUvs",{enumerable:!0,get:function(){return H(E).default}});var P=t("./renderers/canvas/utils/CanvasRenderTarget");Object.defineProperty(i,"CanvasRenderTarget",{enumerable:!0,get:function(){return H(P).default}});var I=t("./Shader");Object.defineProperty(i,"Shader",{enumerable:!0,get:function(){return H(I).default}});var R=t("./renderers/webgl/managers/WebGLManager");Object.defineProperty(i,"WebGLManager",{enumerable:!0,get:function(){return H(R).default}});var O=t("./renderers/webgl/utils/ObjectRenderer");Object.defineProperty(i,"ObjectRenderer",{enumerable:!0,get:function(){return H(O).default}});var L=t("./renderers/webgl/utils/RenderTarget");Object.defineProperty(i,"RenderTarget",{enumerable:!0,get:function(){return H(L).default}});var F=t("./renderers/webgl/utils/Quad");Object.defineProperty(i,"Quad",{enumerable:!0,get:function(){return H(F).default}});var V=t("./renderers/webgl/filters/spriteMask/SpriteMaskFilter");Object.defineProperty(i,"SpriteMaskFilter",{enumerable:!0,get:function(){return H(V).default}});var N=t("./renderers/webgl/filters/Filter");Object.defineProperty(i,"Filter",{enumerable:!0,get:function(){return H(N).default}});var k=t("./Application");Object.defineProperty(i,"Application",{enumerable:!0,get:function(){return H(k).default}});var G=t("./autoDetectRenderer");Object.defineProperty(i,"autoDetectRenderer",{enumerable:!0,get:function(){return G.autoDetectRenderer}});var j=z(t("./utils")),U=z(t("./ticker")),J=H(t("./settings")),X=H(t("./renderers/canvas/CanvasRenderer")),W=H(t("./renderers/webgl/WebGLRenderer"));function z(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function H(t){return t&&t.__esModule?t:{default:t}}i.settings=J.default,i.utils=j,i.ticker=U,i.CanvasRenderer=X.default,i.WebGLRenderer=W.default},{"./Application":43,"./Shader":44,"./autoDetectRenderer":45,"./const":46,"./display/Bounds":47,"./display/Container":48,"./display/DisplayObject":49,"./display/Transform":50,"./display/TransformBase":51,"./display/TransformStatic":52,"./graphics/Graphics":53,"./graphics/GraphicsData":54,"./graphics/canvas/CanvasGraphicsRenderer":55,"./graphics/webgl/GraphicsRenderer":57,"./math":70,"./renderers/canvas/CanvasRenderer":77,"./renderers/canvas/utils/CanvasRenderTarget":79,"./renderers/webgl/WebGLRenderer":84,"./renderers/webgl/filters/Filter":86,"./renderers/webgl/filters/spriteMask/SpriteMaskFilter":89,"./renderers/webgl/managers/WebGLManager":93,"./renderers/webgl/utils/ObjectRenderer":94,"./renderers/webgl/utils/Quad":95,"./renderers/webgl/utils/RenderTarget":96,"./settings":101,"./sprites/Sprite":102,"./sprites/canvas/CanvasSpriteRenderer":103,"./sprites/canvas/CanvasTinter":104,"./sprites/webgl/SpriteRenderer":106,"./text/Text":108,"./text/TextMetrics":109,"./text/TextStyle":110,"./textures/BaseRenderTexture":111,"./textures/BaseTexture":112,"./textures/RenderTexture":113,"./textures/Spritesheet":114,"./textures/Texture":115,"./textures/TextureMatrix":116,"./textures/TextureUvs":117,"./textures/VideoBaseTexture":118,"./ticker":121,"./utils":125,"pixi-gl-core":15}],66:[function(t,e,i){i.__esModule=!0;var n,o=t("./Matrix"),u=(n=o)&&n.__esModule?n:{default:n};var c=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],p=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],m=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],f=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],d=[],_=[];function y(t){return t<0?-1:0<t?1:0}!function(){for(var t=0;t<16;t++){var e=[];_.push(e);for(var i=0;i<16;i++)for(var n=y(c[t]*c[i]+m[t]*p[i]),o=y(p[t]*c[i]+f[t]*p[i]),r=y(c[t]*m[i]+m[t]*f[i]),s=y(p[t]*m[i]+f[t]*f[i]),a=0;a<16;a++)if(c[a]===n&&p[a]===o&&m[a]===r&&f[a]===s){e.push(a);break}}for(var l=0;l<16;l++){var h=new u.default;h.set(c[l],p[l],m[l],f[l],0,0),d.push(h)}}();var r={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MIRROR_HORIZONTAL:12,uX:function(t){return c[t]},uY:function(t){return p[t]},vX:function(t){return m[t]},vY:function(t){return f[t]},inv:function(t){return 8&t?15&t:7&-t},add:function(t,e){return _[t][e]},sub:function(t,e){return _[t][r.inv(e)]},rotate180:function(t){return 4^t},isVertical:function(t){return 2==(3&t)},byDirection:function(t,e){return 2*Math.abs(t)<=Math.abs(e)?0<=e?r.S:r.N:2*Math.abs(e)<=Math.abs(t)?0<t?r.E:r.W:0<e?0<t?r.SE:r.SW:0<t?r.NE:r.NW},matrixAppendRotationInv:function(t,e){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,o=d[r.inv(e)];o.tx=i,o.ty=n,t.append(o)}};i.default=r},{"./Matrix":67}],67:[function(t,e,i){i.__esModule=!0;var n,o=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),r=t("./Point"),a=(n=r)&&n.__esModule?n:{default:n},l=t("../const");var s=function(){function s(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1,o=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,r=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),this.a=t,this.b=e,this.c=i,this.d=n,this.tx=o,this.ty=r,this.array=null}return s.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},s.prototype.set=function(t,e,i,n,o,r){return this.a=t,this.b=e,this.c=i,this.d=n,this.tx=o,this.ty=r,this},s.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var i=e||this.array;return i[8]=(i[7]=t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,this.ty):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0),1),i},s.prototype.apply=function(t,e){e=e||new a.default;var i=t.x,n=t.y;return e.x=this.a*i+this.c*n+this.tx,e.y=this.b*i+this.d*n+this.ty,e},s.prototype.applyInverse=function(t,e){e=e||new a.default;var i=1/(this.a*this.d+this.c*-this.b),n=t.x,o=t.y;return e.x=this.d*i*n+-this.c*i*o+(this.ty*this.c-this.tx*this.d)*i,e.y=this.a*i*o+-this.b*i*n+(-this.ty*this.a+this.tx*this.b)*i,e},s.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},s.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},s.prototype.rotate=function(t){var e=Math.cos(t),i=Math.sin(t),n=this.a,o=this.c,r=this.tx;return this.a=n*e-this.b*i,this.b=n*i+this.b*e,this.c=o*e-this.d*i,this.d=o*i+this.d*e,this.tx=r*e-this.ty*i,this.ty=r*i+this.ty*e,this},s.prototype.append=function(t){var e=this.a,i=this.b,n=this.c,o=this.d;return this.a=t.a*e+t.b*n,this.b=t.a*i+t.b*o,this.c=t.c*e+t.d*n,this.d=t.c*i+t.d*o,this.tx=t.tx*e+t.ty*n+this.tx,this.ty=t.tx*i+t.ty*o+this.ty,this},s.prototype.setTransform=function(t,e,i,n,o,r,s,a,l){return this.a=Math.cos(s+l)*o,this.b=Math.sin(s+l)*o,this.c=-Math.sin(s-a)*r,this.d=Math.cos(s-a)*r,this.tx=t-(i*this.a+n*this.c),this.ty=e-(i*this.b+n*this.d),this},s.prototype.prepend=function(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var i=this.a,n=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=n*t.a+this.d*t.c,this.d=n*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},s.prototype.decompose=function(t){var e=this.a,i=this.b,n=this.c,o=this.d,r=-Math.atan2(-n,o),s=Math.atan2(i,e),a=Math.abs(r+s);return a<1e-5||Math.abs(l.PI_2-a)<1e-5?(t.rotation=s,e<0&&0<=o&&(t.rotation+=t.rotation<=0?Math.PI:-Math.PI),t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=r,t.skew.y=s),t.scale.x=Math.sqrt(e*e+i*i),t.scale.y=Math.sqrt(n*n+o*o),t.position.x=this.tx,t.position.y=this.ty,t},s.prototype.invert=function(){var t=this.a,e=this.b,i=this.c,n=this.d,o=this.tx,r=t*n-e*i;return this.a=n/r,this.b=-e/r,this.c=-i/r,this.d=t/r,this.tx=(i*this.ty-n*o)/r,this.ty=-(t*this.ty-e*o)/r,this},s.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},s.prototype.clone=function(){var t=new s;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},s.prototype.copy=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},o(s,null,[{key:"IDENTITY",get:function(){return new s}},{key:"TEMP_MATRIX",get:function(){return new s}}]),s}();i.default=s},{"../const":46,"./Point":69}],68:[function(t,e,i){i.__esModule=!0;var n=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}();var o=function(){function o(t,e){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),this._x=i,this._y=n,this.cb=t,this.scope=e}return o.prototype.clone=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;return new o(t||this.cb,e||this.scope,this._x,this._y)},o.prototype.set=function(t,e){var i=t||0,n=e||(0!==e?i:0);this._x===i&&this._y===n||(this._x=i,this._y=n,this.cb.call(this.scope))},o.prototype.copy=function(t){this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(this.scope))},o.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},n(o,[{key:"x",get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))}},{key:"y",get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))}}]),o}();i.default=o},{}],69:[function(t,e,i){i.__esModule=!0;var n=function(){function i(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),this.x=t,this.y=e}return i.prototype.clone=function(){return new i(this.x,this.y)},i.prototype.copy=function(t){this.set(t.x,t.y)},i.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},i.prototype.set=function(t,e){this.x=t||0,this.y=e||(0!==e?this.x:0)},i}();i.default=n},{}],70:[function(t,e,i){i.__esModule=!0;var n=t("./Point");Object.defineProperty(i,"Point",{enumerable:!0,get:function(){return p(n).default}});var o=t("./ObservablePoint");Object.defineProperty(i,"ObservablePoint",{enumerable:!0,get:function(){return p(o).default}});var r=t("./Matrix");Object.defineProperty(i,"Matrix",{enumerable:!0,get:function(){return p(r).default}});var s=t("./GroupD8");Object.defineProperty(i,"GroupD8",{enumerable:!0,get:function(){return p(s).default}});var a=t("./shapes/Circle");Object.defineProperty(i,"Circle",{enumerable:!0,get:function(){return p(a).default}});var l=t("./shapes/Ellipse");Object.defineProperty(i,"Ellipse",{enumerable:!0,get:function(){return p(l).default}});var h=t("./shapes/Polygon");Object.defineProperty(i,"Polygon",{enumerable:!0,get:function(){return p(h).default}});var u=t("./shapes/Rectangle");Object.defineProperty(i,"Rectangle",{enumerable:!0,get:function(){return p(u).default}});var c=t("./shapes/RoundedRectangle");function p(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(i,"RoundedRectangle",{enumerable:!0,get:function(){return p(c).default}})},{"./GroupD8":66,"./Matrix":67,"./ObservablePoint":68,"./Point":69,"./shapes/Circle":71,"./shapes/Ellipse":72,"./shapes/Polygon":73,"./shapes/Rectangle":74,"./shapes/RoundedRectangle":75}],71:[function(t,e,i){i.__esModule=!0;var n,o=t("./Rectangle"),r=(n=o)&&n.__esModule?n:{default:n},s=t("../../const");var a=function(){function n(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),this.x=t,this.y=e,this.radius=i,this.type=s.SHAPES.CIRC}return n.prototype.clone=function(){return new n(this.x,this.y,this.radius)},n.prototype.contains=function(t,e){if(this.radius<=0)return!1;var i=this.radius*this.radius,n=this.x-t,o=this.y-e;return(n*=n)+(o*=o)<=i},n.prototype.getBounds=function(){return new r.default(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)},n}();i.default=a},{"../../const":46,"./Rectangle":74}],72:[function(t,e,i){i.__esModule=!0;var n,o=t("./Rectangle"),r=(n=o)&&n.__esModule?n:{default:n},s=t("../../const");var a=function(){function o(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),this.x=t,this.y=e,this.width=i,this.height=n,this.type=s.SHAPES.ELIP}return o.prototype.clone=function(){return new o(this.x,this.y,this.width,this.height)},o.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;var i=(t-this.x)/this.width,n=(e-this.y)/this.height;return(i*=i)+(n*=n)<=1},o.prototype.getBounds=function(){return new r.default(this.x-this.width,this.y-this.height,this.width,this.height)},o}();i.default=a},{"../../const":46,"./Rectangle":74}],73:[function(t,e,i){i.__esModule=!0;var n,o=t("../Point"),a=(n=o)&&n.__esModule?n:{default:n},l=t("../../const");var r=function(){function s(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),Array.isArray(e[0])&&(e=e[0]),e[0]instanceof a.default){for(var n=[],o=0,r=e.length;o<r;o++)n.push(e[o].x,e[o].y);e=n}this.closed=!0,this.points=e,this.type=l.SHAPES.POLY}return s.prototype.clone=function(){return new s(this.points.slice())},s.prototype.close=function(){var t=this.points;t[0]===t[t.length-2]&&t[1]===t[t.length-1]||t.push(t[0],t[1])},s.prototype.contains=function(t,e){for(var i=!1,n=this.points.length/2,o=0,r=n-1;o<n;r=o++){var s=this.points[2*o],a=this.points[2*o+1],l=this.points[2*r],h=this.points[2*r+1];e<a!=e<h&&t<(e-a)/(h-a)*(l-s)+s&&(i=!i)}return i},s}();i.default=r},{"../../const":46,"../Point":69}],74:[function(t,e,i){i.__esModule=!0;var n=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),r=t("../../const");var o=function(){function o(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),this.x=Number(t),this.y=Number(e),this.width=Number(i),this.height=Number(n),this.type=r.SHAPES.RECT}return o.prototype.clone=function(){return new o(this.x,this.y,this.width,this.height)},o.prototype.copy=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},o.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0)&&(t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height)},o.prototype.pad=function(t,e){t=t||0,e=e||(0!==e?t:0),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e},o.prototype.fit=function(t){this.x<t.x&&(this.width+=this.x,this.width<0&&(this.width=0),this.x=t.x),this.y<t.y&&(this.height+=this.y,this.height<0&&(this.height=0),this.y=t.y),this.x+this.width>t.x+t.width&&(this.width=t.width-this.x,this.width<0&&(this.width=0)),this.y+this.height>t.y+t.height&&(this.height=t.height-this.y,this.height<0&&(this.height=0))},o.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),n=Math.min(this.y,t.y),o=Math.max(this.y+this.height,t.y+t.height);this.x=e,this.width=i-e,this.y=n,this.height=o-n},n(o,[{key:"left",get:function(){return this.x}},{key:"right",get:function(){return this.x+this.width}},{key:"top",get:function(){return this.y}},{key:"bottom",get:function(){return this.y+this.height}}],[{key:"EMPTY",get:function(){return new o(0,0,0,0)}}]),o}();i.default=o},{"../../const":46}],75:[function(t,e,i){i.__esModule=!0;var s=t("../../const");var n=function(){function r(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,o=4<arguments.length&&void 0!==arguments[4]?arguments[4]:20;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),this.x=t,this.y=e,this.width=i,this.height=n,this.radius=o,this.type=s.SHAPES.RREC}return r.prototype.clone=function(){return new r(this.x,this.y,this.width,this.height,this.radius)},r.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){if(e>=this.y+this.radius&&e<=this.y+this.height-this.radius||t>=this.x+this.radius&&t<=this.x+this.width-this.radius)return!0;var i=t-(this.x+this.radius),n=e-(this.y+this.radius),o=this.radius*this.radius;if(i*i+n*n<=o)return!0;if((i=t-(this.x+this.width-this.radius))*i+n*n<=o)return!0;if(i*i+(n=e-(this.y+this.height-this.radius))*n<=o)return!0;if((i=t-(this.x+this.radius))*i+n*n<=o)return!0}return!1},r}();i.default=n},{"../../const":46}],76:[function(t,e,i){i.__esModule=!0;var n=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),a=t("../utils"),l=t("../math"),h=t("../const"),u=r(t("../settings")),c=r(t("../display/Container")),p=r(t("../textures/RenderTexture")),o=r(t("eventemitter3"));function r(t){return t&&t.__esModule?t:{default:t}}var m=new l.Matrix,s=function(r){function s(t,e,i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,r.call(this));return(0,a.sayHello)(t),"number"==typeof e&&(e=Object.assign({width:e,height:i||u.default.RENDER_OPTIONS.height},n)),e=Object.assign({},u.default.RENDER_OPTIONS,e),o.options=e,o.type=h.RENDERER_TYPE.UNKNOWN,o.screen=new l.Rectangle(0,0,e.width,e.height),o.view=e.view||document.createElement("canvas"),o.resolution=e.resolution||u.default.RESOLUTION,o.transparent=e.transparent,o.autoResize=e.autoResize||!1,o.blendModes=null,o.preserveDrawingBuffer=e.preserveDrawingBuffer,o.clearBeforeRender=e.clearBeforeRender,o.roundPixels=e.roundPixels,o._backgroundColor=0,o._backgroundColorRgba=[0,0,0,0],o._backgroundColorString="#000000",o.backgroundColor=e.backgroundColor||o._backgroundColor,o._tempDisplayObjectParent=new c.default,o._lastObjectRendered=o._tempDisplayObjectParent,o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(s,r),s.prototype.resize=function(t,e){this.screen.width=t,this.screen.height=e,this.view.width=t*this.resolution,this.view.height=e*this.resolution,this.autoResize&&(this.view.style.width=t+"px",this.view.style.height=e+"px")},s.prototype.generateTexture=function(t,e,i,n){n=n||t.getLocalBounds();var o=p.default.create(0|n.width,0|n.height,e,i);return m.tx=-n.x,m.ty=-n.y,this.render(t,o,!1,m,!!t.parent),o},s.prototype.destroy=function(t){t&&this.view.parentNode&&this.view.parentNode.removeChild(this.view),this.type=h.RENDERER_TYPE.UNKNOWN,this.view=null,this.screen=null,this.resolution=0,this.transparent=!1,this.autoResize=!1,this.blendModes=null,this.options=null,this.preserveDrawingBuffer=!1,this.clearBeforeRender=!1,this.roundPixels=!1,this._backgroundColor=0,this._backgroundColorRgba=null,this._backgroundColorString=null,this._tempDisplayObjectParent=null,this._lastObjectRendered=null},n(s,[{key:"width",get:function(){return this.view.width}},{key:"height",get:function(){return this.view.height}},{key:"backgroundColor",get:function(){return this._backgroundColor},set:function(t){this._backgroundColor=t,this._backgroundColorString=(0,a.hex2string)(t),(0,a.hex2rgb)(t,this._backgroundColorRgba)}}]),s}(o.default);i.default=s},{"../const":46,"../display/Container":48,"../math":70,"../settings":101,"../textures/RenderTexture":113,"../utils":125,eventemitter3:3}],77:[function(t,e,i){i.__esModule=!0;var n=r(t("../SystemRenderer")),s=r(t("./utils/CanvasMaskManager")),u=r(t("./utils/CanvasRenderTarget")),a=r(t("./utils/mapCanvasBlendModesToPixi")),o=t("../../utils"),c=t("../../const"),l=r(t("../../settings"));function r(t){return t&&t.__esModule?t:{default:t}}var h=function(o){function r(t,e,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,o.call(this,"Canvas",t,e,i));return n.type=c.RENDERER_TYPE.CANVAS,n.rootContext=n.view.getContext("2d",{alpha:n.transparent}),n.context=n.rootContext,n.refresh=!0,n.maskManager=new s.default(n),n.smoothProperty="imageSmoothingEnabled",n.rootContext.imageSmoothingEnabled||(n.rootContext.webkitImageSmoothingEnabled?n.smoothProperty="webkitImageSmoothingEnabled":n.rootContext.mozImageSmoothingEnabled?n.smoothProperty="mozImageSmoothingEnabled":n.rootContext.oImageSmoothingEnabled?n.smoothProperty="oImageSmoothingEnabled":n.rootContext.msImageSmoothingEnabled&&(n.smoothProperty="msImageSmoothingEnabled")),n.initPlugins(),n.blendModes=(0,a.default)(),n._activeBlendMode=null,n.renderingToScreen=!1,n.resize(n.options.width,n.options.height),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(r,o),r.prototype.render=function(t,e,i,n,o){if(this.view){this.renderingToScreen=!e,this.emit("prerender");var r=this.resolution;e?((e=e.baseTexture||e)._canvasRenderTarget||(e._canvasRenderTarget=new u.default(e.width,e.height,e.resolution),e.source=e._canvasRenderTarget.canvas,e.valid=!0),this.context=e._canvasRenderTarget.context,this.resolution=e._canvasRenderTarget.resolution):this.context=this.rootContext;var s=this.context;if(e||(this._lastObjectRendered=t),!o){var a=t.parent,l=this._tempDisplayObjectParent.transform.worldTransform;n?(n.copy(l),this._tempDisplayObjectParent.transform._worldID=-1):l.identity(),t.parent=this._tempDisplayObjectParent,t.updateTransform(),t.parent=a}s.save(),s.setTransform(1,0,0,1,0,0),s.globalAlpha=1,this._activeBlendMode=c.BLEND_MODES.NORMAL,s.globalCompositeOperation=this.blendModes[c.BLEND_MODES.NORMAL],navigator.isCocoonJS&&this.view.screencanvas&&(s.fillStyle="black",s.clear()),(void 0!==i?i:this.clearBeforeRender)&&this.renderingToScreen&&(this.transparent?s.clearRect(0,0,this.width,this.height):(s.fillStyle=this._backgroundColorString,s.fillRect(0,0,this.width,this.height)));var h=this.context;this.context=s,t.renderCanvas(this),this.context=h,s.restore(),this.resolution=r,this.emit("postrender")}},r.prototype.clear=function(t){var e=this.context;t=t||this._backgroundColorString,!this.transparent&&t?(e.fillStyle=t,e.fillRect(0,0,this.width,this.height)):e.clearRect(0,0,this.width,this.height)},r.prototype.setBlendMode=function(t){this._activeBlendMode!==t&&(this._activeBlendMode=t,this.context.globalCompositeOperation=this.blendModes[t])},r.prototype.destroy=function(t){this.destroyPlugins(),o.prototype.destroy.call(this,t),this.context=null,this.refresh=!0,this.maskManager.destroy(),this.maskManager=null,this.smoothProperty=null},r.prototype.resize=function(t,e){o.prototype.resize.call(this,t,e),this.smoothProperty&&(this.rootContext[this.smoothProperty]=l.default.SCALE_MODE===c.SCALE_MODES.LINEAR)},r.prototype.invalidateBlendMode=function(){this._activeBlendMode=this.blendModes.indexOf(this.context.globalCompositeOperation)},r}(n.default);i.default=h,o.pluginTarget.mixin(h)},{"../../const":46,"../../settings":101,"../../utils":125,"../SystemRenderer":76,"./utils/CanvasMaskManager":78,"./utils/CanvasRenderTarget":79,"./utils/mapCanvasBlendModesToPixi":81}],78:[function(t,e,i){i.__esModule=!0;var I=t("../../../const");var n=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.renderer=t}return e.prototype.pushMask=function(t){var e=this.renderer;e.context.save();var i=t.alpha,n=t.transform.worldTransform,o=e.resolution;e.context.setTransform(n.a*o,n.b*o,n.c*o,n.d*o,n.tx*o,n.ty*o),t._texture||(this.renderGraphicsShape(t),e.context.clip()),t.worldAlpha=i},e.prototype.renderGraphicsShape=function(t){var e=this.renderer.context,i=t.graphicsData.length;if(0!==i){e.beginPath();for(var n=0;n<i;n++){var o=t.graphicsData[n],r=o.shape;if(o.type===I.SHAPES.POLY){var s=r.points,a=o.holes,l=void 0,h=void 0;e.moveTo(s[0],s[1]);for(var u=2;u<s.length;u+=2)e.lineTo(s[u],s[u+1]);if(s[0]===s[s.length-2]&&s[1]===s[s.length-1]&&e.closePath(),0<a.length){for(var c=l=0;c<s.length;c+=2)l+=s[c]*s[c+3]-s[c+1]*s[c+2];for(var p=0;p<a.length;p++){s=a[p].points;for(var m=h=0;m<s.length;m+=2)h+=s[m]*s[m+3]-s[m+1]*s[m+2];if(e.moveTo(s[0],s[1]),h*l<0)for(var f=2;f<s.length;f+=2)e.lineTo(s[f],s[f+1]);else for(var d=s.length-2;2<=d;d-=2)e.lineTo(s[d],s[d+1])}}}else if(o.type===I.SHAPES.RECT)e.rect(r.x,r.y,r.width,r.height),e.closePath();else if(o.type===I.SHAPES.CIRC)e.arc(r.x,r.y,r.radius,0,2*Math.PI),e.closePath();else if(o.type===I.SHAPES.ELIP){var _=2*r.width,y=2*r.height,x=r.x-_/2,v=r.y-y/2,b=_/2*.5522848,g=y/2*.5522848,w=x+_,C=v+y,D=x+_/2,S=v+y/2;e.moveTo(x,S),e.bezierCurveTo(x,S-g,D-b,v,D,v),e.bezierCurveTo(D+b,v,w,S-g,w,S),e.bezierCurveTo(w,S+g,D+b,C,D,C),e.bezierCurveTo(D-b,C,x,S+g,x,S),e.closePath()}else if(o.type===I.SHAPES.RREC){var T=r.x,A=r.y,M=r.width,B=r.height,E=r.radius,P=Math.min(M,B)/2|0;E=P<E?P:E,e.moveTo(T,A+E),e.lineTo(T,A+B-E),e.quadraticCurveTo(T,A+B,T+E,A+B),e.lineTo(T+M-E,A+B),e.quadraticCurveTo(T+M,A+B,T+M,A+B-E),e.lineTo(T+M,A+E),e.quadraticCurveTo(T+M,A,T+M-E,A),e.lineTo(T+E,A),e.quadraticCurveTo(T,A,T,A+E),e.closePath()}}}},e.prototype.popMask=function(t){t.context.restore(),t.invalidateBlendMode()},e.prototype.destroy=function(){},e}();i.default=n},{"../../../const":46}],79:[function(t,e,i){i.__esModule=!0;var n,o=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),r=t("../../../settings"),s=(n=r)&&n.__esModule?n:{default:n};var a=function(){function n(t,e,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=i||s.default.RESOLUTION,this.resize(t,e)}return n.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},n.prototype.resize=function(t,e){this.canvas.width=t*this.resolution,this.canvas.height=e*this.resolution},n.prototype.destroy=function(){this.context=null,this.canvas=null},o(n,[{key:"width",get:function(){return this.canvas.width},set:function(t){this.canvas.width=t}},{key:"height",get:function(){return this.canvas.height},set:function(t){this.canvas.height=t}}]),n}();i.default=a},{"../../../settings":101}],80:[function(t,e,i){function s(t){var e=document.createElement("canvas");e.width=6,e.height=1;var i=e.getContext("2d");return i.fillStyle=t,i.fillRect(0,0,6,1),e}i.__esModule=!0,i.default=function(){if("undefined"==typeof document)return!1;var t=s("#ff00ff"),e=s("#ffff00"),i=document.createElement("canvas");i.width=6,i.height=1;var n=i.getContext("2d");n.globalCompositeOperation="multiply",n.drawImage(t,0,0),n.drawImage(e,2,0);var o=n.getImageData(2,0,1,1);if(!o)return!1;var r=o.data;return 255===r[0]&&0===r[1]&&0===r[2]}},{}],81:[function(t,e,i){i.__esModule=!0,i.default=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];(0,s.default)()?(t[o.BLEND_MODES.NORMAL]="source-over",t[o.BLEND_MODES.ADD]="lighter",t[o.BLEND_MODES.MULTIPLY]="multiply",t[o.BLEND_MODES.SCREEN]="screen",t[o.BLEND_MODES.OVERLAY]="overlay",t[o.BLEND_MODES.DARKEN]="darken",t[o.BLEND_MODES.LIGHTEN]="lighten",t[o.BLEND_MODES.COLOR_DODGE]="color-dodge",t[o.BLEND_MODES.COLOR_BURN]="color-burn",t[o.BLEND_MODES.HARD_LIGHT]="hard-light",t[o.BLEND_MODES.SOFT_LIGHT]="soft-light",t[o.BLEND_MODES.DIFFERENCE]="difference",t[o.BLEND_MODES.EXCLUSION]="exclusion",t[o.BLEND_MODES.HUE]="hue",t[o.BLEND_MODES.SATURATION]="saturate",t[o.BLEND_MODES.COLOR]="color",t[o.BLEND_MODES.LUMINOSITY]="luminosity"):(t[o.BLEND_MODES.NORMAL]="source-over",t[o.BLEND_MODES.ADD]="lighter",t[o.BLEND_MODES.MULTIPLY]="source-over",t[o.BLEND_MODES.SCREEN]="source-over",t[o.BLEND_MODES.OVERLAY]="source-over",t[o.BLEND_MODES.DARKEN]="source-over",t[o.BLEND_MODES.LIGHTEN]="source-over",t[o.BLEND_MODES.COLOR_DODGE]="source-over",t[o.BLEND_MODES.COLOR_BURN]="source-over",t[o.BLEND_MODES.HARD_LIGHT]="source-over",t[o.BLEND_MODES.SOFT_LIGHT]="source-over",t[o.BLEND_MODES.DIFFERENCE]="source-over",t[o.BLEND_MODES.EXCLUSION]="source-over",t[o.BLEND_MODES.HUE]="source-over",t[o.BLEND_MODES.SATURATION]="source-over",t[o.BLEND_MODES.COLOR]="source-over",t[o.BLEND_MODES.LUMINOSITY]="source-over");return t[o.BLEND_MODES.NORMAL_NPM]=t[o.BLEND_MODES.NORMAL],t[o.BLEND_MODES.ADD_NPM]=t[o.BLEND_MODES.ADD],t[o.BLEND_MODES.SCREEN_NPM]=t[o.BLEND_MODES.SCREEN],t};var n,o=t("../../../const"),r=t("./canUseNewCanvasBlendModes"),s=(n=r)&&n.__esModule?n:{default:n}},{"../../../const":46,"./canUseNewCanvasBlendModes":80}],82:[function(t,e,i){i.__esModule=!0;var n,o=t("../../const"),r=t("../../settings"),s=(n=r)&&n.__esModule?n:{default:n};var a=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.renderer=t,this.count=0,this.checkCount=0,this.maxIdle=s.default.GC_MAX_IDLE,this.checkCountMax=s.default.GC_MAX_CHECK_COUNT,this.mode=s.default.GC_MODE}return e.prototype.update=function(){this.count++,this.mode!==o.GC_MODES.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run()))},e.prototype.run=function(){for(var t=this.renderer.textureManager,e=t._managedTextures,i=!1,n=0;n<e.length;n++){var o=e[n];!o._glRenderTargets&&this.count-o.touched>this.maxIdle&&(t.destroyTexture(o,!0),i=!(e[n]=null))}if(i){for(var r=0,s=0;s<e.length;s++)null!==e[s]&&(e[r++]=e[s]);e.length=r}},e.prototype.unload=function(t){var e=this.renderer.textureManager;t._texture&&t._texture._glRenderTargets&&e.destroyTexture(t._texture,!0);for(var i=t.children.length-1;0<=i;i--)this.unload(t.children[i])},e}();i.default=a},{"../../const":46,"../../settings":101}],83:[function(t,e,i){i.__esModule=!0;var n,l=t("pixi-gl-core"),h=t("../../const"),o=t("./utils/RenderTarget"),u=(n=o)&&n.__esModule?n:{default:n},a=t("../../utils");var r=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.renderer=t,this.gl=t.gl,this._managedTextures=[]}return e.prototype.bindTexture=function(){},e.prototype.getTexture=function(){},e.prototype.updateTexture=function(t,e){var i=this.gl,n=!!t._glRenderTargets;if(!t.hasLoaded)return null;var o=this.renderer.boundTextures;if(void 0===e)for(var r=e=0;r<o.length;++r)if(o[r]===t){e=r;break}o[e]=t,i.activeTexture(i.TEXTURE0+e);var s=t._glTextures[this.renderer.CONTEXT_UID];if(s)n?t._glRenderTargets[this.renderer.CONTEXT_UID].resize(t.width,t.height):s.upload(t.source);else{if(n){var a=new u.default(this.gl,t.width,t.height,t.scaleMode,t.resolution);a.resize(t.width,t.height),s=(t._glRenderTargets[this.renderer.CONTEXT_UID]=a).texture,this.renderer._activeRenderTarget.root||this.renderer._activeRenderTarget.frameBuffer.bind()}else(s=new l.GLTexture(this.gl,null,null,null,null)).bind(e),s.premultiplyAlpha=!0,s.upload(t.source);t._glTextures[this.renderer.CONTEXT_UID]=s,t.on("update",this.updateTexture,this),t.on("dispose",this.destroyTexture,this),this._managedTextures.push(t),t.isPowerOfTwo?(t.mipmap&&s.enableMipmap(),t.wrapMode===h.WRAP_MODES.CLAMP?s.enableWrapClamp():t.wrapMode===h.WRAP_MODES.REPEAT?s.enableWrapRepeat():s.enableWrapMirrorRepeat()):s.enableWrapClamp(),t.scaleMode===h.SCALE_MODES.NEAREST?s.enableNearestScaling():s.enableLinearScaling()}return s},e.prototype.destroyTexture=function(t,e){if((t=t.baseTexture||t).hasLoaded){var i=this.renderer,n=i.CONTEXT_UID,o=t._glTextures,r=t._glRenderTargets;if(o[n]&&(i.unbindTexture(t),o[n].destroy(),t.off("update",this.updateTexture,this),t.off("dispose",this.destroyTexture,this),delete o[n],!e)){var s=this._managedTextures.indexOf(t);-1!==s&&(0,a.removeItems)(this._managedTextures,s,1)}r&&r[n]&&(i._activeRenderTarget===r[n]&&i.bindRenderTarget(i.rootRenderTarget),r[n].destroy(),delete r[n])}},e.prototype.removeAll=function(){for(var t=0;t<this._managedTextures.length;++t){var e=this._managedTextures[t];e._glTextures[this.renderer.CONTEXT_UID]&&delete e._glTextures[this.renderer.CONTEXT_UID]}},e.prototype.destroy=function(){for(var t=0;t<this._managedTextures.length;++t){var e=this._managedTextures[t];this.destroyTexture(e,!0),e.off("update",this.updateTexture,this),e.off("dispose",this.destroyTexture,this)}this._managedTextures=null},e}();i.default=r},{"../../const":46,"../../utils":125,"./utils/RenderTarget":96,"pixi-gl-core":15}],84:[function(t,e,i){i.__esModule=!0;var n=r(t("../SystemRenderer")),s=r(t("./managers/MaskManager")),a=r(t("./managers/StencilManager")),l=r(t("./managers/FilterManager")),h=r(t("./utils/RenderTarget")),u=r(t("./utils/ObjectRenderer")),c=r(t("./TextureManager")),p=r(t("../../textures/BaseTexture")),m=r(t("./TextureGarbageCollector")),f=r(t("./WebGLState")),d=r(t("./utils/mapWebGLDrawModesToPixi")),_=r(t("./utils/validateContext")),o=t("../../utils"),y=r(t("pixi-gl-core")),x=t("../../const");function r(t){return t&&t.__esModule?t:{default:t}}var v=0,b=function(o){function r(t,e,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,o.call(this,"WebGL",t,e,i));return n.legacy=n.options.legacy,n.legacy&&(y.default.VertexArrayObject.FORCE_NATIVE=!0),n.type=x.RENDERER_TYPE.WEBGL,n.handleContextLost=n.handleContextLost.bind(n),n.handleContextRestored=n.handleContextRestored.bind(n),n.view.addEventListener("webglcontextlost",n.handleContextLost,!1),n.view.addEventListener("webglcontextrestored",n.handleContextRestored,!1),n._contextOptions={alpha:n.transparent,antialias:n.options.antialias,premultipliedAlpha:n.transparent&&"notMultiplied"!==n.transparent,stencil:!0,preserveDrawingBuffer:n.options.preserveDrawingBuffer,powerPreference:n.options.powerPreference},n._backgroundColorRgba[3]=n.transparent?0:1,n.maskManager=new s.default(n),n.stencilManager=new a.default(n),n.emptyRenderer=new u.default(n),n.currentRenderer=n.emptyRenderer,n.textureManager=null,n.filterManager=null,n.initPlugins(),n.options.context&&(0,_.default)(n.options.context),n.gl=n.options.context||y.default.createContext(n.view,n._contextOptions),n.CONTEXT_UID=v++,n.state=new f.default(n.gl),n.renderingToScreen=!0,n.boundTextures=null,n._activeShader=null,n._activeVao=null,n._activeRenderTarget=null,n._initContext(),n.drawModes=(0,d.default)(n.gl),n._nextTextureLocation=0,n.setBlendMode(0),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(r,o),r.prototype._initContext=function(){var t=this.gl;t.isContextLost()&&t.getExtension("WEBGL_lose_context")&&t.getExtension("WEBGL_lose_context").restoreContext();var e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this._activeShader=null,this._activeVao=null,this.boundTextures=new Array(e),this.emptyTextures=new Array(e),this.textureManager=new c.default(this),this.filterManager=new l.default(this),this.textureGC=new m.default(this),this.state.resetToDefault(),this.rootRenderTarget=new h.default(t,this.width,this.height,null,this.resolution,!0),this.rootRenderTarget.clearColor=this._backgroundColorRgba,this.bindRenderTarget(this.rootRenderTarget);var i=new y.default.GLTexture.fromData(t,null,1,1),n={_glTextures:{}};n._glTextures[this.CONTEXT_UID]={};for(var o=0;o<e;o++){var r=new p.default;r._glTextures[this.CONTEXT_UID]=i,this.boundTextures[o]=n,this.emptyTextures[o]=r,this.bindTexture(null,o)}this.emit("context",t),this.resize(this.screen.width,this.screen.height)},r.prototype.render=function(t,e,i,n,o){if(this.renderingToScreen=!e,this.emit("prerender"),this.gl&&!this.gl.isContextLost()){if(this._nextTextureLocation=0,e||(this._lastObjectRendered=t),!o){var r=t.parent;t.parent=this._tempDisplayObjectParent,t.updateTransform(),t.parent=r}this.bindRenderTexture(e,n),this.currentRenderer.start(),(void 0!==i?i:this.clearBeforeRender)&&this._activeRenderTarget.clear(),t.renderWebGL(this),this.currentRenderer.flush(),this.textureGC.update(),this.emit("postrender")}},r.prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},r.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},r.prototype.resize=function(t,e){n.default.prototype.resize.call(this,t,e),this.rootRenderTarget.resize(t,e),this._activeRenderTarget===this.rootRenderTarget&&(this.rootRenderTarget.activate(),this._activeShader&&(this._activeShader.uniforms.projectionMatrix=this.rootRenderTarget.projectionMatrix.toArray(!0)))},r.prototype.setBlendMode=function(t){this.state.setBlendMode(t)},r.prototype.clear=function(t){this._activeRenderTarget.clear(t)},r.prototype.setTransform=function(t){this._activeRenderTarget.transform=t},r.prototype.clearRenderTexture=function(t,e){var i=t.baseTexture._glRenderTargets[this.CONTEXT_UID];return i&&i.clear(e),this},r.prototype.bindRenderTexture=function(t,e){var i=void 0;if(t){var n=t.baseTexture;n._glRenderTargets[this.CONTEXT_UID]||this.textureManager.updateTexture(n,0),this.unbindTexture(n),(i=n._glRenderTargets[this.CONTEXT_UID]).setFrame(t.frame)}else i=this.rootRenderTarget;return i.transform=e,this.bindRenderTarget(i),this},r.prototype.bindRenderTarget=function(t){return t!==this._activeRenderTarget&&((this._activeRenderTarget=t).activate(),this._activeShader&&(this._activeShader.uniforms.projectionMatrix=t.projectionMatrix.toArray(!0)),this.stencilManager.setMaskStack(t.stencilMaskStack)),this},r.prototype.bindShader=function(t,e){return this._activeShader!==t&&((this._activeShader=t).bind(),!1!==e&&(t.uniforms.projectionMatrix=this._activeRenderTarget.projectionMatrix.toArray(!0))),this},r.prototype.bindTexture=function(t,e,i){if((t=(t=t||this.emptyTextures[e]).baseTexture||t).touched=this.textureGC.count,i)e=e||0;else{for(var n=0;n<this.boundTextures.length;n++)if(this.boundTextures[n]===t)return n;void 0===e&&(this._nextTextureLocation++,this._nextTextureLocation%=this.boundTextures.length,e=this.boundTextures.length-this._nextTextureLocation-1)}var o=this.gl,r=t._glTextures[this.CONTEXT_UID];return r?(this.boundTextures[e]=t,o.activeTexture(o.TEXTURE0+e),o.bindTexture(o.TEXTURE_2D,r.texture)):this.textureManager.updateTexture(t,e),e},r.prototype.unbindTexture=function(t){var e=this.gl;t=t.baseTexture||t;for(var i=0;i<this.boundTextures.length;i++)this.boundTextures[i]===t&&(this.boundTextures[i]=this.emptyTextures[i],e.activeTexture(e.TEXTURE0+i),e.bindTexture(e.TEXTURE_2D,this.emptyTextures[i]._glTextures[this.CONTEXT_UID].texture));return this},r.prototype.createVao=function(){return new y.default.VertexArrayObject(this.gl,this.state.attribState)},r.prototype.bindVao=function(t){return this._activeVao===t||(t?t.bind():this._activeVao&&this._activeVao.unbind(),this._activeVao=t),this},r.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer),this.bindVao(null),this._activeShader=null,this._activeRenderTarget=this.rootRenderTarget;for(var t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.emptyTextures[t];return this.rootRenderTarget.activate(),this.state.resetToDefault(),this},r.prototype.handleContextLost=function(t){t.preventDefault()},r.prototype.handleContextRestored=function(){this.textureManager.removeAll(),this.filterManager.destroy(!0),this._initContext()},r.prototype.destroy=function(t){this.destroyPlugins(),this.view.removeEventListener("webglcontextlost",this.handleContextLost),this.view.removeEventListener("webglcontextrestored",this.handleContextRestored),this.textureManager.destroy(),o.prototype.destroy.call(this,t),this.uid=0,this.maskManager.destroy(),this.stencilManager.destroy(),this.filterManager.destroy(),this.maskManager=null,this.filterManager=null,this.textureManager=null,this.currentRenderer=null,this.handleContextLost=null,this.handleContextRestored=null,this._contextOptions=null,this.gl.useProgram(null),this.gl.getExtension("WEBGL_lose_context")&&this.gl.getExtension("WEBGL_lose_context").loseContext(),this.gl=null},r}(n.default);i.default=b,o.pluginTarget.mixin(b)},{"../../const":46,"../../textures/BaseTexture":112,"../../utils":125,"../SystemRenderer":76,"./TextureGarbageCollector":82,"./TextureManager":83,"./WebGLState":85,"./managers/FilterManager":90,"./managers/MaskManager":91,"./managers/StencilManager":92,"./utils/ObjectRenderer":94,"./utils/RenderTarget":96,"./utils/mapWebGLDrawModesToPixi":99,"./utils/validateContext":100,"pixi-gl-core":15}],85:[function(t,e,i){i.__esModule=!0;var n,o=t("./utils/mapWebGLBlendModesToPixi"),r=(n=o)&&n.__esModule?n:{default:n};var s=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.activeState=new Uint8Array(16),this.defaultState=new Uint8Array(16),this.defaultState[0]=1,this.stackIndex=0,this.stack=[],this.gl=t,this.maxAttribs=t.getParameter(t.MAX_VERTEX_ATTRIBS),this.attribState={tempAttribState:new Array(this.maxAttribs),attribState:new Array(this.maxAttribs)},this.blendModes=(0,r.default)(t),this.nativeVaoExtension=t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object")}return e.prototype.push=function(){var t=this.stack[this.stackIndex];t||(t=this.stack[this.stackIndex]=new Uint8Array(16)),++this.stackIndex;for(var e=0;e<this.activeState.length;e++)t[e]=this.activeState[e]},e.prototype.pop=function(){var t=this.stack[--this.stackIndex];this.setState(t)},e.prototype.setState=function(t){this.setBlend(t[0]),this.setDepthTest(t[1]),this.setFrontFace(t[2]),this.setCullFace(t[3]),this.setBlendMode(t[4])},e.prototype.setBlend=function(t){t=t?1:0,this.activeState[0]!==t&&(this.activeState[0]=t,this.gl[t?"enable":"disable"](this.gl.BLEND))},e.prototype.setBlendMode=function(t){if(t!==this.activeState[4]){this.activeState[4]=t;var e=this.blendModes[t];2===e.length?this.gl.blendFunc(e[0],e[1]):this.gl.blendFuncSeparate(e[0],e[1],e[2],e[3])}},e.prototype.setDepthTest=function(t){t=t?1:0,this.activeState[1]!==t&&(this.activeState[1]=t,this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST))},e.prototype.setCullFace=function(t){t=t?1:0,this.activeState[3]!==t&&(this.activeState[3]=t,this.gl[t?"enable":"disable"](this.gl.CULL_FACE))},e.prototype.setFrontFace=function(t){t=t?1:0,this.activeState[2]!==t&&(this.activeState[2]=t,this.gl.frontFace(this.gl[t?"CW":"CCW"]))},e.prototype.resetAttributes=function(){for(var t=0;t<this.attribState.tempAttribState.length;t++)this.attribState.tempAttribState[t]=0;for(var e=0;e<this.attribState.attribState.length;e++)this.attribState.attribState[e]=0;for(var i=1;i<this.maxAttribs;i++)this.gl.disableVertexAttribArray(i)},e.prototype.resetToDefault=function(){this.nativeVaoExtension&&this.nativeVaoExtension.bindVertexArrayOES(null),this.resetAttributes();for(var t=0;t<this.activeState.length;++t)this.activeState[t]=32;this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.setState(this.defaultState)},e}();i.default=s},{"./utils/mapWebGLBlendModesToPixi":98}],86:[function(t,e,i){i.__esModule=!0;var n=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),r=o(t("./extractUniformsFromSrc")),s=t("../../../utils"),a=t("../../../const"),l=o(t("../../../settings"));function o(t){return t&&t.__esModule?t:{default:t}}var h={},u=function(){function o(t,e,i){for(var n in function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),this.vertexSrc=t||o.defaultVertexSrc,this.fragmentSrc=e||o.defaultFragmentSrc,this._blendMode=a.BLEND_MODES.NORMAL,this.uniformData=i||(0,r.default)(this.vertexSrc,this.fragmentSrc,"projectionMatrix|uSampler"),this.uniforms={},this.uniformData)this.uniforms[n]=this.uniformData[n].value,this.uniformData[n].type&&(this.uniformData[n].type=this.uniformData[n].type.toLowerCase());this.glShaders={},h[this.vertexSrc+this.fragmentSrc]||(h[this.vertexSrc+this.fragmentSrc]=(0,s.uid)()),this.glShaderKey=h[this.vertexSrc+this.fragmentSrc],this.padding=4,this.resolution=l.default.FILTER_RESOLUTION,this.enabled=!0,this.autoFit=!0}return o.prototype.apply=function(t,e,i,n,o){t.applyFilter(this,e,i,n)},n(o,[{key:"blendMode",get:function(){return this._blendMode},set:function(t){this._blendMode=t}}],[{key:"defaultVertexSrc",get:function(){return["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","uniform mat3 projectionMatrix;","uniform mat3 filterMatrix;","varying vec2 vTextureCoord;","varying vec2 vFilterCoord;","void main(void){","   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vFilterCoord = ( filterMatrix * vec3( aTextureCoord, 1.0)  ).xy;","   vTextureCoord = aTextureCoord ;","}"].join("\n")}},{key:"defaultFragmentSrc",get:function(){return["varying vec2 vTextureCoord;","varying vec2 vFilterCoord;","uniform sampler2D uSampler;","uniform sampler2D filterSampler;","void main(void){","   vec4 masky = texture2D(filterSampler, vFilterCoord);","   vec4 sample = texture2D(uSampler, vTextureCoord);","   vec4 color;","   if(mod(vFilterCoord.x, 1.0) > 0.5)","   {","     color = vec4(1.0, 0.0, 0.0, 1.0);","   }","   else","   {","     color = vec4(0.0, 1.0, 0.0, 1.0);","   }","   gl_FragColor = mix(sample, masky, 0.5);","   gl_FragColor *= sample.a;","}"].join("\n")}}]),o}();i.default=u},{"../../../const":46,"../../../settings":101,"../../../utils":125,"./extractUniformsFromSrc":87}],87:[function(t,e,i){i.__esModule=!0,i.default=function(t,e,i){var n=r(t),o=r(e);return Object.assign(n,o)};var n,o=t("pixi-gl-core");var c=((n=o)&&n.__esModule?n:{default:n}).default.shader.defaultValue;function r(t){for(var e=new RegExp("^(projectionMatrix|uSampler|filterArea|filterClamp)$"),i={},n=void 0,o=t.replace(/\s+/g," ").split(/\s*;\s*/),r=0;r<o.length;r++){var s=o[r].trim();if(-1<s.indexOf("uniform")){var a=s.split(" "),l=a[1],h=a[2],u=1;-1<h.indexOf("[")&&(h=(n=h.split(/\[|]/))[0],u*=Number(n[1])),h.match(e)||(i[h]={value:c(l,u),name:h,type:l})}}return i}},{"pixi-gl-core":15}],88:[function(t,e,i){i.__esModule=!0,i.calculateScreenSpaceMatrix=function(t,e,i){var n=t.identity();return n.translate(e.x/i.width,e.y/i.height),n.scale(i.width,i.height),n},i.calculateNormalizedScreenSpaceMatrix=function(t,e,i){var n=t.identity();n.translate(e.x/i.width,e.y/i.height);var o=i.width/e.width,r=i.height/e.height;return n.scale(o,r),n},i.calculateSpriteMatrix=function(t,e,i,n){var o=n._texture.orig,r=t.set(i.width,0,0,i.height,e.x,e.y),s=n.worldTransform.copy(a.Matrix.TEMP_MATRIX);return s.invert(),r.prepend(s),r.scale(1/o.width,1/o.height),r.translate(n.anchor.x,n.anchor.y),r};var a=t("../../../math")},{"../../../math":70}],89:[function(t,e,i){i.__esModule=!0;var n=o(t("../Filter")),r=t("../../../../math"),s=(t("path"),o(t("../../../../textures/TextureMatrix")));function o(t){return t&&t.__esModule?t:{default:t}}var a=function(n){function o(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var e=new r.Matrix,i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,n.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n","varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n\n    original *= (masky.r * masky.a * alpha * clip);\n\n    gl_FragColor = original;\n}\n"));return t.renderable=!1,i.maskSprite=t,i.maskMatrix=e,i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(o,n),o.prototype.apply=function(t,e,i){var n=this.maskSprite,o=this.maskSprite.texture;o.valid&&(o.transform||(o.transform=new s.default(o,0)),o.transform.update(),this.uniforms.mask=o,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,n).prepend(o.transform.mapCoord),this.uniforms.alpha=n.worldAlpha,this.uniforms.maskClamp=o.transform.uClampFrame,t.applyFilter(this,e,i))},o}(n.default);i.default=a},{"../../../../math":70,"../../../../textures/TextureMatrix":116,"../Filter":86,path:8}],90:[function(t,e,i){i.__esModule=!0;var n=u(t("./WebGLManager")),a=u(t("../utils/RenderTarget")),o=u(t("../utils/Quad")),r=t("../../../math"),l=u(t("../../../Shader")),s=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}}(t("../filters/filterTransforms")),h=u(t("bit-twiddle"));function u(t){return t&&t.__esModule?t:{default:t}}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var f=function(){function t(){c(this,t),this.renderTarget=null,this.target=null,this.resolution=1,this.sourceFrame=new r.Rectangle,this.destinationFrame=new r.Rectangle,this.filters=[]}return t.prototype.clear=function(){this.filters=null,this.target=null,this.renderTarget=null},t}(),p="screen",m=function(i){function n(t){c(this,n);var e=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,i.call(this,t));return e.gl=e.renderer.gl,e.quad=new o.default(e.gl,t.state.attribState),e.shaderCache={},e.pool={},e.filterData=null,e.managedFilters=[],e.renderer.on("prerender",e.onPrerender,e),e._screenWidth=t.view.width,e._screenHeight=t.view.height,e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(n,i),n.prototype.pushFilter=function(t,e){var i=this.renderer,n=this.filterData;if(!n){n=this.renderer._activeRenderTarget.filterStack;var o=new f;o.sourceFrame=o.destinationFrame=this.renderer._activeRenderTarget.size,o.renderTarget=i._activeRenderTarget,this.renderer._activeRenderTarget.filterData=n={index:0,stack:[o]},this.filterData=n}var r=n.stack[++n.index],s=n.stack[0].destinationFrame;r||(r=n.stack[n.index]=new f);var a=t.filterArea&&0===t.filterArea.x&&0===t.filterArea.y&&t.filterArea.width===i.screen.width&&t.filterArea.height===i.screen.height,l=e[0].resolution,h=0|e[0].padding,u=a?i.screen:t.filterArea||t.getBounds(!0),c=r.sourceFrame,p=r.destinationFrame;c.x=(u.x*l|0)/l,c.y=(u.y*l|0)/l,c.width=(u.width*l|0)/l,c.height=(u.height*l|0)/l,a||(n.stack[0].renderTarget.transform||e[0].autoFit&&c.fit(s),c.pad(h)),p.width=c.width,p.height=c.height;var m=this.getPotRenderTarget(i.gl,c.width,c.height,l);r.target=t,r.filters=e,r.resolution=l,(r.renderTarget=m).setFrame(p,c),i.bindRenderTarget(m),m.clear()},n.prototype.popFilter=function(){var t=this.filterData,e=t.stack[t.index-1],i=t.stack[t.index];this.quad.map(i.renderTarget.size,i.sourceFrame).upload();var n=i.filters;if(1===n.length)n[0].apply(this,i.renderTarget,e.renderTarget,!1,i),this.freePotRenderTarget(i.renderTarget);else{var o=i.renderTarget,r=this.getPotRenderTarget(this.renderer.gl,i.sourceFrame.width,i.sourceFrame.height,i.resolution);r.setFrame(i.destinationFrame,i.sourceFrame),r.clear();var s=0;for(s=0;s<n.length-1;++s){n[s].apply(this,o,r,!0,i);var a=o;o=r,r=a}n[s].apply(this,o,e.renderTarget,!1,i),this.freePotRenderTarget(o),this.freePotRenderTarget(r)}i.clear(),t.index--,0===t.index&&(this.filterData=null)},n.prototype.applyFilter=function(t,e,i,n){var o=this.renderer,r=o.gl,s=t.glShaders[o.CONTEXT_UID];s||(t.glShaderKey?(s=this.shaderCache[t.glShaderKey])||(s=new l.default(this.gl,t.vertexSrc,t.fragmentSrc),t.glShaders[o.CONTEXT_UID]=this.shaderCache[t.glShaderKey]=s,this.managedFilters.push(t)):(s=t.glShaders[o.CONTEXT_UID]=new l.default(this.gl,t.vertexSrc,t.fragmentSrc),this.managedFilters.push(t)),o.bindVao(null),this.quad.initVao(s)),o.bindVao(this.quad.vao),o.bindRenderTarget(i),n&&(r.disable(r.SCISSOR_TEST),o.clear(),r.enable(r.SCISSOR_TEST)),i===o.maskManager.scissorRenderTarget&&o.maskManager.pushScissorMask(null,o.maskManager.scissorData),o.bindShader(s);var a=this.renderer.emptyTextures[0];this.renderer.boundTextures[0]=a,this.syncUniforms(s,t),o.state.setBlendMode(t.blendMode),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,e.texture.texture),this.quad.vao.draw(this.renderer.gl.TRIANGLES,6,0),r.bindTexture(r.TEXTURE_2D,a._glTextures[this.renderer.CONTEXT_UID].texture)},n.prototype.syncUniforms=function(t,e){var i=e.uniformData,n=e.uniforms,o=1,r=void 0;if(t.uniforms.filterArea){r=this.filterData.stack[this.filterData.index];var s=t.uniforms.filterArea;s[0]=r.renderTarget.size.width,s[1]=r.renderTarget.size.height,s[2]=r.sourceFrame.x,s[3]=r.sourceFrame.y,t.uniforms.filterArea=s}if(t.uniforms.filterClamp){r=r||this.filterData.stack[this.filterData.index];var a=t.uniforms.filterClamp;a[0]=0,a[1]=0,a[2]=(r.sourceFrame.width-1)/r.renderTarget.size.width,a[3]=(r.sourceFrame.height-1)/r.renderTarget.size.height,t.uniforms.filterClamp=a}for(var l in i)if(t.uniforms.data[l]){var h=i[l].type;if("sampler2d"===h&&0!==n[l]){if(n[l].baseTexture)t.uniforms[l]=this.renderer.bindTexture(n[l].baseTexture,o);else{t.uniforms[l]=o;var u=this.renderer.gl;this.renderer.boundTextures[o]=this.renderer.emptyTextures[o],u.activeTexture(u.TEXTURE0+o),n[l].texture.bind()}o++}else if("mat3"===h)void 0!==n[l].a?t.uniforms[l]=n[l].toArray(!0):t.uniforms[l]=n[l];else if("vec2"===h)if(void 0!==n[l].x){var c=t.uniforms[l]||new Float32Array(2);c[0]=n[l].x,c[1]=n[l].y,t.uniforms[l]=c}else t.uniforms[l]=n[l];else"float"===h?t.uniforms.data[l].value!==i[l]&&(t.uniforms[l]=n[l]):t.uniforms[l]=n[l]}},n.prototype.getRenderTarget=function(t,e){var i=this.filterData.stack[this.filterData.index],n=this.getPotRenderTarget(this.renderer.gl,i.sourceFrame.width,i.sourceFrame.height,e||i.resolution);return n.setFrame(i.destinationFrame,i.sourceFrame),n},n.prototype.returnRenderTarget=function(t){this.freePotRenderTarget(t)},n.prototype.calculateScreenSpaceMatrix=function(t){var e=this.filterData.stack[this.filterData.index];return s.calculateScreenSpaceMatrix(t,e.sourceFrame,e.renderTarget.size)},n.prototype.calculateNormalizedScreenSpaceMatrix=function(t){var e=this.filterData.stack[this.filterData.index];return s.calculateNormalizedScreenSpaceMatrix(t,e.sourceFrame,e.renderTarget.size,e.destinationFrame)},n.prototype.calculateSpriteMatrix=function(t,e){var i=this.filterData.stack[this.filterData.index];return s.calculateSpriteMatrix(t,i.sourceFrame,i.renderTarget.size,e)},n.prototype.destroy=function(){var t=0<arguments.length&&void 0!==arguments[0]&&arguments[0],e=this.renderer,i=this.managedFilters;e.off("prerender",this.onPrerender,this);for(var n=0;n<i.length;n++)t||i[n].glShaders[e.CONTEXT_UID].destroy(),delete i[n].glShaders[e.CONTEXT_UID];this.shaderCache={},t?this.pool={}:this.emptyPool()},n.prototype.getPotRenderTarget=function(t,e,i,n){var o=p;i*=n,(e*=n)===this._screenWidth&&i===this._screenHeight||(o=(65535&(e=h.default.nextPow2(e)))<<16|65535&(i=h.default.nextPow2(i))),this.pool[o]||(this.pool[o]=[]);var r=this.pool[o].pop();if(!r){var s=this.renderer.boundTextures[0];t.activeTexture(t.TEXTURE0),r=new a.default(t,e,i,null,1),t.bindTexture(t.TEXTURE_2D,s._glTextures[this.renderer.CONTEXT_UID].texture)}return r.resolution=n,r.defaultFrame.width=r.size.width=e/n,r.defaultFrame.height=r.size.height=i/n,r.filterPoolKey=o,r},n.prototype.emptyPool=function(){for(var t in this.pool){var e=this.pool[t];if(e)for(var i=0;i<e.length;i++)e[i].destroy(!0)}this.pool={}},n.prototype.freePotRenderTarget=function(t){this.pool[t.filterPoolKey].push(t)},n.prototype.onPrerender=function(){if(this._screenWidth!==this.renderer.view.width||this._screenHeight!==this.renderer.view.height){this._screenWidth=this.renderer.view.width,this._screenHeight=this.renderer.view.height;var t=this.pool[p];if(t)for(var e=0;e<t.length;e++)t[e].destroy(!0);this.pool[p]=[]}},n}(n.default);i.default=m},{"../../../Shader":44,"../../../math":70,"../filters/filterTransforms":88,"../utils/Quad":95,"../utils/RenderTarget":96,"./WebGLManager":93,"bit-twiddle":1}],91:[function(t,e,i){i.__esModule=!0;var n=r(t("./WebGLManager")),o=r(t("../filters/spriteMask/SpriteMaskFilter"));function r(t){return t&&t.__esModule?t:{default:t}}var s=function(i){function n(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n);var e=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,i.call(this,t));return e.scissor=!1,e.scissorData=null,e.scissorRenderTarget=null,e.enableScissor=!0,e.alphaMaskPool=[],e.alphaMaskIndex=0,e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(n,i),n.prototype.pushMask=function(t,e){if(e.texture)this.pushSpriteMask(t,e);else if(this.enableScissor&&!this.scissor&&this.renderer._activeRenderTarget.root&&!this.renderer.stencilManager.stencilMaskStack.length&&e.isFastRect()){var i=e.worldTransform,n=Math.atan2(i.b,i.a);(n=Math.round(n*(180/Math.PI)))%90?this.pushStencilMask(e):this.pushScissorMask(t,e)}else this.pushStencilMask(e)},n.prototype.popMask=function(t,e){e.texture?this.popSpriteMask(t,e):this.enableScissor&&!this.renderer.stencilManager.stencilMaskStack.length?this.popScissorMask(t,e):this.popStencilMask(t,e)},n.prototype.pushSpriteMask=function(t,e){var i=this.alphaMaskPool[this.alphaMaskIndex];i||(i=this.alphaMaskPool[this.alphaMaskIndex]=[new o.default(e)]),i[0].resolution=this.renderer.resolution,i[0].maskSprite=e,t.filterArea=e.getBounds(!0),this.renderer.filterManager.pushFilter(t,i),this.alphaMaskIndex++},n.prototype.popSpriteMask=function(){this.renderer.filterManager.popFilter(),this.alphaMaskIndex--},n.prototype.pushStencilMask=function(t){this.renderer.currentRenderer.stop(),this.renderer.stencilManager.pushStencil(t)},n.prototype.popStencilMask=function(){this.renderer.currentRenderer.stop(),this.renderer.stencilManager.popStencil()},n.prototype.pushScissorMask=function(t,e){e.renderable=!0;var i=this.renderer._activeRenderTarget,n=e.getBounds();n.fit(i.size),e.renderable=!1,this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST);var o=this.renderer.resolution;this.renderer.gl.scissor(n.x*o,(i.root?i.size.height-n.y-n.height:n.y)*o,n.width*o,n.height*o),this.scissorRenderTarget=i,this.scissorData=e,this.scissor=!0},n.prototype.popScissorMask=function(){this.scissorRenderTarget=null,this.scissorData=null,this.scissor=!1;var t=this.renderer.gl;t.disable(t.SCISSOR_TEST)},n}(n.default);i.default=s},{"../filters/spriteMask/SpriteMaskFilter":89,"./WebGLManager":93}],92:[function(t,e,i){i.__esModule=!0;var n,o=t("./WebGLManager"),r=(n=o)&&n.__esModule?n:{default:n};var s=function(i){function n(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n);var e=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,i.call(this,t));return e.stencilMaskStack=null,e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(n,i),n.prototype.setMaskStack=function(t){this.stencilMaskStack=t;var e=this.renderer.gl;0===t.length?e.disable(e.STENCIL_TEST):e.enable(e.STENCIL_TEST)},n.prototype.pushStencil=function(t){this.renderer.setObjectRenderer(this.renderer.plugins.graphics),this.renderer._activeRenderTarget.attachStencilBuffer();var e=this.renderer.gl,i=this.stencilMaskStack.length;0===i&&e.enable(e.STENCIL_TEST),this.stencilMaskStack.push(t),e.colorMask(!1,!1,!1,!1),e.stencilFunc(e.EQUAL,i,this._getBitwiseMask()),e.stencilOp(e.KEEP,e.KEEP,e.INCR),this.renderer.plugins.graphics.render(t),this._useCurrent()},n.prototype.popStencil=function(){this.renderer.setObjectRenderer(this.renderer.plugins.graphics);var t=this.renderer.gl,e=this.stencilMaskStack.pop();0===this.stencilMaskStack.length?(t.disable(t.STENCIL_TEST),t.clear(t.STENCIL_BUFFER_BIT),t.clearStencil(0)):(t.colorMask(!1,!1,!1,!1),t.stencilOp(t.KEEP,t.KEEP,t.DECR),this.renderer.plugins.graphics.render(e),this._useCurrent())},n.prototype._useCurrent=function(){var t=this.renderer.gl;t.colorMask(!0,!0,!0,!0),t.stencilFunc(t.EQUAL,this.stencilMaskStack.length,this._getBitwiseMask()),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},n.prototype._getBitwiseMask=function(){return(1<<this.stencilMaskStack.length)-1},n.prototype.destroy=function(){r.default.prototype.destroy.call(this),this.stencilMaskStack.stencilStack=null},n}(r.default);i.default=s},{"./WebGLManager":93}],93:[function(t,e,i){i.__esModule=!0;var n=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.renderer=t,this.renderer.on("context",this.onContextChange,this)}return e.prototype.onContextChange=function(){},e.prototype.destroy=function(){this.renderer.off("context",this.onContextChange,this),this.renderer=null},e}();i.default=n},{}],94:[function(t,e,i){i.__esModule=!0;var n,o=t("../managers/WebGLManager");var r=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.start=function(){},e.prototype.stop=function(){this.flush()},e.prototype.flush=function(){},e.prototype.render=function(t){},e}(((n=o)&&n.__esModule?n:{default:n}).default);i.default=r},{"../managers/WebGLManager":93}],95:[function(t,e,i){i.__esModule=!0;var o=n(t("pixi-gl-core")),r=n(t("../../../utils/createIndicesForQuads"));function n(t){return t&&t.__esModule?t:{default:t}}var s=function(){function n(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),this.gl=t,this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.interleaved=new Float32Array(16);for(var i=0;i<4;i++)this.interleaved[4*i]=this.vertices[2*i],this.interleaved[4*i+1]=this.vertices[2*i+1],this.interleaved[4*i+2]=this.uvs[2*i],this.interleaved[4*i+3]=this.uvs[2*i+1];this.indices=(0,r.default)(1),this.vertexBuffer=o.default.GLBuffer.createVertexBuffer(t,this.interleaved,t.STATIC_DRAW),this.indexBuffer=o.default.GLBuffer.createIndexBuffer(t,this.indices,t.STATIC_DRAW),this.vao=new o.default.VertexArrayObject(t,e)}return n.prototype.initVao=function(t){this.vao.clear().addIndex(this.indexBuffer).addAttribute(this.vertexBuffer,t.attributes.aVertexPosition,this.gl.FLOAT,!1,16,0).addAttribute(this.vertexBuffer,t.attributes.aTextureCoord,this.gl.FLOAT,!1,16,8)},n.prototype.map=function(t,e){var i=0,n=0;return this.uvs[0]=i,this.uvs[1]=n,this.uvs[2]=i+e.width/t.width,this.uvs[3]=n,this.uvs[4]=i+e.width/t.width,this.uvs[5]=n+e.height/t.height,this.uvs[6]=i,this.uvs[7]=n+e.height/t.height,i=e.x,n=e.y,this.vertices[0]=i,this.vertices[1]=n,this.vertices[2]=i+e.width,this.vertices[3]=n,this.vertices[4]=i+e.width,this.vertices[5]=n+e.height,this.vertices[6]=i,this.vertices[7]=n+e.height,this},n.prototype.upload=function(){for(var t=0;t<4;t++)this.interleaved[4*t]=this.vertices[2*t],this.interleaved[4*t+1]=this.vertices[2*t+1],this.interleaved[4*t+2]=this.uvs[2*t],this.interleaved[4*t+3]=this.uvs[2*t+1];return this.vertexBuffer.upload(this.interleaved),this},n.prototype.destroy=function(){var t=this.gl;t.deleteBuffer(this.vertexBuffer),t.deleteBuffer(this.indexBuffer)},n}();i.default=s},{"../../../utils/createIndicesForQuads":123,"pixi-gl-core":15}],96:[function(t,e,i){i.__esModule=!0;var n,a=t("../../../math"),l=t("../../../const"),o=t("../../../settings"),h=(n=o)&&n.__esModule?n:{default:n},u=t("pixi-gl-core");var r=function(){function s(t,e,i,n,o,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),this.gl=t,this.frameBuffer=null,this.texture=null,this.clearColor=[0,0,0,0],this.size=new a.Rectangle(0,0,1,1),this.resolution=o||h.default.RESOLUTION,this.projectionMatrix=new a.Matrix,this.transform=null,this.frame=null,this.defaultFrame=new a.Rectangle,this.destinationFrame=null,this.sourceFrame=null,this.stencilBuffer=null,this.stencilMaskStack=[],this.filterData=null,this.filterPoolKey="",this.scaleMode=void 0!==n?n:h.default.SCALE_MODE,this.root=r||!1,this.root?(this.frameBuffer=new u.GLFramebuffer(t,100,100),this.frameBuffer.framebuffer=null):(this.frameBuffer=u.GLFramebuffer.createRGBA(t,100,100),this.scaleMode===l.SCALE_MODES.NEAREST?this.frameBuffer.texture.enableNearestScaling():this.frameBuffer.texture.enableLinearScaling(),this.texture=this.frameBuffer.texture),this.setFrame(),this.resize(e,i)}return s.prototype.clear=function(t){var e=t||this.clearColor;this.frameBuffer.clear(e[0],e[1],e[2],e[3])},s.prototype.attachStencilBuffer=function(){this.root||this.frameBuffer.enableStencil()},s.prototype.setFrame=function(t,e){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||this.destinationFrame},s.prototype.activate=function(){var t=this.gl;this.frameBuffer.bind(),this.calculateProjection(this.destinationFrame,this.sourceFrame),this.transform&&this.projectionMatrix.append(this.transform),this.destinationFrame!==this.sourceFrame?(t.enable(t.SCISSOR_TEST),t.scissor(0|this.destinationFrame.x,0|this.destinationFrame.y,this.destinationFrame.width*this.resolution|0,this.destinationFrame.height*this.resolution|0)):t.disable(t.SCISSOR_TEST),t.viewport(0|this.destinationFrame.x,0|this.destinationFrame.y,this.destinationFrame.width*this.resolution|0,this.destinationFrame.height*this.resolution|0)},s.prototype.calculateProjection=function(t,e){var i=this.projectionMatrix;e=e||t,i.identity(),this.root?(i.a=1/t.width*2,i.d=-1/t.height*2,i.tx=-1-e.x*i.a,i.ty=1-e.y*i.d):(i.a=1/t.width*2,i.d=1/t.height*2,i.tx=-1-e.x*i.a,i.ty=-1-e.y*i.d)},s.prototype.resize=function(t,e){if(t|=0,e|=0,this.size.width!==t||this.size.height!==e){this.size.width=t,this.size.height=e,this.defaultFrame.width=t,this.defaultFrame.height=e,this.frameBuffer.resize(t*this.resolution,e*this.resolution);var i=this.frame||this.size;this.calculateProjection(i)}},s.prototype.destroy=function(){this.frameBuffer.destroy(),this.frameBuffer=null,this.texture=null},s}();i.default=r},{"../../../const":46,"../../../math":70,"../../../settings":101,"pixi-gl-core":15}],97:[function(t,e,i){i.__esModule=!0,i.default=function(t,e){var i=!e;if(0===t)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");if(i){var n=document.createElement("canvas");n.width=1,n.height=1,e=s.default.createContext(n)}var o=e.createShader(e.FRAGMENT_SHADER);for(;;){var r=a.replace(/%forloop%/gi,l(t));if(e.shaderSource(o,r),e.compileShader(o),e.getShaderParameter(o,e.COMPILE_STATUS))break;t=t/2|0}i&&e.getExtension("WEBGL_lose_context")&&e.getExtension("WEBGL_lose_context").loseContext();return t};var n,o=t("pixi-gl-core"),s=(n=o)&&n.__esModule?n:{default:n};var a=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function l(t){for(var e="",i=0;i<t;++i)0<i&&(e+="\nelse "),i<t-1&&(e+="if(test == "+i+".0){}");return e}},{"pixi-gl-core":15}],98:[function(t,e,i){i.__esModule=!0,i.default=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];return e[n.BLEND_MODES.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.BLEND_MODES.ADD]=[t.ONE,t.DST_ALPHA],e[n.BLEND_MODES.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA],e[n.BLEND_MODES.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR],e[n.BLEND_MODES.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.BLEND_MODES.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.BLEND_MODES.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.BLEND_MODES.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.BLEND_MODES.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.BLEND_MODES.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.BLEND_MODES.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.BLEND_MODES.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.BLEND_MODES.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.BLEND_MODES.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.BLEND_MODES.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.BLEND_MODES.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.BLEND_MODES.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.BLEND_MODES.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.BLEND_MODES.ADD_NPM]=[t.SRC_ALPHA,t.DST_ALPHA,t.ONE,t.DST_ALPHA],e[n.BLEND_MODES.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_COLOR],e};var n=t("../../../const")},{"../../../const":46}],99:[function(t,e,i){i.__esModule=!0,i.default=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return e[n.DRAW_MODES.POINTS]=t.POINTS,e[n.DRAW_MODES.LINES]=t.LINES,e[n.DRAW_MODES.LINE_LOOP]=t.LINE_LOOP,e[n.DRAW_MODES.LINE_STRIP]=t.LINE_STRIP,e[n.DRAW_MODES.TRIANGLES]=t.TRIANGLES,e[n.DRAW_MODES.TRIANGLE_STRIP]=t.TRIANGLE_STRIP,e[n.DRAW_MODES.TRIANGLE_FAN]=t.TRIANGLE_FAN,e};var n=t("../../../const")},{"../../../const":46}],100:[function(t,e,i){i.__esModule=!0,i.default=function(t){t.getContextAttributes().stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly")}},{}],101:[function(t,e,i){i.__esModule=!0;var n=r(t("./utils/maxRecommendedTextures")),o=r(t("./utils/canUploadSameBuffer"));function r(t){return t&&t.__esModule?t:{default:t}}i.default={TARGET_FPMS:.06,MIPMAP_TEXTURES:!0,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:(0,n.default)(32),SPRITE_BATCH_SIZE:4096,RETINA_PREFIX:/@([0-9\.]+)x/,RENDER_OPTIONS:{view:null,antialias:!1,forceFXAA:!1,autoResize:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,roundPixels:!1,width:800,height:600,legacy:!1},TRANSFORM_MODE:0,GC_MODE:0,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:0,SCALE_MODE:0,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:"mediump",CAN_UPLOAD_SAME_BUFFER:(0,o.default)(),MESH_CANVAS_PADDING:0}},{"./utils/canUploadSameBuffer":122,"./utils/maxRecommendedTextures":127}],102:[function(t,e,i){i.__esModule=!0;var o=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),r=t("../math"),s=t("../utils"),a=t("../const"),l=h(t("../textures/Texture")),n=h(t("../display/Container"));function h(t){return t&&t.__esModule?t:{default:t}}var u=new r.Point,c=function(i){function n(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n);var e=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,i.call(this));return e._anchor=new r.ObservablePoint(e._onAnchorUpdate,e,t?t.defaultAnchor.x:0,t?t.defaultAnchor.y:0),e._texture=null,e._width=0,e._height=0,e._tint=null,e._tintRGB=null,e.tint=16777215,e.blendMode=a.BLEND_MODES.NORMAL,e.shader=null,e.cachedTint=16777215,e.texture=t||l.default.EMPTY,e.vertexData=new Float32Array(8),e.vertexTrimmedData=null,e._transformID=-1,e._textureID=-1,e._transformTrimmedID=-1,e._textureTrimmedID=-1,e.pluginName="sprite",e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(n,i),n.prototype._onTextureUpdate=function(){this._textureID=-1,this._textureTrimmedID=-1,this.cachedTint=16777215,this._width&&(this.scale.x=(0,s.sign)(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=(0,s.sign)(this.scale.y)*this._height/this._texture.orig.height)},n.prototype._onAnchorUpdate=function(){this._transformID=-1,this._transformTrimmedID=-1},n.prototype.calculateVertices=function(){if(this._transformID!==this.transform._worldID||this._textureID!==this._texture._updateID){this._transformID=this.transform._worldID,this._textureID=this._texture._updateID;var t=this._texture,e=this.transform.worldTransform,i=e.a,n=e.b,o=e.c,r=e.d,s=e.tx,a=e.ty,l=this.vertexData,h=t.trim,u=t.orig,c=this._anchor,p=0,m=0,f=0,d=0;f=h?(p=(m=h.x-c._x*u.width)+h.width,(d=h.y-c._y*u.height)+h.height):(p=(m=-c._x*u.width)+u.width,(d=-c._y*u.height)+u.height),l[0]=i*m+o*d+s,l[1]=r*d+n*m+a,l[2]=i*p+o*d+s,l[3]=r*d+n*p+a,l[4]=i*p+o*f+s,l[5]=r*f+n*p+a,l[6]=i*m+o*f+s,l[7]=r*f+n*m+a}},n.prototype.calculateTrimmedVertices=function(){if(this.vertexTrimmedData){if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;var t=this._texture,e=this.vertexTrimmedData,i=t.orig,n=this._anchor,o=this.transform.worldTransform,r=o.a,s=o.b,a=o.c,l=o.d,h=o.tx,u=o.ty,c=-n._x*i.width,p=c+i.width,m=-n._y*i.height,f=m+i.height;e[0]=r*c+a*m+h,e[1]=l*m+s*c+u,e[2]=r*p+a*m+h,e[3]=l*m+s*p+u,e[4]=r*p+a*f+h,e[5]=l*f+s*p+u,e[6]=r*c+a*f+h,e[7]=l*f+s*c+u},n.prototype._renderWebGL=function(t){this.calculateVertices(),t.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)},n.prototype._renderCanvas=function(t){t.plugins[this.pluginName].render(this)},n.prototype._calculateBounds=function(){var t=this._texture.trim,e=this._texture.orig;!t||t.width===e.width&&t.height===e.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))},n.prototype.getLocalBounds=function(t){return 0===this.children.length?(this._bounds.minX=this._texture.orig.width*-this._anchor._x,this._bounds.minY=this._texture.orig.height*-this._anchor._y,this._bounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._bounds.maxY=this._texture.orig.height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new r.Rectangle),t=this._localBoundsRect),this._bounds.getRectangle(t)):i.prototype.getLocalBounds.call(this,t)},n.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,u);var e=this._texture.orig.width,i=this._texture.orig.height,n=-e*this.anchor.x,o=0;return u.x>=n&&u.x<n+e&&(o=-i*this.anchor.y,u.y>=o&&u.y<o+i)},n.prototype.destroy=function(t){if(i.prototype.destroy.call(this,t),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,"boolean"==typeof t?t:t&&t.texture){var e="boolean"==typeof t?t:t&&t.baseTexture;this._texture.destroy(!!e)}this._texture=null,this.shader=null},n.from=function(t){return new n(l.default.from(t))},n.fromFrame=function(t){var e=s.TextureCache[t];if(!e)throw new Error('The frameId "'+t+'" does not exist in the texture cache');return new n(e)},n.fromImage=function(t,e,i){return new n(l.default.fromImage(t,e,i))},o(n,[{key:"width",get:function(){return Math.abs(this.scale.x)*this._texture.orig.width},set:function(t){var e=(0,s.sign)(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t}},{key:"height",get:function(){return Math.abs(this.scale.y)*this._texture.orig.height},set:function(t){var e=(0,s.sign)(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t}},{key:"anchor",get:function(){return this._anchor},set:function(t){this._anchor.copy(t)}},{key:"tint",get:function(){return this._tint},set:function(t){this._tint=t,this._tintRGB=(t>>16)+(65280&t)+((255&t)<<16)}},{key:"texture",get:function(){return this._texture},set:function(t){this._texture!==t&&(this._texture=t||l.default.EMPTY,this.cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.hasLoaded?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))}}]),n}(n.default);i.default=c},{"../const":46,"../display/Container":48,"../math":70,"../textures/Texture":115,"../utils":125}],103:[function(t,e,i){i.__esModule=!0;var n=o(t("../../renderers/canvas/CanvasRenderer")),u=t("../../const"),c=t("../../math"),p=o(t("./CanvasTinter"));function o(t){return t&&t.__esModule?t:{default:t}}var m=new c.Matrix,r=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.renderer=t}return e.prototype.render=function(t){var e=t._texture,i=this.renderer,n=e._frame.width,o=e._frame.height,r=t.transform.worldTransform,s=0,a=0;if(!(e.orig.width<=0||e.orig.height<=0)&&e.baseTexture.source&&(i.setBlendMode(t.blendMode),e.valid)){i.context.globalAlpha=t.worldAlpha;var l=e.baseTexture.scaleMode===u.SCALE_MODES.LINEAR;i.smoothProperty&&i.context[i.smoothProperty]!==l&&(i.context[i.smoothProperty]=l),a=e.trim?(s=e.trim.width/2+e.trim.x-t.anchor.x*e.orig.width,e.trim.height/2+e.trim.y-t.anchor.y*e.orig.height):(s=(.5-t.anchor.x)*e.orig.width,(.5-t.anchor.y)*e.orig.height),e.rotate&&(r.copy(m),r=m,c.GroupD8.matrixAppendRotationInv(r,e.rotate,s,a),a=s=0),s-=n/2,a-=o/2,i.roundPixels?(i.context.setTransform(r.a,r.b,r.c,r.d,r.tx*i.resolution|0,r.ty*i.resolution|0),s|=0,a|=0):i.context.setTransform(r.a,r.b,r.c,r.d,r.tx*i.resolution,r.ty*i.resolution);var h=e.baseTexture.resolution;16777215!==t.tint?(t.cachedTint===t.tint&&t.tintedTexture.tintId===t._texture._updateID||(t.cachedTint=t.tint,t.tintedTexture=p.default.getTintedTexture(t,t.tint)),i.context.drawImage(t.tintedTexture,0,0,n*h,o*h,s*i.resolution,a*i.resolution,n*i.resolution,o*i.resolution)):i.context.drawImage(e.baseTexture.source,e._frame.x*h,e._frame.y*h,n*h,o*h,s*i.resolution,a*i.resolution,n*i.resolution,o*i.resolution)}},e.prototype.destroy=function(){this.renderer=null},e}();i.default=r,n.default.registerPlugin("sprite",r)},{"../../const":46,"../../math":70,"../../renderers/canvas/CanvasRenderer":77,"./CanvasTinter":104}],104:[function(t,e,i){i.__esModule=!0;var n,m=t("../../utils"),o=t("../../renderers/canvas/utils/canUseNewCanvasBlendModes");var a={getTintedTexture:function(t,e){var i=t._texture,n="#"+("00000"+(0|(e=a.roundColor(e))).toString(16)).substr(-6);i.tintCache=i.tintCache||{};var o=i.tintCache[n],r=void 0;if(o){if(o.tintId===i._updateID)return i.tintCache[n];r=i.tintCache[n]}else r=a.canvas||document.createElement("canvas");if(a.tintMethod(i,e,r),r.tintId=i._updateID,a.convertTintToImage){var s=new Image;s.src=r.toDataURL(),i.tintCache[n]=s}else i.tintCache[n]=r,a.canvas=null;return r},tintWithMultiply:function(t,e,i){var n=i.getContext("2d"),o=t._frame.clone(),r=t.baseTexture.resolution;o.x*=r,o.y*=r,o.width*=r,o.height*=r,i.width=Math.ceil(o.width),i.height=Math.ceil(o.height),n.save(),n.fillStyle="#"+("00000"+(0|e).toString(16)).substr(-6),n.fillRect(0,0,o.width,o.height),n.globalCompositeOperation="multiply",n.drawImage(t.baseTexture.source,o.x,o.y,o.width,o.height,0,0,o.width,o.height),n.globalCompositeOperation="destination-atop",n.drawImage(t.baseTexture.source,o.x,o.y,o.width,o.height,0,0,o.width,o.height),n.restore()},tintWithOverlay:function(t,e,i){var n=i.getContext("2d"),o=t._frame.clone(),r=t.baseTexture.resolution;o.x*=r,o.y*=r,o.width*=r,o.height*=r,i.width=Math.ceil(o.width),i.height=Math.ceil(o.height),n.save(),n.globalCompositeOperation="copy",n.fillStyle="#"+("00000"+(0|e).toString(16)).substr(-6),n.fillRect(0,0,o.width,o.height),n.globalCompositeOperation="destination-atop",n.drawImage(t.baseTexture.source,o.x,o.y,o.width,o.height,0,0,o.width,o.height),n.restore()},tintWithPerPixel:function(t,e,i){var n=i.getContext("2d"),o=t._frame.clone(),r=t.baseTexture.resolution;o.x*=r,o.y*=r,o.width*=r,o.height*=r,i.width=Math.ceil(o.width),i.height=Math.ceil(o.height),n.save(),n.globalCompositeOperation="copy",n.drawImage(t.baseTexture.source,o.x,o.y,o.width,o.height,0,0,o.width,o.height),n.restore();for(var s=(0,m.hex2rgb)(e),a=s[0],l=s[1],h=s[2],u=n.getImageData(0,0,o.width,o.height),c=u.data,p=0;p<c.length;p+=4)c[p+0]*=a,c[p+1]*=l,c[p+2]*=h;n.putImageData(u,0,0)},roundColor:function(t){var e=a.cacheStepsPerColorChannel,i=(0,m.hex2rgb)(t);return i[0]=Math.min(255,i[0]/e*e),i[1]=Math.min(255,i[1]/e*e),i[2]=Math.min(255,i[2]/e*e),(0,m.rgb2hex)(i)},cacheStepsPerColorChannel:8,convertTintToImage:!1,canUseMultiply:(0,((n=o)&&n.__esModule?n:{default:n}).default)(),tintMethod:0};a.tintMethod=a.canUseMultiply?a.tintWithMultiply:a.tintWithPerPixel,i.default=a},{"../../renderers/canvas/utils/canUseNewCanvasBlendModes":80,"../../utils":125}],105:[function(t,e,i){i.__esModule=!0;var n=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.vertices=new ArrayBuffer(t),this.float32View=new Float32Array(this.vertices),this.uint32View=new Uint32Array(this.vertices)}return e.prototype.destroy=function(){this.vertices=null,this.positions=null,this.uvs=null,this.colors=null},e}();i.default=n},{}],106:[function(t,e,i){i.__esModule=!0;var n=r(t("../../renderers/webgl/utils/ObjectRenderer")),o=r(t("../../renderers/webgl/WebGLRenderer")),s=r(t("../../utils/createIndicesForQuads")),a=r(t("./generateMultiTextureShader")),l=r(t("../../renderers/webgl/utils/checkMaxIfStatmentsInShader")),h=r(t("./BatchBuffer")),V=r(t("../../settings")),N=t("../../utils"),k=r(t("pixi-gl-core")),G=r(t("bit-twiddle"));function r(t){return t&&t.__esModule?t:{default:t}}var j=0,U=0,u=function(o){function r(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r);var e=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,o.call(this,t));e.vertSize=5,e.vertByteSize=4*e.vertSize,e.size=V.default.SPRITE_BATCH_SIZE,e.buffers=[];for(var i=1;i<=G.default.nextPow2(e.size);i*=2)e.buffers.push(new h.default(4*i*e.vertByteSize));e.indices=(0,s.default)(e.size),e.shader=null,e.currentIndex=0,e.groups=[];for(var n=0;n<e.size;n++)e.groups[n]={textures:[],textureCount:0,ids:[],size:0,start:0,blend:0};return e.sprites=[],e.vertexBuffers=[],e.vaos=[],e.vaoMax=2,e.vertexCount=0,e.renderer.on("prerender",e.onPrerender,e),e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(r,o),r.prototype.onContextChange=function(){var t=this.renderer.gl;this.renderer.legacy?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),V.default.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=(0,l.default)(this.MAX_TEXTURES,t)),this.shader=(0,a.default)(t,this.MAX_TEXTURES),this.indexBuffer=k.default.GLBuffer.createIndexBuffer(t,this.indices,t.STATIC_DRAW),this.renderer.bindVao(null);for(var e=this.shader.attributes,i=0;i<this.vaoMax;i++){var n=this.vertexBuffers[i]=k.default.GLBuffer.createVertexBuffer(t,null,t.STREAM_DRAW),o=this.renderer.createVao().addIndex(this.indexBuffer).addAttribute(n,e.aVertexPosition,t.FLOAT,!1,this.vertByteSize,0).addAttribute(n,e.aTextureCoord,t.UNSIGNED_SHORT,!0,this.vertByteSize,8).addAttribute(n,e.aColor,t.UNSIGNED_BYTE,!0,this.vertByteSize,12);e.aTextureId&&o.addAttribute(n,e.aTextureId,t.FLOAT,!1,this.vertByteSize,16),this.vaos[i]=o}this.vao=this.vaos[0],this.currentBlendMode=99999,this.boundTextures=new Array(this.MAX_TEXTURES)},r.prototype.onPrerender=function(){this.vertexCount=0},r.prototype.render=function(t){this.currentIndex>=this.size&&this.flush(),t._texture._uvs&&(this.sprites[this.currentIndex++]=t)},r.prototype.flush=function(){if(0!==this.currentIndex){var t=this.renderer.gl,e=this.MAX_TEXTURES,i=G.default.nextPow2(this.currentIndex),n=G.default.log2(i),o=this.buffers[n],r=this.sprites,s=this.groups,a=o.float32View,l=o.uint32View,h=this.boundTextures,u=this.renderer.boundTextures,c=this.renderer.textureGC.count,p=0,m=void 0,f=void 0,d=1,_=0,y=s[0],x=void 0,v=void 0,b=N.premultiplyBlendMode[r[0]._texture.baseTexture.premultipliedAlpha?1:0][r[0].blendMode];y.textureCount=0,y.start=0,y.blend=b,j++;var g=void 0;for(g=0;g<e;++g){var w=u[g];w._enabled!==j?((h[g]=w)._virtalBoundId=g,w._enabled=j):h[g]=this.renderer.emptyTextures[g]}for(j++,g=0;g<this.currentIndex;++g){var C=r[g];r[g]=null,m=C._texture.baseTexture;var D=N.premultiplyBlendMode[Number(m.premultipliedAlpha)][C.blendMode];if(b!==D&&(b=D,f=null,_=e,j++),f!==m&&(f=m)._enabled!==j){if(_===e&&(j++,y.size=g-y.start,_=0,(y=s[d++]).blend=b,y.textureCount=0,y.start=g),m.touched=c,-1===m._virtalBoundId)for(var S=0;S<e;++S){var T=(S+U)%e,A=h[T];if(A._enabled!==j){U++,A._virtalBoundId=-1,h[m._virtalBoundId=T]=m;break}}m._enabled=j,y.textureCount++,y.ids[_]=m._virtalBoundId,y.textures[_++]=m}if(x=C.vertexData,v=C._texture._uvs.uvsUint32,this.renderer.roundPixels){var M=this.renderer.resolution;a[p]=(x[0]*M|0)/M,a[p+1]=(x[1]*M|0)/M,a[p+5]=(x[2]*M|0)/M,a[p+6]=(x[3]*M|0)/M,a[p+10]=(x[4]*M|0)/M,a[p+11]=(x[5]*M|0)/M,a[p+15]=(x[6]*M|0)/M,a[p+16]=(x[7]*M|0)/M}else a[p]=x[0],a[p+1]=x[1],a[p+5]=x[2],a[p+6]=x[3],a[p+10]=x[4],a[p+11]=x[5],a[p+15]=x[6],a[p+16]=x[7];l[p+2]=v[0],l[p+7]=v[1],l[p+12]=v[2],l[p+17]=v[3];var B=Math.min(C.worldAlpha,1),E=B<1&&m.premultipliedAlpha?(0,N.premultiplyTint)(C._tintRGB,B):C._tintRGB+(255*B<<24);l[p+3]=l[p+8]=l[p+13]=l[p+18]=E,a[p+4]=a[p+9]=a[p+14]=a[p+19]=m._virtalBoundId,p+=20}if(y.size=g-y.start,V.default.CAN_UPLOAD_SAME_BUFFER)this.vertexBuffers[this.vertexCount].upload(o.vertices,0,!0);else{if(this.vaoMax<=this.vertexCount){this.vaoMax++;var P=this.shader.attributes,I=this.vertexBuffers[this.vertexCount]=k.default.GLBuffer.createVertexBuffer(t,null,t.STREAM_DRAW),R=this.renderer.createVao().addIndex(this.indexBuffer).addAttribute(I,P.aVertexPosition,t.FLOAT,!1,this.vertByteSize,0).addAttribute(I,P.aTextureCoord,t.UNSIGNED_SHORT,!0,this.vertByteSize,8).addAttribute(I,P.aColor,t.UNSIGNED_BYTE,!0,this.vertByteSize,12);P.aTextureId&&R.addAttribute(I,P.aTextureId,t.FLOAT,!1,this.vertByteSize,16),this.vaos[this.vertexCount]=R}this.renderer.bindVao(this.vaos[this.vertexCount]),this.vertexBuffers[this.vertexCount].upload(o.vertices,0,!1),this.vertexCount++}for(g=0;g<e;++g)u[g]._virtalBoundId=-1;for(g=0;g<d;++g){for(var O=s[g],L=O.textureCount,F=0;F<L;F++)f=O.textures[F],u[O.ids[F]]!==f&&this.renderer.bindTexture(f,O.ids[F],!0),f._virtalBoundId=-1;this.renderer.state.setBlendMode(O.blend),t.drawElements(t.TRIANGLES,6*O.size,t.UNSIGNED_SHORT,6*O.start*2)}this.currentIndex=0}},r.prototype.start=function(){this.renderer.bindShader(this.shader),V.default.CAN_UPLOAD_SAME_BUFFER&&(this.renderer.bindVao(this.vaos[this.vertexCount]),this.vertexBuffers[this.vertexCount].bind())},r.prototype.stop=function(){this.flush()},r.prototype.destroy=function(){for(var t=0;t<this.vaoMax;t++)this.vertexBuffers[t]&&this.vertexBuffers[t].destroy(),this.vaos[t]&&this.vaos[t].destroy();this.indexBuffer&&this.indexBuffer.destroy(),this.renderer.off("prerender",this.onPrerender,this),o.prototype.destroy.call(this),this.shader&&(this.shader.destroy(),this.shader=null),this.vertexBuffers=null,this.vaos=null,this.indexBuffer=null,this.indices=null,this.sprites=null;for(var e=0;e<this.buffers.length;++e)this.buffers[e].destroy()},r}(n.default);i.default=u,o.default.registerPlugin("sprite",u)},{"../../renderers/webgl/WebGLRenderer":84,"../../renderers/webgl/utils/ObjectRenderer":94,"../../renderers/webgl/utils/checkMaxIfStatmentsInShader":97,"../../settings":101,"../../utils":125,"../../utils/createIndicesForQuads":123,"./BatchBuffer":105,"./generateMultiTextureShader":107,"bit-twiddle":1,"pixi-gl-core":15}],107:[function(t,e,i){i.__esModule=!0,i.default=function(t,e){var i=a;i=(i=i.replace(/%count%/gi,e)).replace(/%forloop%/gi,function(t){var e="";e+="\n",e+="\n";for(var i=0;i<t;i++)0<i&&(e+="\nelse "),i<t-1&&(e+="if(textureId == "+i+".0)"),e+="\n{",e+="\n\tcolor = texture2D(uSamplers["+i+"], vTextureCoord);",e+="\n}";return e+="\n",e+="\n"}(e));for(var n=new s.default(t,"precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor;\n}\n",i),o=[],r=0;r<e;r++)o[r]=r;return n.bind(),n.uniforms.uSamplers=o,n};var n,o=t("../../Shader"),s=(n=o)&&n.__esModule?n:{default:n};t("path");var a=["varying vec2 vTextureCoord;","varying vec4 vColor;","varying float vTextureId;","uniform sampler2D uSamplers[%count%];","void main(void){","vec4 color;","float textureId = floor(vTextureId+0.5);","%forloop%","gl_FragColor = color * vColor;","}"].join("\n")},{"../../Shader":44,path:8}],108:[function(t,e,i){i.__esModule=!0;var n=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),o=r(t("../sprites/Sprite")),a=r(t("../textures/Texture")),l=t("../math"),h=t("../utils"),d=t("../const"),u=r(t("../settings")),c=r(t("./TextStyle")),y=r(t("./TextMetrics")),p=r(t("../utils/trimCanvas"));function r(t){return t&&t.__esModule?t:{default:t}}var m={texture:!0,children:!1,baseTexture:!0},s=function(r){function s(t,e,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),(i=i||document.createElement("canvas")).width=3,i.height=3;var n=a.default.fromCanvas(i,u.default.SCALE_MODE,"text");n.orig=new l.Rectangle,n.trim=new l.Rectangle;var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,r.call(this,n));return a.default.addToCache(o._texture,o._texture.baseTexture.textureCacheIds[0]),o.canvas=i,o.context=o.canvas.getContext("2d"),o.resolution=u.default.RESOLUTION,o._text=null,o._style=null,o._styleListener=null,o._font="",o.text=t,o.style=e,o.localStyleID=-1,o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(s,r),s.prototype.updateText=function(t){var e=this._style;if(this.localStyleID!==e.styleID&&(this.dirty=!0,this.localStyleID=e.styleID),this.dirty||!t){this._font=this._style.toFontString();var i=this.context,n=y.default.measureText(this._text,this._style,this._style.wordWrap,this.canvas),o=n.width,r=n.height,s=n.lines,a=n.lineHeight,l=n.lineWidths,h=n.maxLineWidth,u=n.fontProperties;this.canvas.width=Math.ceil((Math.max(1,o)+2*e.padding)*this.resolution),this.canvas.height=Math.ceil((Math.max(1,r)+2*e.padding)*this.resolution),i.scale(this.resolution,this.resolution),i.clearRect(0,0,this.canvas.width,this.canvas.height),i.font=this._font,i.strokeStyle=e.stroke,i.lineWidth=e.strokeThickness,i.textBaseline=e.textBaseline,i.lineJoin=e.lineJoin,i.miterLimit=e.miterLimit;var c=void 0,p=void 0;if(e.dropShadow){i.fillStyle=e.dropShadowColor,i.globalAlpha=e.dropShadowAlpha,i.shadowBlur=e.dropShadowBlur,0<e.dropShadowBlur&&(i.shadowColor=e.dropShadowColor);for(var m=Math.cos(e.dropShadowAngle)*e.dropShadowDistance,f=Math.sin(e.dropShadowAngle)*e.dropShadowDistance,d=0;d<s.length;d++)c=e.strokeThickness/2,p=e.strokeThickness/2+d*a+u.ascent,"right"===e.align?c+=h-l[d]:"center"===e.align&&(c+=(h-l[d])/2),e.fill&&(this.drawLetterSpacing(s[d],c+m+e.padding,p+f+e.padding),e.stroke&&e.strokeThickness&&(i.strokeStyle=e.dropShadowColor,this.drawLetterSpacing(s[d],c+m+e.padding,p+f+e.padding,!0),i.strokeStyle=e.stroke))}i.shadowBlur=0,i.globalAlpha=1,i.fillStyle=this._generateFillStyle(e,s);for(var _=0;_<s.length;_++)c=e.strokeThickness/2,p=e.strokeThickness/2+_*a+u.ascent,"right"===e.align?c+=h-l[_]:"center"===e.align&&(c+=(h-l[_])/2),e.stroke&&e.strokeThickness&&this.drawLetterSpacing(s[_],c+e.padding,p+e.padding,!0),e.fill&&this.drawLetterSpacing(s[_],c+e.padding,p+e.padding);this.updateTexture()}},s.prototype.drawLetterSpacing=function(t,e,i){var n=3<arguments.length&&void 0!==arguments[3]&&arguments[3],o=this._style.letterSpacing;if(0!==o)for(var r=String.prototype.split.call(t,""),s=e,a=0,l="";a<t.length;)l=r[a++],n?this.context.strokeText(l,s,i):this.context.fillText(l,s,i),s+=this.context.measureText(l).width+o;else n?this.context.strokeText(t,e,i):this.context.fillText(t,e,i)},s.prototype.updateTexture=function(){var t=this.canvas;if(this._style.trim){var e=(0,p.default)(t);e.data&&(t.width=e.width,t.height=e.height,this.context.putImageData(e.data,0,0))}var i=this._texture,n=this._style,o=n.trim?0:n.padding,r=i.baseTexture;r.hasLoaded=!0,r.resolution=this.resolution,r.realWidth=t.width,r.realHeight=t.height,r.width=t.width/this.resolution,r.height=t.height/this.resolution,i.trim.width=i._frame.width=t.width/this.resolution,i.trim.height=i._frame.height=t.height/this.resolution,i.trim.x=-o,i.trim.y=-o,i.orig.width=i._frame.width-2*o,i.orig.height=i._frame.height-2*o,this._onTextureUpdate(),r.emit("update",r),this.dirty=!1},s.prototype.renderWebGL=function(t){this.resolution!==t.resolution&&(this.resolution=t.resolution,this.dirty=!0),this.updateText(!0),r.prototype.renderWebGL.call(this,t)},s.prototype._renderCanvas=function(t){this.resolution!==t.resolution&&(this.resolution=t.resolution,this.dirty=!0),this.updateText(!0),r.prototype._renderCanvas.call(this,t)},s.prototype.getLocalBounds=function(t){return this.updateText(!0),r.prototype.getLocalBounds.call(this,t)},s.prototype._calculateBounds=function(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)},s.prototype._onStyleChange=function(){this.dirty=!0},s.prototype._generateFillStyle=function(t,e){if(!Array.isArray(t.fill))return t.fill;if(navigator.isCocoonJS)return t.fill[0];var i=void 0,n=void 0,o=void 0,r=void 0,s=this.canvas.width/this.resolution,a=this.canvas.height/this.resolution,l=t.fill.slice(),h=t.fillGradientStops.slice();if(!h.length)for(var u=l.length+1,c=1;c<u;++c)h.push(c/u);if(l.unshift(t.fill[0]),h.unshift(0),l.push(t.fill[t.fill.length-1]),h.push(1),t.fillGradientType===d.TEXT_GRADIENT.LINEAR_VERTICAL){i=this.context.createLinearGradient(s/2,0,s/2,a),n=(l.length+1)*e.length;for(var p=o=0;p<e.length;p++){o+=1;for(var m=0;m<l.length;m++)r="number"==typeof h[m]?h[m]/e.length+p/e.length:o/n,i.addColorStop(r,l[m]),o++}}else{i=this.context.createLinearGradient(0,a/2,s,a/2),n=l.length+1,o=1;for(var f=0;f<l.length;f++)r="number"==typeof h[f]?h[f]:o/n,i.addColorStop(r,l[f]),o++}return i},s.prototype.destroy=function(t){"boolean"==typeof t&&(t={children:t}),t=Object.assign({},m,t),r.prototype.destroy.call(this,t),this.context=null,this.canvas=null,this._style=null},n(s,[{key:"width",get:function(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width},set:function(t){this.updateText(!0);var e=(0,h.sign)(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t}},{key:"height",get:function(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height},set:function(t){this.updateText(!0);var e=(0,h.sign)(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t}},{key:"style",get:function(){return this._style},set:function(t){(t=t||{})instanceof c.default?this._style=t:this._style=new c.default(t),this.localStyleID=-1,this.dirty=!0}},{key:"text",get:function(){return this._text},set:function(t){t=String(""===t||null==t?" ":t),this._text!==t&&(this._text=t,this.dirty=!0)}}]),s}(o.default);i.default=s},{"../const":46,"../math":70,"../settings":101,"../sprites/Sprite":102,"../textures/Texture":115,"../utils":125,"../utils/trimCanvas":130,"./TextMetrics":109,"./TextStyle":110}],109:[function(t,e,i){i.__esModule=!0;var n=function(){function A(t,e,i,n,o,r,s,a,l){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,A),this.text=t,this.style=e,this.width=i,this.height=n,this.lines=o,this.lineWidths=r,this.lineHeight=s,this.maxLineWidth=a,this.fontProperties=l}return A.measureText=function(t,e,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:A._canvas;i=null==i?e.wordWrap:i;var o=e.toFontString(),r=A.measureFont(o),s=n.getContext("2d");s.font=o;for(var a=(i?A.wordWrap(t,e,n):t).split(/(?:\r\n|\r|\n)/),l=new Array(a.length),h=0,u=0;u<a.length;u++){var c=s.measureText(a[u]).width+(a[u].length-1)*e.letterSpacing;l[u]=c,h=Math.max(h,c)}var p=h+e.strokeThickness;e.dropShadow&&(p+=e.dropShadowDistance);var m=e.lineHeight||r.fontSize+e.strokeThickness,f=Math.max(m,r.fontSize+e.strokeThickness)+(a.length-1)*(m+e.leading);return e.dropShadow&&(f+=e.dropShadowDistance),new A(t,e,p,f,a,l,m+e.leading,h,r)},A.wordWrap=function(t,e){for(var i=(2<arguments.length&&void 0!==arguments[2]?arguments[2]:A._canvas).getContext("2d"),n=0,o="",r="",s={},a=e.letterSpacing,l=e.whiteSpace,h=A.collapseSpaces(l),u=A.collapseNewlines(l),c=!h,p=e.wordWrapWidth+a,m=A.tokenize(t),f=0;f<m.length;f++){var d=m[f];if(A.isNewline(d)){if(!u){r+=A.addLine(o),c=!h,o="",n=0;continue}d=" "}if(h){var _=A.isBreakingSpace(d),y=A.isBreakingSpace(o[o.length-1]);if(_&&y)continue}var x=A.getFromCache(d,a,s,i);if(p<x)if(""!==o&&(r+=A.addLine(o),o="",n=0),A.canBreakWords(d,e.breakWords))for(var v=d.split(""),b=0;b<v.length;b++){for(var g=v[b],w=1;v[b+w];){var C=v[b+w],D=g[g.length-1];if(A.canBreakChars(D,C,d,b,e.breakWords))break;g+=C,w++}b+=g.length-1;var S=A.getFromCache(g,a,s,i);p<S+n&&(r+=A.addLine(o),c=!1,o="",n=0),o+=g,n+=S}else{0<o.length&&(r+=A.addLine(o),o="",n=0);var T=f===m.length-1;r+=A.addLine(d,!T),c=!1,o="",n=0}else p<x+n&&(c=!1,r+=A.addLine(o),o="",n=0),(0<o.length||!A.isBreakingSpace(d)||c)&&(o+=d,n+=x)}return r+=A.addLine(o,!1)},A.addLine=function(t){var e=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];return t=A.trimRight(t),t=e?t+"\n":t},A.getFromCache=function(t,e,i,n){var o=i[t];if(void 0===o){var r=t.length*e;o=n.measureText(t).width+r,i[t]=o}return o},A.collapseSpaces=function(t){return"normal"===t||"pre-line"===t},A.collapseNewlines=function(t){return"normal"===t},A.trimRight=function(t){if("string"!=typeof t)return"";for(var e=t.length-1;0<=e;e--){var i=t[e];if(!A.isBreakingSpace(i))break;t=t.slice(0,-1)}return t},A.isNewline=function(t){return"string"==typeof t&&0<=A._newlines.indexOf(t.charCodeAt(0))},A.isBreakingSpace=function(t){return"string"==typeof t&&0<=A._breakingSpaces.indexOf(t.charCodeAt(0))},A.tokenize=function(t){var e=[],i="";if("string"!=typeof t)return e;for(var n=0;n<t.length;n++){var o=t[n];A.isBreakingSpace(o)||A.isNewline(o)?(""!==i&&(e.push(i),i=""),e.push(o)):i+=o}return""!==i&&e.push(i),e},A.canBreakWords=function(t,e){return e},A.canBreakChars=function(t,e,i,n,o){return!0},A.measureFont=function(t){if(A._fonts[t])return A._fonts[t];var e={},i=A._canvas,n=A._context;n.font=t;var o=A.METRICS_STRING+A.BASELINE_SYMBOL,r=Math.ceil(n.measureText(o).width),s=Math.ceil(n.measureText(A.BASELINE_SYMBOL).width),a=2*s;s=s*A.BASELINE_MULTIPLIER|0,i.width=r,i.height=a,n.fillStyle="#f00",n.fillRect(0,0,r,a),n.font=t,n.textBaseline="alphabetic",n.fillStyle="#000",n.fillText(o,0,s);var l=n.getImageData(0,0,r,a).data,h=l.length,u=4*r,c=0,p=0,m=!1;for(c=0;c<s;++c){for(var f=0;f<u;f+=4)if(255!==l[p+f]){m=!0;break}if(m)break;p+=u}for(e.ascent=s-c,p=h-u,m=!1,c=a;s<c;--c){for(var d=0;d<u;d+=4)if(255!==l[p+d]){m=!0;break}if(m)break;p-=u}return e.descent=c-s,e.fontSize=e.ascent+e.descent,A._fonts[t]=e},A.clearMetrics=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";t?delete A._fonts[t]:A._fonts={}},A}();i.default=n;var o=document.createElement("canvas");o.width=o.height=10,n._canvas=o,n._context=o.getContext("2d"),n._fonts={},n.METRICS_STRING="|q",n.BASELINE_SYMBOL="M",n.BASELINE_MULTIPLIER=1.4,n._newlines=[10,13],n._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288]},{}],110:[function(t,e,i){i.__esModule=!0;var n=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),o=t("../const"),r=t("../utils");var s={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:o.TEXT_GRADIENT.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100,leading:0},a=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],l=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.styleID=0,this.reset(),c(this,t,t)}return e.prototype.clone=function(){var t={};return c(t,this,s),new e(t)},e.prototype.reset=function(){c(this,s,s)},e.prototype.toFontString=function(){var t="number"==typeof this.fontSize?this.fontSize+"px":this.fontSize,e=this.fontFamily;Array.isArray(this.fontFamily)||(e=this.fontFamily.split(","));for(var i=e.length-1;0<=i;i--){var n=e[i].trim();!/([\"\'])[^\'\"]+\1/.test(n)&&a.indexOf(n)<0&&(n='"'+n+'"'),e[i]=n}return this.fontStyle+" "+this.fontVariant+" "+this.fontWeight+" "+t+" "+e.join(",")},n(e,[{key:"align",get:function(){return this._align},set:function(t){this._align!==t&&(this._align=t,this.styleID++)}},{key:"breakWords",get:function(){return this._breakWords},set:function(t){this._breakWords!==t&&(this._breakWords=t,this.styleID++)}},{key:"dropShadow",get:function(){return this._dropShadow},set:function(t){this._dropShadow!==t&&(this._dropShadow=t,this.styleID++)}},{key:"dropShadowAlpha",get:function(){return this._dropShadowAlpha},set:function(t){this._dropShadowAlpha!==t&&(this._dropShadowAlpha=t,this.styleID++)}},{key:"dropShadowAngle",get:function(){return this._dropShadowAngle},set:function(t){this._dropShadowAngle!==t&&(this._dropShadowAngle=t,this.styleID++)}},{key:"dropShadowBlur",get:function(){return this._dropShadowBlur},set:function(t){this._dropShadowBlur!==t&&(this._dropShadowBlur=t,this.styleID++)}},{key:"dropShadowColor",get:function(){return this._dropShadowColor},set:function(t){var e=u(t);this._dropShadowColor!==e&&(this._dropShadowColor=e,this.styleID++)}},{key:"dropShadowDistance",get:function(){return this._dropShadowDistance},set:function(t){this._dropShadowDistance!==t&&(this._dropShadowDistance=t,this.styleID++)}},{key:"fill",get:function(){return this._fill},set:function(t){var e=u(t);this._fill!==e&&(this._fill=e,this.styleID++)}},{key:"fillGradientType",get:function(){return this._fillGradientType},set:function(t){this._fillGradientType!==t&&(this._fillGradientType=t,this.styleID++)}},{key:"fillGradientStops",get:function(){return this._fillGradientStops},set:function(t){(function(t,e){if(!Array.isArray(t)||!Array.isArray(e))return!1;if(t.length!==e.length)return!1;for(var i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0})(this._fillGradientStops,t)||(this._fillGradientStops=t,this.styleID++)}},{key:"fontFamily",get:function(){return this._fontFamily},set:function(t){this.fontFamily!==t&&(this._fontFamily=t,this.styleID++)}},{key:"fontSize",get:function(){return this._fontSize},set:function(t){this._fontSize!==t&&(this._fontSize=t,this.styleID++)}},{key:"fontStyle",get:function(){return this._fontStyle},set:function(t){this._fontStyle!==t&&(this._fontStyle=t,this.styleID++)}},{key:"fontVariant",get:function(){return this._fontVariant},set:function(t){this._fontVariant!==t&&(this._fontVariant=t,this.styleID++)}},{key:"fontWeight",get:function(){return this._fontWeight},set:function(t){this._fontWeight!==t&&(this._fontWeight=t,this.styleID++)}},{key:"letterSpacing",get:function(){return this._letterSpacing},set:function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.styleID++)}},{key:"lineHeight",get:function(){return this._lineHeight},set:function(t){this._lineHeight!==t&&(this._lineHeight=t,this.styleID++)}},{key:"leading",get:function(){return this._leading},set:function(t){this._leading!==t&&(this._leading=t,this.styleID++)}},{key:"lineJoin",get:function(){return this._lineJoin},set:function(t){this._lineJoin!==t&&(this._lineJoin=t,this.styleID++)}},{key:"miterLimit",get:function(){return this._miterLimit},set:function(t){this._miterLimit!==t&&(this._miterLimit=t,this.styleID++)}},{key:"padding",get:function(){return this._padding},set:function(t){this._padding!==t&&(this._padding=t,this.styleID++)}},{key:"stroke",get:function(){return this._stroke},set:function(t){var e=u(t);this._stroke!==e&&(this._stroke=e,this.styleID++)}},{key:"strokeThickness",get:function(){return this._strokeThickness},set:function(t){this._strokeThickness!==t&&(this._strokeThickness=t,this.styleID++)}},{key:"textBaseline",get:function(){return this._textBaseline},set:function(t){this._textBaseline!==t&&(this._textBaseline=t,this.styleID++)}},{key:"trim",get:function(){return this._trim},set:function(t){this._trim!==t&&(this._trim=t,this.styleID++)}},{key:"whiteSpace",get:function(){return this._whiteSpace},set:function(t){this._whiteSpace!==t&&(this._whiteSpace=t,this.styleID++)}},{key:"wordWrap",get:function(){return this._wordWrap},set:function(t){this._wordWrap!==t&&(this._wordWrap=t,this.styleID++)}},{key:"wordWrapWidth",get:function(){return this._wordWrapWidth},set:function(t){this._wordWrapWidth!==t&&(this._wordWrapWidth=t,this.styleID++)}}]),e}();function h(t){return"number"==typeof t?(0,r.hex2string)(t):("string"==typeof t&&0===t.indexOf("0x")&&(t=t.replace("0x","#")),t)}function u(t){if(Array.isArray(t)){for(var e=0;e<t.length;++e)t[e]=h(t[e]);return t}return h(t)}function c(t,e,i){for(var n in i)Array.isArray(e[n])?t[n]=e[n].slice():t[n]=e[n]}i.default=l},{"../const":46,"../utils":125}],111:[function(t,e,i){i.__esModule=!0;var n=o(t("./BaseTexture")),a=o(t("../settings"));function o(t){return t&&t.__esModule?t:{default:t}}var r=function(r){function s(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:100,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:100,i=arguments[2],n=arguments[3];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,r.call(this,null,i));return o.resolution=n||a.default.RESOLUTION,o.width=Math.ceil(t),o.height=Math.ceil(e),o.realWidth=o.width*o.resolution,o.realHeight=o.height*o.resolution,o.scaleMode=void 0!==i?i:a.default.SCALE_MODE,o.hasLoaded=!0,o._glRenderTargets={},o._canvasRenderTarget=null,o.valid=!1,o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(s,r),s.prototype.resize=function(t,e){t=Math.ceil(t),e=Math.ceil(e),t===this.width&&e===this.height||(this.valid=0<t&&0<e,this.width=t,this.height=e,this.realWidth=this.width*this.resolution,this.realHeight=this.height*this.resolution,this.valid&&this.emit("update",this))},s.prototype.destroy=function(){r.prototype.destroy.call(this,!0),this.renderer=null},s}(n.default);i.default=r},{"../settings":101,"./BaseTexture":112}],112:[function(t,e,i){i.__esModule=!0;var a=t("../utils"),r=o(t("../settings")),n=o(t("eventemitter3")),l=o(t("../utils/determineCrossOrigin")),h=o(t("bit-twiddle"));function o(t){return t&&t.__esModule?t:{default:t}}var s=function(o){function s(t,e,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,o.call(this));return n.uid=(0,a.uid)(),n.touched=0,n.resolution=i||r.default.RESOLUTION,n.width=100,n.height=100,n.realWidth=100,n.realHeight=100,n.scaleMode=void 0!==e?e:r.default.SCALE_MODE,n.hasLoaded=!1,n.isLoading=!1,n.source=null,n.origSource=null,n.imageType=null,n.sourceScale=1,n.premultipliedAlpha=!0,n.imageUrl=null,n.isPowerOfTwo=!1,n.mipmap=r.default.MIPMAP_TEXTURES,n.wrapMode=r.default.WRAP_MODE,n._glTextures={},n._enabled=0,n._virtalBoundId=-1,n._destroyed=!1,n.textureCacheIds=[],t&&n.loadSource(t),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(s,o),s.prototype.update=function(){"svg"!==this.imageType&&(this.realWidth=this.source.naturalWidth||this.source.videoWidth||this.source.width,this.realHeight=this.source.naturalHeight||this.source.videoHeight||this.source.height,this._updateDimensions()),this.emit("update",this)},s.prototype._updateDimensions=function(){this.width=this.realWidth/this.resolution,this.height=this.realHeight/this.resolution,this.isPowerOfTwo=h.default.isPow2(this.realWidth)&&h.default.isPow2(this.realHeight)},s.prototype.loadSource=function(t){var e=this.isLoading;this.hasLoaded=!1,this.isLoading=!1,e&&this.source&&(this.source.onload=null,this.source.onerror=null);var i=!this.source;if(((this.source=t).src&&t.complete||t.getContext)&&t.width&&t.height)this._updateImageType(),"svg"===this.imageType?this._loadSvgSource():this._sourceLoaded(),i&&this.emit("loaded",this);else if(!t.getContext){this.isLoading=!0;var n=this;if(t.onload=function(){n._updateImageType(),t.onload=null,t.onerror=null,n.isLoading&&(n.isLoading=!1,n._sourceLoaded(),"svg"!==n.imageType?n.emit("loaded",n):n._loadSvgSource())},t.onerror=function(){t.onload=null,t.onerror=null,n.isLoading&&(n.isLoading=!1,n.emit("error",n))},t.complete&&t.src){if(t.onload=null,t.onerror=null,"svg"===n.imageType)return void n._loadSvgSource();this.isLoading=!1,t.width&&t.height?(this._sourceLoaded(),e&&this.emit("loaded",this)):e&&this.emit("error",this)}}},s.prototype._updateImageType=function(){if(this.imageUrl){var t=(0,a.decomposeDataUri)(this.imageUrl),e=void 0;if(t&&"image"===t.mediaType){var i=t.subType.split("+")[0];if(!(e=(0,a.getUrlFileExtension)("."+i)))throw new Error("Invalid image type in data URI.")}else(e=(0,a.getUrlFileExtension)(this.imageUrl))||(e="png");this.imageType=e}},s.prototype._loadSvgSource=function(){if("svg"===this.imageType){var t=(0,a.decomposeDataUri)(this.imageUrl);t?this._loadSvgSourceUsingDataUri(t):this._loadSvgSourceUsingXhr()}},s.prototype._loadSvgSourceUsingDataUri=function(t){var e=void 0;if("base64"===t.encoding){if(!atob)throw new Error("Your browser doesn't support base64 conversions.");e=atob(t.data)}else e=t.data;this._loadSvgSourceUsingString(e)},s.prototype._loadSvgSourceUsingXhr=function(){var t=this,e=new XMLHttpRequest;e.onload=function(){if(e.readyState!==e.DONE||200!==e.status)throw new Error("Failed to load SVG using XHR.");t._loadSvgSourceUsingString(e.response)},e.onerror=function(){return t.emit("error",t)},e.open("GET",this.imageUrl,!0),e.send()},s.prototype._loadSvgSourceUsingString=function(t){var e=(0,a.getSvgSize)(t),i=e.width,n=e.height;if(!i||!n)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");this.realWidth=Math.round(i*this.sourceScale),this.realHeight=Math.round(n*this.sourceScale),this._updateDimensions();var o=document.createElement("canvas");o.width=this.realWidth,o.height=this.realHeight,o._pixiId="canvas_"+(0,a.uid)(),o.getContext("2d").drawImage(this.source,0,0,i,n,0,0,this.realWidth,this.realHeight),this.origSource=this.source,this.source=o,s.addToCache(this,o._pixiId),this.isLoading=!1,this._sourceLoaded(),this.emit("loaded",this)},s.prototype._sourceLoaded=function(){this.hasLoaded=!0,this.update()},s.prototype.destroy=function(){this.imageUrl&&(delete a.TextureCache[this.imageUrl],this.imageUrl=null,navigator.isCocoonJS||(this.source.src="")),this.source=null,this.dispose(),s.removeFromCache(this),this.textureCacheIds=null,this._destroyed=!0},s.prototype.dispose=function(){this.emit("dispose",this)},s.prototype.updateSourceImage=function(t){this.source.src=t,this.loadSource(this.source)},s.fromImage=function(t,e,i,n){var o=a.BaseTextureCache[t];if(!o){var r=new Image;void 0===e&&0!==t.indexOf("data:")?r.crossOrigin=(0,l.default)(t):e&&(r.crossOrigin="string"==typeof e?e:"anonymous"),(o=new s(r,i)).imageUrl=t,n&&(o.sourceScale=n),o.resolution=(0,a.getResolutionOfUrl)(t),r.src=t,s.addToCache(o,t)}return o},s.fromCanvas=function(t,e){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"canvas";t._pixiId||(t._pixiId=i+"_"+(0,a.uid)());var n=a.BaseTextureCache[t._pixiId];return n||(n=new s(t,e),s.addToCache(n,t._pixiId)),n},s.from=function(t,e,i){if("string"==typeof t)return s.fromImage(t,void 0,e,i);if(t instanceof HTMLImageElement){var n=t.src,o=a.BaseTextureCache[n];return o||((o=new s(t,e)).imageUrl=n,i&&(o.sourceScale=i),o.resolution=(0,a.getResolutionOfUrl)(n),s.addToCache(o,n)),o}return t instanceof HTMLCanvasElement?s.fromCanvas(t,e):t},s.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),a.BaseTextureCache[e]&&console.warn("BaseTexture added to the cache with an id ["+e+"] that already had an entry"),a.BaseTextureCache[e]=t)},s.removeFromCache=function(t){if("string"==typeof t){var e=a.BaseTextureCache[t];if(e){var i=e.textureCacheIds.indexOf(t);return-1<i&&e.textureCacheIds.splice(i,1),delete a.BaseTextureCache[t],e}}else if(t&&t.textureCacheIds){for(var n=0;n<t.textureCacheIds.length;++n)delete a.BaseTextureCache[t.textureCacheIds[n]];return t.textureCacheIds.length=0,t}return null},s}(n.default);i.default=s},{"../settings":101,"../utils":125,"../utils/determineCrossOrigin":124,"bit-twiddle":1,eventemitter3:3}],113:[function(t,e,i){i.__esModule=!0;var u=n(t("./BaseRenderTexture"));function n(t){return t&&t.__esModule?t:{default:t}}var o=function(l){function h(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);var i=null;if(!(t instanceof u.default)){var n=arguments[1],o=arguments[2],r=arguments[3],s=arguments[4];console.warn("Please use RenderTexture.create("+n+", "+o+") instead of the ctor directly."),i=arguments[0],e=null,t=new u.default(n,o,r,s)}var a=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,l.call(this,t,e));return a.legacyRenderer=i,a.valid=!0,a._updateUvs(),a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(h,l),h.prototype.resize=function(t,e,i){t=Math.ceil(t),e=Math.ceil(e),this.valid=0<t&&0<e,this._frame.width=this.orig.width=t,this._frame.height=this.orig.height=e,i||this.baseTexture.resize(t,e),this._updateUvs()},h.create=function(t,e,i,n){return new h(new u.default(t,e,i,n))},h}(n(t("./Texture")).default);i.default=o},{"./BaseRenderTexture":111,"./Texture":115}],114:[function(t,e,i){i.__esModule=!0;var n=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),p=t("../"),o=t("../utils");var r=function(){function c(t,e){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),this.baseTexture=t,this.textures={},this.animations={},this.data=e,this.resolution=this._updateResolution(i||this.baseTexture.imageUrl),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}return n(c,null,[{key:"BATCH_SIZE",get:function(){return 1e3}}]),c.prototype._updateResolution=function(t){var e=this.data.meta.scale,i=(0,o.getResolutionOfUrl)(t,null);return null===i&&(i=void 0!==e?parseFloat(e):1),1!==i&&(this.baseTexture.resolution=i,this.baseTexture.update()),i},c.prototype.parse=function(t){this._batchIndex=0,this._callback=t,this._frameKeys.length<=c.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()},c.prototype._processFrames=function(t){for(var e=t,i=c.BATCH_SIZE,n=this.baseTexture.sourceScale;e-t<i&&e<this._frameKeys.length;){var o=this._frameKeys[e],r=this._frames[o],s=r.frame;if(s){var a=null,l=null,h=!1!==r.trimmed&&r.sourceSize?r.sourceSize:r.frame,u=new p.Rectangle(0,0,Math.floor(h.w*n)/this.resolution,Math.floor(h.h*n)/this.resolution);a=r.rotated?new p.Rectangle(Math.floor(s.x*n)/this.resolution,Math.floor(s.y*n)/this.resolution,Math.floor(s.h*n)/this.resolution,Math.floor(s.w*n)/this.resolution):new p.Rectangle(Math.floor(s.x*n)/this.resolution,Math.floor(s.y*n)/this.resolution,Math.floor(s.w*n)/this.resolution,Math.floor(s.h*n)/this.resolution),!1!==r.trimmed&&r.spriteSourceSize&&(l=new p.Rectangle(Math.floor(r.spriteSourceSize.x*n)/this.resolution,Math.floor(r.spriteSourceSize.y*n)/this.resolution,Math.floor(s.w*n)/this.resolution,Math.floor(s.h*n)/this.resolution)),this.textures[o]=new p.Texture(this.baseTexture,a,u,l,r.rotated?2:0,r.anchor),p.Texture.addToCache(this.textures[o],o)}e++}},c.prototype._processAnimations=function(){var t=this.data.animations||{};for(var e in t){this.animations[e]=[];var i=t[e],n=Array.isArray(i),o=0;for(i=n?i:i[Symbol.iterator]();;){var r;if(n){if(o>=i.length)break;r=i[o++]}else{if((o=i.next()).done)break;r=o.value}var s=r;this.animations[e].push(this.textures[s])}}},c.prototype._parseComplete=function(){var t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)},c.prototype._nextBatch=function(){var t=this;this._processFrames(this._batchIndex*c.BATCH_SIZE),this._batchIndex++,setTimeout(function(){t._batchIndex*c.BATCH_SIZE<t._frameKeys.length?t._nextBatch():(t._processAnimations(),t._parseComplete())},0)},c.prototype.destroy=function(){var t=0<arguments.length&&void 0!==arguments[0]&&arguments[0];for(var e in this.textures)this.textures[e].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&this.baseTexture.destroy(),this.baseTexture=null},c}();i.default=r},{"../":65,"../utils":125}],115:[function(t,e,i){i.__esModule=!0;var n=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),r=l(t("./BaseTexture")),o=l(t("./VideoBaseTexture")),s=l(t("./TextureUvs")),a=l(t("eventemitter3")),h=t("../math"),u=t("../utils"),c=l(t("../settings"));function l(t){return t&&t.__esModule?t:{default:t}}var p=function(a){function l(t,e,i,n,o,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l);var s=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,a.call(this));if(s.noFrame=!1,e||(s.noFrame=!0,e=new h.Rectangle(0,0,1,1)),t instanceof l&&(t=t.baseTexture),s.baseTexture=t,s._frame=e,s.trim=n,s.valid=!1,s.requiresUpdate=!1,s._uvs=null,s.orig=i||e,s._rotate=Number(o||0),!0===o)s._rotate=2;else if(s._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");return t.hasLoaded?(s.noFrame&&(e=new h.Rectangle(0,0,t.width,t.height),t.on("update",s.onBaseTextureUpdated,s)),s.frame=e):t.once("loaded",s.onBaseTextureLoaded,s),s.defaultAnchor=r?new h.Point(r.x,r.y):new h.Point(0,0),s._updateID=0,s.transform=null,s.textureCacheIds=[],s}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(l,a),l.prototype.update=function(){this.baseTexture.update()},l.prototype.onBaseTextureLoaded=function(t){this._updateID++,this.noFrame?this.frame=new h.Rectangle(0,0,t.width,t.height):this.frame=this._frame,this.baseTexture.on("update",this.onBaseTextureUpdated,this),this.emit("update",this)},l.prototype.onBaseTextureUpdated=function(t){this._updateID++,this._frame.width=t.width,this._frame.height=t.height,this.emit("update",this)},l.prototype.destroy=function(t){this.baseTexture&&(t&&(u.TextureCache[this.baseTexture.imageUrl]&&l.removeFromCache(this.baseTexture.imageUrl),this.baseTexture.destroy()),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture.off("loaded",this.onBaseTextureLoaded,this),this.baseTexture=null),this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,l.removeFromCache(this),this.textureCacheIds=null},l.prototype.clone=function(){return new l(this.baseTexture,this.frame,this.orig,this.trim,this.rotate,this.defaultAnchor)},l.prototype._updateUvs=function(){this._uvs||(this._uvs=new s.default),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},l.fromImage=function(t,e,i,n){var o=u.TextureCache[t];return o||(o=new l(r.default.fromImage(t,e,i,n)),l.addToCache(o,t)),o},l.fromFrame=function(t){var e=u.TextureCache[t];if(!e)throw new Error('The frameId "'+t+'" does not exist in the texture cache');return e},l.fromCanvas=function(t,e){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"canvas";return new l(r.default.fromCanvas(t,e,i))},l.fromVideo=function(t,e,i,n){return"string"==typeof t?l.fromVideoUrl(t,e,i,n):new l(o.default.fromVideo(t,e,n))},l.fromVideoUrl=function(t,e,i,n){return new l(o.default.fromUrl(t,e,i,n))},l.from=function(t){if("string"!=typeof t)return t instanceof HTMLImageElement?new l(r.default.from(t)):t instanceof HTMLCanvasElement?l.fromCanvas(t,c.default.SCALE_MODE,"HTMLCanvasElement"):t instanceof HTMLVideoElement?l.fromVideo(t):t instanceof r.default?new l(t):t;var e=u.TextureCache[t];return e||(null!==t.match(/\.(mp4|webm|ogg|h264|avi|mov)$/)?l.fromVideoUrl(t):l.fromImage(t))},l.fromLoader=function(t,e,i){var n=new r.default(t,void 0,(0,u.getResolutionOfUrl)(e)),o=new l(n);return n.imageUrl=e,i||(i=e),r.default.addToCache(o.baseTexture,i),l.addToCache(o,i),i!==e&&(r.default.addToCache(o.baseTexture,e),l.addToCache(o,e)),o},l.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),u.TextureCache[e]&&console.warn("Texture added to the cache with an id ["+e+"] that already had an entry"),u.TextureCache[e]=t)},l.removeFromCache=function(t){if("string"==typeof t){var e=u.TextureCache[t];if(e){var i=e.textureCacheIds.indexOf(t);return-1<i&&e.textureCacheIds.splice(i,1),delete u.TextureCache[t],e}}else if(t&&t.textureCacheIds){for(var n=0;n<t.textureCacheIds.length;++n)u.TextureCache[t.textureCacheIds[n]]===t&&delete u.TextureCache[t.textureCacheIds[n]];return t.textureCacheIds.length=0,t}return null},n(l,[{key:"frame",get:function(){return this._frame},set:function(t){this._frame=t,this.noFrame=!1;var e=t.x,i=t.y,n=t.width,o=t.height,r=e+n>this.baseTexture.width,s=i+o>this.baseTexture.height;if(r||s){var a=r&&s?"and":"or",l="X: "+e+" + "+n+" = "+(e+n)+" > "+this.baseTexture.width,h="Y: "+i+" + "+o+" = "+(i+o)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+l+" "+a+" "+h)}this.valid=n&&o&&this.baseTexture.hasLoaded,this.trim||this.rotate||(this.orig=t),this.valid&&this._updateUvs()}},{key:"rotate",get:function(){return this._rotate},set:function(t){this._rotate=t,this.valid&&this._updateUvs()}},{key:"width",get:function(){return this.orig.width}},{key:"height",get:function(){return this.orig.height}}]),l}(a.default);function m(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}(i.default=p).EMPTY=new p(new r.default),m(p.EMPTY),m(p.EMPTY.baseTexture),p.WHITE=function(){var t=document.createElement("canvas");t.width=10,t.height=10;var e=t.getContext("2d");return e.fillStyle="white",e.fillRect(0,0,10,10),new p(new r.default(t))}(),m(p.WHITE),m(p.WHITE.baseTexture)},{"../math":70,"../settings":101,"../utils":125,"./BaseTexture":112,"./TextureUvs":117,"./VideoBaseTexture":118,eventemitter3:3}],116:[function(t,e,i){i.__esModule=!0;var n,o=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),r=t("../math/Matrix"),s=(n=r)&&n.__esModule?n:{default:n};var h=new s.default,a=function(){function i(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),this._texture=t,this.mapCoord=new s.default,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._lastTextureID=-1,this.clampOffset=0,this.clampMargin=void 0===e?.5:e}return i.prototype.multiplyUvs=function(t,e){void 0===e&&(e=t);for(var i=this.mapCoord,n=0;n<t.length;n+=2){var o=t[n],r=t[n+1];e[n]=o*i.a+r*i.c+i.tx,e[n+1]=o*i.b+r*i.d+i.ty}return e},i.prototype.update=function(t){var e=this._texture;if(!e||!e.valid)return!1;if(!t&&this._lastTextureID===e._updateID)return!1;this._lastTextureID=e._updateID;var i=e._uvs;this.mapCoord.set(i.x1-i.x0,i.y1-i.y0,i.x3-i.x0,i.y3-i.y0,i.x0,i.y0);var n=e.orig,o=e.trim;o&&(h.set(n.width/o.width,0,0,n.height/o.height,-o.x/o.width,-o.y/o.height),this.mapCoord.append(h));var r=e.baseTexture,s=this.uClampFrame,a=this.clampMargin/r.resolution,l=this.clampOffset;return s[0]=(e._frame.x+a+l)/r.width,s[1]=(e._frame.y+a+l)/r.height,s[2]=(e._frame.x+e._frame.width-a+l)/r.width,s[3]=(e._frame.y+e._frame.height-a+l)/r.height,this.uClampOffset[0]=l/r.realWidth,this.uClampOffset[1]=l/r.realHeight,!0},o(i,[{key:"texture",get:function(){return this._texture},set:function(t){this._texture=t,this._lastTextureID=-1}}]),i}();i.default=a},{"../math/Matrix":67}],117:[function(t,e,i){i.__esModule=!0;var n,o=t("../math/GroupD8"),h=(n=o)&&n.__esModule?n:{default:n};var r=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsUint32=new Uint32Array(4)}return t.prototype.set=function(t,e,i){var n=e.width,o=e.height;if(i){var r=t.width/2/n,s=t.height/2/o,a=t.x/n+r,l=t.y/o+s;i=h.default.add(i,h.default.NW),this.x0=a+r*h.default.uX(i),this.y0=l+s*h.default.uY(i),i=h.default.add(i,2),this.x1=a+r*h.default.uX(i),this.y1=l+s*h.default.uY(i),i=h.default.add(i,2),this.x2=a+r*h.default.uX(i),this.y2=l+s*h.default.uY(i),i=h.default.add(i,2),this.x3=a+r*h.default.uX(i),this.y3=l+s*h.default.uY(i)}else this.x0=t.x/n,this.y0=t.y/o,this.x1=(t.x+t.width)/n,this.y1=t.y/o,this.x2=(t.x+t.width)/n,this.y2=(t.y+t.height)/o,this.x3=t.x/n,this.y3=(t.y+t.height)/o;this.uvsUint32[0]=(65535&Math.round(65535*this.y0))<<16|65535&Math.round(65535*this.x0),this.uvsUint32[1]=(65535&Math.round(65535*this.y1))<<16|65535&Math.round(65535*this.x1),this.uvsUint32[2]=(65535&Math.round(65535*this.y2))<<16|65535&Math.round(65535*this.x2),this.uvsUint32[3]=(65535&Math.round(65535*this.y3))<<16|65535&Math.round(65535*this.x3)},t}();i.default=r},{"../math/GroupD8":66}],118:[function(t,e,i){i.__esModule=!0;var n=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),r=o(t("./BaseTexture")),s=t("../utils"),l=t("../ticker"),h=t("../const"),u=o(t("../utils/determineCrossOrigin"));function o(t){return t&&t.__esModule?t:{default:t}}var a=function(o){function a(t,e){var i=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),!t)throw new Error("No video source element specified.");(t.readyState===t.HAVE_ENOUGH_DATA||t.readyState===t.HAVE_FUTURE_DATA)&&t.width&&t.height&&(t.complete=!0);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,o.call(this,t,e));return n.width=t.videoWidth,n.height=t.videoHeight,n._autoUpdate=!0,n._isAutoUpdating=!1,n.autoPlay=i,n.update=n.update.bind(n),n._onCanPlay=n._onCanPlay.bind(n),t.addEventListener("play",n._onPlayStart.bind(n)),t.addEventListener("pause",n._onPlayStop.bind(n)),n.hasLoaded=!1,n.__loaded=!1,n._isSourceReady()?n._onCanPlay():(t.addEventListener("canplay",n._onCanPlay),t.addEventListener("canplaythrough",n._onCanPlay)),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(a,o),a.prototype._isSourcePlaying=function(){var t=this.source;return 0<t.currentTime&&!1===t.paused&&!1===t.ended&&2<t.readyState},a.prototype._isSourceReady=function(){return 3===this.source.readyState||4===this.source.readyState},a.prototype._onPlayStart=function(){this.hasLoaded||this._onCanPlay(),!this._isAutoUpdating&&this.autoUpdate&&(l.shared.add(this.update,this,h.UPDATE_PRIORITY.HIGH),this._isAutoUpdating=!0)},a.prototype._onPlayStop=function(){this._isAutoUpdating&&(l.shared.remove(this.update,this),this._isAutoUpdating=!1)},a.prototype._onCanPlay=function(){this.hasLoaded=!0,this.source&&(this.source.removeEventListener("canplay",this._onCanPlay),this.source.removeEventListener("canplaythrough",this._onCanPlay),this.width=this.source.videoWidth,this.height=this.source.videoHeight,this.__loaded||(this.__loaded=!0,this.emit("loaded",this)),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&this.source.play())},a.prototype.destroy=function(){this._isAutoUpdating&&l.shared.remove(this.update,this),this.source&&this.source._pixiId&&(r.default.removeFromCache(this.source._pixiId),delete this.source._pixiId,this.source.pause(),this.source.src="",this.source.load()),o.prototype.destroy.call(this)},a.fromVideo=function(t,e,i){t._pixiId||(t._pixiId="video_"+(0,s.uid)());var n=s.BaseTextureCache[t._pixiId];return n||(n=new a(t,e,i),r.default.addToCache(n,t._pixiId)),n},a.fromUrl=function(t,e,i,n){var o=document.createElement("video");o.setAttribute("webkit-playsinline",""),o.setAttribute("playsinline","");var r=Array.isArray(t)?t[0].src||t[0]:t.src||t;if(void 0===i&&0!==r.indexOf("data:")?o.crossOrigin=(0,u.default)(r):i&&(o.crossOrigin="string"==typeof i?i:"anonymous"),Array.isArray(t))for(var s=0;s<t.length;++s)o.appendChild(c(t[s].src||t[s],t[s].mime));else o.appendChild(c(r,t.mime));return o.load(),a.fromVideo(o,e,n)},n(a,[{key:"autoUpdate",get:function(){return this._autoUpdate},set:function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isAutoUpdating?(l.shared.remove(this.update,this),this._isAutoUpdating=!1):this._autoUpdate&&!this._isAutoUpdating&&(l.shared.add(this.update,this,h.UPDATE_PRIORITY.HIGH),this._isAutoUpdating=!0))}}]),a}(r.default);function c(t,e){if(!e){var i=t.split("?").shift().toLowerCase();e="video/"+i.substr(i.lastIndexOf(".")+1)}var n=document.createElement("source");return n.src=t,n.type=e,n}(i.default=a).fromUrls=a.fromUrl},{"../const":46,"../ticker":121,"../utils":125,"../utils/determineCrossOrigin":124,"./BaseTexture":112}],119:[function(t,e,i){i.__esModule=!0;var n=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),o=a(t("../settings")),r=t("../const"),s=a(t("./TickerListener"));function a(t){return t&&t.__esModule?t:{default:t}}var l=function(){function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._head=new s.default(null,null,1/0),this._requestId=null,this._maxElapsedMS=100,this.autoStart=!1,this.deltaTime=1,this.elapsedMS=1/o.default.TARGET_FPMS,this.lastTime=-1,this.speed=1,this.started=!1,this._tick=function(t){e._requestId=null,e.started&&(e.update(t),e.started&&null===e._requestId&&e._head.next&&(e._requestId=requestAnimationFrame(e._tick)))}}return t.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._requestId=requestAnimationFrame(this._tick))},t.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},t.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},t.prototype.add=function(t,e){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:r.UPDATE_PRIORITY.NORMAL;return this._addListener(new s.default(t,e,i))},t.prototype.addOnce=function(t,e){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:r.UPDATE_PRIORITY.NORMAL;return this._addListener(new s.default(t,e,i,!0))},t.prototype._addListener=function(t){var e=this._head.next,i=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(i);break}e=(i=e).next}t.previous||t.connect(i)}else t.connect(i);return this._startIfPossible(),this},t.prototype.remove=function(t,e){for(var i=this._head.next;i;)i=i.match(t,e)?i.destroy():i.next;return this._head.next||this._cancelIfNeeded(),this},t.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},t.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},t.prototype.destroy=function(){this.stop();for(var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),this._head=null},t.prototype.update=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:performance.now(),e=void 0;if(t>this.lastTime){(e=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(e=this._maxElapsedMS),this.deltaTime=e*o.default.TARGET_FPMS*this.speed;for(var i=this._head,n=i.next;n;)n=n.emit(this.deltaTime);i.next||this._cancelIfNeeded()}else this.deltaTime=this.elapsedMS=0;this.lastTime=t},n(t,[{key:"FPS",get:function(){return 1e3/this.elapsedMS}},{key:"minFPS",get:function(){return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(Math.max(0,t)/1e3,o.default.TARGET_FPMS);this._maxElapsedMS=1/e}}]),t}();i.default=l},{"../const":46,"../settings":101,"./TickerListener":120}],120:[function(t,e,i){i.__esModule=!0;var n=function(){function o(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=3<arguments.length&&void 0!==arguments[3]&&arguments[3];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),this.fn=t,this.context=e,this.priority=i,this.once=n,this.next=null,this.previous=null,this._destroyed=!1}return o.prototype.match=function(t,e){return e=e||null,this.fn===t&&this.context===e},o.prototype.emit=function(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));var e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e},o.prototype.connect=function(t){(this.previous=t).next&&(t.next.previous=this),this.next=t.next,t.next=this},o.prototype.destroy=function(){var t=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var e=this.next;return this.next=t?null:e,this.previous=null,e},o}();i.default=n},{}],121:[function(t,e,i){i.__esModule=!0,i.Ticker=i.shared=void 0;var n,o=t("./Ticker"),r=(n=o)&&n.__esModule?n:{default:n};var s=new r.default;s.autoStart=!0,s.destroy=function(){},i.shared=s,i.Ticker=r.default},{"./Ticker":119}],122:[function(t,e,i){i.__esModule=!0,i.default=function(){return!(navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform))}},{}],123:[function(t,e,i){i.__esModule=!0,i.default=function(t){for(var e=6*t,i=new Uint16Array(e),n=0,o=0;n<e;n+=6,o+=4)i[n+0]=o+0,i[n+1]=o+1,i[n+2]=o+2,i[n+3]=o+0,i[n+4]=o+2,i[n+5]=o+3;return i}},{}],124:[function(t,e,i){i.__esModule=!0,i.default=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:window.location;if(0===t.indexOf("data:"))return"";e=e||window.location,s||(s=document.createElement("a"));s.href=t;var i=!(t=r.default.parse(s.href)).port&&""===e.port||t.port===e.port;return t.hostname===e.hostname&&i&&t.protocol===e.protocol?"":"anonymous"};var n,o=t("url"),r=(n=o)&&n.__esModule?n:{default:n};var s=void 0},{url:38}],125:[function(t,e,i){i.__esModule=!0,i.premultiplyBlendMode=i.BaseTextureCache=i.TextureCache=i.earcut=i.mixins=i.pluginTarget=i.EventEmitter=i.removeItems=i.isMobile=void 0,i.uid=function(){return++f},i.hex2rgb=function(t,e){return(e=e||[])[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255,e},i.hex2string=function(t){return t=t.toString(16),"#"+(t="000000".substr(0,6-t.length)+t)},i.rgb2hex=function(t){return(255*t[0]<<16)+(255*t[1]<<8)+(255*t[2]|0)},i.getResolutionOfUrl=function(t,e){var i=o.default.RETINA_PREFIX.exec(t);if(i)return parseFloat(i[1]);return void 0!==e?e:1},i.decomposeDataUri=function(t){var e=n.DATA_URI.exec(t);if(e)return{mediaType:e[1]?e[1].toLowerCase():void 0,subType:e[2]?e[2].toLowerCase():void 0,charset:e[3]?e[3].toLowerCase():void 0,encoding:e[4]?e[4].toLowerCase():void 0,data:e[5]};return},i.getUrlFileExtension=function(t){var e=n.URL_FILE_EXTENSION.exec(t);if(e)return e[1].toLowerCase();return},i.getSvgSize=function(t){var e=n.SVG_SIZE.exec(t),i={};e&&(i[e[1]]=Math.round(parseFloat(e[3])),i[e[5]]=Math.round(parseFloat(e[7])));return i},i.skipHello=function(){d=!0},i.sayHello=function(t){if(d)return;if(-1<navigator.userAgent.toLowerCase().indexOf("chrome")){var e=["\n %c %c %c PixiJS "+n.VERSION+" -  "+t+"   %c  %c  http://www.pixijs.com/  %c %c %c%c \n\n","background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];window.console.log.apply(console,e)}else window.console&&window.console.log("PixiJS "+n.VERSION+" - "+t+" - http://www.pixijs.com/");d=!0},i.isWebGLSupported=function(){var t={stencil:!0,failIfMajorPerformanceCaveat:!0};try{if(!window.WebGLRenderingContext)return!1;var e=document.createElement("canvas"),i=e.getContext("webgl",t)||e.getContext("experimental-webgl",t),n=!(!i||!i.getContextAttributes().stencil);if(i){var o=i.getExtension("WEBGL_lose_context");o&&o.loseContext()}return i=null,n}catch(t){return!1}},i.sign=function(t){return 0===t?0:t<0?-1:1},i.destroyTextureCache=function(){var t=void 0;for(t in _)_[t].destroy();for(t in y)y[t].destroy()},i.clearTextureCache=function(){var t=void 0;for(t in _)delete _[t];for(t in y)delete y[t]},i.correctBlendMode=function(t,e){return x[e?1:0][t]},i.premultiplyTint=function(t,e){if(1===e)return(255*e<<24)+t;if(0===e)return 0;var i=t>>16&255,n=t>>8&255,o=255&t;return(255*e<<24)+((i=i*e+.5|0)<<16)+((n=n*e+.5|0)<<8)+(o=o*e+.5|0)},i.premultiplyRgba=function(t,e,i,n){i=i||new Float32Array(4),i[2]=n||void 0===n?(i[0]=t[0]*e,i[1]=t[1]*e,t[2]*e):(i[0]=t[0],i[1]=t[1],t[2]);return i[3]=e,i},i.premultiplyTintToRgba=function(t,e,i,n){(i=i||new Float32Array(4))[0]=(t>>16&255)/255,i[1]=(t>>8&255)/255,i[2]=(255&t)/255,(n||void 0===n)&&(i[0]*=e,i[1]*=e,i[2]*=e);return i[3]=e,i};var n=t("../const"),o=m(t("../settings")),r=m(t("eventemitter3")),s=m(t("./pluginTarget")),a=p(t("./mixin")),l=p(t("ismobilejs")),h=m(t("remove-array-items")),u=m(t("./mapPremultipliedBlendModes")),c=m(t("earcut"));function p(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function m(t){return t&&t.__esModule?t:{default:t}}var f=0,d=!1;i.isMobile=l,i.removeItems=h.default,i.EventEmitter=r.default,i.pluginTarget=s.default,i.mixins=a,i.earcut=c.default;var _=i.TextureCache=Object.create(null),y=i.BaseTextureCache=Object.create(null);var x=i.premultiplyBlendMode=(0,u.default)()},{"../const":46,"../settings":101,"./mapPremultipliedBlendModes":126,"./mixin":128,"./pluginTarget":129,earcut:2,eventemitter3:3,ismobilejs:4,"remove-array-items":31}],126:[function(t,e,i){i.__esModule=!0,i.default=function(){for(var t=[],e=[],i=0;i<32;i++)t[i]=i,e[i]=i;t[o.BLEND_MODES.NORMAL_NPM]=o.BLEND_MODES.NORMAL,t[o.BLEND_MODES.ADD_NPM]=o.BLEND_MODES.ADD,t[o.BLEND_MODES.SCREEN_NPM]=o.BLEND_MODES.SCREEN,e[o.BLEND_MODES.NORMAL]=o.BLEND_MODES.NORMAL_NPM,e[o.BLEND_MODES.ADD]=o.BLEND_MODES.ADD_NPM,e[o.BLEND_MODES.SCREEN]=o.BLEND_MODES.SCREEN_NPM;var n=[];return n.push(e),n.push(t),n};var o=t("../const")},{"../const":46}],127:[function(t,e,i){i.__esModule=!0,i.default=function(t){if(r.default.tablet||r.default.phone)return 4;return t};var n,o=t("ismobilejs"),r=(n=o)&&n.__esModule?n:{default:n}},{ismobilejs:4}],128:[function(t,e,i){function n(t,e){if(t&&e)for(var i=Object.keys(e),n=0;n<i.length;++n){var o=i[n];Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(e,o))}}i.__esModule=!0,i.mixin=n,i.delayMixin=function(t,e){o.push(t,e)},i.performMixins=function(){for(var t=0;t<o.length;t+=2)n(o[t],o[t+1]);o.length=0};var o=[]},{}],129:[function(t,e,i){i.__esModule=!0,i.default={mixin:function(t){var i;(i=t).__plugins={},i.registerPlugin=function(t,e){i.__plugins[t]=e},i.prototype.initPlugins=function(){for(var t in this.plugins=this.plugins||{},i.__plugins)this.plugins[t]=new i.__plugins[t](this)},i.prototype.destroyPlugins=function(){for(var t in this.plugins)this.plugins[t].destroy(),this.plugins[t]=null;this.plugins=null}}}},{}],130:[function(t,e,i){i.__esModule=!0,i.default=function(t){var e=t.width,i=t.height,n=t.getContext("2d"),o=n.getImageData(0,0,e,i).data,r=o.length,s={top:null,left:null,right:null,bottom:null},a=null,l=void 0,h=void 0,u=void 0;for(l=0;l<r;l+=4)0!==o[l+3]&&(h=l/4%e,u=~~(l/4/e),null===s.top&&(s.top=u),null===s.left?s.left=h:h<s.left&&(s.left=h),null===s.right?s.right=h+1:s.right<h&&(s.right=h+1),null===s.bottom?s.bottom=u:s.bottom<u&&(s.bottom=u));null!==s.top&&(e=s.right-s.left,i=s.bottom-s.top+1,a=n.getImageData(s.left,s.top,e,i));return{height:i,width:e,data:a}}},{}],131:[function(t,e,i){i.__esModule=!0,i.default=function(i){var t=i.mesh,e=i.particles,n=i.extras,o=i.filters,r=i.prepare,s=i.loaders,a=i.interaction;Object.defineProperties(i,{SpriteBatch:{get:function(){throw new ReferenceError("SpriteBatch does not exist any more, please use the new ParticleContainer instead.")}},AssetLoader:{get:function(){throw new ReferenceError("The loader system was overhauled in PixiJS v3, please see the new PIXI.loaders.Loader class.")}},Stage:{get:function(){return f("You do not need to use a PIXI Stage any more, you can simply render any container."),i.Container}},DisplayObjectContainer:{get:function(){return f("DisplayObjectContainer has been shortened to Container, please use Container from now on."),i.Container}},Strip:{get:function(){return f("The Strip class has been renamed to Mesh and moved to mesh.Mesh, please use mesh.Mesh from now on."),t.Mesh}},Rope:{get:function(){return f("The Rope class has been moved to mesh.Rope, please use mesh.Rope from now on."),t.Rope}},ParticleContainer:{get:function(){return f("The ParticleContainer class has been moved to particles.ParticleContainer, please use particles.ParticleContainer from now on."),e.ParticleContainer}},MovieClip:{get:function(){return f("The MovieClip class has been moved to extras.AnimatedSprite, please use extras.AnimatedSprite."),n.AnimatedSprite}},TilingSprite:{get:function(){return f("The TilingSprite class has been moved to extras.TilingSprite, please use extras.TilingSprite from now on."),n.TilingSprite}},BitmapText:{get:function(){return f("The BitmapText class has been moved to extras.BitmapText, please use extras.BitmapText from now on."),n.BitmapText}},blendModes:{get:function(){return f("The blendModes has been moved to BLEND_MODES, please use BLEND_MODES from now on."),i.BLEND_MODES}},scaleModes:{get:function(){return f("The scaleModes has been moved to SCALE_MODES, please use SCALE_MODES from now on."),i.SCALE_MODES}},BaseTextureCache:{get:function(){return f("The BaseTextureCache class has been moved to utils.BaseTextureCache, please use utils.BaseTextureCache from now on."),i.utils.BaseTextureCache}},TextureCache:{get:function(){return f("The TextureCache class has been moved to utils.TextureCache, please use utils.TextureCache from now on."),i.utils.TextureCache}},math:{get:function(){return f("The math namespace is deprecated, please access members already accessible on PIXI."),i}},AbstractFilter:{get:function(){return f("AstractFilter has been renamed to Filter, please use PIXI.Filter"),i.Filter}},TransformManual:{get:function(){return f("TransformManual has been renamed to TransformBase, please update your pixi-spine"),i.TransformBase}},TARGET_FPMS:{get:function(){return f("PIXI.TARGET_FPMS has been deprecated, please use PIXI.settings.TARGET_FPMS"),i.settings.TARGET_FPMS},set:function(t){f("PIXI.TARGET_FPMS has been deprecated, please use PIXI.settings.TARGET_FPMS"),i.settings.TARGET_FPMS=t}},FILTER_RESOLUTION:{get:function(){return f("PIXI.FILTER_RESOLUTION has been deprecated, please use PIXI.settings.FILTER_RESOLUTION"),i.settings.FILTER_RESOLUTION},set:function(t){f("PIXI.FILTER_RESOLUTION has been deprecated, please use PIXI.settings.FILTER_RESOLUTION"),i.settings.FILTER_RESOLUTION=t}},RESOLUTION:{get:function(){return f("PIXI.RESOLUTION has been deprecated, please use PIXI.settings.RESOLUTION"),i.settings.RESOLUTION},set:function(t){f("PIXI.RESOLUTION has been deprecated, please use PIXI.settings.RESOLUTION"),i.settings.RESOLUTION=t}},MIPMAP_TEXTURES:{get:function(){return f("PIXI.MIPMAP_TEXTURES has been deprecated, please use PIXI.settings.MIPMAP_TEXTURES"),i.settings.MIPMAP_TEXTURES},set:function(t){f("PIXI.MIPMAP_TEXTURES has been deprecated, please use PIXI.settings.MIPMAP_TEXTURES"),i.settings.MIPMAP_TEXTURES=t}},SPRITE_BATCH_SIZE:{get:function(){return f("PIXI.SPRITE_BATCH_SIZE has been deprecated, please use PIXI.settings.SPRITE_BATCH_SIZE"),i.settings.SPRITE_BATCH_SIZE},set:function(t){f("PIXI.SPRITE_BATCH_SIZE has been deprecated, please use PIXI.settings.SPRITE_BATCH_SIZE"),i.settings.SPRITE_BATCH_SIZE=t}},SPRITE_MAX_TEXTURES:{get:function(){return f("PIXI.SPRITE_MAX_TEXTURES has been deprecated, please use PIXI.settings.SPRITE_MAX_TEXTURES"),i.settings.SPRITE_MAX_TEXTURES},set:function(t){f("PIXI.SPRITE_MAX_TEXTURES has been deprecated, please use PIXI.settings.SPRITE_MAX_TEXTURES"),i.settings.SPRITE_MAX_TEXTURES=t}},RETINA_PREFIX:{get:function(){return f("PIXI.RETINA_PREFIX has been deprecated, please use PIXI.settings.RETINA_PREFIX"),i.settings.RETINA_PREFIX},set:function(t){f("PIXI.RETINA_PREFIX has been deprecated, please use PIXI.settings.RETINA_PREFIX"),i.settings.RETINA_PREFIX=t}},DEFAULT_RENDER_OPTIONS:{get:function(){return f("PIXI.DEFAULT_RENDER_OPTIONS has been deprecated, please use PIXI.settings.DEFAULT_RENDER_OPTIONS"),i.settings.RENDER_OPTIONS}}});for(var l=[{parent:"TRANSFORM_MODE",target:"TRANSFORM_MODE"},{parent:"GC_MODES",target:"GC_MODE"},{parent:"WRAP_MODES",target:"WRAP_MODE"},{parent:"SCALE_MODES",target:"SCALE_MODE"},{parent:"PRECISION",target:"PRECISION_FRAGMENT"}],h=function(t){var e=l[t];Object.defineProperty(i[e.parent],"DEFAULT",{get:function(){return f("PIXI."+e.parent+".DEFAULT has been deprecated, please use PIXI.settings."+e.target),i.settings[e.target]},set:function(t){f("PIXI."+e.parent+".DEFAULT has been deprecated, please use PIXI.settings."+e.target),i.settings[e.target]=t}})},u=0;u<l.length;u++)h(u);Object.defineProperties(i.settings,{PRECISION:{get:function(){return f("PIXI.settings.PRECISION has been deprecated, please use PIXI.settings.PRECISION_FRAGMENT"),i.settings.PRECISION_FRAGMENT},set:function(t){f("PIXI.settings.PRECISION has been deprecated, please use PIXI.settings.PRECISION_FRAGMENT"),i.settings.PRECISION_FRAGMENT=t}}}),n.AnimatedSprite&&Object.defineProperties(n,{MovieClip:{get:function(){return f("The MovieClip class has been renamed to AnimatedSprite, please use AnimatedSprite from now on."),n.AnimatedSprite}}});n&&Object.defineProperties(n,{TextureTransform:{get:function(){return f("The TextureTransform class has been renamed to TextureMatrix, please use PIXI.TextureMatrix from now on."),i.TextureMatrix}}});i.DisplayObject.prototype.generateTexture=function(t,e,i){return f("generateTexture has moved to the renderer, please use renderer.generateTexture(displayObject)"),t.generateTexture(this,e,i)},i.Graphics.prototype.generateTexture=function(t,e){return f("graphics generate texture has moved to the renderer. Or to render a graphics to a texture using canvas please use generateCanvasTexture"),this.generateCanvasTexture(t,e)},i.GroupD8.isSwapWidthHeight=function(t){return f("GroupD8.isSwapWidthHeight was renamed to GroupD8.isVertical"),i.GroupD8.isVertical(t)},i.RenderTexture.prototype.render=function(t,e,i,n){this.legacyRenderer.render(t,this,i,e,!n),f("RenderTexture.render is now deprecated, please use renderer.render(displayObject, renderTexture)")},i.RenderTexture.prototype.getImage=function(t){return f("RenderTexture.getImage is now deprecated, please use renderer.extract.image(target)"),this.legacyRenderer.extract.image(t)},i.RenderTexture.prototype.getBase64=function(t){return f("RenderTexture.getBase64 is now deprecated, please use renderer.extract.base64(target)"),this.legacyRenderer.extract.base64(t)},i.RenderTexture.prototype.getCanvas=function(t){return f("RenderTexture.getCanvas is now deprecated, please use renderer.extract.canvas(target)"),this.legacyRenderer.extract.canvas(t)},i.RenderTexture.prototype.getPixels=function(t){return f("RenderTexture.getPixels is now deprecated, please use renderer.extract.pixels(target)"),this.legacyRenderer.pixels(t)},i.Sprite.prototype.setTexture=function(t){this.texture=t,f("setTexture is now deprecated, please use the texture property, e.g : sprite.texture = texture;")},n.BitmapText&&(n.BitmapText.prototype.setText=function(t){this.text=t,f("setText is now deprecated, please use the text property, e.g : myBitmapText.text = 'my text';")});i.Text.prototype.setText=function(t){this.text=t,f("setText is now deprecated, please use the text property, e.g : myText.text = 'my text';")},i.Text.calculateFontProperties=function(t){return f("Text.calculateFontProperties is now deprecated, please use the TextMetrics.measureFont"),i.TextMetrics.measureFont(t)},Object.defineProperties(i.Text,{fontPropertiesCache:{get:function(){return f("Text.fontPropertiesCache is deprecated"),i.TextMetrics._fonts}},fontPropertiesCanvas:{get:function(){return f("Text.fontPropertiesCanvas is deprecated"),i.TextMetrics._canvas}},fontPropertiesContext:{get:function(){return f("Text.fontPropertiesContext is deprecated"),i.TextMetrics._context}}}),i.Text.prototype.setStyle=function(t){this.style=t,f("setStyle is now deprecated, please use the style property, e.g : myText.style = style;")},i.Text.prototype.determineFontProperties=function(t){return f("determineFontProperties is now deprecated, please use TextMetrics.measureFont method"),i.TextMetrics.measureFont(t)},i.Text.getFontStyle=function(t){return f("getFontStyle is now deprecated, please use TextStyle.toFontString() instead"),(t=t||{})instanceof i.TextStyle||(t=new i.TextStyle(t)),t.toFontString()},Object.defineProperties(i.TextStyle.prototype,{font:{get:function(){f("text style property 'font' is now deprecated, please use the 'fontFamily', 'fontSize', 'fontStyle', 'fontVariant' and 'fontWeight' properties from now on");var t="number"==typeof this._fontSize?this._fontSize+"px":this._fontSize;return this._fontStyle+" "+this._fontVariant+" "+this._fontWeight+" "+t+" "+this._fontFamily},set:function(t){f("text style property 'font' is now deprecated, please use the 'fontFamily','fontSize',fontStyle','fontVariant' and 'fontWeight' properties from now on"),1<t.indexOf("italic")?this._fontStyle="italic":-1<t.indexOf("oblique")?this._fontStyle="oblique":this._fontStyle="normal",-1<t.indexOf("small-caps")?this._fontVariant="small-caps":this._fontVariant="normal";var e=t.split(" "),i=-1;this._fontSize=26;for(var n=0;n<e.length;++n)if(e[n].match(/(px|pt|em|%)/)){i=n,this._fontSize=e[n];break}this._fontWeight="normal";for(var o=0;o<i;++o)if(e[o].match(/(bold|bolder|lighter|100|200|300|400|500|600|700|800|900)/)){this._fontWeight=e[o];break}if(-1<i&&i<e.length-1){this._fontFamily="";for(var r=i+1;r<e.length;++r)this._fontFamily+=e[r]+" ";this._fontFamily=this._fontFamily.slice(0,-1)}else this._fontFamily="Arial";this.styleID++}}}),i.Texture.prototype.setFrame=function(t){this.frame=t,f("setFrame is now deprecated, please use the frame property, e.g: myTexture.frame = frame;")},i.Texture.addTextureToCache=function(t,e){i.Texture.addToCache(t,e),f("Texture.addTextureToCache is deprecated, please use Texture.addToCache from now on.")},i.Texture.removeTextureFromCache=function(t){return f("Texture.removeTextureFromCache is deprecated, please use Texture.removeFromCache from now on. Be aware that Texture.removeFromCache does not automatically its BaseTexture from the BaseTextureCache. For that, use BaseTexture.removeFromCache"),i.BaseTexture.removeFromCache(t),i.Texture.removeFromCache(t)},Object.defineProperties(o,{AbstractFilter:{get:function(){return f("AstractFilter has been renamed to Filter, please use PIXI.Filter"),i.AbstractFilter}},SpriteMaskFilter:{get:function(){return f("filters.SpriteMaskFilter is an undocumented alias, please use SpriteMaskFilter from now on."),i.SpriteMaskFilter}},VoidFilter:{get:function(){return f("VoidFilter has been renamed to AlphaFilter, please use PIXI.filters.AlphaFilter"),o.AlphaFilter}}}),i.utils.uuid=function(){return f("utils.uuid() is deprecated, please use utils.uid() from now on."),i.utils.uid()},i.utils.canUseNewCanvasBlendModes=function(){return f("utils.canUseNewCanvasBlendModes() is deprecated, please use CanvasTinter.canUseMultiply from now on"),i.CanvasTinter.canUseMultiply};var c=!0;Object.defineProperty(i.utils,"_saidHello",{set:function(t){t&&(f("PIXI.utils._saidHello is deprecated, please use PIXI.utils.skipHello()"),this.skipHello()),c=t},get:function(){return c}}),r.BasePrepare&&(r.BasePrepare.prototype.register=function(t,e){return f("renderer.plugins.prepare.register is now deprecated, please use renderer.plugins.prepare.registerFindHook & renderer.plugins.prepare.registerUploadHook"),t&&this.registerFindHook(t),e&&this.registerUploadHook(e),this});r.canvas&&Object.defineProperty(r.canvas,"UPLOADS_PER_FRAME",{set:function(){f("PIXI.CanvasPrepare.UPLOADS_PER_FRAME has been removed. Please set renderer.plugins.prepare.limiter.maxItemsPerFrame on your renderer")},get:function(){return f("PIXI.CanvasPrepare.UPLOADS_PER_FRAME has been removed. Please use renderer.plugins.prepare.limiter"),NaN}});r.webgl&&Object.defineProperty(r.webgl,"UPLOADS_PER_FRAME",{set:function(){f("PIXI.WebGLPrepare.UPLOADS_PER_FRAME has been removed. Please set renderer.plugins.prepare.limiter.maxItemsPerFrame on your renderer")},get:function(){return f("PIXI.WebGLPrepare.UPLOADS_PER_FRAME has been removed. Please use renderer.plugins.prepare.limiter"),NaN}});if(s.Loader){var p=s.Resource,m=s.Loader;Object.defineProperties(p.prototype,{isJson:{get:function(){return f("The isJson property is deprecated, please use `resource.type === Resource.TYPE.JSON`."),this.type===p.TYPE.JSON}},isXml:{get:function(){return f("The isXml property is deprecated, please use `resource.type === Resource.TYPE.XML`."),this.type===p.TYPE.XML}},isImage:{get:function(){return f("The isImage property is deprecated, please use `resource.type === Resource.TYPE.IMAGE`."),this.type===p.TYPE.IMAGE}},isAudio:{get:function(){return f("The isAudio property is deprecated, please use `resource.type === Resource.TYPE.AUDIO`."),this.type===p.TYPE.AUDIO}},isVideo:{get:function(){return f("The isVideo property is deprecated, please use `resource.type === Resource.TYPE.VIDEO`."),this.type===p.TYPE.VIDEO}}}),Object.defineProperties(m.prototype,{before:{get:function(){return f("The before() method is deprecated, please use pre()."),this.pre}},after:{get:function(){return f("The after() method is deprecated, please use use()."),this.use}}})}a.interactiveTarget&&Object.defineProperty(a.interactiveTarget,"defaultCursor",{set:function(t){f("Property defaultCursor has been replaced with 'cursor'. "),this.cursor=t},get:function(){return f("Property defaultCursor has been replaced with 'cursor'. "),this.cursor}});a.InteractionManager&&(Object.defineProperty(a.InteractionManager,"defaultCursorStyle",{set:function(t){f("Property defaultCursorStyle has been replaced with 'cursorStyles.default'. "),this.cursorStyles.default=t},get:function(){return f("Property defaultCursorStyle has been replaced with 'cursorStyles.default'. "),this.cursorStyles.default}}),Object.defineProperty(a.InteractionManager,"currentCursorStyle",{set:function(t){f("Property currentCursorStyle has been removed.See the currentCursorMode property, which works differently."),this.currentCursorMode=t},get:function(){return f("Property currentCursorStyle has been removed.See the currentCursorMode property, which works differently."),this.currentCursorMode}}))};var n={};function f(t){if(!n[t]){var e=(new Error).stack;void 0===e?console.warn("Deprecation Warning: ",t):(e=e.split("\n").splice(3).join("\n"),console.groupCollapsed?(console.groupCollapsed("%cDeprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",t),console.warn(e),console.groupEnd()):(console.warn("Deprecation Warning: ",t),console.warn(e))),n[t]=!0}}},{}],132:[function(t,e,i){i.__esModule=!0;var u=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}}(t("../../core"));var c=new u.Rectangle,n=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(this.renderer=t).extract=this}return e.prototype.image=function(t){var e=new Image;return e.src=this.base64(t),e},e.prototype.base64=function(t){return this.canvas(t).toDataURL()},e.prototype.canvas=function(t){var e=this.renderer,i=void 0,n=void 0,o=void 0,r=void 0;t&&(r=t instanceof u.RenderTexture?t:e.generateTexture(t)),r?(i=r.baseTexture._canvasRenderTarget.context,n=r.baseTexture._canvasRenderTarget.resolution,o=r.frame):(i=e.rootContext,(o=c).width=this.renderer.width,o.height=this.renderer.height);var s=o.width*n,a=o.height*n,l=new u.CanvasRenderTarget(s,a,1),h=i.getImageData(o.x*n,o.y*n,s,a);return l.context.putImageData(h,0,0),l.canvas},e.prototype.pixels=function(t){var e=this.renderer,i=void 0,n=void 0,o=void 0,r=void 0;return t&&(r=t instanceof u.RenderTexture?t:e.generateTexture(t)),r?(i=r.baseTexture._canvasRenderTarget.context,n=r.baseTexture._canvasRenderTarget.resolution,o=r.frame):(i=e.rootContext,(o=c).width=e.width,o.height=e.height),i.getImageData(0,0,o.width*n,o.height*n).data},e.prototype.destroy=function(){this.renderer.extract=null,this.renderer=null},e}();i.default=n,u.CanvasRenderer.registerPlugin("extract",n)},{"../../core":65}],133:[function(t,e,i){i.__esModule=!0;var n=t("./webgl/WebGLExtract");Object.defineProperty(i,"webgl",{enumerable:!0,get:function(){return r(n).default}});var o=t("./canvas/CanvasExtract");function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(i,"canvas",{enumerable:!0,get:function(){return r(o).default}})},{"./canvas/CanvasExtract":132,"./webgl/WebGLExtract":134}],134:[function(t,e,i){i.__esModule=!0;var f=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}}(t("../../core"));var d=new f.Rectangle,n=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(this.renderer=t).extract=this}return e.prototype.image=function(t){var e=new Image;return e.src=this.base64(t),e},e.prototype.base64=function(t){return this.canvas(t).toDataURL()},e.prototype.canvas=function(t){var e=this.renderer,i=void 0,n=void 0,o=void 0,r=!1,s=void 0,a=!1;t&&(t instanceof f.RenderTexture?s=t:(s=this.renderer.generateTexture(t),a=!0)),s?(n=(i=s.baseTexture._glRenderTargets[this.renderer.CONTEXT_UID]).resolution,o=s.frame,r=!1):(n=(i=this.renderer.rootRenderTarget).resolution,r=!0,(o=d).width=i.size.width,o.height=i.size.height);var l=o.width*n,h=o.height*n,u=new f.CanvasRenderTarget(l,h,1);if(i){e.bindRenderTarget(i);var c=new Uint8Array(4*l*h),p=e.gl;p.readPixels(o.x*n,o.y*n,l,h,p.RGBA,p.UNSIGNED_BYTE,c);var m=u.context.getImageData(0,0,l,h);m.data.set(c),u.context.putImageData(m,0,0),r&&(u.context.scale(1,-1),u.context.drawImage(u.canvas,0,-h))}return a&&s.destroy(!0),u.canvas},e.prototype.pixels=function(t){var e=this.renderer,i=void 0,n=void 0,o=void 0,r=void 0,s=!1;t&&(t instanceof f.RenderTexture?r=t:(r=this.renderer.generateTexture(t),s=!0)),r?(n=(i=r.baseTexture._glRenderTargets[this.renderer.CONTEXT_UID]).resolution,o=r.frame):(n=(i=this.renderer.rootRenderTarget).resolution,(o=d).width=i.size.width,o.height=i.size.height);var a=o.width*n,l=o.height*n,h=new Uint8Array(4*a*l);if(i){e.bindRenderTarget(i);var u=e.gl;u.readPixels(o.x*n,o.y*n,a,l,u.RGBA,u.UNSIGNED_BYTE,h)}return s&&r.destroy(!0),h},e.prototype.destroy=function(){this.renderer.extract=null,this.renderer=null},e}();i.default=n,f.WebGLRenderer.registerPlugin("extract",n)},{"../../core":65}],135:[function(t,e,i){i.__esModule=!0;var r=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),s=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}}(t("../core"));var n=function(n){function o(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,n.call(this,t[0]instanceof s.Texture?t[0]:t[0].texture));return i._textures=null,i._durations=null,i.textures=t,i._autoUpdate=!1!==e,i.animationSpeed=1,i.loop=!0,i.onComplete=null,i.onFrameChange=null,i.onLoop=null,i._currentTime=0,i.playing=!1,i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(o,n),o.prototype.stop=function(){this.playing&&(this.playing=!1,this._autoUpdate&&s.ticker.shared.remove(this.update,this))},o.prototype.play=function(){this.playing||(this.playing=!0,this._autoUpdate&&s.ticker.shared.add(this.update,this,s.UPDATE_PRIORITY.HIGH))},o.prototype.gotoAndStop=function(t){this.stop();var e=this.currentFrame;this._currentTime=t,e!==this.currentFrame&&this.updateTexture()},o.prototype.gotoAndPlay=function(t){var e=this.currentFrame;this._currentTime=t,e!==this.currentFrame&&this.updateTexture(),this.play()},o.prototype.update=function(t){var e=this.animationSpeed*t,i=this.currentFrame;if(null!==this._durations){var n=this._currentTime%1*this._durations[this.currentFrame];for(n+=e/60*1e3;n<0;)this._currentTime--,n+=this._durations[this.currentFrame];var o=Math.sign(this.animationSpeed*t);for(this._currentTime=Math.floor(this._currentTime);n>=this._durations[this.currentFrame];)n-=this._durations[this.currentFrame]*o,this._currentTime+=o;this._currentTime+=n/this._durations[this.currentFrame]}else this._currentTime+=e;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):i!==this.currentFrame&&(this.loop&&this.onLoop&&(0<this.animationSpeed&&this.currentFrame<i?this.onLoop():this.animationSpeed<0&&this.currentFrame>i&&this.onLoop()),this.updateTexture())},o.prototype.updateTexture=function(){this._texture=this._textures[this.currentFrame],this._textureID=-1,this.cachedTint=16777215,this.onFrameChange&&this.onFrameChange(this.currentFrame)},o.prototype.destroy=function(t){this.stop(),n.prototype.destroy.call(this,t)},o.fromFrames=function(t){for(var e=[],i=0;i<t.length;++i)e.push(s.Texture.fromFrame(t[i]));return new o(e)},o.fromImages=function(t){for(var e=[],i=0;i<t.length;++i)e.push(s.Texture.fromImage(t[i]));return new o(e)},r(o,[{key:"totalFrames",get:function(){return this._textures.length}},{key:"textures",get:function(){return this._textures},set:function(t){if(t[0]instanceof s.Texture)this._textures=t,this._durations=null;else{this._textures=[],this._durations=[];for(var e=0;e<t.length;e++)this._textures.push(t[e].texture),this._durations.push(t[e].time)}this.gotoAndStop(0),this.updateTexture()}},{key:"currentFrame",get:function(){var t=Math.floor(this._currentTime)%this._textures.length;return t<0&&(t+=this._textures.length),t}}]),o}(s.Sprite);i.default=n},{"../core":65}],136:[function(t,e,i){i.__esModule=!0;var o=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),P=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}}(t("../core")),r=n(t("../core/math/ObservablePoint")),C=t("../core/utils"),D=n(t("../core/settings"));function n(t){return t&&t.__esModule?t:{default:t}}var s=function(n){function E(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,E);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,n.call(this));return i._textWidth=0,i._textHeight=0,i._glyphs=[],i._font={tint:void 0!==e.tint?e.tint:16777215,align:e.align||"left",name:null,size:0},i.font=e.font,i._text=t,i._maxWidth=0,i._maxLineHeight=0,i._letterSpacing=0,i._anchor=new r.default(function(){i.dirty=!0},i,0,0),i.dirty=!1,i.updateText(),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(E,n),E.prototype.updateText=function(){for(var t=E.fonts[this._font.name],e=this._font.size/t.size,i=new P.Point,n=[],o=[],r=this.text.replace(/(?:\r\n|\r)/g,"\n"),s=r.length,a=this._maxWidth*t.size/this._font.size,l=null,h=0,u=0,c=0,p=-1,m=0,f=0,d=0,_=0;_<s;_++){var y=r.charCodeAt(_),x=r.charAt(_);if(/(?:\s)/.test(x)&&(p=_,m=h),"\r"!==x&&"\n"!==x){var v=t.chars[y];v&&(l&&v.kerning[l]&&(i.x+=v.kerning[l]),n.push({texture:v.texture,line:c,charCode:y,position:new P.Point(i.x+v.xOffset+this._letterSpacing/2,i.y+v.yOffset)}),i.x+=v.xAdvance+this._letterSpacing,h=i.x,d=Math.max(d,v.yOffset+v.texture.height),l=y,-1!==p&&0<a&&i.x>a&&(++f,P.utils.removeItems(n,1+p-f,1+_-p),_=p,p=-1,o.push(m),u=Math.max(u,m),c++,i.x=0,i.y+=t.lineHeight,l=null))}else o.push(h),u=Math.max(u,h),++c,++f,i.x=0,i.y+=t.lineHeight,l=null}var b=r.charAt(r.length-1);"\r"!==b&&"\n"!==b&&(/(?:\s)/.test(b)&&(h=m),o.push(h),u=Math.max(u,h));for(var g=[],w=0;w<=c;w++){var C=0;"right"===this._font.align?C=u-o[w]:"center"===this._font.align&&(C=(u-o[w])/2),g.push(C)}for(var D=n.length,S=this.tint,T=0;T<D;T++){var A=this._glyphs[T];A?A.texture=n[T].texture:(A=new P.Sprite(n[T].texture),this._glyphs.push(A)),A.position.x=(n[T].position.x+g[n[T].line])*e,A.position.y=n[T].position.y*e,A.scale.x=A.scale.y=e,A.tint=S,A.parent||this.addChild(A)}for(var M=D;M<this._glyphs.length;++M)this.removeChild(this._glyphs[M]);if(this._textWidth=u*e,this._textHeight=(i.y+t.lineHeight)*e,0!==this.anchor.x||0!==this.anchor.y)for(var B=0;B<D;B++)this._glyphs[B].x-=this._textWidth*this.anchor.x,this._glyphs[B].y-=this._textHeight*this.anchor.y;this._maxLineHeight=d*e},E.prototype.updateTransform=function(){this.validate(),this.containerUpdateTransform()},E.prototype.getLocalBounds=function(){return this.validate(),n.prototype.getLocalBounds.call(this)},E.prototype.validate=function(){this.dirty&&(this.updateText(),this.dirty=!1)},E.registerFont=function(t,e){var i={},n=t.getElementsByTagName("info")[0],o=t.getElementsByTagName("common")[0],r=t.getElementsByTagName("page"),s=(0,C.getResolutionOfUrl)(r[0].getAttribute("file"),D.default.RESOLUTION),a={};i.font=n.getAttribute("face"),i.size=parseInt(n.getAttribute("size"),10),i.lineHeight=parseInt(o.getAttribute("lineHeight"),10)/s,i.chars={},e instanceof P.Texture&&(e=[e]);for(var l=0;l<r.length;l++){var h=r[l].getAttribute("id"),u=r[l].getAttribute("file");a[h]=e instanceof Array?e[l]:e[u]}for(var c=t.getElementsByTagName("char"),p=0;p<c.length;p++){var m=c[p],f=parseInt(m.getAttribute("id"),10),d=m.getAttribute("page")||0,_=new P.Rectangle(parseInt(m.getAttribute("x"),10)/s+a[d].frame.x/s,parseInt(m.getAttribute("y"),10)/s+a[d].frame.y/s,parseInt(m.getAttribute("width"),10)/s,parseInt(m.getAttribute("height"),10)/s);i.chars[f]={xOffset:parseInt(m.getAttribute("xoffset"),10)/s,yOffset:parseInt(m.getAttribute("yoffset"),10)/s,xAdvance:parseInt(m.getAttribute("xadvance"),10)/s,kerning:{},texture:new P.Texture(a[d].baseTexture,_),page:d}}for(var y=t.getElementsByTagName("kerning"),x=0;x<y.length;x++){var v=y[x],b=parseInt(v.getAttribute("first"),10)/s,g=parseInt(v.getAttribute("second"),10)/s,w=parseInt(v.getAttribute("amount"),10)/s;i.chars[g]&&(i.chars[g].kerning[b]=w)}return E.fonts[i.font]=i},o(E,[{key:"tint",get:function(){return this._font.tint},set:function(t){this._font.tint="number"==typeof t&&0<=t?t:16777215,this.dirty=!0}},{key:"align",get:function(){return this._font.align},set:function(t){this._font.align=t||"left",this.dirty=!0}},{key:"anchor",get:function(){return this._anchor},set:function(t){"number"==typeof t?this._anchor.set(t):this._anchor.copy(t)}},{key:"font",get:function(){return this._font},set:function(t){t&&(this._font.size="string"==typeof t?(t=t.split(" "),this._font.name=1===t.length?t[0]:t.slice(1).join(" "),2<=t.length?parseInt(t[0],10):E.fonts[this._font.name].size):(this._font.name=t.name,"number"==typeof t.size?t.size:parseInt(t.size,10)),this.dirty=!0)}},{key:"text",get:function(){return this._text},set:function(t){t=t.toString()||" ",this._text!==t&&(this._text=t,this.dirty=!0)}},{key:"maxWidth",get:function(){return this._maxWidth},set:function(t){this._maxWidth!==t&&(this._maxWidth=t,this.dirty=!0)}},{key:"maxLineHeight",get:function(){return this.validate(),this._maxLineHeight}},{key:"textWidth",get:function(){return this.validate(),this._textWidth}},{key:"letterSpacing",get:function(){return this._letterSpacing},set:function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.dirty=!0)}},{key:"textHeight",get:function(){return this.validate(),this._textHeight}}]),E}(P.Container);(i.default=s).fonts={}},{"../core":65,"../core/math/ObservablePoint":68,"../core/settings":101,"../core/utils":125}],137:[function(t,e,i){i.__esModule=!0;var n,s=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),g=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}}(t("../core")),o=t("../core/sprites/canvas/CanvasTinter"),w=(n=o)&&n.__esModule?n:{default:n};var a=new g.Point,r=function(o){function r(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:100,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:100;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,o.call(this,t));return n.tileTransform=new g.TransformStatic,n._width=e,n._height=i,n._canvasPattern=null,n.uvTransform=t.transform||new g.TextureMatrix(t),n.pluginName="tilingSprite",n.uvRespectAnchor=!1,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(r,o),r.prototype._onTextureUpdate=function(){this.uvTransform&&(this.uvTransform.texture=this._texture),this.cachedTint=16777215},r.prototype._renderWebGL=function(t){var e=this._texture;e&&e.valid&&(this.tileTransform.updateLocalTransform(),this.uvTransform.update(),t.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this))},r.prototype._renderCanvas=function(t){var e=this._texture;if(e.baseTexture.hasLoaded){var i=t.context,n=this.worldTransform,o=t.resolution,r=2===e.rotate,s=e.baseTexture,a=s.resolution,l=this.tilePosition.x/this.tileScale.x%e.orig.width*a,h=this.tilePosition.y/this.tileScale.y%e.orig.height*a;if(this._textureID!==this._texture._updateID||this.cachedTint!==this.tint){this._textureID=this._texture._updateID;var u=new g.CanvasRenderTarget(e.orig.width,e.orig.height,a);if(16777215!==this.tint)this.tintedTexture=w.default.getTintedTexture(this,this.tint),u.context.drawImage(this.tintedTexture,0,0);else{var c=e._frame.x*a,p=e._frame.y*a,m=e._frame.width*a,f=e._frame.height*a,d=(e.trim?e.trim.width:e.orig.width)*a,_=(e.trim?e.trim.height:e.orig.height)*a,y=(e.trim?e.trim.x:0)*a,x=(e.trim?e.trim.y:0)*a;r?(u.context.rotate(-Math.PI/2),u.context.translate(-_,0),u.context.drawImage(s.source,c,p,m,f,-x,y,_,d)):u.context.drawImage(s.source,c,p,m,f,y,x,d,_)}this.cachedTint=this.tint,this._canvasPattern=u.context.createPattern(u.canvas,"repeat")}i.globalAlpha=this.worldAlpha,i.setTransform(n.a*o,n.b*o,n.c*o,n.d*o,n.tx*o,n.ty*o),t.setBlendMode(this.blendMode),i.fillStyle=this._canvasPattern,i.scale(this.tileScale.x/a,this.tileScale.y/a);var v=this.anchor.x*-this._width*a,b=this.anchor.y*-this._height*a;this.uvRespectAnchor?(i.translate(l,h),i.fillRect(-l+v,-h+b,this._width/this.tileScale.x*a,this._height/this.tileScale.y*a)):(i.translate(l+v,h+b),i.fillRect(-l,-h,this._width/this.tileScale.x*a,this._height/this.tileScale.y*a))}},r.prototype._calculateBounds=function(){var t=this._width*-this._anchor._x,e=this._height*-this._anchor._y,i=this._width*(1-this._anchor._x),n=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,t,e,i,n)},r.prototype.getLocalBounds=function(t){return 0===this.children.length?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new g.Rectangle),t=this._localBoundsRect),this._bounds.getRectangle(t)):o.prototype.getLocalBounds.call(this,t)},r.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,a);var e=this._width,i=this._height,n=-e*this.anchor._x;if(a.x>=n&&a.x<n+e){var o=-i*this.anchor._y;if(a.y>=o&&a.y<o+i)return!0}return!1},r.prototype.destroy=function(t){o.prototype.destroy.call(this,t),this.tileTransform=null,this.uvTransform=null},r.from=function(t,e,i){return new r(g.Texture.from(t),e,i)},r.fromFrame=function(t,e,i){var n=g.utils.TextureCache[t];if(!n)throw new Error('The frameId "'+t+'" does not exist in the texture cache '+this);return new r(n,e,i)},r.fromImage=function(t,e,i,n,o){return new r(g.Texture.fromImage(t,n,o),e,i)},s(r,[{key:"clampMargin",get:function(){return this.uvTransform.clampMargin},set:function(t){this.uvTransform.clampMargin=t,this.uvTransform.update(!0)}},{key:"tileScale",get:function(){return this.tileTransform.scale},set:function(t){this.tileTransform.scale.copy(t)}},{key:"tilePosition",get:function(){return this.tileTransform.position},set:function(t){this.tileTransform.position.copy(t)}},{key:"width",get:function(){return this._width},set:function(t){this._width=t}},{key:"height",get:function(){return this._height},set:function(t){this._height=t}}]),r}(g.Sprite);i.default=r},{"../core":65,"../core/sprites/canvas/CanvasTinter":104}],138:[function(t,e,i){var u=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}}(t("../core")),c=n(t("../core/textures/Texture")),p=n(t("../core/textures/BaseTexture")),m=t("../core/utils");function n(t){return t&&t.__esModule?t:{default:t}}var o=u.DisplayObject,f=new u.Matrix;o.prototype._cacheAsBitmap=!1,o.prototype._cacheData=!1;var r=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.textureCacheId=null,this.originalRenderWebGL=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalHitTest=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.sprite=null};Object.defineProperties(o.prototype,{cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(t){if(this._cacheAsBitmap!==t){var e=void 0;(this._cacheAsBitmap=t)?(this._cacheData||(this._cacheData=new r),(e=this._cacheData).originalRenderWebGL=this.renderWebGL,e.originalRenderCanvas=this.renderCanvas,e.originalUpdateTransform=this.updateTransform,e.originalCalculateBounds=this._calculateBounds,e.originalGetLocalBounds=this.getLocalBounds,e.originalDestroy=this.destroy,e.originalContainsPoint=this.containsPoint,e.originalMask=this._mask,e.originalFilterArea=this.filterArea,this.renderWebGL=this._renderCachedWebGL,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):((e=this._cacheData).sprite&&this._destroyCachedDisplayObject(),this.renderWebGL=e.originalRenderWebGL,this.renderCanvas=e.originalRenderCanvas,this._calculateBounds=e.originalCalculateBounds,this.getLocalBounds=e.originalGetLocalBounds,this.destroy=e.originalDestroy,this.updateTransform=e.originalUpdateTransform,this.containsPoint=e.originalContainsPoint,this._mask=e.originalMask,this.filterArea=e.originalFilterArea)}}}}),o.prototype._renderCachedWebGL=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cacheData.sprite._transformID=-1,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderWebGL(t))},o.prototype._initCachedDisplayObject=function(t){if(!this._cacheData||!this._cacheData.sprite){var e=this.alpha;this.alpha=1,t.currentRenderer.flush();var i=this.getLocalBounds().clone();if(this._filters&&this._filters.length){var n=this._filters[0].padding;i.pad(n)}var o=t._activeRenderTarget,r=t.filterManager.filterStack,s=u.RenderTexture.create(0|i.width,0|i.height),a="cacheAsBitmap_"+(0,m.uid)();this._cacheData.textureCacheId=a,p.default.addToCache(s.baseTexture,a),c.default.addToCache(s,a);var l=f;l.tx=-i.x,l.ty=-i.y,this.transform.worldTransform.identity(),this.renderWebGL=this._cacheData.originalRenderWebGL,t.render(this,s,!0,l,!0),t.bindRenderTarget(o),t.filterManager.filterStack=r,this.renderWebGL=this._renderCachedWebGL,this.updateTransform=this.displayObjectUpdateTransform,this._mask=null,this.filterArea=null;var h=new u.Sprite(s);h.transform.worldTransform=this.transform.worldTransform,h.anchor.x=-i.x/i.width,h.anchor.y=-i.y/i.height,h.alpha=e,h._bounds=this._bounds,this._calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._cacheData.sprite=h,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=h.containsPoint.bind(h)}},o.prototype._renderCachedCanvas=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite.renderCanvas(t))},o.prototype._initCachedDisplayObjectCanvas=function(t){if(!this._cacheData||!this._cacheData.sprite){var e=this.getLocalBounds(),i=this.alpha;this.alpha=1;var n=t.context,o=u.RenderTexture.create(0|e.width,0|e.height),r="cacheAsBitmap_"+(0,m.uid)();this._cacheData.textureCacheId=r,p.default.addToCache(o.baseTexture,r),c.default.addToCache(o,r);var s=f;this.transform.localTransform.copy(s),s.invert(),s.tx-=e.x,s.ty-=e.y,this.renderCanvas=this._cacheData.originalRenderCanvas,t.render(this,o,!0,s,!1),t.context=n,this.renderCanvas=this._renderCachedCanvas,this._calculateBounds=this._calculateCachedBounds,this._mask=null,this.filterArea=null;var a=new u.Sprite(o);a.transform.worldTransform=this.transform.worldTransform,a.anchor.x=-e.x/e.width,a.anchor.y=-e.y/e.height,a._bounds=this._bounds,a.alpha=i,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.updateTransform=this.displayObjectUpdateTransform,this._cacheData.sprite=a,this.containsPoint=a.containsPoint.bind(a)}},o.prototype._calculateCachedBounds=function(){this._cacheData.sprite._calculateBounds()},o.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds()},o.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,p.default.removeFromCache(this._cacheData.textureCacheId),c.default.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null},o.prototype._cacheAsBitmapDestroy=function(t){this.cacheAsBitmap=!1,this.destroy(t)}},{"../core":65,"../core/textures/BaseTexture":112,"../core/textures/Texture":115,"../core/utils":125}],139:[function(t,e,i){var n=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}}(t("../core"));n.DisplayObject.prototype.name=null,n.Container.prototype.getChildByName=function(t){for(var e=0;e<this.children.length;e++)if(this.children[e].name===t)return this.children[e];return null}},{"../core":65}],140:[function(t,e,i){var n=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}}(t("../core"));n.DisplayObject.prototype.getGlobalPosition=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new n.Point,e=1<arguments.length&&void 0!==arguments[1]&&arguments[1];return this.parent?this.parent.toGlobal(this.position,t,e):(t.x=this.position.x,t.y=this.position.y),t}},{"../core":65}],141:[function(t,e,i){i.__esModule=!0,i.BitmapText=i.TilingSpriteRenderer=i.TilingSprite=i.AnimatedSprite=void 0;var n=t("./AnimatedSprite");Object.defineProperty(i,"AnimatedSprite",{enumerable:!0,get:function(){return a(n).default}});var o=t("./TilingSprite");Object.defineProperty(i,"TilingSprite",{enumerable:!0,get:function(){return a(o).default}});var r=t("./webgl/TilingSpriteRenderer");Object.defineProperty(i,"TilingSpriteRenderer",{enumerable:!0,get:function(){return a(r).default}});var s=t("./BitmapText");function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(i,"BitmapText",{enumerable:!0,get:function(){return a(s).default}}),t("./cacheAsBitmap"),t("./getChildByName"),t("./getGlobalPosition")},{"./AnimatedSprite":135,"./BitmapText":136,"./TilingSprite":137,"./cacheAsBitmap":138,"./getChildByName":139,"./getGlobalPosition":140,"./webgl/TilingSpriteRenderer":142}],142:[function(t,e,i){i.__esModule=!0;var f=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}}(t("../../core")),d=t("../../core/const");t("path");var _=new f.Matrix,n=function(i){function n(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n);var e=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,i.call(this,t));return e.shader=null,e.simpleShader=null,e.quad=null,e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(n,i),n.prototype.onContextChange=function(){var t=this.renderer.gl;this.shader=new f.Shader(t,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n","varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = mod(vTextureCoord - uClampOffset, vec2(1.0, 1.0)) + uClampOffset;\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    vec4 sample = texture2D(uSampler, coord);\n    gl_FragColor = sample * uColor;\n}\n"),this.simpleShader=new f.Shader(t,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n","varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\n\nvoid main(void)\n{\n    vec4 sample = texture2D(uSampler, vTextureCoord);\n    gl_FragColor = sample * uColor;\n}\n"),this.renderer.bindVao(null),this.quad=new f.Quad(t,this.renderer.state.attribState),this.quad.initVao(this.shader)},n.prototype.render=function(t){var e=this.renderer,i=this.quad;e.bindVao(i.vao);var n=i.vertices;n[0]=n[6]=t._width*-t.anchor.x,n[1]=n[3]=t._height*-t.anchor.y,n[2]=n[4]=t._width*(1-t.anchor.x),n[5]=n[7]=t._height*(1-t.anchor.y),t.uvRespectAnchor&&((n=i.uvs)[0]=n[6]=-t.anchor.x,n[1]=n[3]=-t.anchor.y,n[2]=n[4]=1-t.anchor.x,n[5]=n[7]=1-t.anchor.y),i.upload();var o=t._texture,r=o.baseTexture,s=t.tileTransform.localTransform,a=t.uvTransform,l=r.isPowerOfTwo&&o.frame.width===r.width&&o.frame.height===r.height;l&&(r._glTextures[e.CONTEXT_UID]?l=r.wrapMode!==d.WRAP_MODES.CLAMP:r.wrapMode===d.WRAP_MODES.CLAMP&&(r.wrapMode=d.WRAP_MODES.REPEAT));var h=l?this.simpleShader:this.shader;e.bindShader(h);var u=o.width,c=o.height,p=t._width,m=t._height;_.set(s.a*u/p,s.b*u/m,s.c*c/p,s.d*c/m,s.tx/p,s.ty/m),_.invert(),l?_.prepend(a.mapCoord):(h.uniforms.uMapCoord=a.mapCoord.toArray(!0),h.uniforms.uClampFrame=a.uClampFrame,h.uniforms.uClampOffset=a.uClampOffset),h.uniforms.uTransform=_.toArray(!0),h.uniforms.uColor=f.utils.premultiplyTintToRgba(t.tint,t.worldAlpha,h.uniforms.uColor,r.premultipliedAlpha),h.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),h.uniforms.uSampler=e.bindTexture(o),e.setBlendMode(f.utils.correctBlendMode(t.blendMode,r.premultipliedAlpha)),i.vao.draw(this.renderer.gl.TRIANGLES,6,0)},n}(f.ObjectRenderer);i.default=n,f.WebGLRenderer.registerPlugin("tilingSprite",n)},{"../../core":65,"../../core/const":46,path:8}],143:[function(t,e,i){i.__esModule=!0;var o=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),n=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}}(t("../../core"));t("path");var r=function(i){function n(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n);var e=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,i.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float uAlpha;\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;\n}\n"));return e.alpha=t,e.glShaderKey="alpha",e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(n,i),o(n,[{key:"alpha",get:function(){return this.uniforms.uAlpha},set:function(t){this.uniforms.uAlpha=t}}]),n}(n.Filter);i.default=r},{"../../core":65,path:8}],144:[function(t,e,i){i.__esModule=!0;var n=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),a=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}}(t("../../core")),l=o(t("./BlurXFilter")),h=o(t("./BlurYFilter"));function o(t){return t&&t.__esModule?t:{default:t}}var r=function(r){function s(t,e,i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,r.call(this));return o.blurXFilter=new l.default(t,e,i,n),o.blurYFilter=new h.default(t,e,i,n),o.padding=0,o.resolution=i||a.settings.RESOLUTION,o.quality=e||4,o.blur=t||8,o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(s,r),s.prototype.apply=function(t,e,i){var n=t.getRenderTarget(!0);this.blurXFilter.apply(t,e,n,!0),this.blurYFilter.apply(t,n,i,!1),t.returnRenderTarget(n)},n(s,[{key:"blur",get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=this.blurYFilter.blur=t,this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))}},{key:"quality",get:function(){return this.blurXFilter.quality},set:function(t){this.blurXFilter.quality=this.blurYFilter.quality=t}},{key:"blurX",get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=t,this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))}},{key:"blurY",get:function(){return this.blurYFilter.blur},set:function(t){this.blurYFilter.blur=t,this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))}},{key:"blendMode",get:function(){return this.blurYFilter._blendMode},set:function(t){this.blurYFilter._blendMode=t}}]),s}(a.Filter);i.default=r},{"../../core":65,"./BlurXFilter":145,"./BlurYFilter":146}],145:[function(t,e,i){i.__esModule=!0;var n=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),h=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}}(t("../../core")),c=o(t("./generateBlurVertSource")),p=o(t("./generateBlurFragSource")),m=o(t("./getMaxBlurKernelSize"));function o(t){return t&&t.__esModule?t:{default:t}}var r=function(a){function l(t,e,i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),n=n||5;var o=(0,c.default)(n,!0),r=(0,p.default)(n),s=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,a.call(this,o,r));return s.resolution=i||h.settings.RESOLUTION,s._quality=0,s.quality=e||4,s.strength=t||8,s.firstRun=!0,s}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(l,a),l.prototype.apply=function(t,e,i,n){if(this.firstRun){var o=t.renderer.gl,r=(0,m.default)(o);this.vertexSrc=(0,c.default)(r,!0),this.fragmentSrc=(0,p.default)(r),this.firstRun=!1}if(this.uniforms.strength=1/i.size.width*(i.size.width/e.size.width),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,1===this.passes)t.applyFilter(this,e,i,n);else{for(var s=t.getRenderTarget(!0),a=e,l=s,h=0;h<this.passes-1;h++){t.applyFilter(this,a,l,!0);var u=l;l=a,a=u}t.applyFilter(this,a,i,n),t.returnRenderTarget(s)}},n(l,[{key:"blur",get:function(){return this.strength},set:function(t){this.padding=2*Math.abs(t),this.strength=t}},{key:"quality",get:function(){return this._quality},set:function(t){this._quality=t,this.passes=t}}]),l}(h.Filter);i.default=r},{"../../core":65,"./generateBlurFragSource":147,"./generateBlurVertSource":148,"./getMaxBlurKernelSize":149}],146:[function(t,e,i){i.__esModule=!0;var n=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),h=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}}(t("../../core")),c=o(t("./generateBlurVertSource")),p=o(t("./generateBlurFragSource")),m=o(t("./getMaxBlurKernelSize"));function o(t){return t&&t.__esModule?t:{default:t}}var r=function(a){function l(t,e,i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),n=n||5;var o=(0,c.default)(n,!1),r=(0,p.default)(n),s=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,a.call(this,o,r));return s.resolution=i||h.settings.RESOLUTION,s._quality=0,s.quality=e||4,s.strength=t||8,s.firstRun=!0,s}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(l,a),l.prototype.apply=function(t,e,i,n){if(this.firstRun){var o=t.renderer.gl,r=(0,m.default)(o);this.vertexSrc=(0,c.default)(r,!1),this.fragmentSrc=(0,p.default)(r),this.firstRun=!1}if(this.uniforms.strength=1/i.size.height*(i.size.height/e.size.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,1===this.passes)t.applyFilter(this,e,i,n);else{for(var s=t.getRenderTarget(!0),a=e,l=s,h=0;h<this.passes-1;h++){t.applyFilter(this,a,l,!0);var u=l;l=a,a=u}t.applyFilter(this,a,i,n),t.returnRenderTarget(s)}},n(l,[{key:"blur",get:function(){return this.strength},set:function(t){this.padding=2*Math.abs(t),this.strength=t}},{key:"quality",get:function(){return this._quality},set:function(t){this._quality=t,this.passes=t}}]),l}(h.Filter);i.default=r},{"../../core":65,"./generateBlurFragSource":147,"./generateBlurVertSource":148,"./getMaxBlurKernelSize":149}],147:[function(t,e,i){i.__esModule=!0,i.default=function(t){for(var e=l[t],i=e.length,n=h,o="",r=void 0,s=0;s<t;s++){var a="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;".replace("%index%",s);i<=(r=s)&&(r=t-s-1),a=a.replace("%value%",e[r]),o+=a,o+="\n"}return n=(n=n.replace("%blur%",o)).replace("%size%",t)};var l={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},h=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join("\n")},{}],148:[function(t,e,i){i.__esModule=!0,i.default=function(t,e){var i=Math.ceil(t/2),n=l,o="",r=void 0;r=e?"vBlurTexCoords[%index%] = aTextureCoord + vec2(%sampleIndex% * strength, 0.0);":"vBlurTexCoords[%index%] = aTextureCoord + vec2(0.0, %sampleIndex% * strength);";for(var s=0;s<t;s++){var a=r.replace("%index%",s);a=a.replace("%sampleIndex%",s-(i-1)+".0"),o+=a,o+="\n"}return n=(n=n.replace("%blur%",o)).replace("%size%",t)};var l=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","uniform float strength;","uniform mat3 projectionMatrix;","varying vec2 vBlurTexCoords[%size%];","void main(void)","{","gl_Position = vec4((projectionMatrix * vec3((aVertexPosition), 1.0)).xy, 0.0, 1.0);","%blur%","}"].join("\n")},{}],149:[function(t,e,i){i.__esModule=!0,i.default=function(t){var e=t.getParameter(t.MAX_VARYING_VECTORS),i=15;for(;e<i;)i-=2;return i}},{}],150:[function(t,e,i){i.__esModule=!0;var n=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),o=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}}(t("../../core"));t("path");var r=function(e){function i(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i);var t=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,e.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float m[20];\nuniform float uAlpha;\n\nvoid main(void)\n{\n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n    if (uAlpha == 0.0) {\n        gl_FragColor = c;\n        return;\n    }\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (c.a > 0.0) {\n      c.rgb /= c.a;\n    }\n\n    vec4 result;\n\n    result.r = (m[0] * c.r);\n        result.r += (m[1] * c.g);\n        result.r += (m[2] * c.b);\n        result.r += (m[3] * c.a);\n        result.r += m[4];\n\n    result.g = (m[5] * c.r);\n        result.g += (m[6] * c.g);\n        result.g += (m[7] * c.b);\n        result.g += (m[8] * c.a);\n        result.g += m[9];\n\n    result.b = (m[10] * c.r);\n       result.b += (m[11] * c.g);\n       result.b += (m[12] * c.b);\n       result.b += (m[13] * c.a);\n       result.b += m[14];\n\n    result.a = (m[15] * c.r);\n       result.a += (m[16] * c.g);\n       result.a += (m[17] * c.b);\n       result.a += (m[18] * c.a);\n       result.a += m[19];\n\n    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);\n\n    // Premultiply alpha again.\n    rgb *= result.a;\n\n    gl_FragColor = vec4(rgb, result.a);\n}\n"));return t.uniforms.m=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],t.alpha=1,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(i,e),i.prototype._loadMatrix=function(t){var e=t;1<arguments.length&&void 0!==arguments[1]&&arguments[1]&&(this._multiply(e,this.uniforms.m,t),e=this._colorMatrix(e)),this.uniforms.m=e},i.prototype._multiply=function(t,e,i){return t[0]=e[0]*i[0]+e[1]*i[5]+e[2]*i[10]+e[3]*i[15],t[1]=e[0]*i[1]+e[1]*i[6]+e[2]*i[11]+e[3]*i[16],t[2]=e[0]*i[2]+e[1]*i[7]+e[2]*i[12]+e[3]*i[17],t[3]=e[0]*i[3]+e[1]*i[8]+e[2]*i[13]+e[3]*i[18],t[4]=e[0]*i[4]+e[1]*i[9]+e[2]*i[14]+e[3]*i[19]+e[4],t[5]=e[5]*i[0]+e[6]*i[5]+e[7]*i[10]+e[8]*i[15],t[6]=e[5]*i[1]+e[6]*i[6]+e[7]*i[11]+e[8]*i[16],t[7]=e[5]*i[2]+e[6]*i[7]+e[7]*i[12]+e[8]*i[17],t[8]=e[5]*i[3]+e[6]*i[8]+e[7]*i[13]+e[8]*i[18],t[9]=e[5]*i[4]+e[6]*i[9]+e[7]*i[14]+e[8]*i[19]+e[9],t[10]=e[10]*i[0]+e[11]*i[5]+e[12]*i[10]+e[13]*i[15],t[11]=e[10]*i[1]+e[11]*i[6]+e[12]*i[11]+e[13]*i[16],t[12]=e[10]*i[2]+e[11]*i[7]+e[12]*i[12]+e[13]*i[17],t[13]=e[10]*i[3]+e[11]*i[8]+e[12]*i[13]+e[13]*i[18],t[14]=e[10]*i[4]+e[11]*i[9]+e[12]*i[14]+e[13]*i[19]+e[14],t[15]=e[15]*i[0]+e[16]*i[5]+e[17]*i[10]+e[18]*i[15],t[16]=e[15]*i[1]+e[16]*i[6]+e[17]*i[11]+e[18]*i[16],t[17]=e[15]*i[2]+e[16]*i[7]+e[17]*i[12]+e[18]*i[17],t[18]=e[15]*i[3]+e[16]*i[8]+e[17]*i[13]+e[18]*i[18],t[19]=e[15]*i[4]+e[16]*i[9]+e[17]*i[14]+e[18]*i[19]+e[19],t},i.prototype._colorMatrix=function(t){var e=new Float32Array(t);return e[4]/=255,e[9]/=255,e[14]/=255,e[19]/=255,e},i.prototype.brightness=function(t,e){var i=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(i,e)},i.prototype.greyscale=function(t,e){var i=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(i,e)},i.prototype.blackAndWhite=function(t){this._loadMatrix([.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],t)},i.prototype.hue=function(t,e){t=(t||0)/180*Math.PI;var i=Math.cos(t),n=Math.sin(t),o=(0,Math.sqrt)(1/3),r=[i+1/3*(1-i),1/3*(1-i)-o*n,1/3*(1-i)+o*n,0,0,1/3*(1-i)+o*n,i+1/3*(1-i),1/3*(1-i)-o*n,0,0,1/3*(1-i)-o*n,1/3*(1-i)+o*n,i+1/3*(1-i),0,0,0,0,0,1,0];this._loadMatrix(r,e)},i.prototype.contrast=function(t,e){var i=(t||0)+1,n=-.5*(i-1),o=[i,0,0,0,n,0,i,0,0,n,0,0,i,0,n,0,0,0,1,0];this._loadMatrix(o,e)},i.prototype.saturate=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,e=arguments[1],i=2*t/3+1,n=-.5*(i-1),o=[i,n,n,0,0,n,i,n,0,0,n,n,i,0,0,0,0,0,1,0];this._loadMatrix(o,e)},i.prototype.desaturate=function(){this.saturate(-1)},i.prototype.negative=function(t){this._loadMatrix([-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0],t)},i.prototype.sepia=function(t){this._loadMatrix([.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],t)},i.prototype.technicolor=function(t){this._loadMatrix([1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],t)},i.prototype.polaroid=function(t){this._loadMatrix([1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],t)},i.prototype.toBGR=function(t){this._loadMatrix([0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],t)},i.prototype.kodachrome=function(t){this._loadMatrix([1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0],t)},i.prototype.browni=function(t){this._loadMatrix([.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],t)},i.prototype.vintage=function(t){this._loadMatrix([.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],t)},i.prototype.colorTone=function(t,e,i,n,o){var r=((i=i||16770432)>>16&255)/255,s=(i>>8&255)/255,a=(255&i)/255,l=((n=n||3375104)>>16&255)/255,h=(n>>8&255)/255,u=(255&n)/255,c=[.3,.59,.11,0,0,r,s,a,t=t||.2,0,l,h,u,e=e||.15,0,r-l,s-h,a-u,0,0];this._loadMatrix(c,o)},i.prototype.night=function(t,e){var i=[-2*(t=t||.1),-t,0,0,0,-t,0,t,0,0,0,t,2*t,0,0,0,0,0,1,0];this._loadMatrix(i,e)},i.prototype.predator=function(t,e){var i=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(i,e)},i.prototype.lsd=function(t){this._loadMatrix([2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],t)},i.prototype.reset=function(){this._loadMatrix([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],!1)},n(i,[{key:"matrix",get:function(){return this.uniforms.m},set:function(t){this.uniforms.m=t}},{key:"alpha",get:function(){return this.uniforms.uAlpha},set:function(t){this.uniforms.uAlpha=t}}]),i}(o.Filter);(i.default=r).prototype.grayscale=r.prototype.greyscale},{"../../core":65,path:8}],151:[function(t,e,i){i.__esModule=!0;var n=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),s=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}}(t("../../core"));t("path");var o=function(o){function r(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r);var i=new s.Matrix;t.renderable=!1;var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,o.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 filterMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\n\nvoid main(void)\n{\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vFilterCoord = ( filterMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n   vTextureCoord = aTextureCoord;\n}","varying vec2 vFilterCoord;\nvarying vec2 vTextureCoord;\n\nuniform vec2 scale;\n\nuniform sampler2D uSampler;\nuniform sampler2D mapSampler;\n\nuniform vec4 filterArea;\nuniform vec4 filterClamp;\n\nvoid main(void)\n{\n  vec4 map =  texture2D(mapSampler, vFilterCoord);\n\n  map -= 0.5;\n  map.xy *= scale / filterArea.xy;\n\n  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), filterClamp.xy, filterClamp.zw));\n}\n"));return n.maskSprite=t,n.maskMatrix=i,n.uniforms.mapSampler=t._texture,n.uniforms.filterMatrix=i,n.uniforms.scale={x:1,y:1},null==e&&(e=20),n.scale=new s.Point(e,e),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(r,o),r.prototype.apply=function(t,e,i){this.uniforms.filterMatrix=t.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y,t.applyFilter(this,e,i)},n(r,[{key:"map",get:function(){return this.uniforms.mapSampler},set:function(t){this.uniforms.mapSampler=t}}]),r}(s.Filter);i.default=o},{"../../core":65,path:8}],152:[function(t,e,i){i.__esModule=!0;var n=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}}(t("../../core"));t("path");var o=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,"\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nuniform vec4 filterArea;\n\nvarying vec2 vTextureCoord;\n\nvec2 mapCoord( vec2 coord )\n{\n    coord *= filterArea.xy;\n    coord += filterArea.zw;\n\n    return coord;\n}\n\nvec2 unmapCoord( vec2 coord )\n{\n    coord -= filterArea.zw;\n    coord /= filterArea.xy;\n\n    return coord;\n}\n\nvoid texcoords(vec2 fragCoord, vec2 resolution,\n               out vec2 v_rgbNW, out vec2 v_rgbNE,\n               out vec2 v_rgbSW, out vec2 v_rgbSE,\n               out vec2 v_rgbM) {\n    vec2 inverseVP = 1.0 / resolution.xy;\n    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n    v_rgbM = vec2(fragCoord * inverseVP);\n}\n\nvoid main(void) {\n\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n   vTextureCoord = aTextureCoord;\n\n   vec2 fragCoord = vTextureCoord * filterArea.xy;\n\n   texcoords(fragCoord, filterArea.xy, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n}",'varying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec4 filterArea;\n\n/**\n Basic FXAA implementation based on the code on geeks3d.com with the\n modification that the texture2DLod stuff was removed since it\'s\n unsupported by WebGL.\n \n --\n \n From:\n https://github.com/mitsuhiko/webgl-meincraft\n \n Copyright (c) 2011 by Armin Ronacher.\n \n Some rights reserved.\n \n Redistribution and use in source and binary forms, with or without\n modification, are permitted provided that the following conditions are\n met:\n \n * Redistributions of source code must retain the above copyright\n notice, this list of conditions and the following disclaimer.\n \n * Redistributions in binary form must reproduce the above\n copyright notice, this list of conditions and the following\n disclaimer in the documentation and/or other materials provided\n with the distribution.\n \n * The names of the contributors may not be used to endorse or\n promote products derived from this software without specific\n prior written permission.\n \n THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n#ifndef FXAA_REDUCE_MIN\n#define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n#define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n#define FXAA_SPAN_MAX     8.0\n#endif\n\n//optimized version for mobile, where dependent\n//texture reads can be a bottleneck\nvec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 resolution,\n          vec2 v_rgbNW, vec2 v_rgbNE,\n          vec2 v_rgbSW, vec2 v_rgbSE,\n          vec2 v_rgbM) {\n    vec4 color;\n    mediump vec2 inverseVP = vec2(1.0 / resolution.x, 1.0 / resolution.y);\n    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\n    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\n    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\n    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\n    vec4 texColor = texture2D(tex, v_rgbM);\n    vec3 rgbM  = texColor.xyz;\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n    \n    mediump vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n    \n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n    \n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n                  dir * rcpDirMin)) * inverseVP;\n    \n    vec3 rgbA = 0.5 * (\n                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\n                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\n                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\n    \n    float lumaB = dot(rgbB, luma);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, texColor.a);\n    else\n        color = vec4(rgbB, texColor.a);\n    return color;\n}\n\nvoid main() {\n\n      vec2 fragCoord = vTextureCoord * filterArea.xy;\n\n      vec4 color;\n\n    color = fxaa(uSampler, fragCoord, filterArea.xy, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n\n      gl_FragColor = color;\n}\n'))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e}(n.Filter);i.default=o},{"../../core":65,path:8}],153:[function(t,e,i){i.__esModule=!0;var n=t("./fxaa/FXAAFilter");Object.defineProperty(i,"FXAAFilter",{enumerable:!0,get:function(){return c(n).default}});var o=t("./noise/NoiseFilter");Object.defineProperty(i,"NoiseFilter",{enumerable:!0,get:function(){return c(o).default}});var r=t("./displacement/DisplacementFilter");Object.defineProperty(i,"DisplacementFilter",{enumerable:!0,get:function(){return c(r).default}});var s=t("./blur/BlurFilter");Object.defineProperty(i,"BlurFilter",{enumerable:!0,get:function(){return c(s).default}});var a=t("./blur/BlurXFilter");Object.defineProperty(i,"BlurXFilter",{enumerable:!0,get:function(){return c(a).default}});var l=t("./blur/BlurYFilter");Object.defineProperty(i,"BlurYFilter",{enumerable:!0,get:function(){return c(l).default}});var h=t("./colormatrix/ColorMatrixFilter");Object.defineProperty(i,"ColorMatrixFilter",{enumerable:!0,get:function(){return c(h).default}});var u=t("./alpha/AlphaFilter");function c(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(i,"AlphaFilter",{enumerable:!0,get:function(){return c(u).default}})},{"./alpha/AlphaFilter":143,"./blur/BlurFilter":144,"./blur/BlurXFilter":145,"./blur/BlurYFilter":146,"./colormatrix/ColorMatrixFilter":150,"./displacement/DisplacementFilter":151,"./fxaa/FXAAFilter":152,"./noise/NoiseFilter":154}],154:[function(t,e,i){i.__esModule=!0;var r=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),n=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}}(t("../../core"));t("path");var o=function(n){function o(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:.5,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:Math.random();!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,n.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","precision highp float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform float uNoise;\nuniform float uSeed;\nuniform sampler2D uSampler;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main()\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n    float randomValue = rand(gl_FragCoord.xy * uSeed);\n    float diff = (randomValue - 0.5) * uNoise;\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (color.a > 0.0) {\n        color.rgb /= color.a;\n    }\n\n    color.r += diff;\n    color.g += diff;\n    color.b += diff;\n\n    // Premultiply alpha again.\n    color.rgb *= color.a;\n\n    gl_FragColor = color;\n}\n"));return i.noise=t,i.seed=e,i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(o,n),r(o,[{key:"noise",get:function(){return this.uniforms.uNoise},set:function(t){this.uniforms.uNoise=t}},{key:"seed",get:function(){return this.uniforms.uSeed},set:function(t){this.uniforms.uSeed=t}}]),o}(n.Filter);i.default=o},{"../../core":65,path:8}],155:[function(t,e,i){i.__esModule=!0;var n=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),o=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}}(t("../core"));var r=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.global=new o.Point,this.target=null,this.originalEvent=null,this.identifier=null,this.isPrimary=!1,this.button=0,this.buttons=0,this.width=0,this.height=0,this.tiltX=0,this.tiltY=0,this.pointerType=null,this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0}return t.prototype.getLocalPosition=function(t,e,i){return t.worldTransform.applyInverse(i||this.global,e)},t.prototype.copyEvent=function(t){t.isPrimary&&(this.isPrimary=!0),this.button=t.button,this.buttons=Number.isInteger(t.buttons)?t.buttons:t.which,this.width=t.width,this.height=t.height,this.tiltX=t.tiltX,this.tiltY=t.tiltY,this.pointerType=t.pointerType,this.pressure=t.pressure,this.rotationAngle=t.rotationAngle,this.twist=t.twist||0,this.tangentialPressure=t.tangentialPressure||0},t.prototype.reset=function(){this.isPrimary=!1},n(t,[{key:"pointerId",get:function(){return this.identifier}}]),t}();i.default=r},{"../core":65}],156:[function(t,e,i){i.__esModule=!0;var n=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.stopped=!1,this.target=null,this.currentTarget=null,this.type=null,this.data=null}return t.prototype.stopPropagation=function(){this.stopped=!0},t.prototype.reset=function(){this.stopped=!1,this.currentTarget=null,this.target=null},t}();i.default=n},{}],157:[function(t,e,i){i.__esModule=!0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}}(t("../core")),a=h(t("./InteractionData")),l=h(t("./InteractionEvent")),m=h(t("./InteractionTrackingData")),n=h(t("eventemitter3")),o=h(t("./interactiveTarget"));function h(t){return t&&t.__esModule?t:{default:t}}s.utils.mixins.delayMixin(s.DisplayObject.prototype,o.default);var u={target:null,data:{global:null}},c=function(n){function o(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,n.call(this));return e=e||{},i.renderer=t,i.autoPreventDefault=void 0===e.autoPreventDefault||e.autoPreventDefault,i.interactionFrequency=e.interactionFrequency||10,i.mouse=new a.default,i.mouse.identifier=1,i.mouse.global.set(-999999),i.activeInteractionData={},i.activeInteractionData[1]=i.mouse,i.interactionDataPool=[],i.eventData=new l.default,i.interactionDOMElement=null,i.moveWhenInside=!1,i.eventsAdded=!1,i.mouseOverRenderer=!1,i.supportsTouchEvents="ontouchstart"in window,i.supportsPointerEvents=!!window.PointerEvent,i.onPointerUp=i.onPointerUp.bind(i),i.processPointerUp=i.processPointerUp.bind(i),i.onPointerCancel=i.onPointerCancel.bind(i),i.processPointerCancel=i.processPointerCancel.bind(i),i.onPointerDown=i.onPointerDown.bind(i),i.processPointerDown=i.processPointerDown.bind(i),i.onPointerMove=i.onPointerMove.bind(i),i.processPointerMove=i.processPointerMove.bind(i),i.onPointerOut=i.onPointerOut.bind(i),i.processPointerOverOut=i.processPointerOverOut.bind(i),i.onPointerOver=i.onPointerOver.bind(i),i.cursorStyles={default:"inherit",pointer:"pointer"},i.currentCursorMode=null,i.cursor=null,i._tempPoint=new s.Point,i.resolution=1,i.setTargetElement(i.renderer.view,i.renderer.resolution),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(o,n),o.prototype.hitTest=function(t,e){return u.target=null,u.data.global=t,e||(e=this.renderer._lastObjectRendered),this.processInteractive(u,e,null,!0),u.target},o.prototype.setTargetElement=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;this.removeEvents(),this.interactionDOMElement=t,this.resolution=e,this.addEvents()},o.prototype.addEvents=function(){this.interactionDOMElement&&(s.ticker.shared.add(this.update,this,s.UPDATE_PRIORITY.INTERACTION),window.navigator.msPointerEnabled?(this.interactionDOMElement.style["-ms-content-zooming"]="none",this.interactionDOMElement.style["-ms-touch-action"]="none"):this.supportsPointerEvents&&(this.interactionDOMElement.style["touch-action"]="none"),this.supportsPointerEvents?(window.document.addEventListener("pointermove",this.onPointerMove,!0),this.interactionDOMElement.addEventListener("pointerdown",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("pointerleave",this.onPointerOut,!0),this.interactionDOMElement.addEventListener("pointerover",this.onPointerOver,!0),window.addEventListener("pointercancel",this.onPointerCancel,!0),window.addEventListener("pointerup",this.onPointerUp,!0)):(window.document.addEventListener("mousemove",this.onPointerMove,!0),this.interactionDOMElement.addEventListener("mousedown",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("mouseout",this.onPointerOut,!0),this.interactionDOMElement.addEventListener("mouseover",this.onPointerOver,!0),window.addEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.interactionDOMElement.addEventListener("touchstart",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("touchcancel",this.onPointerCancel,!0),this.interactionDOMElement.addEventListener("touchend",this.onPointerUp,!0),this.interactionDOMElement.addEventListener("touchmove",this.onPointerMove,!0)),this.eventsAdded=!0)},o.prototype.removeEvents=function(){this.interactionDOMElement&&(s.ticker.shared.remove(this.update,this),window.navigator.msPointerEnabled?(this.interactionDOMElement.style["-ms-content-zooming"]="",this.interactionDOMElement.style["-ms-touch-action"]=""):this.supportsPointerEvents&&(this.interactionDOMElement.style["touch-action"]=""),this.supportsPointerEvents?(window.document.removeEventListener("pointermove",this.onPointerMove,!0),this.interactionDOMElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("pointerleave",this.onPointerOut,!0),this.interactionDOMElement.removeEventListener("pointerover",this.onPointerOver,!0),window.removeEventListener("pointercancel",this.onPointerCancel,!0),window.removeEventListener("pointerup",this.onPointerUp,!0)):(window.document.removeEventListener("mousemove",this.onPointerMove,!0),this.interactionDOMElement.removeEventListener("mousedown",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("mouseout",this.onPointerOut,!0),this.interactionDOMElement.removeEventListener("mouseover",this.onPointerOver,!0),window.removeEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.interactionDOMElement.removeEventListener("touchstart",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("touchcancel",this.onPointerCancel,!0),this.interactionDOMElement.removeEventListener("touchend",this.onPointerUp,!0),this.interactionDOMElement.removeEventListener("touchmove",this.onPointerMove,!0)),this.interactionDOMElement=null,this.eventsAdded=!1)},o.prototype.update=function(t){if(this._deltaTime+=t,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.interactionDOMElement))if(this.didMove)this.didMove=!1;else{for(var e in this.cursor=null,this.activeInteractionData)if(this.activeInteractionData.hasOwnProperty(e)){var i=this.activeInteractionData[e];if(i.originalEvent&&"touch"!==i.pointerType){var n=this.configureInteractionEventForDOMEvent(this.eventData,i.originalEvent,i);this.processInteractive(n,this.renderer._lastObjectRendered,this.processPointerOverOut,!0)}}this.setCursorMode(this.cursor)}},o.prototype.setCursorMode=function(t){if(t=t||"default",this.currentCursorMode!==t){this.currentCursorMode=t;var e=this.cursorStyles[t];if(e)switch(void 0===e?"undefined":r(e)){case"string":this.interactionDOMElement.style.cursor=e;break;case"function":e(t);break;case"object":Object.assign(this.interactionDOMElement.style,e)}else"string"!=typeof t||Object.prototype.hasOwnProperty.call(this.cursorStyles,t)||(this.interactionDOMElement.style.cursor=t)}},o.prototype.dispatchEvent=function(t,e,i){i.stopped||(i.currentTarget=t,i.type=e,t.emit(e,i),t[e]&&t[e](i))},o.prototype.mapPositionToPoint=function(t,e,i){var n=void 0;n=this.interactionDOMElement.parentElement?this.interactionDOMElement.getBoundingClientRect():{x:0,y:0,width:0,height:0};var o=navigator.isCocoonJS?this.resolution:1/this.resolution;t.x=(e-n.left)*(this.interactionDOMElement.width/n.width)*o,t.y=(i-n.top)*(this.interactionDOMElement.height/n.height)*o},o.prototype.processInteractive=function(t,e,i,n,o){if(!e||!e.visible)return!1;var r=t.data.global,s=!1,a=o=e.interactive||o,l=!0;if(e.hitArea?(n&&(e.worldTransform.applyInverse(r,this._tempPoint),e.hitArea.contains(this._tempPoint.x,this._tempPoint.y)?s=!0:l=n=!1),a=!1):e._mask&&n&&(e._mask.containsPoint(r)||(l=n=!1)),l&&e.interactiveChildren&&e.children)for(var h=e.children,u=h.length-1;0<=u;u--){var c=h[u],p=this.processInteractive(t,c,i,n,a);if(p){if(!c.parent)continue;a=!1,p&&(t.target&&(n=!1),s=!0)}}return o&&(n&&!t.target&&!e.hitArea&&e.containsPoint&&e.containsPoint(r)&&(s=!0),e.interactive&&(s&&!t.target&&(t.target=e),i&&i(t,e,!!s))),s},o.prototype.onPointerDown=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t);this.autoPreventDefault&&e[0].isNormalized&&t.preventDefault();for(var i=e.length,n=0;n<i;n++){var o=e[n],r=this.getInteractionDataForPointerId(o),s=this.configureInteractionEventForDOMEvent(this.eventData,o,r);if(s.data.originalEvent=t,this.processInteractive(s,this.renderer._lastObjectRendered,this.processPointerDown,!0),this.emit("pointerdown",s),"touch"===o.pointerType)this.emit("touchstart",s);else if("mouse"===o.pointerType||"pen"===o.pointerType){var a=2===o.button;this.emit(a?"rightdown":"mousedown",this.eventData)}}}},o.prototype.processPointerDown=function(t,e,i){var n=t.data,o=t.data.identifier;if(i)if(e.trackedPointers[o]||(e.trackedPointers[o]=new m.default(o)),this.dispatchEvent(e,"pointerdown",t),"touch"===n.pointerType)this.dispatchEvent(e,"touchstart",t);else if("mouse"===n.pointerType||"pen"===n.pointerType){var r=2===n.button;r?e.trackedPointers[o].rightDown=!0:e.trackedPointers[o].leftDown=!0,this.dispatchEvent(e,r?"rightdown":"mousedown",t)}},o.prototype.onPointerComplete=function(t,e,i){for(var n=this.normalizeToPointerData(t),o=n.length,r=t.target!==this.interactionDOMElement?"outside":"",s=0;s<o;s++){var a=n[s],l=this.getInteractionDataForPointerId(a),h=this.configureInteractionEventForDOMEvent(this.eventData,a,l);if(h.data.originalEvent=t,this.processInteractive(h,this.renderer._lastObjectRendered,i,e||!r),this.emit(e?"pointercancel":"pointerup"+r,h),"mouse"===a.pointerType||"pen"===a.pointerType){var u=2===a.button;this.emit(u?"rightup"+r:"mouseup"+r,h)}else"touch"===a.pointerType&&(this.emit(e?"touchcancel":"touchend"+r,h),this.releaseInteractionDataForPointerId(a.pointerId,l))}},o.prototype.onPointerCancel=function(t){this.supportsTouchEvents&&"touch"===t.pointerType||this.onPointerComplete(t,!0,this.processPointerCancel)},o.prototype.processPointerCancel=function(t,e){var i=t.data,n=t.data.identifier;void 0!==e.trackedPointers[n]&&(delete e.trackedPointers[n],this.dispatchEvent(e,"pointercancel",t),"touch"===i.pointerType&&this.dispatchEvent(e,"touchcancel",t))},o.prototype.onPointerUp=function(t){this.supportsTouchEvents&&"touch"===t.pointerType||this.onPointerComplete(t,!1,this.processPointerUp)},o.prototype.processPointerUp=function(t,e,i){var n=t.data,o=t.data.identifier,r=e.trackedPointers[o],s="touch"===n.pointerType,a="mouse"===n.pointerType||"pen"===n.pointerType,l=!1;if(a){var h=2===n.button,u=m.default.FLAGS,c=h?u.RIGHT_DOWN:u.LEFT_DOWN,p=void 0!==r&&r.flags&c;i?(this.dispatchEvent(e,h?"rightup":"mouseup",t),p&&(this.dispatchEvent(e,h?"rightclick":"click",t),l=!0)):p&&this.dispatchEvent(e,h?"rightupoutside":"mouseupoutside",t),r&&(h?r.rightDown=!1:r.leftDown=!1)}i?(this.dispatchEvent(e,"pointerup",t),s&&this.dispatchEvent(e,"touchend",t),r&&(a&&!l||this.dispatchEvent(e,"pointertap",t),s&&(this.dispatchEvent(e,"tap",t),r.over=!1))):r&&(this.dispatchEvent(e,"pointerupoutside",t),s&&this.dispatchEvent(e,"touchendoutside",t)),r&&r.none&&delete e.trackedPointers[o]},o.prototype.onPointerMove=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t);"mouse"!==e[0].pointerType&&"pen"!==e[0].pointerType||(this.didMove=!0,this.cursor=null);for(var i=e.length,n=0;n<i;n++){var o=e[n],r=this.getInteractionDataForPointerId(o),s=this.configureInteractionEventForDOMEvent(this.eventData,o,r);s.data.originalEvent=t;var a="touch"!==o.pointerType||this.moveWhenInside;this.processInteractive(s,this.renderer._lastObjectRendered,this.processPointerMove,a),this.emit("pointermove",s),"touch"===o.pointerType&&this.emit("touchmove",s),"mouse"!==o.pointerType&&"pen"!==o.pointerType||this.emit("mousemove",s)}"mouse"===e[0].pointerType&&this.setCursorMode(this.cursor)}},o.prototype.processPointerMove=function(t,e,i){var n=t.data,o="touch"===n.pointerType,r="mouse"===n.pointerType||"pen"===n.pointerType;r&&this.processPointerOverOut(t,e,i),this.moveWhenInside&&!i||(this.dispatchEvent(e,"pointermove",t),o&&this.dispatchEvent(e,"touchmove",t),r&&this.dispatchEvent(e,"mousemove",t))},o.prototype.onPointerOut=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t)[0];"mouse"===e.pointerType&&(this.mouseOverRenderer=!1,this.setCursorMode(null));var i=this.getInteractionDataForPointerId(e),n=this.configureInteractionEventForDOMEvent(this.eventData,e,i);n.data.originalEvent=e,this.processInteractive(n,this.renderer._lastObjectRendered,this.processPointerOverOut,!1),this.emit("pointerout",n),"mouse"===e.pointerType||"pen"===e.pointerType?this.emit("mouseout",n):this.releaseInteractionDataForPointerId(i.identifier)}},o.prototype.processPointerOverOut=function(t,e,i){var n=t.data,o=t.data.identifier,r="mouse"===n.pointerType||"pen"===n.pointerType,s=e.trackedPointers[o];i&&!s&&(s=e.trackedPointers[o]=new m.default(o)),void 0!==s&&(i&&this.mouseOverRenderer?(s.over||(s.over=!0,this.dispatchEvent(e,"pointerover",t),r&&this.dispatchEvent(e,"mouseover",t)),r&&null===this.cursor&&(this.cursor=e.cursor)):s.over&&(s.over=!1,this.dispatchEvent(e,"pointerout",this.eventData),r&&this.dispatchEvent(e,"mouseout",t),s.none&&delete e.trackedPointers[o]))},o.prototype.onPointerOver=function(t){var e=this.normalizeToPointerData(t)[0],i=this.getInteractionDataForPointerId(e),n=this.configureInteractionEventForDOMEvent(this.eventData,e,i);"mouse"===(n.data.originalEvent=e).pointerType&&(this.mouseOverRenderer=!0),this.emit("pointerover",n),"mouse"!==e.pointerType&&"pen"!==e.pointerType||this.emit("mouseover",n)},o.prototype.getInteractionDataForPointerId=function(t){var e=t.pointerId,i=void 0;return 1===e||"mouse"===t.pointerType?i=this.mouse:this.activeInteractionData[e]?i=this.activeInteractionData[e]:((i=this.interactionDataPool.pop()||new a.default).identifier=e,this.activeInteractionData[e]=i),i.copyEvent(t),i},o.prototype.releaseInteractionDataForPointerId=function(t){var e=this.activeInteractionData[t];e&&(delete this.activeInteractionData[t],e.reset(),this.interactionDataPool.push(e))},o.prototype.configureInteractionEventForDOMEvent=function(t,e,i){return t.data=i,this.mapPositionToPoint(i.global,e.clientX,e.clientY),navigator.isCocoonJS&&"touch"===e.pointerType&&(i.global.x=i.global.x/this.resolution,i.global.y=i.global.y/this.resolution),"touch"===e.pointerType&&(e.globalX=i.global.x,e.globalY=i.global.y),i.originalEvent=e,t.reset(),t},o.prototype.normalizeToPointerData=function(t){var e=[];if(this.supportsTouchEvents&&t instanceof TouchEvent)for(var i=0,n=t.changedTouches.length;i<n;i++){var o=t.changedTouches[i];void 0===o.button&&(o.button=t.touches.length?1:0),void 0===o.buttons&&(o.buttons=t.touches.length?1:0),void 0===o.isPrimary&&(o.isPrimary=1===t.touches.length&&"touchstart"===t.type),void 0===o.width&&(o.width=o.radiusX||1),void 0===o.height&&(o.height=o.radiusY||1),void 0===o.tiltX&&(o.tiltX=0),void 0===o.tiltY&&(o.tiltY=0),void 0===o.pointerType&&(o.pointerType="touch"),void 0===o.pointerId&&(o.pointerId=o.identifier||0),void 0===o.pressure&&(o.pressure=o.force||.5),o.twist=0,void(o.tangentialPressure=0)===o.layerX&&(o.layerX=o.offsetX=o.clientX),void 0===o.layerY&&(o.layerY=o.offsetY=o.clientY),o.isNormalized=!0,e.push(o)}else!(t instanceof MouseEvent)||this.supportsPointerEvents&&t instanceof window.PointerEvent||(void 0===t.isPrimary&&(t.isPrimary=!0),void 0===t.width&&(t.width=1),void 0===t.height&&(t.height=1),void 0===t.tiltX&&(t.tiltX=0),void 0===t.tiltY&&(t.tiltY=0),void 0===t.pointerType&&(t.pointerType="mouse"),void 0===t.pointerId&&(t.pointerId=1),void 0===t.pressure&&(t.pressure=.5),t.twist=0,t.tangentialPressure=0,t.isNormalized=!0),e.push(t);return e},o.prototype.destroy=function(){this.removeEvents(),this.removeAllListeners(),this.renderer=null,this.mouse=null,this.eventData=null,this.interactionDOMElement=null,this.onPointerDown=null,this.processPointerDown=null,this.onPointerUp=null,this.processPointerUp=null,this.onPointerCancel=null,this.processPointerCancel=null,this.onPointerMove=null,this.processPointerMove=null,this.onPointerOut=null,this.processPointerOverOut=null,this.onPointerOver=null,this._tempPoint=null},o}(n.default);i.default=c,s.WebGLRenderer.registerPlugin("interaction",c),s.CanvasRenderer.registerPlugin("interaction",c)},{"../core":65,"./InteractionData":155,"./InteractionEvent":156,"./InteractionTrackingData":158,"./interactiveTarget":160,eventemitter3:3}],158:[function(t,e,i){i.__esModule=!0;var n=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}();var o=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this._pointerId=t,this._flags=e.FLAGS.NONE}return e.prototype._doSet=function(t,e){this._flags=e?this._flags|t:this._flags&~t},n(e,[{key:"pointerId",get:function(){return this._pointerId}},{key:"flags",get:function(){return this._flags},set:function(t){this._flags=t}},{key:"none",get:function(){return this._flags===this.constructor.FLAGS.NONE}},{key:"over",get:function(){return 0!=(this._flags&this.constructor.FLAGS.OVER)},set:function(t){this._doSet(this.constructor.FLAGS.OVER,t)}},{key:"rightDown",get:function(){return 0!=(this._flags&this.constructor.FLAGS.RIGHT_DOWN)},set:function(t){this._doSet(this.constructor.FLAGS.RIGHT_DOWN,t)}},{key:"leftDown",get:function(){return 0!=(this._flags&this.constructor.FLAGS.LEFT_DOWN)},set:function(t){this._doSet(this.constructor.FLAGS.LEFT_DOWN,t)}}]),e}();(i.default=o).FLAGS=Object.freeze({NONE:0,OVER:1,LEFT_DOWN:2,RIGHT_DOWN:4})},{}],159:[function(t,e,i){i.__esModule=!0;var n=t("./InteractionData");Object.defineProperty(i,"InteractionData",{enumerable:!0,get:function(){return l(n).default}});var o=t("./InteractionManager");Object.defineProperty(i,"InteractionManager",{enumerable:!0,get:function(){return l(o).default}});var r=t("./interactiveTarget");Object.defineProperty(i,"interactiveTarget",{enumerable:!0,get:function(){return l(r).default}});var s=t("./InteractionTrackingData");Object.defineProperty(i,"InteractionTrackingData",{enumerable:!0,get:function(){return l(s).default}});var a=t("./InteractionEvent");function l(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(i,"InteractionEvent",{enumerable:!0,get:function(){return l(a).default}})},{"./InteractionData":155,"./InteractionEvent":156,"./InteractionManager":157,"./InteractionTrackingData":158,"./interactiveTarget":160}],160:[function(t,e,i){i.__esModule=!0,i.default={interactive:!1,interactiveChildren:!0,hitArea:null,get buttonMode(){return"pointer"===this.cursor},set buttonMode(t){t?this.cursor="pointer":"pointer"===this.cursor&&(this.cursor=null)},cursor:null,get trackedPointers(){return void 0===this._trackedPointers&&(this._trackedPointers={}),this._trackedPointers},_trackedPointers:void 0}},{}],161:[function(t,e,i){i.__esModule=!0,i.parse=d,i.default=function(){return function(e,i){if(e.data&&e.type===f.Resource.TYPE.XML)if(0!==e.data.getElementsByTagName("page").length&&0!==e.data.getElementsByTagName("info").length&&null!==e.data.getElementsByTagName("info")[0].getAttribute("face")){var t=e.isDataUrl?"":m.dirname(e.url);e.isDataUrl&&("."===t&&(t=""),this.baseUrl&&t&&"/"===this.baseUrl.charAt(this.baseUrl.length-1)&&(t+="/")),(t=t.replace(this.baseUrl,""))&&"/"!==t.charAt(t.length-1)&&(t+="/");for(var n=e.data.getElementsByTagName("page"),o={},r=function(t){o[t.metadata.pageFile]=t.texture,Object.keys(o).length===n.length&&(d(e,o),i())},s=0;s<n.length;++s){var a=n[s].getAttribute("file"),l=t+a,h=!1;for(var u in this.resources){var c=this.resources[u];if(c.url===l){c.metadata.pageFile=a,c.texture?r(c):c.onAfterMiddleware.add(r),h=!0;break}}if(!h){var p={crossOrigin:e.crossOrigin,loadType:f.Resource.LOAD_TYPE.IMAGE,metadata:Object.assign({pageFile:a},e.metadata.imageMetadata),parentResource:e};this.add(l,p,r)}}}else i();else i()}};var m=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}}(t("path")),f=t("resource-loader"),n=t("../extras");function d(t,e){t.bitmapFont=n.BitmapText.registerFont(t.data,e)}},{"../extras":141,path:8,"resource-loader":36}],162:[function(t,e,i){i.__esModule=!0,i.shared=i.Resource=i.textureParser=i.getResourcePath=i.spritesheetParser=i.parseBitmapFontData=i.bitmapFontParser=i.Loader=void 0;var n=t("./bitmapFontParser");Object.defineProperty(i,"bitmapFontParser",{enumerable:!0,get:function(){return h(n).default}}),Object.defineProperty(i,"parseBitmapFontData",{enumerable:!0,get:function(){return n.parse}});var o=t("./spritesheetParser");Object.defineProperty(i,"spritesheetParser",{enumerable:!0,get:function(){return h(o).default}}),Object.defineProperty(i,"getResourcePath",{enumerable:!0,get:function(){return o.getResourcePath}});var r=t("./textureParser");Object.defineProperty(i,"textureParser",{enumerable:!0,get:function(){return h(r).default}});var s=t("resource-loader");Object.defineProperty(i,"Resource",{enumerable:!0,get:function(){return s.Resource}});var a=h(t("../core/Application")),l=h(t("./loader"));function h(t){return t&&t.__esModule?t:{default:t}}i.Loader=l.default;var u=new l.default;u.destroy=function(){},i.shared=u;var c=a.default.prototype;c._loader=null,Object.defineProperty(c,"loader",{get:function(){if(!this._loader){var t=this._options.sharedLoader;this._loader=t?u:new l.default}return this._loader}}),c._parentDestroy=c.destroy,c.destroy=function(t,e){this._loader&&(this._loader.destroy(),this._loader=null),this._parentDestroy(t,e)}},{"../core/Application":43,"./bitmapFontParser":161,"./loader":163,"./spritesheetParser":164,"./textureParser":165,"resource-loader":36}],163:[function(t,e,i){i.__esModule=!0;var n=h(t("resource-loader")),o=t("resource-loader/lib/middlewares/parsing/blob"),s=h(t("eventemitter3")),r=h(t("./textureParser")),a=h(t("./spritesheetParser")),l=h(t("./bitmapFontParser"));function h(t){return t&&t.__esModule?t:{default:t}}var u=function(o){function r(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,o.call(this,t,e));s.default.call(n);for(var i=0;i<r._pixiMiddleware.length;++i)n.use(r._pixiMiddleware[i]());return n.onStart.add(function(t){return n.emit("start",t)}),n.onProgress.add(function(t,e){return n.emit("progress",t,e)}),n.onError.add(function(t,e,i){return n.emit("error",t,e,i)}),n.onLoad.add(function(t,e){return n.emit("load",t,e)}),n.onComplete.add(function(t,e){return n.emit("complete",t,e)}),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(r,o),r.addPixiMiddleware=function(t){r._pixiMiddleware.push(t)},r.prototype.destroy=function(){this.removeAllListeners(),this.reset()},r}(n.default);for(var c in i.default=u,s.default.prototype)u.prototype[c]=s.default.prototype[c];u._pixiMiddleware=[o.blobMiddlewareFactory,r.default,a.default,l.default];var p=n.default.Resource;p.setExtensionXhrType("fnt",p.XHR_RESPONSE_TYPE.DOCUMENT)},{"./bitmapFontParser":161,"./spritesheetParser":164,"./textureParser":165,eventemitter3:3,"resource-loader":36,"resource-loader/lib/middlewares/parsing/blob":37}],164:[function(t,e,i){i.__esModule=!0,i.default=function(){return function(i,n){var t=i.name+"_image";if(i.data&&i.type===r.Resource.TYPE.JSON&&i.data.frames&&!this.resources[t]){var e={crossOrigin:i.crossOrigin,metadata:i.metadata.imageMetadata,parentResource:i},o=l(i,this.baseUrl);this.add(t,o,e,function(t){if(t.error)n(t.error);else{var e=new a.Spritesheet(t.texture.baseTexture,i.data,i.url);e.parse(function(){i.spritesheet=e,i.textures=e.textures,n()})}})}else n()}},i.getResourcePath=l;var n,r=t("resource-loader"),o=t("url"),s=(n=o)&&n.__esModule?n:{default:n},a=t("../core");function l(t,e){return t.isDataUrl?t.data.meta.image:s.default.resolve(t.url.replace(e,""),t.data.meta.image)}},{"../core":65,"resource-loader":36,url:38}],165:[function(t,e,i){i.__esModule=!0,i.default=function(){return function(t,e){t.data&&t.type===o.Resource.TYPE.IMAGE&&(t.texture=s.default.fromLoader(t.data,t.url,t.name)),e()}};var n,o=t("resource-loader"),r=t("../core/textures/Texture"),s=(n=r)&&n.__esModule?n:{default:n}},{"../core/textures/Texture":115,"resource-loader":36}],166:[function(t,e,i){i.__esModule=!0;var n,o=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),a=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}}(t("../core")),r=t("../core/textures/Texture"),l=(n=r)&&n.__esModule?n:{default:n};var c=new a.Point,p=new a.Polygon,s=function(s){function u(t,e,i,n,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,s.call(this));return r._texture=t||l.default.EMPTY,r.uvs=i||new Float32Array([0,0,1,0,1,1,0,1]),r.vertices=e||new Float32Array([0,0,100,0,100,100,0,100]),r.indices=n||new Uint16Array([0,1,3,2]),r.dirty=0,r.indexDirty=0,r.vertexDirty=0,r.autoUpdate=!0,r.blendMode=a.BLEND_MODES.NORMAL,r.canvasPadding=a.settings.MESH_CANVAS_PADDING,r.drawMode=o||u.DRAW_MODES.TRIANGLE_MESH,r.shader=null,r.tintRgb=new Float32Array([1,1,1]),r._glDatas={},r._uvTransform=new a.TextureMatrix(r._texture),r.uploadUvTransform=!1,r.pluginName="mesh",r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(u,s),u.prototype._renderWebGL=function(t){this.refresh(),t.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)},u.prototype._renderCanvas=function(t){this.refresh(),t.plugins[this.pluginName].render(this)},u.prototype._onTextureUpdate=function(){this._uvTransform.texture=this._texture,this.refresh()},u.prototype.multiplyUvs=function(){this.uploadUvTransform||this._uvTransform.multiplyUvs(this.uvs)},u.prototype.refresh=function(t){this.autoUpdate&&this.vertexDirty++,this._uvTransform.update(t)&&this._refresh()},u.prototype._refresh=function(){},u.prototype._calculateBounds=function(){this._bounds.addVertices(this.transform,this.vertices,0,this.vertices.length)},u.prototype.containsPoint=function(t){if(!this.getBounds().contains(t.x,t.y))return!1;this.worldTransform.applyInverse(t,c);for(var e=this.vertices,i=p.points,n=this.indices,o=this.indices.length,r=this.drawMode===u.DRAW_MODES.TRIANGLES?3:1,s=0;s+2<o;s+=r){var a=2*n[s],l=2*n[s+1],h=2*n[s+2];if(i[0]=e[a],i[1]=e[a+1],i[2]=e[l],i[3]=e[l+1],i[4]=e[h],i[5]=e[h+1],p.contains(c.x,c.y))return!0}return!1},u.prototype.destroy=function(t){for(var e in this._glDatas){var i=this._glDatas[e];i.destroy?i.destroy():(i.vertexBuffer&&(i.vertexBuffer.destroy(),i.vertexBuffer=null),i.indexBuffer&&(i.indexBuffer.destroy(),i.indexBuffer=null),i.uvBuffer&&(i.uvBuffer.destroy(),i.uvBuffer=null),i.vao&&(i.vao.destroy(),i.vao=null))}this._glDatas=null,s.prototype.destroy.call(this,t)},o(u,[{key:"texture",get:function(){return this._texture},set:function(t){this._texture!==t&&(this._texture=t)&&(t.baseTexture.hasLoaded?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this))}},{key:"tint",get:function(){return a.utils.rgb2hex(this.tintRgb)},set:function(t){this.tintRgb=a.utils.hex2rgb(t,this.tintRgb)}}]),u}(a.Container);(i.default=s).DRAW_MODES={TRIANGLE_MESH:0,TRIANGLES:1}},{"../core":65,"../core/textures/Texture":115}],167:[function(t,e,i){i.__esModule=!0;var n,o=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),r=t("./Plane"),s=(n=r)&&n.__esModule?n:{default:n};var a=function(s){function a(t,e,i,n,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,s.call(this,t,4,4));return r._origWidth=t.orig.width,r._origHeight=t.orig.height,r._width=r._origWidth,r._height=r._origHeight,r._leftWidth=void 0!==e?e:10,r._rightWidth=void 0!==n?n:10,r._topHeight=void 0!==i?i:10,r._bottomHeight=void 0!==o?o:10,r.refresh(!0),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(a,s),a.prototype.updateHorizontalVertices=function(){var t=this.vertices,e=this._topHeight+this._bottomHeight,i=this._height>e?1:this._height/e;t[9]=t[11]=t[13]=t[15]=this._topHeight*i,t[17]=t[19]=t[21]=t[23]=this._height-this._bottomHeight*i,t[25]=t[27]=t[29]=t[31]=this._height},a.prototype.updateVerticalVertices=function(){var t=this.vertices,e=this._leftWidth+this._rightWidth,i=this._width>e?1:this._width/e;t[2]=t[10]=t[18]=t[26]=this._leftWidth*i,t[4]=t[12]=t[20]=t[28]=this._width-this._rightWidth*i,t[6]=t[14]=t[22]=t[30]=this._width},a.prototype._renderCanvas=function(t){var e=t.context;e.globalAlpha=this.worldAlpha,t.setBlendMode(this.blendMode);var i=this.worldTransform,n=t.resolution;t.roundPixels?e.setTransform(i.a*n,i.b*n,i.c*n,i.d*n,i.tx*n|0,i.ty*n|0):e.setTransform(i.a*n,i.b*n,i.c*n,i.d*n,i.tx*n,i.ty*n);var o=this._texture.baseTexture,r=o.source,s=o.width*o.resolution,a=o.height*o.resolution;this.drawSegment(e,r,s,a,0,1,10,11),this.drawSegment(e,r,s,a,2,3,12,13),this.drawSegment(e,r,s,a,4,5,14,15),this.drawSegment(e,r,s,a,8,9,18,19),this.drawSegment(e,r,s,a,10,11,20,21),this.drawSegment(e,r,s,a,12,13,22,23),this.drawSegment(e,r,s,a,16,17,26,27),this.drawSegment(e,r,s,a,18,19,28,29),this.drawSegment(e,r,s,a,20,21,30,31)},a.prototype.drawSegment=function(t,e,i,n,o,r,s,a){var l=this.uvs,h=this.vertices,u=(l[s]-l[o])*i,c=(l[a]-l[r])*n,p=h[s]-h[o],m=h[a]-h[r];u<1&&(u=1),c<1&&(c=1),p<1&&(p=1),m<1&&(m=1),t.drawImage(e,l[o]*i,l[r]*n,u,c,h[o],h[r],p,m)},a.prototype._refresh=function(){s.prototype._refresh.call(this);var t=this.uvs,e=this._texture;this._origWidth=e.orig.width,this._origHeight=e.orig.height;var i=1/this._origWidth,n=1/this._origHeight;t[0]=t[8]=t[16]=t[24]=0,t[1]=t[3]=t[5]=t[7]=0,t[6]=t[14]=t[22]=t[30]=1,t[25]=t[27]=t[29]=t[31]=1,t[2]=t[10]=t[18]=t[26]=i*this._leftWidth,t[4]=t[12]=t[20]=t[28]=1-i*this._rightWidth,t[9]=t[11]=t[13]=t[15]=n*this._topHeight,t[17]=t[19]=t[21]=t[23]=1-n*this._bottomHeight,this.updateHorizontalVertices(),this.updateVerticalVertices(),this.dirty++,this.multiplyUvs()},o(a,[{key:"width",get:function(){return this._width},set:function(t){this._width=t,this._refresh()}},{key:"height",get:function(){return this._height},set:function(t){this._height=t,this._refresh()}},{key:"leftWidth",get:function(){return this._leftWidth},set:function(t){this._leftWidth=t,this._refresh()}},{key:"rightWidth",get:function(){return this._rightWidth},set:function(t){this._rightWidth=t,this._refresh()}},{key:"topHeight",get:function(){return this._topHeight},set:function(t){this._topHeight=t,this._refresh()}},{key:"bottomHeight",get:function(){return this._bottomHeight},set:function(t){this._bottomHeight=t,this._refresh()}}]),a}(s.default);i.default=a},{"./Plane":168}],168:[function(t,e,i){i.__esModule=!0;var n,o=t("./Mesh"),s=(n=o)&&n.__esModule?n:{default:n};var r=function(o){function r(t,e,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,o.call(this,t));return n._ready=!0,n.verticesX=e||10,n.verticesY=i||10,n.drawMode=s.default.DRAW_MODES.TRIANGLES,n.refresh(),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(r,o),r.prototype._refresh=function(){for(var t=this._texture,e=this.verticesX*this.verticesY,i=[],n=[],o=[],r=this.verticesX-1,s=this.verticesY-1,a=t.width/r,l=t.height/s,h=0;h<e;h++){var u=h%this.verticesX,c=h/this.verticesX|0;i.push(u*a,c*l),n.push(u/r,c/s)}for(var p=r*s,m=0;m<p;m++){var f=m%r,d=m/r|0,_=d*this.verticesX+f,y=d*this.verticesX+f+1,x=(d+1)*this.verticesX+f,v=(d+1)*this.verticesX+f+1;o.push(_,y,x),o.push(y,v,x)}this.vertices=new Float32Array(i),this.uvs=new Float32Array(n),this.colors=new Float32Array([]),this.indices=new Uint16Array(o),this.dirty++,this.indexDirty++,this.multiplyUvs()},r.prototype._onTextureUpdate=function(){s.default.prototype._onTextureUpdate.call(this),this._ready&&this.refresh()},r}(s.default);i.default=r},{"./Mesh":166}],169:[function(t,e,i){i.__esModule=!0;var n,o=t("./Mesh");var r=function(n){function o(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,n.call(this,t));return i.points=e,i.vertices=new Float32Array(4*e.length),i.uvs=new Float32Array(4*e.length),i.colors=new Float32Array(2*e.length),i.indices=new Uint16Array(2*e.length),i.autoUpdate=!0,i.refresh(),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(o,n),o.prototype._refresh=function(){var t=this.points;if(!(t.length<1)&&this._texture._uvs){this.vertices.length/4!==t.length&&(this.vertices=new Float32Array(4*t.length),this.uvs=new Float32Array(4*t.length),this.colors=new Float32Array(2*t.length),this.indices=new Uint16Array(2*t.length));var e=this.uvs,i=this.indices,n=this.colors;e[0]=0,e[1]=0,e[2]=0,e[3]=1,n[0]=1,n[1]=1,i[0]=0,i[1]=1;for(var o=t.length,r=1;r<o;r++){var s=4*r,a=r/(o-1);e[s]=a,e[s+1]=0,e[s+2]=a,e[s+3]=1,n[s=2*r]=1,n[s+1]=1,i[s=2*r]=s,i[s+1]=s+1}this.dirty++,this.indexDirty++,this.multiplyUvs(),this.refreshVertices()}},o.prototype.refreshVertices=function(){var t=this.points;if(!(t.length<1))for(var e=t[0],i=void 0,n=0,o=0,r=this.vertices,s=t.length,a=0;a<s;a++){var l=t[a],h=4*a;o=-((i=a<t.length-1?t[a+1]:l).x-e.x),n=i.y-e.y;var u=10*(1-a/(s-1));1<u&&(u=1);var c=Math.sqrt(n*n+o*o),p=this._texture.height/2;n/=c,o/=c,n*=p,o*=p,r[h]=l.x+n,r[h+1]=l.y+o,r[h+2]=l.x-n,r[h+3]=l.y-o,e=l}},o.prototype.updateTransform=function(){this.autoUpdate&&this.refreshVertices(),this.containerUpdateTransform()},o}(((n=o)&&n.__esModule?n:{default:n}).default);i.default=r},{"./Mesh":166}],170:[function(t,e,i){i.__esModule=!0;var n,o=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}}(t("../../core")),r=t("../Mesh"),s=(n=r)&&n.__esModule?n:{default:n};var a=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.renderer=t}return e.prototype.render=function(t){var e=this.renderer,i=e.context,n=t.worldTransform,o=e.resolution;e.roundPixels?i.setTransform(n.a*o,n.b*o,n.c*o,n.d*o,n.tx*o|0,n.ty*o|0):i.setTransform(n.a*o,n.b*o,n.c*o,n.d*o,n.tx*o,n.ty*o),e.context.globalAlpha=t.worldAlpha,e.setBlendMode(t.blendMode),t.drawMode===s.default.DRAW_MODES.TRIANGLE_MESH?this._renderTriangleMesh(t):this._renderTriangles(t)},e.prototype._renderTriangleMesh=function(t){for(var e=t.vertices.length/2,i=0;i<e-2;i++){var n=2*i;this._renderDrawTriangle(t,n,n+2,n+4)}},e.prototype._renderTriangles=function(t){for(var e=t.indices,i=e.length,n=0;n<i;n+=3){var o=2*e[n],r=2*e[n+1],s=2*e[n+2];this._renderDrawTriangle(t,o,r,s)}},e.prototype._renderDrawTriangle=function(t,e,i,n){var o=this.renderer.context,r=t.uvs,s=t.vertices,a=t._texture;if(a.valid){var l=a.baseTexture,h=l.source,u=l.width,c=l.height,p=void 0,m=void 0,f=void 0,d=void 0,_=void 0,y=void 0;if(t.uploadUvTransform){var x=t._uvTransform.mapCoord;p=(r[e]*x.a+r[e+1]*x.c+x.tx)*l.width,m=(r[i]*x.a+r[i+1]*x.c+x.tx)*l.width,f=(r[n]*x.a+r[n+1]*x.c+x.tx)*l.width,d=(r[e]*x.b+r[e+1]*x.d+x.ty)*l.height,_=(r[i]*x.b+r[i+1]*x.d+x.ty)*l.height,y=(r[n]*x.b+r[n+1]*x.d+x.ty)*l.height}else p=r[e]*l.width,m=r[i]*l.width,f=r[n]*l.width,d=r[e+1]*l.height,_=r[i+1]*l.height,y=r[n+1]*l.height;var v=s[e],b=s[i],g=s[n],w=s[e+1],C=s[i+1],D=s[n+1],S=t.canvasPadding/this.renderer.resolution;if(0<S){var T=S/Math.abs(t.worldTransform.a),A=S/Math.abs(t.worldTransform.d),M=(v+b+g)/3,B=(w+C+D)/3,E=v-M,P=w-B,I=Math.sqrt(E*E+P*P);v=M+E/I*(I+T),w=B+P/I*(I+A),P=C-B,b=M+(E=b-M)/(I=Math.sqrt(E*E+P*P))*(I+T),C=B+P/I*(I+A),P=D-B,g=M+(E=g-M)/(I=Math.sqrt(E*E+P*P))*(I+T),D=B+P/I*(I+A)}o.save(),o.beginPath(),o.moveTo(v,w),o.lineTo(b,C),o.lineTo(g,D),o.closePath(),o.clip();var R=p*_+d*f+m*y-_*f-d*m-p*y,O=v*_+d*g+b*y-_*g-d*b-v*y,L=p*b+v*f+m*g-b*f-v*m-p*g,F=p*_*g+d*b*f+v*m*y-v*_*f-d*m*g-p*b*y,V=w*_+d*D+C*y-_*D-d*C-w*y,N=p*C+w*f+m*D-C*f-w*m-p*D,k=p*_*D+d*C*f+w*m*y-w*_*f-d*m*D-p*C*y;o.transform(O/R,V/R,L/R,N/R,F/R,k/R),o.drawImage(h,0,0,u*l.resolution,c*l.resolution,0,0,u,c),o.restore(),this.renderer.invalidateBlendMode()}},e.prototype.renderMeshFlat=function(t){var e=this.renderer.context,i=t.vertices,n=i.length/2;e.beginPath();for(var o=1;o<n-2;++o){var r=2*o,s=i[r],a=i[r+1],l=i[r+2],h=i[r+3],u=i[r+4],c=i[r+5];e.moveTo(s,a),e.lineTo(l,h),e.lineTo(u,c)}e.fillStyle="#FF0000",e.fill(),e.closePath()},e.prototype.destroy=function(){this.renderer=null},e}();i.default=a,o.CanvasRenderer.registerPlugin("mesh",a)},{"../../core":65,"../Mesh":166}],171:[function(t,e,i){i.__esModule=!0;var n=t("./Mesh");Object.defineProperty(i,"Mesh",{enumerable:!0,get:function(){return h(n).default}});var o=t("./webgl/MeshRenderer");Object.defineProperty(i,"MeshRenderer",{enumerable:!0,get:function(){return h(o).default}});var r=t("./canvas/CanvasMeshRenderer");Object.defineProperty(i,"CanvasMeshRenderer",{enumerable:!0,get:function(){return h(r).default}});var s=t("./Plane");Object.defineProperty(i,"Plane",{enumerable:!0,get:function(){return h(s).default}});var a=t("./NineSlicePlane");Object.defineProperty(i,"NineSlicePlane",{enumerable:!0,get:function(){return h(a).default}});var l=t("./Rope");function h(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(i,"Rope",{enumerable:!0,get:function(){return h(l).default}})},{"./Mesh":166,"./NineSlicePlane":167,"./Plane":168,"./Rope":169,"./canvas/CanvasMeshRenderer":170,"./webgl/MeshRenderer":172}],172:[function(t,e,i){i.__esModule=!0;var s=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}}(t("../../core")),a=n(t("pixi-gl-core")),l=n(t("../Mesh"));t("path");function n(t){return t&&t.__esModule?t:{default:t}}var h=s.Matrix.IDENTITY,o=function(i){function n(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n);var e=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,i.call(this,t));return e.shader=null,e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(n,i),n.prototype.onContextChange=function(){var t=this.renderer.gl;this.shader=new s.Shader(t,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n","varying vec2 vTextureCoord;\nuniform vec4 uColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;\n}\n")},n.prototype.render=function(t){var e=this.renderer,i=e.gl,n=t._texture;if(n.valid){var o=t._glDatas[e.CONTEXT_UID];o||(e.bindVao(null),(o={shader:this.shader,vertexBuffer:a.default.GLBuffer.createVertexBuffer(i,t.vertices,i.STREAM_DRAW),uvBuffer:a.default.GLBuffer.createVertexBuffer(i,t.uvs,i.STREAM_DRAW),indexBuffer:a.default.GLBuffer.createIndexBuffer(i,t.indices,i.STATIC_DRAW),vao:null,dirty:t.dirty,indexDirty:t.indexDirty,vertexDirty:t.vertexDirty}).vao=new a.default.VertexArrayObject(i).addIndex(o.indexBuffer).addAttribute(o.vertexBuffer,o.shader.attributes.aVertexPosition,i.FLOAT,!1,8,0).addAttribute(o.uvBuffer,o.shader.attributes.aTextureCoord,i.FLOAT,!1,8,0),t._glDatas[e.CONTEXT_UID]=o),e.bindVao(o.vao),t.dirty!==o.dirty&&(o.dirty=t.dirty,o.uvBuffer.upload(t.uvs)),t.indexDirty!==o.indexDirty&&(o.indexDirty=t.indexDirty,o.indexBuffer.upload(t.indices)),t.vertexDirty!==o.vertexDirty&&(o.vertexDirty=t.vertexDirty,o.vertexBuffer.upload(t.vertices)),e.bindShader(o.shader),o.shader.uniforms.uSampler=e.bindTexture(n),e.state.setBlendMode(s.utils.correctBlendMode(t.blendMode,n.baseTexture.premultipliedAlpha)),o.shader.uniforms.uTransform&&(t.uploadUvTransform?o.shader.uniforms.uTransform=t._uvTransform.mapCoord.toArray(!0):o.shader.uniforms.uTransform=h.toArray(!0)),o.shader.uniforms.translationMatrix=t.worldTransform.toArray(!0),o.shader.uniforms.uColor=s.utils.premultiplyRgba(t.tintRgb,t.worldAlpha,o.shader.uniforms.uColor,n.baseTexture.premultipliedAlpha);var r=t.drawMode===l.default.DRAW_MODES.TRIANGLE_MESH?i.TRIANGLE_STRIP:i.TRIANGLES;o.vao.draw(r,t.indices.length,0)}},n}(s.ObjectRenderer);i.default=o,s.WebGLRenderer.registerPlugin("mesh",o)},{"../../core":65,"../Mesh":166,path:8,"pixi-gl-core":15}],173:[function(t,e,i){i.__esModule=!0;var n=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),a=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}}(t("../core")),o=t("../core/utils");var r=function(r){function s(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1500,e=arguments[1],i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:16384,n=3<arguments.length&&void 0!==arguments[3]&&arguments[3];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,r.call(this));return 16384<i&&(i=16384),t<i&&(i=t),o._properties=[!1,!0,!1,!1,!1],o._maxSize=t,o._batchSize=i,o._glBuffers={},o._bufferUpdateIDs=[],o._updateID=0,o.interactiveChildren=!1,o.blendMode=a.BLEND_MODES.NORMAL,o.autoResize=n,o.roundPixels=!0,o.baseTexture=null,o.setProperties(e),o._tint=0,o.tintRgb=new Float32Array(4),o.tint=16777215,o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(s,r),s.prototype.setProperties=function(t){t&&(this._properties[0]="vertices"in t||"scale"in t?!!t.vertices||!!t.scale:this._properties[0],this._properties[1]="position"in t?!!t.position:this._properties[1],this._properties[2]="rotation"in t?!!t.rotation:this._properties[2],this._properties[3]="uvs"in t?!!t.uvs:this._properties[3],this._properties[4]="tint"in t||"alpha"in t?!!t.tint||!!t.alpha:this._properties[4])},s.prototype.updateTransform=function(){this.displayObjectUpdateTransform()},s.prototype.renderWebGL=function(t){var e=this;this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable&&(this.baseTexture||(this.baseTexture=this.children[0]._texture.baseTexture,this.baseTexture.hasLoaded||this.baseTexture.once("update",function(){return e.onChildrenChange(0)})),t.setObjectRenderer(t.plugins.particle),t.plugins.particle.render(this))},s.prototype.onChildrenChange=function(t){for(var e=Math.floor(t/this._batchSize);this._bufferUpdateIDs.length<e;)this._bufferUpdateIDs.push(0);this._bufferUpdateIDs[e]=++this._updateID},s.prototype.renderCanvas=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable){var e=t.context,i=this.worldTransform,n=!0,o=0,r=0,s=0,a=0;t.setBlendMode(this.blendMode),e.globalAlpha=this.worldAlpha,this.displayObjectUpdateTransform();for(var l=0;l<this.children.length;++l){var h=this.children[l];if(h.visible){var u=h._texture.frame;if(e.globalAlpha=this.worldAlpha*h.alpha,h.rotation%(2*Math.PI)==0)n&&(e.setTransform(i.a,i.b,i.c,i.d,i.tx*t.resolution,i.ty*t.resolution),n=!1),o=h.anchor.x*(-u.width*h.scale.x)+h.position.x+.5,r=h.anchor.y*(-u.height*h.scale.y)+h.position.y+.5,s=u.width*h.scale.x,a=u.height*h.scale.y;else{n||(n=!0),h.displayObjectUpdateTransform();var c=h.worldTransform;t.roundPixels?e.setTransform(c.a,c.b,c.c,c.d,c.tx*t.resolution|0,c.ty*t.resolution|0):e.setTransform(c.a,c.b,c.c,c.d,c.tx*t.resolution,c.ty*t.resolution),o=h.anchor.x*-u.width+.5,r=h.anchor.y*-u.height+.5,s=u.width,a=u.height}var p=h._texture.baseTexture.resolution;e.drawImage(h._texture.baseTexture.source,u.x*p,u.y*p,u.width*p,u.height*p,o*t.resolution,r*t.resolution,s*t.resolution,a*t.resolution)}}}},s.prototype.destroy=function(t){if(r.prototype.destroy.call(this,t),this._buffers)for(var e=0;e<this._buffers.length;++e)this._buffers[e].destroy();this._properties=null,this._buffers=null,this._bufferUpdateIDs=null},n(s,[{key:"tint",get:function(){return this._tint},set:function(t){this._tint=t,(0,o.hex2rgb)(t,this.tintRgb)}}]),s}(a.Container);i.default=r},{"../core":65,"../core/utils":125}],174:[function(t,e,i){i.__esModule=!0;var n=t("./ParticleContainer");Object.defineProperty(i,"ParticleContainer",{enumerable:!0,get:function(){return r(n).default}});var o=t("./webgl/ParticleRenderer");function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(i,"ParticleRenderer",{enumerable:!0,get:function(){return r(o).default}})},{"./ParticleContainer":173,"./webgl/ParticleRenderer":176}],175:[function(t,e,i){i.__esModule=!0;var m=n(t("pixi-gl-core")),f=n(t("../../core/utils/createIndicesForQuads"));function n(t){return t&&t.__esModule?t:{default:t}}var o=function(){function s(t,e,i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),this.gl=t,this.size=n,this.dynamicProperties=[],this.staticProperties=[];for(var o=0;o<e.length;++o){var r=e[o];r={attribute:r.attribute,size:r.size,uploadFunction:r.uploadFunction,unsignedByte:r.unsignedByte,offset:r.offset},i[o]?this.dynamicProperties.push(r):this.staticProperties.push(r)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}return s.prototype.initBuffers=function(){var t=this.gl,e=0;this.indices=(0,f.default)(this.size),this.indexBuffer=m.default.GLBuffer.createIndexBuffer(t,this.indices,t.STATIC_DRAW);for(var i=this.dynamicStride=0;i<this.dynamicProperties.length;++i){var n=this.dynamicProperties[i];n.offset=e,e+=n.size,this.dynamicStride+=n.size}var o=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(o),this.dynamicDataUint32=new Uint32Array(o),this.dynamicBuffer=m.default.GLBuffer.createVertexBuffer(t,o,t.STREAM_DRAW);for(var r=0,s=this.staticStride=0;s<this.staticProperties.length;++s){var a=this.staticProperties[s];a.offset=r,r+=a.size,this.staticStride+=a.size}var l=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(l),this.staticDataUint32=new Uint32Array(l),this.staticBuffer=m.default.GLBuffer.createVertexBuffer(t,l,t.STATIC_DRAW),this.vao=new m.default.VertexArrayObject(t).addIndex(this.indexBuffer);for(var h=0;h<this.dynamicProperties.length;++h){var u=this.dynamicProperties[h];u.unsignedByte?this.vao.addAttribute(this.dynamicBuffer,u.attribute,t.UNSIGNED_BYTE,!0,4*this.dynamicStride,4*u.offset):this.vao.addAttribute(this.dynamicBuffer,u.attribute,t.FLOAT,!1,4*this.dynamicStride,4*u.offset)}for(var c=0;c<this.staticProperties.length;++c){var p=this.staticProperties[c];p.unsignedByte?this.vao.addAttribute(this.staticBuffer,p.attribute,t.UNSIGNED_BYTE,!0,4*this.staticStride,4*p.offset):this.vao.addAttribute(this.staticBuffer,p.attribute,t.FLOAT,!1,4*this.staticStride,4*p.offset)}},s.prototype.uploadDynamic=function(t,e,i){for(var n=0;n<this.dynamicProperties.length;n++){var o=this.dynamicProperties[n];o.uploadFunction(t,e,i,o.unsignedByte?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,o.offset)}this.dynamicBuffer.upload()},s.prototype.uploadStatic=function(t,e,i){for(var n=0;n<this.staticProperties.length;n++){var o=this.staticProperties[n];o.uploadFunction(t,e,i,o.unsignedByte?this.staticDataUint32:this.staticData,this.staticStride,o.offset)}this.staticBuffer.upload()},s.prototype.destroy=function(){this.dynamicProperties=null,this.dynamicBuffer.destroy(),this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer.destroy(),this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null},s}();i.default=o},{"../../core/utils/createIndicesForQuads":123,"pixi-gl-core":15}],176:[function(t,e,i){i.__esModule=!0;var _=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}}(t("../../core")),o=n(t("./ParticleShader")),a=n(t("./ParticleBuffer")),c=t("../../core/utils");function n(t){return t&&t.__esModule?t:{default:t}}var r=function(i){function n(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n);var e=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,i.call(this,t));return e.shader=null,e.indexBuffer=null,e.properties=null,e.tempMatrix=new _.Matrix,e.CONTEXT_UID=0,e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(n,i),n.prototype.onContextChange=function(){var t=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.shader=new o.default(t),this.properties=[{attribute:this.shader.attributes.aVertexPosition,size:2,uploadFunction:this.uploadVertices,offset:0},{attribute:this.shader.attributes.aPositionCoord,size:2,uploadFunction:this.uploadPosition,offset:0},{attribute:this.shader.attributes.aRotation,size:1,uploadFunction:this.uploadRotation,offset:0},{attribute:this.shader.attributes.aTextureCoord,size:2,uploadFunction:this.uploadUvs,offset:0},{attribute:this.shader.attributes.aColor,size:1,unsignedByte:!0,uploadFunction:this.uploadTint,offset:0}]},n.prototype.start=function(){this.renderer.bindShader(this.shader)},n.prototype.render=function(t){var e=t.children,i=t._maxSize,n=t._batchSize,o=this.renderer,r=e.length;if(0!==r){i<r&&(r=i);var s=t._glBuffers[o.CONTEXT_UID];s||(s=t._glBuffers[o.CONTEXT_UID]=this.generateBuffers(t));var a=e[0]._texture.baseTexture;this.renderer.setBlendMode(_.utils.correctBlendMode(t.blendMode,a.premultipliedAlpha));var l=o.gl,h=t.worldTransform.copy(this.tempMatrix);h.prepend(o._activeRenderTarget.projectionMatrix),this.shader.uniforms.projectionMatrix=h.toArray(!0),this.shader.uniforms.uColor=_.utils.premultiplyRgba(t.tintRgb,t.worldAlpha,this.shader.uniforms.uColor,a.premultipliedAlpha),this.shader.uniforms.uSampler=o.bindTexture(a);for(var u=!1,c=0,p=0;c<r;c+=n,p+=1){var m=r-c;if(n<m&&(m=n),p>=s.length){if(!t.autoResize)break;s.push(this._generateOneMoreBuffer(t))}var f=s[p];f.uploadDynamic(e,c,m);var d=t._bufferUpdateIDs[p]||0;(u=u||f._updateID<d)&&(f._updateID=t._updateID,f.uploadStatic(e,c,m)),o.bindVao(f.vao),f.vao.draw(l.TRIANGLES,6*m)}}},n.prototype.generateBuffers=function(t){for(var e=this.renderer.gl,i=[],n=t._maxSize,o=t._batchSize,r=t._properties,s=0;s<n;s+=o)i.push(new a.default(e,this.properties,r,o));return i},n.prototype._generateOneMoreBuffer=function(t){var e=this.renderer.gl,i=t._batchSize,n=t._properties;return new a.default(e,this.properties,n,i)},n.prototype.uploadVertices=function(t,e,i,n,o,r){for(var s=0,a=0,l=0,h=0,u=0;u<i;++u){var c=t[e+u],p=c._texture,m=c.scale.x,f=c.scale.y,d=p.trim,_=p.orig;d?(s=(a=d.x-c.anchor.x*_.width)+d.width,l=(h=d.y-c.anchor.y*_.height)+d.height):(s=_.width*(1-c.anchor.x),a=_.width*-c.anchor.x,l=_.height*(1-c.anchor.y),h=_.height*-c.anchor.y),n[r]=a*m,n[r+1]=h*f,n[r+o]=s*m,n[r+o+1]=h*f,n[r+2*o]=s*m,n[r+2*o+1]=l*f,n[r+3*o]=a*m,n[r+3*o+1]=l*f,r+=4*o}},n.prototype.uploadPosition=function(t,e,i,n,o,r){for(var s=0;s<i;s++){var a=t[e+s].position;n[r]=a.x,n[r+1]=a.y,n[r+o]=a.x,n[r+o+1]=a.y,n[r+2*o]=a.x,n[r+2*o+1]=a.y,n[r+3*o]=a.x,n[r+3*o+1]=a.y,r+=4*o}},n.prototype.uploadRotation=function(t,e,i,n,o,r){for(var s=0;s<i;s++){var a=t[e+s].rotation;n[r]=a,n[r+o]=a,n[r+2*o]=a,n[r+3*o]=a,r+=4*o}},n.prototype.uploadUvs=function(t,e,i,n,o,r){for(var s=0;s<i;++s){var a=t[e+s]._texture._uvs;n[r+3*o+1]=a?(n[r]=a.x0,n[r+1]=a.y0,n[r+o]=a.x1,n[r+o+1]=a.y1,n[r+2*o]=a.x2,n[r+2*o+1]=a.y2,n[r+3*o]=a.x3,a.y3):(n[r]=0,n[r+1]=0,n[r+o]=0,n[r+o+1]=0,n[r+2*o]=0,n[r+2*o+1]=0,n[r+3*o]=0),r+=4*o}},n.prototype.uploadTint=function(t,e,i,n,o,r){for(var s=0;s<i;++s){var a=t[e+s],l=a._texture.baseTexture.premultipliedAlpha,h=a.alpha,u=h<1&&l?(0,c.premultiplyTint)(a._tintRGB,h):a._tintRGB+(255*h<<24);n[r]=u,n[r+o]=u,n[r+2*o]=u,n[r+3*o]=u,r+=4*o}},n.prototype.destroy=function(){this.renderer.gl&&this.renderer.gl.deleteBuffer(this.indexBuffer),i.prototype.destroy.call(this),this.shader.destroy(),this.indices=null,this.tempMatrix=null},n}(_.ObjectRenderer);i.default=r,_.WebGLRenderer.registerPlugin("particle",r)},{"../../core":65,"../../core/utils":125,"./ParticleBuffer":175,"./ParticleShader":177}],177:[function(t,e,i){i.__esModule=!0;var n,o=t("../../core/Shader");var r=function(e){function i(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,e.call(this,t,["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute vec4 aColor;","attribute vec2 aPositionCoord;","attribute float aRotation;","uniform mat3 projectionMatrix;","uniform vec4 uColor;","varying vec2 vTextureCoord;","varying vec4 vColor;","void main(void){","   float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);","   float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);","   vec2 v = vec2(x, y);","   v = v + aPositionCoord;","   gl_Position = vec4((projectionMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = aColor * uColor;","}"].join("\n"),["varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","void main(void){","  vec4 color = texture2D(uSampler, vTextureCoord) * vColor;","  gl_FragColor = color;","}"].join("\n")))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(i,e),i}(((n=o)&&n.__esModule?n:{default:n}).default);i.default=r},{"../../core/Shader":44}],178:[function(t,e,i){Math.sign||(Math.sign=function(t){return 0===(t=Number(t))||isNaN(t)?t:0<t?1:-1})},{}],179:[function(t,e,i){Number.isInteger||(Number.isInteger=function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t})},{}],180:[function(t,e,i){var n,o=t("object-assign"),r=(n=o)&&n.__esModule?n:{default:n};Object.assign||(Object.assign=r.default)},{"object-assign":6}],181:[function(t,e,i){t("./Object.assign"),t("./requestAnimationFrame"),t("./Math.sign"),t("./Number.isInteger"),window.ArrayBuffer||(window.ArrayBuffer=Array),window.Float32Array||(window.Float32Array=Array),window.Uint32Array||(window.Uint32Array=Array),window.Uint16Array||(window.Uint16Array=Array)},{"./Math.sign":178,"./Number.isInteger":179,"./Object.assign":180,"./requestAnimationFrame":182}],182:[function(t,e,i){(function(t){if(Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),!t.performance||!t.performance.now){var e=Date.now();t.performance||(t.performance={}),t.performance.now=function(){return Date.now()-e}}for(var n=Date.now(),i=["ms","moz","webkit","o"],o=0;o<i.length&&!t.requestAnimationFrame;++o){var r=i[o];t.requestAnimationFrame=t[r+"RequestAnimationFrame"],t.cancelAnimationFrame=t[r+"CancelAnimationFrame"]||t[r+"CancelRequestAnimationFrame"]}t.requestAnimationFrame||(t.requestAnimationFrame=function(t){if("function"!=typeof t)throw new TypeError(t+"is not a function");var e=Date.now(),i=16+n-e;return i<0&&(i=0),n=e,setTimeout(function(){n=Date.now(),t(performance.now())},i)}),t.cancelAnimationFrame||(t.cancelAnimationFrame=function(t){return clearTimeout(t)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],183:[function(t,e,i){i.__esModule=!0;var n,a=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}}(t("../core")),o=t("./limiters/CountLimiter"),r=(n=o)&&n.__esModule?n:{default:n};var l=a.ticker.shared;a.settings.UPLOADS_PER_FRAME=4;var s=function(){function i(t){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),this.limiter=new r.default(a.settings.UPLOADS_PER_FRAME),this.renderer=t,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=function(){e.queue&&e.prepareItems()},this.registerFindHook(f),this.registerFindHook(d),this.registerFindHook(h),this.registerFindHook(u),this.registerFindHook(c),this.registerUploadHook(p),this.registerUploadHook(m)}return i.prototype.upload=function(t,e){"function"==typeof t&&(e=t,t=null),t&&this.add(t),this.queue.length?(e&&this.completes.push(e),this.ticking||(this.ticking=!0,l.addOnce(this.tick,this,a.UPDATE_PRIORITY.UTILITY))):e&&e()},i.prototype.tick=function(){setTimeout(this.delayedTick,0)},i.prototype.prepareItems=function(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){var t=this.queue[0],e=!1;if(t&&!t._destroyed)for(var i=0,n=this.uploadHooks.length;i<n;i++)if(this.uploadHooks[i](this.uploadHookHelper,t)){this.queue.shift(),e=!0;break}e||this.queue.shift()}if(this.queue.length)l.addOnce(this.tick,this,a.UPDATE_PRIORITY.UTILITY);else{this.ticking=!1;for(var o=this.completes.slice(0),r=this.completes.length=0,s=o.length;r<s;r++)o[r]()}},i.prototype.registerFindHook=function(t){return t&&this.addHooks.push(t),this},i.prototype.registerUploadHook=function(t){return t&&this.uploadHooks.push(t),this},i.prototype.add=function(t){for(var e=0,i=this.addHooks.length;e<i&&!this.addHooks[e](t,this.queue);e++);if(t instanceof a.Container)for(var n=t.children.length-1;0<=n;n--)this.add(t.children[n]);return this},i.prototype.destroy=function(){this.ticking&&l.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null},i}();function h(t,e){var i=!1;if(t&&t._textures&&t._textures.length)for(var n=0;n<t._textures.length;n++)if(t._textures[n]instanceof a.Texture){var o=t._textures[n].baseTexture;-1===e.indexOf(o)&&(e.push(o),i=!0)}return i}function u(t,e){return t instanceof a.BaseTexture&&(-1===e.indexOf(t)&&e.push(t),!0)}function c(t,e){if(t._texture&&t._texture instanceof a.Texture){var i=t._texture.baseTexture;return-1===e.indexOf(i)&&e.push(i),!0}return!1}function p(t,e){return e instanceof a.Text&&(e.updateText(!0),!0)}function m(t,e){if(e instanceof a.TextStyle){var i=e.toFontString();return a.TextMetrics.measureFont(i),!0}return!1}function f(t,e){if(t instanceof a.Text){-1===e.indexOf(t.style)&&e.push(t.style),-1===e.indexOf(t)&&e.push(t);var i=t._texture.baseTexture;return-1===e.indexOf(i)&&e.push(i),!0}return!1}function d(t,e){return t instanceof a.TextStyle&&(-1===e.indexOf(t)&&e.push(t),!0)}i.default=s},{"../core":65,"./limiters/CountLimiter":186}],184:[function(t,e,i){i.__esModule=!0;var n,r=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}}(t("../../core")),o=t("../BasePrepare"),s=(n=o)&&n.__esModule?n:{default:n};var a=function(i){function n(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n);var e=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,i.call(this,t));return(e.uploadHookHelper=e).canvas=document.createElement("canvas"),e.canvas.width=16,e.canvas.height=16,e.ctx=e.canvas.getContext("2d"),e.registerUploadHook(l),e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(n,i),n.prototype.destroy=function(){i.prototype.destroy.call(this),this.ctx=null,this.canvas=null},n}(s.default);function l(t,e){if(e instanceof r.BaseTexture){var i=e.source,n=0===i.width?t.canvas.width:Math.min(t.canvas.width,i.width),o=0===i.height?t.canvas.height:Math.min(t.canvas.height,i.height);return t.ctx.drawImage(i,0,0,n,o,0,0,t.canvas.width,t.canvas.height),!0}return!1}i.default=a,r.CanvasRenderer.registerPlugin("prepare",a)},{"../../core":65,"../BasePrepare":183}],185:[function(t,e,i){i.__esModule=!0;var n=t("./webgl/WebGLPrepare");Object.defineProperty(i,"webgl",{enumerable:!0,get:function(){return l(n).default}});var o=t("./canvas/CanvasPrepare");Object.defineProperty(i,"canvas",{enumerable:!0,get:function(){return l(o).default}});var r=t("./BasePrepare");Object.defineProperty(i,"BasePrepare",{enumerable:!0,get:function(){return l(r).default}});var s=t("./limiters/CountLimiter");Object.defineProperty(i,"CountLimiter",{enumerable:!0,get:function(){return l(s).default}});var a=t("./limiters/TimeLimiter");function l(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(i,"TimeLimiter",{enumerable:!0,get:function(){return l(a).default}})},{"./BasePrepare":183,"./canvas/CanvasPrepare":184,"./limiters/CountLimiter":186,"./limiters/TimeLimiter":187,"./webgl/WebGLPrepare":188}],186:[function(t,e,i){i.__esModule=!0;var n=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.maxItemsPerFrame=t,this.itemsLeft=0}return e.prototype.beginFrame=function(){this.itemsLeft=this.maxItemsPerFrame},e.prototype.allowedToUpload=function(){return 0<this.itemsLeft--},e}();i.default=n},{}],187:[function(t,e,i){i.__esModule=!0;var n=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.maxMilliseconds=t,this.frameStart=0}return e.prototype.beginFrame=function(){this.frameStart=Date.now()},e.prototype.allowedToUpload=function(){return Date.now()-this.frameStart<this.maxMilliseconds},e}();i.default=n},{}],188:[function(t,e,i){i.__esModule=!0;var n,o=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}}(t("../../core")),r=t("../BasePrepare");var s=function(i){function n(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n);var e=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,i.call(this,t));return e.uploadHookHelper=e.renderer,e.registerFindHook(h),e.registerUploadHook(a),e.registerUploadHook(l),e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(n,i),n}(((n=r)&&n.__esModule?n:{default:n}).default);function a(t,e){return e instanceof o.BaseTexture&&(e._glTextures[t.CONTEXT_UID]||t.textureManager.updateTexture(e),!0)}function l(t,e){return e instanceof o.Graphics&&((e.dirty||e.clearDirty||!e._webGL[t.plugins.graphics.CONTEXT_UID])&&t.plugins.graphics.updateGraphics(e),!0)}function h(t,e){return t instanceof o.Graphics&&(e.push(t),!0)}i.default=s,o.WebGLRenderer.registerPlugin("prepare",s)},{"../../core":65,"../BasePrepare":183}],189:[function(y,t,x){(function(t){x.__esModule=!0,x.loader=x.prepare=x.particles=x.mesh=x.loaders=x.interaction=x.filters=x.extras=x.extract=x.accessibility=void 0;var e=y("./polyfill");Object.keys(e).forEach(function(t){"default"!==t&&"__esModule"!==t&&Object.defineProperty(x,t,{enumerable:!0,get:function(){return e[t]}})});var i=y("./core");Object.keys(i).forEach(function(t){"default"!==t&&"__esModule"!==t&&Object.defineProperty(x,t,{enumerable:!0,get:function(){return i[t]}})});var n,o=y("./deprecation"),r=(n=o)&&n.__esModule?n:{default:n},s=d(y("./accessibility")),a=d(y("./extract")),l=d(y("./extras")),h=d(y("./filters")),u=d(y("./interaction")),c=d(y("./loaders")),p=d(y("./mesh")),m=d(y("./particles")),f=d(y("./prepare"));function d(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}i.utils.mixins.performMixins();var _=c.shared||null;x.accessibility=s,x.extract=a,x.extras=l,x.filters=h,x.interaction=u,x.loaders=c,x.mesh=p,x.particles=m,x.prepare=f,x.loader=_,"function"==typeof r.default&&(0,r.default)(x),t.PIXI=x}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./accessibility":42,"./core":65,"./deprecation":131,"./extract":133,"./extras":141,"./filters":153,"./interaction":159,"./loaders":162,"./mesh":171,"./particles":174,"./polyfill":181,"./prepare":185}]},{},[189])(189)});
//# sourceMappingURL=libs.min.js.map
